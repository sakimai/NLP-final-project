2024-11-04 18:05:15,245:INFO: Effective parameters:
2024-11-04 18:05:15,246:INFO:   <<< alpha: 0.8
2024-11-04 18:05:15,246:INFO:   <<< aug_choose: t2v
2024-11-04 18:05:15,246:INFO:   <<< batch_size: 512
2024-11-04 18:05:15,246:INFO:   <<< batch_size_val: 256
2024-11-04 18:05:15,246:INFO:   <<< cache_dir: 
2024-11-04 18:05:15,246:INFO:   <<< cla_weight_dir: cla_weight
2024-11-04 18:05:15,246:INFO:   <<< coef_lr: 1.0
2024-11-04 18:05:15,246:INFO:   <<< combine_type: sum
2024-11-04 18:05:15,246:INFO:   <<< cross_att_layers: 1
2024-11-04 18:05:15,246:INFO:   <<< cross_model: cross-base
2024-11-04 18:05:15,246:INFO:   <<< cross_num_hidden_layers: 4
2024-11-04 18:05:15,246:INFO:   <<< data_path: data_h2
2024-11-04 18:05:15,246:INFO:   <<< datatype: h2s
2024-11-04 18:05:15,247:INFO:   <<< debug: False
2024-11-04 18:05:15,247:INFO:   <<< distributed: True
2024-11-04 18:05:15,247:INFO:   <<< do_eval: True
2024-11-04 18:05:15,247:INFO:   <<< do_lower_case: False
2024-11-04 18:05:15,247:INFO:   <<< do_pretrain: False
2024-11-04 18:05:15,247:INFO:   <<< do_train: False
2024-11-04 18:05:15,247:INFO:   <<< dual_mix: 0.5
2024-11-04 18:05:15,247:INFO:   <<< epochs: 200
2024-11-04 18:05:15,247:INFO:   <<< eval_frame_order: 0
2024-11-04 18:05:15,247:INFO:   <<< expand_msrvtt_sentences: False
2024-11-04 18:05:15,247:INFO:   <<< feature_framerate: 1
2024-11-04 18:05:15,247:INFO:   <<< feature_len: 64
2024-11-04 18:05:15,248:INFO:   <<< features_path: sign_feature/h2s_domain_agnostic
2024-11-04 18:05:15,248:INFO:   <<< features_path_retrain: sign_feature/h2s_domain_aware
2024-11-04 18:05:15,248:INFO:   <<< fp16: True
2024-11-04 18:05:15,248:INFO:   <<< fp16_opt_level: O1
2024-11-04 18:05:15,248:INFO:   <<< freeze_layer_num: 0
2024-11-04 18:05:15,248:INFO:   <<< gpu_ids: [0, 1]
2024-11-04 18:05:15,248:INFO:   <<< gradient_accumulation_steps: 1
2024-11-04 18:05:15,248:INFO:   <<< hard_negative_rate: 0.5
2024-11-04 18:05:15,248:INFO:   <<< init_model: chpt/H2S_sota.pth
2024-11-04 18:05:15,248:INFO:   <<< linear_patch: 2d
2024-11-04 18:05:15,248:INFO:   <<< local_rank: 0
2024-11-04 18:05:15,248:INFO:   <<< loose_type: True
2024-11-04 18:05:15,248:INFO:   <<< lr: 1e-05
2024-11-04 18:05:15,249:INFO:   <<< lr_decay: 0.001
2024-11-04 18:05:15,249:INFO:   <<< margin: 0.1
2024-11-04 18:05:15,249:INFO:   <<< max_frames: 128
2024-11-04 18:05:15,249:INFO:   <<< max_words: 32
2024-11-04 18:05:15,249:INFO:   <<< mix_design: balance
2024-11-04 18:05:15,249:INFO:   <<< n_display: 1
2024-11-04 18:05:15,249:INFO:   <<< n_gpu: 1
2024-11-04 18:05:15,249:INFO:   <<< n_pair: 1
2024-11-04 18:05:15,249:INFO:   <<< negative_weighting: 1
2024-11-04 18:05:15,249:INFO:   <<< not_load_visual: False
2024-11-04 18:05:15,249:INFO:   <<< num_thread_reader: 8
2024-11-04 18:05:15,249:INFO:   <<< output_dir: new_experiment
2024-11-04 18:05:15,250:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-11-04 18:05:15,250:INFO:   <<< rank: 0
2024-11-04 18:05:15,250:INFO:   <<< resume_model: None
2024-11-04 18:05:15,250:INFO:   <<< sampled_use_mil: False
2024-11-04 18:05:15,250:INFO:   <<< seed: 42
2024-11-04 18:05:15,250:INFO:   <<< sim_calcu: softmax_max
2024-11-04 18:05:15,250:INFO:   <<< sim_header: Filip
2024-11-04 18:05:15,250:INFO:   <<< slice_framepos: 0
2024-11-04 18:05:15,250:INFO:   <<< task_type: retrieval
2024-11-04 18:05:15,250:INFO:   <<< tau: 0.07
2024-11-04 18:05:15,250:INFO:   <<< text_aug: True
2024-11-04 18:05:15,250:INFO:   <<< text_aug_choosen: random_swap
2024-11-04 18:05:15,250:INFO:   <<< text_num_hidden_layers: 12
2024-11-04 18:05:15,251:INFO:   <<< train_frame_order: 0
2024-11-04 18:05:15,251:INFO:   <<< use_mil: False
2024-11-04 18:05:15,251:INFO:   <<< video_dim: 1024
2024-11-04 18:05:15,251:INFO:   <<< visual_num_hidden_layers: 12
2024-11-04 18:05:15,251:INFO:   <<< warmup_proportion: 0.1
2024-11-04 18:05:15,251:INFO:   <<< world_size: 1
2024-11-04 18:05:15,252:INFO: device: cuda:0 n_gpu: 1
2024-11-04 20:56:39,250:INFO: Effective parameters:
2024-11-04 20:56:39,251:INFO:   <<< alpha: 0.8
2024-11-04 20:56:39,251:INFO:   <<< aug_choose: t2v
2024-11-04 20:56:39,251:INFO:   <<< batch_size: 512
2024-11-04 20:56:39,251:INFO:   <<< batch_size_val: 256
2024-11-04 20:56:39,251:INFO:   <<< cache_dir: 
2024-11-04 20:56:39,251:INFO:   <<< cla_weight_dir: cla_weight
2024-11-04 20:56:39,251:INFO:   <<< coef_lr: 1.0
2024-11-04 20:56:39,251:INFO:   <<< combine_type: sum
2024-11-04 20:56:39,251:INFO:   <<< cross_att_layers: 1
2024-11-04 20:56:39,251:INFO:   <<< cross_model: cross-base
2024-11-04 20:56:39,251:INFO:   <<< cross_num_hidden_layers: 4
2024-11-04 20:56:39,251:INFO:   <<< data_path: data_h2
2024-11-04 20:56:39,252:INFO:   <<< datatype: h2s
2024-11-04 20:56:39,252:INFO:   <<< debug: False
2024-11-04 20:56:39,252:INFO:   <<< distributed: True
2024-11-04 20:56:39,252:INFO:   <<< do_eval: True
2024-11-04 20:56:39,252:INFO:   <<< do_lower_case: False
2024-11-04 20:56:39,252:INFO:   <<< do_pretrain: False
2024-11-04 20:56:39,252:INFO:   <<< do_train: False
2024-11-04 20:56:39,252:INFO:   <<< dual_mix: 0.5
2024-11-04 20:56:39,252:INFO:   <<< epochs: 200
2024-11-04 20:56:39,252:INFO:   <<< eval_frame_order: 0
2024-11-04 20:56:39,252:INFO:   <<< expand_msrvtt_sentences: False
2024-11-04 20:56:39,252:INFO:   <<< feature_framerate: 1
2024-11-04 20:56:39,252:INFO:   <<< feature_len: 64
2024-11-04 20:56:39,252:INFO:   <<< features_path: sign_feature/h2s_domain_agnostic
2024-11-04 20:56:39,252:INFO:   <<< features_path_retrain: sign_feature/h2s_domain_aware
2024-11-04 20:56:39,252:INFO:   <<< fp16: True
2024-11-04 20:56:39,252:INFO:   <<< fp16_opt_level: O1
2024-11-04 20:56:39,252:INFO:   <<< freeze_layer_num: 0
2024-11-04 20:56:39,252:INFO:   <<< gpu_ids: [0, 1]
2024-11-04 20:56:39,253:INFO:   <<< gradient_accumulation_steps: 1
2024-11-04 20:56:39,253:INFO:   <<< hard_negative_rate: 0.5
2024-11-04 20:56:39,253:INFO:   <<< init_model: chpt/H2S_sota.pth
2024-11-04 20:56:39,253:INFO:   <<< linear_patch: 2d
2024-11-04 20:56:39,253:INFO:   <<< local_rank: 0
2024-11-04 20:56:39,253:INFO:   <<< loose_type: True
2024-11-04 20:56:39,253:INFO:   <<< lr: 1e-05
2024-11-04 20:56:39,253:INFO:   <<< lr_decay: 0.001
2024-11-04 20:56:39,253:INFO:   <<< margin: 0.1
2024-11-04 20:56:39,253:INFO:   <<< max_frames: 128
2024-11-04 20:56:39,253:INFO:   <<< max_words: 32
2024-11-04 20:56:39,253:INFO:   <<< mix_design: balance
2024-11-04 20:56:39,253:INFO:   <<< n_display: 1
2024-11-04 20:56:39,253:INFO:   <<< n_gpu: 1
2024-11-04 20:56:39,253:INFO:   <<< n_pair: 1
2024-11-04 20:56:39,253:INFO:   <<< negative_weighting: 1
2024-11-04 20:56:39,253:INFO:   <<< not_load_visual: False
2024-11-04 20:56:39,253:INFO:   <<< num_thread_reader: 8
2024-11-04 20:56:39,254:INFO:   <<< output_dir: new_experiment
2024-11-04 20:56:39,254:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-11-04 20:56:39,254:INFO:   <<< rank: 0
2024-11-04 20:56:39,254:INFO:   <<< resume_model: None
2024-11-04 20:56:39,254:INFO:   <<< sampled_use_mil: False
2024-11-04 20:56:39,254:INFO:   <<< seed: 42
2024-11-04 20:56:39,254:INFO:   <<< sim_calcu: softmax_max
2024-11-04 20:56:39,254:INFO:   <<< sim_header: Filip
2024-11-04 20:56:39,254:INFO:   <<< slice_framepos: 0
2024-11-04 20:56:39,254:INFO:   <<< task_type: retrieval
2024-11-04 20:56:39,254:INFO:   <<< tau: 0.07
2024-11-04 20:56:39,254:INFO:   <<< text_aug: True
2024-11-04 20:56:39,254:INFO:   <<< text_aug_choosen: random_swap
2024-11-04 20:56:39,254:INFO:   <<< text_num_hidden_layers: 12
2024-11-04 20:56:39,254:INFO:   <<< train_frame_order: 0
2024-11-04 20:56:39,254:INFO:   <<< use_mil: False
2024-11-04 20:56:39,254:INFO:   <<< video_dim: 1024
2024-11-04 20:56:39,254:INFO:   <<< visual_num_hidden_layers: 12
2024-11-04 20:56:39,255:INFO:   <<< warmup_proportion: 0.1
2024-11-04 20:56:39,255:INFO:   <<< world_size: 1
2024-11-04 20:56:39,255:INFO: device: cuda:0 n_gpu: 1
2024-11-04 20:57:44,290:INFO: Effective parameters:
2024-11-04 20:57:44,290:INFO:   <<< alpha: 0.8
2024-11-04 20:57:44,290:INFO:   <<< aug_choose: t2v
2024-11-04 20:57:44,290:INFO:   <<< batch_size: 512
2024-11-04 20:57:44,290:INFO:   <<< batch_size_val: 256
2024-11-04 20:57:44,290:INFO:   <<< cache_dir: 
2024-11-04 20:57:44,290:INFO:   <<< cla_weight_dir: cla_weight
2024-11-04 20:57:44,290:INFO:   <<< coef_lr: 1.0
2024-11-04 20:57:44,290:INFO:   <<< combine_type: sum
2024-11-04 20:57:44,290:INFO:   <<< cross_att_layers: 1
2024-11-04 20:57:44,290:INFO:   <<< cross_model: cross-base
2024-11-04 20:57:44,290:INFO:   <<< cross_num_hidden_layers: 4
2024-11-04 20:57:44,291:INFO:   <<< data_path: data_h2
2024-11-04 20:57:44,291:INFO:   <<< datatype: h2s
2024-11-04 20:57:44,291:INFO:   <<< debug: False
2024-11-04 20:57:44,291:INFO:   <<< distributed: True
2024-11-04 20:57:44,291:INFO:   <<< do_eval: True
2024-11-04 20:57:44,291:INFO:   <<< do_lower_case: False
2024-11-04 20:57:44,291:INFO:   <<< do_pretrain: False
2024-11-04 20:57:44,291:INFO:   <<< do_train: False
2024-11-04 20:57:44,291:INFO:   <<< dual_mix: 0.5
2024-11-04 20:57:44,291:INFO:   <<< epochs: 200
2024-11-04 20:57:44,291:INFO:   <<< eval_frame_order: 0
2024-11-04 20:57:44,291:INFO:   <<< expand_msrvtt_sentences: False
2024-11-04 20:57:44,291:INFO:   <<< feature_framerate: 1
2024-11-04 20:57:44,291:INFO:   <<< feature_len: 64
2024-11-04 20:57:44,291:INFO:   <<< features_path: sign_feature/h2s_domain_agnostic
2024-11-04 20:57:44,291:INFO:   <<< features_path_retrain: sign_feature/h2s_domain_aware
2024-11-04 20:57:44,291:INFO:   <<< fp16: True
2024-11-04 20:57:44,291:INFO:   <<< fp16_opt_level: O1
2024-11-04 20:57:44,292:INFO:   <<< freeze_layer_num: 0
2024-11-04 20:57:44,292:INFO:   <<< gpu_ids: [0, 1]
2024-11-04 20:57:44,292:INFO:   <<< gradient_accumulation_steps: 1
2024-11-04 20:57:44,292:INFO:   <<< hard_negative_rate: 0.5
2024-11-04 20:57:44,292:INFO:   <<< init_model: chpt/H2S_sota.pth
2024-11-04 20:57:44,292:INFO:   <<< linear_patch: 2d
2024-11-04 20:57:44,292:INFO:   <<< local_rank: 0
2024-11-04 20:57:44,292:INFO:   <<< loose_type: True
2024-11-04 20:57:44,292:INFO:   <<< lr: 1e-05
2024-11-04 20:57:44,292:INFO:   <<< lr_decay: 0.001
2024-11-04 20:57:44,292:INFO:   <<< margin: 0.1
2024-11-04 20:57:44,292:INFO:   <<< max_frames: 128
2024-11-04 20:57:44,292:INFO:   <<< max_words: 32
2024-11-04 20:57:44,292:INFO:   <<< mix_design: balance
2024-11-04 20:57:44,292:INFO:   <<< n_display: 1
2024-11-04 20:57:44,292:INFO:   <<< n_gpu: 1
2024-11-04 20:57:44,292:INFO:   <<< n_pair: 1
2024-11-04 20:57:44,293:INFO:   <<< negative_weighting: 1
2024-11-04 20:57:44,293:INFO:   <<< not_load_visual: False
2024-11-04 20:57:44,293:INFO:   <<< num_thread_reader: 8
2024-11-04 20:57:44,293:INFO:   <<< output_dir: new_experiment
2024-11-04 20:57:44,293:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-11-04 20:57:44,293:INFO:   <<< rank: 0
2024-11-04 20:57:44,293:INFO:   <<< resume_model: None
2024-11-04 20:57:44,293:INFO:   <<< sampled_use_mil: False
2024-11-04 20:57:44,293:INFO:   <<< seed: 42
2024-11-04 20:57:44,293:INFO:   <<< sim_calcu: softmax_max
2024-11-04 20:57:44,293:INFO:   <<< sim_header: Filip
2024-11-04 20:57:44,293:INFO:   <<< slice_framepos: 0
2024-11-04 20:57:44,293:INFO:   <<< task_type: retrieval
2024-11-04 20:57:44,293:INFO:   <<< tau: 0.07
2024-11-04 20:57:44,293:INFO:   <<< text_aug: True
2024-11-04 20:57:44,293:INFO:   <<< text_aug_choosen: random_swap
2024-11-04 20:57:44,293:INFO:   <<< text_num_hidden_layers: 12
2024-11-04 20:57:44,294:INFO:   <<< train_frame_order: 0
2024-11-04 20:57:44,294:INFO:   <<< use_mil: False
2024-11-04 20:57:44,294:INFO:   <<< video_dim: 1024
2024-11-04 20:57:44,294:INFO:   <<< visual_num_hidden_layers: 12
2024-11-04 20:57:44,294:INFO:   <<< warmup_proportion: 0.1
2024-11-04 20:57:44,294:INFO:   <<< world_size: 1
2024-11-04 20:57:44,294:INFO: device: cuda:0 n_gpu: 1
2024-11-04 20:57:50,004:INFO: loading archive file /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base
2024-11-04 20:57:50,007:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-11-04 20:57:50,008:INFO: Weight doesn't exsits. /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base/cross_pytorch_model.bin
2024-11-04 20:57:50,008:WARNING: Stage-One:True, Stage-Two:False
2024-11-04 20:57:50,008:WARNING: Test retrieval by loose type.
2024-11-04 20:57:50,008:WARNING: 	 embed_dim: 512
2024-11-04 20:57:50,008:WARNING: 	 image_resolution: 224
2024-11-04 20:57:50,008:WARNING: 	 vision_layers: 12
2024-11-04 20:57:50,008:WARNING: 	 vision_width: 768
2024-11-04 20:57:50,008:WARNING: 	 vision_patch_size: 32
2024-11-04 20:57:50,008:WARNING: 	 context_length: 77
2024-11-04 20:57:50,009:WARNING: 	 vocab_size: 49408
2024-11-04 20:57:50,009:WARNING: 	 transformer_width: 512
2024-11-04 20:57:50,009:WARNING: 	 transformer_heads: 8
2024-11-04 20:57:50,009:WARNING: 	 transformer_layers: 12
2024-11-04 20:57:50,009:WARNING: 		 linear_patch: 2d
2024-11-04 20:57:50,009:WARNING: 	 cut_top_layer: 0
2024-11-04 20:57:51,976:WARNING: 	 sim_header: Filip
2024-11-04 20:57:59,344:INFO: --------------------
2024-11-04 20:57:59,344:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-11-04 20:57:59,455:INFO: ***** Running test *****
2024-11-04 20:57:59,455:INFO:   Num examples = 2348
2024-11-04 20:57:59,455:INFO:   Batch size = 256
2024-11-04 20:57:59,455:INFO:   Num steps = 10
2024-11-04 20:57:59,934:WARNING: Eval under the multi-sentence per video clip setting.
2024-11-04 20:57:59,934:WARNING: sentence num: 1969, video num: 2348
2024-11-04 21:00:03,724:INFO: Effective parameters:
2024-11-04 21:00:03,724:INFO:   <<< alpha: 0.8
2024-11-04 21:00:03,724:INFO:   <<< aug_choose: t2v
2024-11-04 21:00:03,724:INFO:   <<< batch_size: 512
2024-11-04 21:00:03,724:INFO:   <<< batch_size_val: 256
2024-11-04 21:00:03,724:INFO:   <<< cache_dir: 
2024-11-04 21:00:03,724:INFO:   <<< cla_weight_dir: cla_weight
2024-11-04 21:00:03,724:INFO:   <<< coef_lr: 1.0
2024-11-04 21:00:03,724:INFO:   <<< combine_type: sum
2024-11-04 21:00:03,724:INFO:   <<< cross_att_layers: 1
2024-11-04 21:00:03,724:INFO:   <<< cross_model: cross-base
2024-11-04 21:00:03,724:INFO:   <<< cross_num_hidden_layers: 4
2024-11-04 21:00:03,724:INFO:   <<< data_path: data_h2
2024-11-04 21:00:03,725:INFO:   <<< datatype: h2s
2024-11-04 21:00:03,725:INFO:   <<< debug: False
2024-11-04 21:00:03,725:INFO:   <<< distributed: True
2024-11-04 21:00:03,725:INFO:   <<< do_eval: True
2024-11-04 21:00:03,725:INFO:   <<< do_lower_case: False
2024-11-04 21:00:03,725:INFO:   <<< do_pretrain: False
2024-11-04 21:00:03,725:INFO:   <<< do_train: False
2024-11-04 21:00:03,725:INFO:   <<< dual_mix: 0.5
2024-11-04 21:00:03,725:INFO:   <<< epochs: 200
2024-11-04 21:00:03,725:INFO:   <<< eval_frame_order: 0
2024-11-04 21:00:03,725:INFO:   <<< expand_msrvtt_sentences: False
2024-11-04 21:00:03,725:INFO:   <<< feature_framerate: 1
2024-11-04 21:00:03,725:INFO:   <<< feature_len: 64
2024-11-04 21:00:03,725:INFO:   <<< features_path: sign_feature/h2s_domain_agnostic
2024-11-04 21:00:03,725:INFO:   <<< features_path_retrain: sign_feature/h2s_domain_aware
2024-11-04 21:00:03,725:INFO:   <<< fp16: True
2024-11-04 21:00:03,725:INFO:   <<< fp16_opt_level: O1
2024-11-04 21:00:03,726:INFO:   <<< freeze_layer_num: 0
2024-11-04 21:00:03,726:INFO:   <<< gpu_ids: [0, 1]
2024-11-04 21:00:03,726:INFO:   <<< gradient_accumulation_steps: 1
2024-11-04 21:00:03,726:INFO:   <<< hard_negative_rate: 0.5
2024-11-04 21:00:03,726:INFO:   <<< init_model: chpt/H2S_sota.pth
2024-11-04 21:00:03,726:INFO:   <<< linear_patch: 2d
2024-11-04 21:00:03,726:INFO:   <<< local_rank: 0
2024-11-04 21:00:03,726:INFO:   <<< loose_type: True
2024-11-04 21:00:03,726:INFO:   <<< lr: 1e-05
2024-11-04 21:00:03,726:INFO:   <<< lr_decay: 0.001
2024-11-04 21:00:03,726:INFO:   <<< margin: 0.1
2024-11-04 21:00:03,726:INFO:   <<< max_frames: 128
2024-11-04 21:00:03,726:INFO:   <<< max_words: 32
2024-11-04 21:00:03,726:INFO:   <<< mix_design: balance
2024-11-04 21:00:03,726:INFO:   <<< n_display: 1
2024-11-04 21:00:03,726:INFO:   <<< n_gpu: 1
2024-11-04 21:00:03,726:INFO:   <<< n_pair: 1
2024-11-04 21:00:03,727:INFO:   <<< negative_weighting: 1
2024-11-04 21:00:03,727:INFO:   <<< not_load_visual: False
2024-11-04 21:00:03,727:INFO:   <<< num_thread_reader: 8
2024-11-04 21:00:03,727:INFO:   <<< output_dir: new_experiment
2024-11-04 21:00:03,727:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-11-04 21:00:03,727:INFO:   <<< rank: 0
2024-11-04 21:00:03,727:INFO:   <<< resume_model: None
2024-11-04 21:00:03,727:INFO:   <<< sampled_use_mil: False
2024-11-04 21:00:03,727:INFO:   <<< seed: 42
2024-11-04 21:00:03,727:INFO:   <<< sim_calcu: softmax_max
2024-11-04 21:00:03,727:INFO:   <<< sim_header: Filip
2024-11-04 21:00:03,727:INFO:   <<< slice_framepos: 0
2024-11-04 21:00:03,727:INFO:   <<< task_type: retrieval
2024-11-04 21:00:03,727:INFO:   <<< tau: 0.07
2024-11-04 21:00:03,727:INFO:   <<< text_aug: True
2024-11-04 21:00:03,727:INFO:   <<< text_aug_choosen: random_swap
2024-11-04 21:00:03,727:INFO:   <<< text_num_hidden_layers: 12
2024-11-04 21:00:03,727:INFO:   <<< train_frame_order: 0
2024-11-04 21:00:03,728:INFO:   <<< use_mil: False
2024-11-04 21:00:03,728:INFO:   <<< video_dim: 1024
2024-11-04 21:00:03,728:INFO:   <<< visual_num_hidden_layers: 12
2024-11-04 21:00:03,728:INFO:   <<< warmup_proportion: 0.1
2024-11-04 21:00:03,728:INFO:   <<< world_size: 1
2024-11-04 21:00:03,728:INFO: device: cuda:0 n_gpu: 1
2024-11-04 21:00:05,716:INFO: loading archive file /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base
2024-11-04 21:00:05,718:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-11-04 21:00:05,718:INFO: Weight doesn't exsits. /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base/cross_pytorch_model.bin
2024-11-04 21:00:05,719:WARNING: Stage-One:True, Stage-Two:False
2024-11-04 21:00:05,719:WARNING: Test retrieval by loose type.
2024-11-04 21:00:05,719:WARNING: 	 embed_dim: 512
2024-11-04 21:00:05,719:WARNING: 	 image_resolution: 224
2024-11-04 21:00:05,719:WARNING: 	 vision_layers: 12
2024-11-04 21:00:05,719:WARNING: 	 vision_width: 768
2024-11-04 21:00:05,719:WARNING: 	 vision_patch_size: 32
2024-11-04 21:00:05,719:WARNING: 	 context_length: 77
2024-11-04 21:00:05,719:WARNING: 	 vocab_size: 49408
2024-11-04 21:00:05,719:WARNING: 	 transformer_width: 512
2024-11-04 21:00:05,719:WARNING: 	 transformer_heads: 8
2024-11-04 21:00:05,719:WARNING: 	 transformer_layers: 12
2024-11-04 21:00:05,719:WARNING: 		 linear_patch: 2d
2024-11-04 21:00:05,719:WARNING: 	 cut_top_layer: 0
2024-11-04 21:00:07,631:WARNING: 	 sim_header: Filip
2024-11-04 21:00:14,892:INFO: --------------------
2024-11-04 21:00:14,892:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-11-04 21:00:14,998:INFO: ***** Running test *****
2024-11-04 21:00:14,998:INFO:   Num examples = 2348
2024-11-04 21:00:14,998:INFO:   Batch size = 256
2024-11-04 21:00:14,998:INFO:   Num steps = 10
2024-11-04 21:00:15,228:WARNING: Eval under the multi-sentence per video clip setting.
2024-11-04 21:00:15,228:WARNING: sentence num: 1969, video num: 2348
2024-11-04 21:01:31,737:INFO: Effective parameters:
2024-11-04 21:01:31,737:INFO:   <<< alpha: 0.8
2024-11-04 21:01:31,737:INFO:   <<< aug_choose: t2v
2024-11-04 21:01:31,737:INFO:   <<< batch_size: 512
2024-11-04 21:01:31,737:INFO:   <<< batch_size_val: 256
2024-11-04 21:01:31,737:INFO:   <<< cache_dir: 
2024-11-04 21:01:31,737:INFO:   <<< cla_weight_dir: cla_weight
2024-11-04 21:01:31,738:INFO:   <<< coef_lr: 1.0
2024-11-04 21:01:31,738:INFO:   <<< combine_type: sum
2024-11-04 21:01:31,738:INFO:   <<< cross_att_layers: 1
2024-11-04 21:01:31,738:INFO:   <<< cross_model: cross-base
2024-11-04 21:01:31,738:INFO:   <<< cross_num_hidden_layers: 4
2024-11-04 21:01:31,738:INFO:   <<< data_path: data_h2
2024-11-04 21:01:31,738:INFO:   <<< datatype: h2s
2024-11-04 21:01:31,738:INFO:   <<< debug: False
2024-11-04 21:01:31,738:INFO:   <<< distributed: True
2024-11-04 21:01:31,738:INFO:   <<< do_eval: True
2024-11-04 21:01:31,738:INFO:   <<< do_lower_case: False
2024-11-04 21:01:31,738:INFO:   <<< do_pretrain: False
2024-11-04 21:01:31,738:INFO:   <<< do_train: False
2024-11-04 21:01:31,738:INFO:   <<< dual_mix: 0.5
2024-11-04 21:01:31,738:INFO:   <<< epochs: 200
2024-11-04 21:01:31,738:INFO:   <<< eval_frame_order: 0
2024-11-04 21:01:31,738:INFO:   <<< expand_msrvtt_sentences: False
2024-11-04 21:01:31,739:INFO:   <<< feature_framerate: 1
2024-11-04 21:01:31,739:INFO:   <<< feature_len: 64
2024-11-04 21:01:31,739:INFO:   <<< features_path: sign_feature/h2s_domain_agnostic
2024-11-04 21:01:31,739:INFO:   <<< features_path_retrain: sign_feature/h2s_domain_aware
2024-11-04 21:01:31,739:INFO:   <<< fp16: True
2024-11-04 21:01:31,739:INFO:   <<< fp16_opt_level: O1
2024-11-04 21:01:31,739:INFO:   <<< freeze_layer_num: 0
2024-11-04 21:01:31,739:INFO:   <<< gpu_ids: [0, 1]
2024-11-04 21:01:31,739:INFO:   <<< gradient_accumulation_steps: 1
2024-11-04 21:01:31,739:INFO:   <<< hard_negative_rate: 0.5
2024-11-04 21:01:31,739:INFO:   <<< init_model: chpt/H2S_sota.pth
2024-11-04 21:01:31,739:INFO:   <<< linear_patch: 2d
2024-11-04 21:01:31,739:INFO:   <<< local_rank: 0
2024-11-04 21:01:31,739:INFO:   <<< loose_type: True
2024-11-04 21:01:31,739:INFO:   <<< lr: 1e-05
2024-11-04 21:01:31,739:INFO:   <<< lr_decay: 0.001
2024-11-04 21:01:31,739:INFO:   <<< margin: 0.1
2024-11-04 21:01:31,740:INFO:   <<< max_frames: 128
2024-11-04 21:01:31,740:INFO:   <<< max_words: 32
2024-11-04 21:01:31,740:INFO:   <<< mix_design: balance
2024-11-04 21:01:31,740:INFO:   <<< n_display: 1
2024-11-04 21:01:31,740:INFO:   <<< n_gpu: 1
2024-11-04 21:01:31,740:INFO:   <<< n_pair: 1
2024-11-04 21:01:31,740:INFO:   <<< negative_weighting: 1
2024-11-04 21:01:31,740:INFO:   <<< not_load_visual: False
2024-11-04 21:01:31,740:INFO:   <<< num_thread_reader: 8
2024-11-04 21:01:31,740:INFO:   <<< output_dir: new_experiment
2024-11-04 21:01:31,740:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-11-04 21:01:31,740:INFO:   <<< rank: 0
2024-11-04 21:01:31,740:INFO:   <<< resume_model: None
2024-11-04 21:01:31,740:INFO:   <<< sampled_use_mil: False
2024-11-04 21:01:31,740:INFO:   <<< seed: 42
2024-11-04 21:01:31,740:INFO:   <<< sim_calcu: softmax_max
2024-11-04 21:01:31,740:INFO:   <<< sim_header: Filip
2024-11-04 21:01:31,741:INFO:   <<< slice_framepos: 0
2024-11-04 21:01:31,741:INFO:   <<< task_type: retrieval
2024-11-04 21:01:31,741:INFO:   <<< tau: 0.07
2024-11-04 21:01:31,741:INFO:   <<< text_aug: True
2024-11-04 21:01:31,741:INFO:   <<< text_aug_choosen: random_swap
2024-11-04 21:01:31,741:INFO:   <<< text_num_hidden_layers: 12
2024-11-04 21:01:31,741:INFO:   <<< train_frame_order: 0
2024-11-04 21:01:31,741:INFO:   <<< use_mil: False
2024-11-04 21:01:31,741:INFO:   <<< video_dim: 1024
2024-11-04 21:01:31,741:INFO:   <<< visual_num_hidden_layers: 12
2024-11-04 21:01:31,741:INFO:   <<< warmup_proportion: 0.1
2024-11-04 21:01:31,741:INFO:   <<< world_size: 1
2024-11-04 21:01:31,742:INFO: device: cuda:0 n_gpu: 1
2024-11-04 21:01:33,650:INFO: loading archive file /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base
2024-11-04 21:01:33,651:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-11-04 21:01:33,651:INFO: Weight doesn't exsits. /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base/cross_pytorch_model.bin
2024-11-04 21:01:33,651:WARNING: Stage-One:True, Stage-Two:False
2024-11-04 21:01:33,651:WARNING: Test retrieval by loose type.
2024-11-04 21:01:33,652:WARNING: 	 embed_dim: 512
2024-11-04 21:01:33,652:WARNING: 	 image_resolution: 224
2024-11-04 21:01:33,652:WARNING: 	 vision_layers: 12
2024-11-04 21:01:33,652:WARNING: 	 vision_width: 768
2024-11-04 21:01:33,652:WARNING: 	 vision_patch_size: 32
2024-11-04 21:01:33,652:WARNING: 	 context_length: 77
2024-11-04 21:01:33,652:WARNING: 	 vocab_size: 49408
2024-11-04 21:01:33,652:WARNING: 	 transformer_width: 512
2024-11-04 21:01:33,652:WARNING: 	 transformer_heads: 8
2024-11-04 21:01:33,652:WARNING: 	 transformer_layers: 12
2024-11-04 21:01:33,652:WARNING: 		 linear_patch: 2d
2024-11-04 21:01:33,652:WARNING: 	 cut_top_layer: 0
2024-11-04 21:01:35,665:WARNING: 	 sim_header: Filip
2024-11-04 21:01:43,598:INFO: --------------------
2024-11-04 21:01:43,599:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-11-04 21:01:43,710:INFO: ***** Running test *****
2024-11-04 21:01:43,710:INFO:   Num examples = 2348
2024-11-04 21:01:43,710:INFO:   Batch size = 256
2024-11-04 21:01:43,710:INFO:   Num steps = 10
2024-11-04 21:01:44,169:WARNING: Eval under the multi-sentence per video clip setting.
2024-11-04 21:01:44,169:WARNING: sentence num: 1969, video num: 2348
2024-11-04 21:11:13,535:INFO: Effective parameters:
2024-11-04 21:11:13,536:INFO:   <<< alpha: 0.8
2024-11-04 21:11:13,536:INFO:   <<< aug_choose: t2v
2024-11-04 21:11:13,536:INFO:   <<< batch_size: 512
2024-11-04 21:11:13,536:INFO:   <<< batch_size_val: 256
2024-11-04 21:11:13,536:INFO:   <<< cache_dir: 
2024-11-04 21:11:13,536:INFO:   <<< cla_weight_dir: cla_weight
2024-11-04 21:11:13,536:INFO:   <<< coef_lr: 1.0
2024-11-04 21:11:13,536:INFO:   <<< combine_type: sum
2024-11-04 21:11:13,536:INFO:   <<< cross_att_layers: 1
2024-11-04 21:11:13,536:INFO:   <<< cross_model: cross-base
2024-11-04 21:11:13,536:INFO:   <<< cross_num_hidden_layers: 4
2024-11-04 21:11:13,536:INFO:   <<< data_path: data_h2
2024-11-04 21:11:13,536:INFO:   <<< datatype: h2s
2024-11-04 21:11:13,536:INFO:   <<< debug: False
2024-11-04 21:11:13,536:INFO:   <<< distributed: True
2024-11-04 21:11:13,537:INFO:   <<< do_eval: True
2024-11-04 21:11:13,537:INFO:   <<< do_lower_case: False
2024-11-04 21:11:13,537:INFO:   <<< do_pretrain: False
2024-11-04 21:11:13,537:INFO:   <<< do_train: False
2024-11-04 21:11:13,537:INFO:   <<< dual_mix: 0.5
2024-11-04 21:11:13,537:INFO:   <<< epochs: 200
2024-11-04 21:11:13,537:INFO:   <<< eval_frame_order: 0
2024-11-04 21:11:13,537:INFO:   <<< expand_msrvtt_sentences: False
2024-11-04 21:11:13,537:INFO:   <<< feature_framerate: 1
2024-11-04 21:11:13,537:INFO:   <<< feature_len: 64
2024-11-04 21:11:13,537:INFO:   <<< features_path: sign_feature/h2s_domain_agnostic
2024-11-04 21:11:13,537:INFO:   <<< features_path_retrain: sign_feature/h2s_domain_aware
2024-11-04 21:11:13,537:INFO:   <<< fp16: True
2024-11-04 21:11:13,537:INFO:   <<< fp16_opt_level: O1
2024-11-04 21:11:13,537:INFO:   <<< freeze_layer_num: 0
2024-11-04 21:11:13,537:INFO:   <<< gpu_ids: [0, 1]
2024-11-04 21:11:13,537:INFO:   <<< gradient_accumulation_steps: 1
2024-11-04 21:11:13,538:INFO:   <<< hard_negative_rate: 0.5
2024-11-04 21:11:13,538:INFO:   <<< init_model: chpt/H2S_sota.pth
2024-11-04 21:11:13,538:INFO:   <<< linear_patch: 2d
2024-11-04 21:11:13,538:INFO:   <<< local_rank: 0
2024-11-04 21:11:13,538:INFO:   <<< loose_type: True
2024-11-04 21:11:13,538:INFO:   <<< lr: 1e-05
2024-11-04 21:11:13,538:INFO:   <<< lr_decay: 0.001
2024-11-04 21:11:13,538:INFO:   <<< margin: 0.1
2024-11-04 21:11:13,538:INFO:   <<< max_frames: 128
2024-11-04 21:11:13,538:INFO:   <<< max_words: 32
2024-11-04 21:11:13,538:INFO:   <<< mix_design: balance
2024-11-04 21:11:13,538:INFO:   <<< n_display: 1
2024-11-04 21:11:13,538:INFO:   <<< n_gpu: 1
2024-11-04 21:11:13,538:INFO:   <<< n_pair: 1
2024-11-04 21:11:13,538:INFO:   <<< negative_weighting: 1
2024-11-04 21:11:13,538:INFO:   <<< not_load_visual: False
2024-11-04 21:11:13,538:INFO:   <<< num_thread_reader: 8
2024-11-04 21:11:13,539:INFO:   <<< output_dir: new_experiment
2024-11-04 21:11:13,539:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-11-04 21:11:13,539:INFO:   <<< rank: 0
2024-11-04 21:11:13,539:INFO:   <<< resume_model: None
2024-11-04 21:11:13,539:INFO:   <<< sampled_use_mil: False
2024-11-04 21:11:13,539:INFO:   <<< seed: 42
2024-11-04 21:11:13,539:INFO:   <<< sim_calcu: softmax_max
2024-11-04 21:11:13,539:INFO:   <<< sim_header: Filip
2024-11-04 21:11:13,539:INFO:   <<< slice_framepos: 0
2024-11-04 21:11:13,539:INFO:   <<< task_type: retrieval
2024-11-04 21:11:13,539:INFO:   <<< tau: 0.07
2024-11-04 21:11:13,539:INFO:   <<< text_aug: True
2024-11-04 21:11:13,539:INFO:   <<< text_aug_choosen: random_swap
2024-11-04 21:11:13,539:INFO:   <<< text_num_hidden_layers: 12
2024-11-04 21:11:13,539:INFO:   <<< train_frame_order: 0
2024-11-04 21:11:13,539:INFO:   <<< use_mil: False
2024-11-04 21:11:13,540:INFO:   <<< video_dim: 1024
2024-11-04 21:11:13,540:INFO:   <<< visual_num_hidden_layers: 12
2024-11-04 21:11:13,540:INFO:   <<< warmup_proportion: 0.1
2024-11-04 21:11:13,540:INFO:   <<< world_size: 1
2024-11-04 21:11:13,540:INFO: device: cuda:0 n_gpu: 1
2024-11-04 21:11:15,474:INFO: loading archive file /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base
2024-11-04 21:11:15,475:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-11-04 21:11:15,476:INFO: Weight doesn't exsits. /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base/cross_pytorch_model.bin
2024-11-04 21:11:15,476:WARNING: Stage-One:True, Stage-Two:False
2024-11-04 21:11:15,476:WARNING: Test retrieval by loose type.
2024-11-04 21:11:15,476:WARNING: 	 embed_dim: 512
2024-11-04 21:11:15,476:WARNING: 	 image_resolution: 224
2024-11-04 21:11:15,476:WARNING: 	 vision_layers: 12
2024-11-04 21:11:15,476:WARNING: 	 vision_width: 768
2024-11-04 21:11:15,476:WARNING: 	 vision_patch_size: 32
2024-11-04 21:11:15,477:WARNING: 	 context_length: 77
2024-11-04 21:11:15,477:WARNING: 	 vocab_size: 49408
2024-11-04 21:11:15,477:WARNING: 	 transformer_width: 512
2024-11-04 21:11:15,477:WARNING: 	 transformer_heads: 8
2024-11-04 21:11:15,477:WARNING: 	 transformer_layers: 12
2024-11-04 21:11:15,477:WARNING: 		 linear_patch: 2d
2024-11-04 21:11:15,477:WARNING: 	 cut_top_layer: 0
2024-11-04 21:11:17,395:WARNING: 	 sim_header: Filip
2024-11-04 21:11:24,649:INFO: --------------------
2024-11-04 21:11:24,650:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-11-04 21:11:24,754:INFO: ***** Running test *****
2024-11-04 21:11:24,755:INFO:   Num examples = 2348
2024-11-04 21:11:24,755:INFO:   Batch size = 256
2024-11-04 21:11:24,755:INFO:   Num steps = 10
2024-11-04 21:11:25,139:WARNING: Eval under the multi-sentence per video clip setting.
2024-11-04 21:11:25,139:WARNING: sentence num: 1969, video num: 2348
2024-11-04 21:12:35,288:INFO: Effective parameters:
2024-11-04 21:12:35,288:INFO:   <<< alpha: 0.8
2024-11-04 21:12:35,288:INFO:   <<< aug_choose: t2v
2024-11-04 21:12:35,288:INFO:   <<< batch_size: 512
2024-11-04 21:12:35,288:INFO:   <<< batch_size_val: 256
2024-11-04 21:12:35,288:INFO:   <<< cache_dir: 
2024-11-04 21:12:35,288:INFO:   <<< cla_weight_dir: cla_weight
2024-11-04 21:12:35,288:INFO:   <<< coef_lr: 1.0
2024-11-04 21:12:35,289:INFO:   <<< combine_type: sum
2024-11-04 21:12:35,289:INFO:   <<< cross_att_layers: 1
2024-11-04 21:12:35,289:INFO:   <<< cross_model: cross-base
2024-11-04 21:12:35,289:INFO:   <<< cross_num_hidden_layers: 4
2024-11-04 21:12:35,289:INFO:   <<< data_path: data_h2
2024-11-04 21:12:35,289:INFO:   <<< datatype: h2s
2024-11-04 21:12:35,289:INFO:   <<< debug: False
2024-11-04 21:12:35,289:INFO:   <<< distributed: True
2024-11-04 21:12:35,289:INFO:   <<< do_eval: True
2024-11-04 21:12:35,289:INFO:   <<< do_lower_case: False
2024-11-04 21:12:35,289:INFO:   <<< do_pretrain: False
2024-11-04 21:12:35,289:INFO:   <<< do_train: False
2024-11-04 21:12:35,289:INFO:   <<< dual_mix: 0.5
2024-11-04 21:12:35,289:INFO:   <<< epochs: 200
2024-11-04 21:12:35,289:INFO:   <<< eval_frame_order: 0
2024-11-04 21:12:35,289:INFO:   <<< expand_msrvtt_sentences: False
2024-11-04 21:12:35,289:INFO:   <<< feature_framerate: 1
2024-11-04 21:12:35,290:INFO:   <<< feature_len: 64
2024-11-04 21:12:35,290:INFO:   <<< features_path: sign_feature/h2s_domain_agnostic
2024-11-04 21:12:35,290:INFO:   <<< features_path_retrain: sign_feature/h2s_domain_aware
2024-11-04 21:12:35,290:INFO:   <<< fp16: True
2024-11-04 21:12:35,290:INFO:   <<< fp16_opt_level: O1
2024-11-04 21:12:35,290:INFO:   <<< freeze_layer_num: 0
2024-11-04 21:12:35,290:INFO:   <<< gpu_ids: [0, 1]
2024-11-04 21:12:35,290:INFO:   <<< gradient_accumulation_steps: 1
2024-11-04 21:12:35,290:INFO:   <<< hard_negative_rate: 0.5
2024-11-04 21:12:35,290:INFO:   <<< init_model: chpt/H2S_sota.pth
2024-11-04 21:12:35,290:INFO:   <<< linear_patch: 2d
2024-11-04 21:12:35,290:INFO:   <<< local_rank: 0
2024-11-04 21:12:35,290:INFO:   <<< loose_type: True
2024-11-04 21:12:35,290:INFO:   <<< lr: 1e-05
2024-11-04 21:12:35,290:INFO:   <<< lr_decay: 0.001
2024-11-04 21:12:35,290:INFO:   <<< margin: 0.1
2024-11-04 21:12:35,291:INFO:   <<< max_frames: 128
2024-11-04 21:12:35,291:INFO:   <<< max_words: 32
2024-11-04 21:12:35,291:INFO:   <<< mix_design: balance
2024-11-04 21:12:35,291:INFO:   <<< n_display: 1
2024-11-04 21:12:35,291:INFO:   <<< n_gpu: 1
2024-11-04 21:12:35,291:INFO:   <<< n_pair: 1
2024-11-04 21:12:35,291:INFO:   <<< negative_weighting: 1
2024-11-04 21:12:35,291:INFO:   <<< not_load_visual: False
2024-11-04 21:12:35,291:INFO:   <<< num_thread_reader: 8
2024-11-04 21:12:35,291:INFO:   <<< output_dir: new_experiment
2024-11-04 21:12:35,291:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-11-04 21:12:35,291:INFO:   <<< rank: 0
2024-11-04 21:12:35,291:INFO:   <<< resume_model: None
2024-11-04 21:12:35,291:INFO:   <<< sampled_use_mil: False
2024-11-04 21:12:35,291:INFO:   <<< seed: 42
2024-11-04 21:12:35,291:INFO:   <<< sim_calcu: softmax_max
2024-11-04 21:12:35,291:INFO:   <<< sim_header: Filip
2024-11-04 21:12:35,292:INFO:   <<< slice_framepos: 0
2024-11-04 21:12:35,292:INFO:   <<< task_type: retrieval
2024-11-04 21:12:35,292:INFO:   <<< tau: 0.07
2024-11-04 21:12:35,292:INFO:   <<< text_aug: True
2024-11-04 21:12:35,292:INFO:   <<< text_aug_choosen: random_swap
2024-11-04 21:12:35,292:INFO:   <<< text_num_hidden_layers: 12
2024-11-04 21:12:35,292:INFO:   <<< train_frame_order: 0
2024-11-04 21:12:35,292:INFO:   <<< use_mil: False
2024-11-04 21:12:35,292:INFO:   <<< video_dim: 1024
2024-11-04 21:12:35,292:INFO:   <<< visual_num_hidden_layers: 12
2024-11-04 21:12:35,292:INFO:   <<< warmup_proportion: 0.1
2024-11-04 21:12:35,292:INFO:   <<< world_size: 1
2024-11-04 21:12:35,293:INFO: device: cuda:0 n_gpu: 1
2024-11-04 21:12:37,238:INFO: loading archive file /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base
2024-11-04 21:12:37,240:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-11-04 21:12:37,240:INFO: Weight doesn't exsits. /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base/cross_pytorch_model.bin
2024-11-04 21:12:37,240:WARNING: Stage-One:True, Stage-Two:False
2024-11-04 21:12:37,240:WARNING: Test retrieval by loose type.
2024-11-04 21:12:37,240:WARNING: 	 embed_dim: 512
2024-11-04 21:12:37,240:WARNING: 	 image_resolution: 224
2024-11-04 21:12:37,241:WARNING: 	 vision_layers: 12
2024-11-04 21:12:37,241:WARNING: 	 vision_width: 768
2024-11-04 21:12:37,241:WARNING: 	 vision_patch_size: 32
2024-11-04 21:12:37,241:WARNING: 	 context_length: 77
2024-11-04 21:12:37,241:WARNING: 	 vocab_size: 49408
2024-11-04 21:12:37,241:WARNING: 	 transformer_width: 512
2024-11-04 21:12:37,241:WARNING: 	 transformer_heads: 8
2024-11-04 21:12:37,241:WARNING: 	 transformer_layers: 12
2024-11-04 21:12:37,241:WARNING: 		 linear_patch: 2d
2024-11-04 21:12:37,241:WARNING: 	 cut_top_layer: 0
2024-11-04 21:12:39,165:WARNING: 	 sim_header: Filip
2024-11-04 21:12:46,417:INFO: --------------------
2024-11-04 21:12:46,418:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-11-04 21:12:46,554:INFO: ***** Running test *****
2024-11-04 21:12:46,554:INFO:   Num examples = 2348
2024-11-04 21:12:46,554:INFO:   Batch size = 256
2024-11-04 21:12:46,554:INFO:   Num steps = 10
2024-11-04 21:12:46,930:WARNING: Eval under the multi-sentence per video clip setting.
2024-11-04 21:12:46,930:WARNING: sentence num: 1969, video num: 2348
2024-11-04 21:47:04,514:INFO: Effective parameters:
2024-11-04 21:47:04,514:INFO:   <<< alpha: 0.8
2024-11-04 21:47:04,514:INFO:   <<< aug_choose: t2v
2024-11-04 21:47:04,514:INFO:   <<< batch_size: 512
2024-11-04 21:47:04,514:INFO:   <<< batch_size_val: 256
2024-11-04 21:47:04,514:INFO:   <<< cache_dir: 
2024-11-04 21:47:04,514:INFO:   <<< cla_weight_dir: cla_weight
2024-11-04 21:47:04,515:INFO:   <<< coef_lr: 1.0
2024-11-04 21:47:04,515:INFO:   <<< combine_type: sum
2024-11-04 21:47:04,515:INFO:   <<< cross_att_layers: 1
2024-11-04 21:47:04,515:INFO:   <<< cross_model: cross-base
2024-11-04 21:47:04,515:INFO:   <<< cross_num_hidden_layers: 4
2024-11-04 21:47:04,515:INFO:   <<< data_path: data_h2
2024-11-04 21:47:04,515:INFO:   <<< datatype: h2s
2024-11-04 21:47:04,515:INFO:   <<< debug: False
2024-11-04 21:47:04,515:INFO:   <<< distributed: True
2024-11-04 21:47:04,515:INFO:   <<< do_eval: True
2024-11-04 21:47:04,515:INFO:   <<< do_lower_case: False
2024-11-04 21:47:04,515:INFO:   <<< do_pretrain: False
2024-11-04 21:47:04,515:INFO:   <<< do_train: False
2024-11-04 21:47:04,515:INFO:   <<< dual_mix: 0.5
2024-11-04 21:47:04,515:INFO:   <<< epochs: 200
2024-11-04 21:47:04,515:INFO:   <<< eval_frame_order: 0
2024-11-04 21:47:04,515:INFO:   <<< expand_msrvtt_sentences: False
2024-11-04 21:47:04,515:INFO:   <<< feature_framerate: 1
2024-11-04 21:47:04,516:INFO:   <<< feature_len: 64
2024-11-04 21:47:04,516:INFO:   <<< features_path: sign_feature/h2s_domain_agnostic
2024-11-04 21:47:04,516:INFO:   <<< features_path_retrain: sign_feature/h2s_domain_aware
2024-11-04 21:47:04,516:INFO:   <<< fp16: True
2024-11-04 21:47:04,516:INFO:   <<< fp16_opt_level: O1
2024-11-04 21:47:04,516:INFO:   <<< freeze_layer_num: 0
2024-11-04 21:47:04,516:INFO:   <<< gpu_ids: [0, 1]
2024-11-04 21:47:04,516:INFO:   <<< gradient_accumulation_steps: 1
2024-11-04 21:47:04,516:INFO:   <<< hard_negative_rate: 0.5
2024-11-04 21:47:04,516:INFO:   <<< init_model: chpt/H2S_sota.pth
2024-11-04 21:47:04,516:INFO:   <<< linear_patch: 2d
2024-11-04 21:47:04,516:INFO:   <<< local_rank: 0
2024-11-04 21:47:04,516:INFO:   <<< loose_type: True
2024-11-04 21:47:04,516:INFO:   <<< lr: 1e-05
2024-11-04 21:47:04,516:INFO:   <<< lr_decay: 0.001
2024-11-04 21:47:04,516:INFO:   <<< margin: 0.1
2024-11-04 21:47:04,516:INFO:   <<< max_frames: 128
2024-11-04 21:47:04,516:INFO:   <<< max_words: 32
2024-11-04 21:47:04,516:INFO:   <<< mix_design: balance
2024-11-04 21:47:04,517:INFO:   <<< n_display: 1
2024-11-04 21:47:04,517:INFO:   <<< n_gpu: 1
2024-11-04 21:47:04,517:INFO:   <<< n_pair: 1
2024-11-04 21:47:04,517:INFO:   <<< negative_weighting: 1
2024-11-04 21:47:04,517:INFO:   <<< not_load_visual: False
2024-11-04 21:47:04,517:INFO:   <<< num_thread_reader: 8
2024-11-04 21:47:04,517:INFO:   <<< output_dir: new_experiment
2024-11-04 21:47:04,517:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-11-04 21:47:04,517:INFO:   <<< rank: 0
2024-11-04 21:47:04,517:INFO:   <<< resume_model: None
2024-11-04 21:47:04,517:INFO:   <<< sampled_use_mil: False
2024-11-04 21:47:04,517:INFO:   <<< seed: 42
2024-11-04 21:47:04,517:INFO:   <<< sim_calcu: softmax_max
2024-11-04 21:47:04,517:INFO:   <<< sim_header: Filip
2024-11-04 21:47:04,517:INFO:   <<< slice_framepos: 0
2024-11-04 21:47:04,517:INFO:   <<< task_type: retrieval
2024-11-04 21:47:04,517:INFO:   <<< tau: 0.07
2024-11-04 21:47:04,517:INFO:   <<< text_aug: True
2024-11-04 21:47:04,518:INFO:   <<< text_aug_choosen: random_swap
2024-11-04 21:47:04,518:INFO:   <<< text_num_hidden_layers: 12
2024-11-04 21:47:04,518:INFO:   <<< train_frame_order: 0
2024-11-04 21:47:04,518:INFO:   <<< use_mil: False
2024-11-04 21:47:04,518:INFO:   <<< video_dim: 1024
2024-11-04 21:47:04,518:INFO:   <<< visual_num_hidden_layers: 12
2024-11-04 21:47:04,518:INFO:   <<< warmup_proportion: 0.1
2024-11-04 21:47:04,518:INFO:   <<< world_size: 1
2024-11-04 21:47:04,518:INFO: device: cuda:0 n_gpu: 1
2024-11-04 21:47:06,441:INFO: loading archive file /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base
2024-11-04 21:47:06,444:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-11-04 21:47:06,444:INFO: Weight doesn't exsits. /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base/cross_pytorch_model.bin
2024-11-04 21:47:06,444:WARNING: Stage-One:True, Stage-Two:False
2024-11-04 21:47:06,444:WARNING: Test retrieval by loose type.
2024-11-04 21:47:06,444:WARNING: 	 embed_dim: 512
2024-11-04 21:47:06,444:WARNING: 	 image_resolution: 224
2024-11-04 21:47:06,444:WARNING: 	 vision_layers: 12
2024-11-04 21:47:06,444:WARNING: 	 vision_width: 768
2024-11-04 21:47:06,444:WARNING: 	 vision_patch_size: 32
2024-11-04 21:47:06,445:WARNING: 	 context_length: 77
2024-11-04 21:47:06,445:WARNING: 	 vocab_size: 49408
2024-11-04 21:47:06,445:WARNING: 	 transformer_width: 512
2024-11-04 21:47:06,445:WARNING: 	 transformer_heads: 8
2024-11-04 21:47:06,445:WARNING: 	 transformer_layers: 12
2024-11-04 21:47:06,445:WARNING: 		 linear_patch: 2d
2024-11-04 21:47:06,445:WARNING: 	 cut_top_layer: 0
2024-11-04 21:47:08,363:WARNING: 	 sim_header: Filip
2024-11-04 21:47:15,629:INFO: --------------------
2024-11-04 21:47:15,629:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-11-04 21:47:15,739:INFO: ***** Running test *****
2024-11-04 21:47:15,739:INFO:   Num examples = 2348
2024-11-04 21:47:15,739:INFO:   Batch size = 256
2024-11-04 21:47:15,739:INFO:   Num steps = 10
2024-11-04 21:47:16,329:WARNING: Eval under the multi-sentence per video clip setting.
2024-11-04 21:47:16,329:WARNING: sentence num: 1969, video num: 2348
2024-11-04 21:51:20,742:INFO: Effective parameters:
2024-11-04 21:51:20,742:INFO:   <<< alpha: 0.8
2024-11-04 21:51:20,742:INFO:   <<< aug_choose: t2v
2024-11-04 21:51:20,742:INFO:   <<< batch_size: 512
2024-11-04 21:51:20,742:INFO:   <<< batch_size_val: 256
2024-11-04 21:51:20,742:INFO:   <<< cache_dir: 
2024-11-04 21:51:20,743:INFO:   <<< cla_weight_dir: cla_weight
2024-11-04 21:51:20,743:INFO:   <<< coef_lr: 1.0
2024-11-04 21:51:20,743:INFO:   <<< combine_type: sum
2024-11-04 21:51:20,743:INFO:   <<< cross_att_layers: 1
2024-11-04 21:51:20,743:INFO:   <<< cross_model: cross-base
2024-11-04 21:51:20,743:INFO:   <<< cross_num_hidden_layers: 4
2024-11-04 21:51:20,743:INFO:   <<< data_path: data_h2
2024-11-04 21:51:20,743:INFO:   <<< datatype: h2s
2024-11-04 21:51:20,743:INFO:   <<< debug: False
2024-11-04 21:51:20,743:INFO:   <<< distributed: True
2024-11-04 21:51:20,743:INFO:   <<< do_eval: True
2024-11-04 21:51:20,743:INFO:   <<< do_lower_case: False
2024-11-04 21:51:20,743:INFO:   <<< do_pretrain: False
2024-11-04 21:51:20,743:INFO:   <<< do_train: False
2024-11-04 21:51:20,743:INFO:   <<< dual_mix: 0.5
2024-11-04 21:51:20,743:INFO:   <<< epochs: 200
2024-11-04 21:51:20,743:INFO:   <<< eval_frame_order: 0
2024-11-04 21:51:20,743:INFO:   <<< expand_msrvtt_sentences: False
2024-11-04 21:51:20,743:INFO:   <<< feature_framerate: 1
2024-11-04 21:51:20,743:INFO:   <<< feature_len: 64
2024-11-04 21:51:20,743:INFO:   <<< features_path: sign_feature/h2s_domain_agnostic
2024-11-04 21:51:20,744:INFO:   <<< features_path_retrain: sign_feature/h2s_domain_aware
2024-11-04 21:51:20,744:INFO:   <<< fp16: True
2024-11-04 21:51:20,744:INFO:   <<< fp16_opt_level: O1
2024-11-04 21:51:20,744:INFO:   <<< freeze_layer_num: 0
2024-11-04 21:51:20,744:INFO:   <<< gpu_ids: [0, 1]
2024-11-04 21:51:20,744:INFO:   <<< gradient_accumulation_steps: 1
2024-11-04 21:51:20,744:INFO:   <<< hard_negative_rate: 0.5
2024-11-04 21:51:20,744:INFO:   <<< init_model: chpt/H2S_sota.pth
2024-11-04 21:51:20,744:INFO:   <<< linear_patch: 2d
2024-11-04 21:51:20,744:INFO:   <<< local_rank: 0
2024-11-04 21:51:20,744:INFO:   <<< loose_type: True
2024-11-04 21:51:20,744:INFO:   <<< lr: 1e-05
2024-11-04 21:51:20,744:INFO:   <<< lr_decay: 0.001
2024-11-04 21:51:20,744:INFO:   <<< margin: 0.1
2024-11-04 21:51:20,744:INFO:   <<< max_frames: 128
2024-11-04 21:51:20,744:INFO:   <<< max_words: 32
2024-11-04 21:51:20,744:INFO:   <<< mix_design: balance
2024-11-04 21:51:20,744:INFO:   <<< n_display: 1
2024-11-04 21:51:20,744:INFO:   <<< n_gpu: 1
2024-11-04 21:51:20,744:INFO:   <<< n_pair: 1
2024-11-04 21:51:20,745:INFO:   <<< negative_weighting: 1
2024-11-04 21:51:20,745:INFO:   <<< not_load_visual: False
2024-11-04 21:51:20,745:INFO:   <<< num_thread_reader: 8
2024-11-04 21:51:20,745:INFO:   <<< output_dir: new_experiment
2024-11-04 21:51:20,745:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-11-04 21:51:20,745:INFO:   <<< rank: 0
2024-11-04 21:51:20,745:INFO:   <<< resume_model: None
2024-11-04 21:51:20,745:INFO:   <<< sampled_use_mil: False
2024-11-04 21:51:20,745:INFO:   <<< seed: 42
2024-11-04 21:51:20,745:INFO:   <<< sim_calcu: softmax_max
2024-11-04 21:51:20,745:INFO:   <<< sim_header: Filip
2024-11-04 21:51:20,745:INFO:   <<< slice_framepos: 0
2024-11-04 21:51:20,745:INFO:   <<< task_type: retrieval
2024-11-04 21:51:20,745:INFO:   <<< tau: 0.07
2024-11-04 21:51:20,745:INFO:   <<< text_aug: True
2024-11-04 21:51:20,745:INFO:   <<< text_aug_choosen: random_swap
2024-11-04 21:51:20,745:INFO:   <<< text_num_hidden_layers: 12
2024-11-04 21:51:20,745:INFO:   <<< train_frame_order: 0
2024-11-04 21:51:20,745:INFO:   <<< use_mil: False
2024-11-04 21:51:20,745:INFO:   <<< video_dim: 1024
2024-11-04 21:51:20,745:INFO:   <<< visual_num_hidden_layers: 12
2024-11-04 21:51:20,746:INFO:   <<< warmup_proportion: 0.1
2024-11-04 21:51:20,746:INFO:   <<< world_size: 1
2024-11-04 21:51:20,746:INFO: device: cuda:0 n_gpu: 1
2024-11-04 21:51:22,953:INFO: loading archive file /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base
2024-11-04 21:51:22,954:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-11-04 21:51:22,954:INFO: Weight doesn't exsits. /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base/cross_pytorch_model.bin
2024-11-04 21:51:22,955:WARNING: Stage-One:True, Stage-Two:False
2024-11-04 21:51:22,955:WARNING: Test retrieval by loose type.
2024-11-04 21:51:22,955:WARNING: 	 embed_dim: 512
2024-11-04 21:51:22,955:WARNING: 	 image_resolution: 224
2024-11-04 21:51:22,955:WARNING: 	 vision_layers: 12
2024-11-04 21:51:22,955:WARNING: 	 vision_width: 768
2024-11-04 21:51:22,955:WARNING: 	 vision_patch_size: 32
2024-11-04 21:51:22,955:WARNING: 	 context_length: 77
2024-11-04 21:51:22,955:WARNING: 	 vocab_size: 49408
2024-11-04 21:51:22,955:WARNING: 	 transformer_width: 512
2024-11-04 21:51:22,955:WARNING: 	 transformer_heads: 8
2024-11-04 21:51:22,955:WARNING: 	 transformer_layers: 12
2024-11-04 21:51:22,955:WARNING: 		 linear_patch: 2d
2024-11-04 21:51:22,956:WARNING: 	 cut_top_layer: 0
2024-11-04 21:51:25,108:WARNING: 	 sim_header: Filip
2024-11-04 21:51:32,718:INFO: --------------------
2024-11-04 21:51:32,718:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-11-04 21:51:32,834:INFO: ***** Running test *****
2024-11-04 21:51:32,835:INFO:   Num examples = 2348
2024-11-04 21:51:32,835:INFO:   Batch size = 256
2024-11-04 21:51:32,835:INFO:   Num steps = 10
2024-11-04 21:51:33,500:WARNING: Eval under the multi-sentence per video clip setting.
2024-11-04 21:51:33,500:WARNING: sentence num: 1969, video num: 2348
2024-11-04 21:59:23,409:INFO: Effective parameters:
2024-11-04 21:59:23,410:INFO:   <<< alpha: 0.8
2024-11-04 21:59:23,410:INFO:   <<< aug_choose: t2v
2024-11-04 21:59:23,410:INFO:   <<< batch_size: 512
2024-11-04 21:59:23,410:INFO:   <<< batch_size_val: 256
2024-11-04 21:59:23,410:INFO:   <<< cache_dir: 
2024-11-04 21:59:23,410:INFO:   <<< cla_weight_dir: cla_weight
2024-11-04 21:59:23,410:INFO:   <<< coef_lr: 1.0
2024-11-04 21:59:23,410:INFO:   <<< combine_type: sum
2024-11-04 21:59:23,410:INFO:   <<< cross_att_layers: 1
2024-11-04 21:59:23,410:INFO:   <<< cross_model: cross-base
2024-11-04 21:59:23,410:INFO:   <<< cross_num_hidden_layers: 4
2024-11-04 21:59:23,410:INFO:   <<< data_path: data_h2
2024-11-04 21:59:23,410:INFO:   <<< datatype: h2s
2024-11-04 21:59:23,410:INFO:   <<< debug: False
2024-11-04 21:59:23,410:INFO:   <<< distributed: True
2024-11-04 21:59:23,410:INFO:   <<< do_eval: True
2024-11-04 21:59:23,411:INFO:   <<< do_lower_case: False
2024-11-04 21:59:23,411:INFO:   <<< do_pretrain: False
2024-11-04 21:59:23,411:INFO:   <<< do_train: False
2024-11-04 21:59:23,411:INFO:   <<< dual_mix: 0.5
2024-11-04 21:59:23,411:INFO:   <<< epochs: 200
2024-11-04 21:59:23,411:INFO:   <<< eval_frame_order: 0
2024-11-04 21:59:23,411:INFO:   <<< expand_msrvtt_sentences: False
2024-11-04 21:59:23,411:INFO:   <<< feature_framerate: 1
2024-11-04 21:59:23,411:INFO:   <<< feature_len: 64
2024-11-04 21:59:23,411:INFO:   <<< features_path: sign_feature/h2s_domain_agnostic
2024-11-04 21:59:23,411:INFO:   <<< features_path_retrain: sign_feature/h2s_domain_aware
2024-11-04 21:59:23,411:INFO:   <<< fp16: True
2024-11-04 21:59:23,411:INFO:   <<< fp16_opt_level: O1
2024-11-04 21:59:23,411:INFO:   <<< freeze_layer_num: 0
2024-11-04 21:59:23,411:INFO:   <<< gpu_ids: [0, 1]
2024-11-04 21:59:23,411:INFO:   <<< gradient_accumulation_steps: 1
2024-11-04 21:59:23,411:INFO:   <<< hard_negative_rate: 0.5
2024-11-04 21:59:23,411:INFO:   <<< init_model: chpt/H2S_sota.pth
2024-11-04 21:59:23,411:INFO:   <<< linear_patch: 2d
2024-11-04 21:59:23,411:INFO:   <<< local_rank: 0
2024-11-04 21:59:23,411:INFO:   <<< loose_type: True
2024-11-04 21:59:23,412:INFO:   <<< lr: 1e-05
2024-11-04 21:59:23,412:INFO:   <<< lr_decay: 0.001
2024-11-04 21:59:23,412:INFO:   <<< margin: 0.1
2024-11-04 21:59:23,412:INFO:   <<< max_frames: 128
2024-11-04 21:59:23,412:INFO:   <<< max_words: 32
2024-11-04 21:59:23,412:INFO:   <<< mix_design: balance
2024-11-04 21:59:23,412:INFO:   <<< n_display: 1
2024-11-04 21:59:23,412:INFO:   <<< n_gpu: 1
2024-11-04 21:59:23,412:INFO:   <<< n_pair: 1
2024-11-04 21:59:23,412:INFO:   <<< negative_weighting: 1
2024-11-04 21:59:23,412:INFO:   <<< not_load_visual: False
2024-11-04 21:59:23,412:INFO:   <<< num_thread_reader: 8
2024-11-04 21:59:23,412:INFO:   <<< output_dir: new_experiment
2024-11-04 21:59:23,412:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-11-04 21:59:23,412:INFO:   <<< rank: 0
2024-11-04 21:59:23,412:INFO:   <<< resume_model: None
2024-11-04 21:59:23,412:INFO:   <<< sampled_use_mil: False
2024-11-04 21:59:23,412:INFO:   <<< seed: 42
2024-11-04 21:59:23,412:INFO:   <<< sim_calcu: softmax_max
2024-11-04 21:59:23,412:INFO:   <<< sim_header: Filip
2024-11-04 21:59:23,412:INFO:   <<< slice_framepos: 0
2024-11-04 21:59:23,412:INFO:   <<< task_type: retrieval
2024-11-04 21:59:23,412:INFO:   <<< tau: 0.07
2024-11-04 21:59:23,413:INFO:   <<< text_aug: True
2024-11-04 21:59:23,413:INFO:   <<< text_aug_choosen: random_swap
2024-11-04 21:59:23,413:INFO:   <<< text_num_hidden_layers: 12
2024-11-04 21:59:23,413:INFO:   <<< train_frame_order: 0
2024-11-04 21:59:23,413:INFO:   <<< use_mil: False
2024-11-04 21:59:23,413:INFO:   <<< video_dim: 1024
2024-11-04 21:59:23,413:INFO:   <<< visual_num_hidden_layers: 12
2024-11-04 21:59:23,413:INFO:   <<< warmup_proportion: 0.1
2024-11-04 21:59:23,413:INFO:   <<< world_size: 1
2024-11-04 21:59:23,413:INFO: device: cuda:0 n_gpu: 1
2024-11-04 21:59:25,344:INFO: loading archive file /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base
2024-11-04 21:59:25,350:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-11-04 21:59:25,353:INFO: Weight doesn't exsits. /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base/cross_pytorch_model.bin
2024-11-04 21:59:25,353:WARNING: Stage-One:True, Stage-Two:False
2024-11-04 21:59:25,353:WARNING: Test retrieval by loose type.
2024-11-04 21:59:25,353:WARNING: 	 embed_dim: 512
2024-11-04 21:59:25,354:WARNING: 	 image_resolution: 224
2024-11-04 21:59:25,354:WARNING: 	 vision_layers: 12
2024-11-04 21:59:25,354:WARNING: 	 vision_width: 768
2024-11-04 21:59:25,354:WARNING: 	 vision_patch_size: 32
2024-11-04 21:59:25,354:WARNING: 	 context_length: 77
2024-11-04 21:59:25,354:WARNING: 	 vocab_size: 49408
2024-11-04 21:59:25,354:WARNING: 	 transformer_width: 512
2024-11-04 21:59:25,354:WARNING: 	 transformer_heads: 8
2024-11-04 21:59:25,354:WARNING: 	 transformer_layers: 12
2024-11-04 21:59:25,354:WARNING: 		 linear_patch: 2d
2024-11-04 21:59:25,354:WARNING: 	 cut_top_layer: 0
2024-11-04 21:59:27,271:WARNING: 	 sim_header: Filip
2024-11-04 21:59:34,518:INFO: --------------------
2024-11-04 21:59:34,520:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-11-04 21:59:34,663:INFO: ***** Running test *****
2024-11-04 21:59:34,663:INFO:   Num examples = 2348
2024-11-04 21:59:34,663:INFO:   Batch size = 256
2024-11-04 21:59:34,663:INFO:   Num steps = 10
2024-11-04 21:59:36,554:WARNING: Eval under the multi-sentence per video clip setting.
2024-11-04 21:59:36,554:WARNING: sentence num: 1969, video num: 2348
2024-11-04 22:06:18,980:INFO: Effective parameters:
2024-11-04 22:06:18,980:INFO:   <<< alpha: 0.8
2024-11-04 22:06:18,980:INFO:   <<< aug_choose: t2v
2024-11-04 22:06:18,981:INFO:   <<< batch_size: 512
2024-11-04 22:06:18,981:INFO:   <<< batch_size_val: 256
2024-11-04 22:06:18,981:INFO:   <<< cache_dir: 
2024-11-04 22:06:18,981:INFO:   <<< cla_weight_dir: cla_weight
2024-11-04 22:06:18,981:INFO:   <<< coef_lr: 1.0
2024-11-04 22:06:18,981:INFO:   <<< combine_type: sum
2024-11-04 22:06:18,981:INFO:   <<< cross_att_layers: 1
2024-11-04 22:06:18,981:INFO:   <<< cross_model: cross-base
2024-11-04 22:06:18,981:INFO:   <<< cross_num_hidden_layers: 4
2024-11-04 22:06:18,981:INFO:   <<< data_path: data_h2
2024-11-04 22:06:18,981:INFO:   <<< datatype: h2s
2024-11-04 22:06:18,981:INFO:   <<< debug: False
2024-11-04 22:06:18,981:INFO:   <<< distributed: True
2024-11-04 22:06:18,981:INFO:   <<< do_eval: True
2024-11-04 22:06:18,981:INFO:   <<< do_lower_case: False
2024-11-04 22:06:18,981:INFO:   <<< do_pretrain: False
2024-11-04 22:06:18,982:INFO:   <<< do_train: False
2024-11-04 22:06:18,982:INFO:   <<< dual_mix: 0.5
2024-11-04 22:06:18,982:INFO:   <<< epochs: 200
2024-11-04 22:06:18,982:INFO:   <<< eval_frame_order: 0
2024-11-04 22:06:18,982:INFO:   <<< expand_msrvtt_sentences: False
2024-11-04 22:06:18,982:INFO:   <<< feature_framerate: 1
2024-11-04 22:06:18,982:INFO:   <<< feature_len: 64
2024-11-04 22:06:18,982:INFO:   <<< features_path: sign_feature/h2s_domain_agnostic
2024-11-04 22:06:18,982:INFO:   <<< features_path_retrain: sign_feature/h2s_domain_aware
2024-11-04 22:06:18,982:INFO:   <<< fp16: True
2024-11-04 22:06:18,982:INFO:   <<< fp16_opt_level: O1
2024-11-04 22:06:18,982:INFO:   <<< freeze_layer_num: 0
2024-11-04 22:06:18,982:INFO:   <<< gpu_ids: [0, 1]
2024-11-04 22:06:18,982:INFO:   <<< gradient_accumulation_steps: 1
2024-11-04 22:06:18,982:INFO:   <<< hard_negative_rate: 0.5
2024-11-04 22:06:18,983:INFO:   <<< init_model: chpt/H2S_sota.pth
2024-11-04 22:06:18,983:INFO:   <<< linear_patch: 2d
2024-11-04 22:06:18,983:INFO:   <<< local_rank: 0
2024-11-04 22:06:18,983:INFO:   <<< loose_type: True
2024-11-04 22:06:18,983:INFO:   <<< lr: 1e-05
2024-11-04 22:06:18,983:INFO:   <<< lr_decay: 0.001
2024-11-04 22:06:18,983:INFO:   <<< margin: 0.1
2024-11-04 22:06:18,983:INFO:   <<< max_frames: 128
2024-11-04 22:06:18,983:INFO:   <<< max_words: 32
2024-11-04 22:06:18,983:INFO:   <<< mix_design: balance
2024-11-04 22:06:18,983:INFO:   <<< n_display: 1
2024-11-04 22:06:18,983:INFO:   <<< n_gpu: 1
2024-11-04 22:06:18,983:INFO:   <<< n_pair: 1
2024-11-04 22:06:18,983:INFO:   <<< negative_weighting: 1
2024-11-04 22:06:18,984:INFO:   <<< not_load_visual: False
2024-11-04 22:06:18,984:INFO:   <<< num_thread_reader: 8
2024-11-04 22:06:18,984:INFO:   <<< output_dir: new_experiment
2024-11-04 22:06:18,984:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-11-04 22:06:18,984:INFO:   <<< rank: 0
2024-11-04 22:06:18,984:INFO:   <<< resume_model: None
2024-11-04 22:06:18,984:INFO:   <<< sampled_use_mil: False
2024-11-04 22:06:18,984:INFO:   <<< seed: 42
2024-11-04 22:06:18,984:INFO:   <<< sim_calcu: softmax_max
2024-11-04 22:06:18,984:INFO:   <<< sim_header: Filip
2024-11-04 22:06:18,984:INFO:   <<< slice_framepos: 0
2024-11-04 22:06:18,984:INFO:   <<< task_type: retrieval
2024-11-04 22:06:18,984:INFO:   <<< tau: 0.07
2024-11-04 22:06:18,984:INFO:   <<< text_aug: True
2024-11-04 22:06:18,984:INFO:   <<< text_aug_choosen: random_swap
2024-11-04 22:06:18,984:INFO:   <<< text_num_hidden_layers: 12
2024-11-04 22:06:18,985:INFO:   <<< train_frame_order: 0
2024-11-04 22:06:18,985:INFO:   <<< use_mil: False
2024-11-04 22:06:18,985:INFO:   <<< video_dim: 1024
2024-11-04 22:06:18,985:INFO:   <<< visual_num_hidden_layers: 12
2024-11-04 22:06:18,985:INFO:   <<< warmup_proportion: 0.1
2024-11-04 22:06:18,985:INFO:   <<< world_size: 1
2024-11-04 22:06:18,986:INFO: device: cuda:0 n_gpu: 1
2024-11-04 22:12:47,536:INFO: Effective parameters:
2024-11-04 22:12:47,536:INFO:   <<< alpha: 0.8
2024-11-04 22:12:47,537:INFO:   <<< aug_choose: t2v
2024-11-04 22:12:47,537:INFO:   <<< batch_size: 512
2024-11-04 22:12:47,537:INFO:   <<< batch_size_val: 256
2024-11-04 22:12:47,537:INFO:   <<< cache_dir: 
2024-11-04 22:12:47,537:INFO:   <<< cla_weight_dir: cla_weight
2024-11-04 22:12:47,537:INFO:   <<< coef_lr: 1.0
2024-11-04 22:12:47,537:INFO:   <<< combine_type: sum
2024-11-04 22:12:47,537:INFO:   <<< cross_att_layers: 1
2024-11-04 22:12:47,537:INFO:   <<< cross_model: cross-base
2024-11-04 22:12:47,537:INFO:   <<< cross_num_hidden_layers: 4
2024-11-04 22:12:47,537:INFO:   <<< data_path: data_h2
2024-11-04 22:12:47,538:INFO:   <<< datatype: h2s
2024-11-04 22:12:47,538:INFO:   <<< debug: False
2024-11-04 22:12:47,538:INFO:   <<< distributed: True
2024-11-04 22:12:47,538:INFO:   <<< do_eval: True
2024-11-04 22:12:47,538:INFO:   <<< do_lower_case: False
2024-11-04 22:12:47,538:INFO:   <<< do_pretrain: False
2024-11-04 22:12:47,538:INFO:   <<< do_train: False
2024-11-04 22:12:47,538:INFO:   <<< dual_mix: 0.5
2024-11-04 22:12:47,538:INFO:   <<< epochs: 200
2024-11-04 22:12:47,538:INFO:   <<< eval_frame_order: 0
2024-11-04 22:12:47,538:INFO:   <<< expand_msrvtt_sentences: False
2024-11-04 22:12:47,539:INFO:   <<< feature_framerate: 1
2024-11-04 22:12:47,539:INFO:   <<< feature_len: 64
2024-11-04 22:12:47,539:INFO:   <<< features_path: sign_feature/h2s_domain_agnostic
2024-11-04 22:12:47,539:INFO:   <<< features_path_retrain: sign_feature/h2s_domain_aware
2024-11-04 22:12:47,539:INFO:   <<< fp16: True
2024-11-04 22:12:47,539:INFO:   <<< fp16_opt_level: O1
2024-11-04 22:12:47,539:INFO:   <<< freeze_layer_num: 0
2024-11-04 22:12:47,539:INFO:   <<< gpu_ids: [0, 1]
2024-11-04 22:12:47,539:INFO:   <<< gradient_accumulation_steps: 1
2024-11-04 22:12:47,539:INFO:   <<< hard_negative_rate: 0.5
2024-11-04 22:12:47,539:INFO:   <<< init_model: chpt/H2S_sota.pth
2024-11-04 22:12:47,540:INFO:   <<< linear_patch: 2d
2024-11-04 22:12:47,540:INFO:   <<< local_rank: 0
2024-11-04 22:12:47,540:INFO:   <<< loose_type: True
2024-11-04 22:12:47,540:INFO:   <<< lr: 1e-05
2024-11-04 22:12:47,540:INFO:   <<< lr_decay: 0.001
2024-11-04 22:12:47,540:INFO:   <<< margin: 0.1
2024-11-04 22:12:47,540:INFO:   <<< max_frames: 128
2024-11-04 22:12:47,540:INFO:   <<< max_words: 32
2024-11-04 22:12:47,540:INFO:   <<< mix_design: balance
2024-11-04 22:12:47,540:INFO:   <<< n_display: 1
2024-11-04 22:12:47,540:INFO:   <<< n_gpu: 1
2024-11-04 22:12:47,541:INFO:   <<< n_pair: 1
2024-11-04 22:12:47,541:INFO:   <<< negative_weighting: 1
2024-11-04 22:12:47,541:INFO:   <<< not_load_visual: False
2024-11-04 22:12:47,541:INFO:   <<< num_thread_reader: 8
2024-11-04 22:12:47,541:INFO:   <<< output_dir: new_experiment
2024-11-04 22:12:47,541:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-11-04 22:12:47,541:INFO:   <<< rank: 0
2024-11-04 22:12:47,541:INFO:   <<< resume_model: None
2024-11-04 22:12:47,541:INFO:   <<< sampled_use_mil: False
2024-11-04 22:12:47,541:INFO:   <<< seed: 42
2024-11-04 22:12:47,541:INFO:   <<< sim_calcu: softmax_max
2024-11-04 22:12:47,541:INFO:   <<< sim_header: Filip
2024-11-04 22:12:47,542:INFO:   <<< slice_framepos: 0
2024-11-04 22:12:47,542:INFO:   <<< task_type: retrieval
2024-11-04 22:12:47,542:INFO:   <<< tau: 0.07
2024-11-04 22:12:47,542:INFO:   <<< text_aug: True
2024-11-04 22:12:47,542:INFO:   <<< text_aug_choosen: random_swap
2024-11-04 22:12:47,542:INFO:   <<< text_num_hidden_layers: 12
2024-11-04 22:12:47,542:INFO:   <<< train_frame_order: 0
2024-11-04 22:12:47,542:INFO:   <<< use_mil: False
2024-11-04 22:12:47,542:INFO:   <<< video_dim: 1024
2024-11-04 22:12:47,542:INFO:   <<< visual_num_hidden_layers: 12
2024-11-04 22:12:47,542:INFO:   <<< warmup_proportion: 0.1
2024-11-04 22:12:47,543:INFO:   <<< world_size: 1
2024-11-04 22:12:47,543:INFO: device: cuda:0 n_gpu: 1
2024-11-04 22:17:07,751:INFO: Effective parameters:
2024-11-04 22:17:07,752:INFO:   <<< alpha: 0.8
2024-11-04 22:17:07,752:INFO:   <<< aug_choose: t2v
2024-11-04 22:17:07,752:INFO:   <<< batch_size: 512
2024-11-04 22:17:07,752:INFO:   <<< batch_size_val: 256
2024-11-04 22:17:07,752:INFO:   <<< cache_dir: 
2024-11-04 22:17:07,752:INFO:   <<< cla_weight_dir: cla_weight
2024-11-04 22:17:07,752:INFO:   <<< coef_lr: 1.0
2024-11-04 22:17:07,752:INFO:   <<< combine_type: sum
2024-11-04 22:17:07,752:INFO:   <<< cross_att_layers: 1
2024-11-04 22:17:07,752:INFO:   <<< cross_model: cross-base
2024-11-04 22:17:07,752:INFO:   <<< cross_num_hidden_layers: 4
2024-11-04 22:17:07,752:INFO:   <<< data_path: data_h2
2024-11-04 22:17:07,752:INFO:   <<< datatype: h2s
2024-11-04 22:17:07,752:INFO:   <<< debug: False
2024-11-04 22:17:07,752:INFO:   <<< distributed: True
2024-11-04 22:17:07,753:INFO:   <<< do_eval: True
2024-11-04 22:17:07,753:INFO:   <<< do_lower_case: False
2024-11-04 22:17:07,753:INFO:   <<< do_pretrain: False
2024-11-04 22:17:07,753:INFO:   <<< do_train: False
2024-11-04 22:17:07,753:INFO:   <<< dual_mix: 0.5
2024-11-04 22:17:07,753:INFO:   <<< epochs: 200
2024-11-04 22:17:07,753:INFO:   <<< eval_frame_order: 0
2024-11-04 22:17:07,753:INFO:   <<< expand_msrvtt_sentences: False
2024-11-04 22:17:07,753:INFO:   <<< feature_framerate: 1
2024-11-04 22:17:07,753:INFO:   <<< feature_len: 64
2024-11-04 22:17:07,753:INFO:   <<< features_path: sign_feature/h2s_domain_agnostic
2024-11-04 22:17:07,753:INFO:   <<< features_path_retrain: sign_feature/h2s_domain_aware
2024-11-04 22:17:07,753:INFO:   <<< fp16: True
2024-11-04 22:17:07,753:INFO:   <<< fp16_opt_level: O1
2024-11-04 22:17:07,753:INFO:   <<< freeze_layer_num: 0
2024-11-04 22:17:07,753:INFO:   <<< gpu_ids: [0, 1]
2024-11-04 22:17:07,753:INFO:   <<< gradient_accumulation_steps: 1
2024-11-04 22:17:07,753:INFO:   <<< hard_negative_rate: 0.5
2024-11-04 22:17:07,754:INFO:   <<< init_model: chpt/H2S_sota.pth
2024-11-04 22:17:07,754:INFO:   <<< linear_patch: 2d
2024-11-04 22:17:07,754:INFO:   <<< local_rank: 0
2024-11-04 22:17:07,754:INFO:   <<< loose_type: True
2024-11-04 22:17:07,754:INFO:   <<< lr: 1e-05
2024-11-04 22:17:07,754:INFO:   <<< lr_decay: 0.001
2024-11-04 22:17:07,754:INFO:   <<< margin: 0.1
2024-11-04 22:17:07,754:INFO:   <<< max_frames: 128
2024-11-04 22:17:07,754:INFO:   <<< max_words: 32
2024-11-04 22:17:07,754:INFO:   <<< mix_design: balance
2024-11-04 22:17:07,754:INFO:   <<< n_display: 1
2024-11-04 22:17:07,754:INFO:   <<< n_gpu: 1
2024-11-04 22:17:07,754:INFO:   <<< n_pair: 1
2024-11-04 22:17:07,754:INFO:   <<< negative_weighting: 1
2024-11-04 22:17:07,754:INFO:   <<< not_load_visual: False
2024-11-04 22:17:07,754:INFO:   <<< num_thread_reader: 8
2024-11-04 22:17:07,754:INFO:   <<< output_dir: new_experiment
2024-11-04 22:17:07,754:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-11-04 22:17:07,755:INFO:   <<< rank: 0
2024-11-04 22:17:07,755:INFO:   <<< resume_model: None
2024-11-04 22:17:07,755:INFO:   <<< sampled_use_mil: False
2024-11-04 22:17:07,755:INFO:   <<< seed: 42
2024-11-04 22:17:07,755:INFO:   <<< sim_calcu: softmax_max
2024-11-04 22:17:07,755:INFO:   <<< sim_header: Filip
2024-11-04 22:17:07,755:INFO:   <<< slice_framepos: 0
2024-11-04 22:17:07,755:INFO:   <<< task_type: retrieval
2024-11-04 22:17:07,755:INFO:   <<< tau: 0.07
2024-11-04 22:17:07,755:INFO:   <<< text_aug: True
2024-11-04 22:17:07,755:INFO:   <<< text_aug_choosen: random_swap
2024-11-04 22:17:07,755:INFO:   <<< text_num_hidden_layers: 12
2024-11-04 22:17:07,755:INFO:   <<< train_frame_order: 0
2024-11-04 22:17:07,755:INFO:   <<< use_mil: False
2024-11-04 22:17:07,755:INFO:   <<< video_dim: 1024
2024-11-04 22:17:07,755:INFO:   <<< visual_num_hidden_layers: 12
2024-11-04 22:17:07,755:INFO:   <<< warmup_proportion: 0.1
2024-11-04 22:17:07,755:INFO:   <<< world_size: 1
2024-11-04 22:17:07,756:INFO: device: cuda:0 n_gpu: 1
2024-11-04 22:42:32,143:INFO: Effective parameters:
2024-11-04 22:42:32,144:INFO:   <<< alpha: 0.8
2024-11-04 22:42:32,144:INFO:   <<< aug_choose: t2v
2024-11-04 22:42:32,144:INFO:   <<< batch_size: 512
2024-11-04 22:42:32,144:INFO:   <<< batch_size_val: 256
2024-11-04 22:42:32,144:INFO:   <<< cache_dir: 
2024-11-04 22:42:32,144:INFO:   <<< cla_weight_dir: cla_weight
2024-11-04 22:42:32,144:INFO:   <<< coef_lr: 1.0
2024-11-04 22:42:32,144:INFO:   <<< combine_type: sum
2024-11-04 22:42:32,144:INFO:   <<< cross_att_layers: 1
2024-11-04 22:42:32,144:INFO:   <<< cross_model: cross-base
2024-11-04 22:42:32,144:INFO:   <<< cross_num_hidden_layers: 4
2024-11-04 22:42:32,144:INFO:   <<< data_path: data_h2
2024-11-04 22:42:32,144:INFO:   <<< datatype: h2s
2024-11-04 22:42:32,145:INFO:   <<< debug: False
2024-11-04 22:42:32,145:INFO:   <<< distributed: True
2024-11-04 22:42:32,145:INFO:   <<< do_eval: True
2024-11-04 22:42:32,145:INFO:   <<< do_lower_case: False
2024-11-04 22:42:32,145:INFO:   <<< do_pretrain: False
2024-11-04 22:42:32,145:INFO:   <<< do_train: False
2024-11-04 22:42:32,145:INFO:   <<< dual_mix: 0.5
2024-11-04 22:42:32,145:INFO:   <<< epochs: 200
2024-11-04 22:42:32,145:INFO:   <<< eval_frame_order: 0
2024-11-04 22:42:32,145:INFO:   <<< expand_msrvtt_sentences: False
2024-11-04 22:42:32,145:INFO:   <<< feature_framerate: 1
2024-11-04 22:42:32,145:INFO:   <<< feature_len: 64
2024-11-04 22:42:32,145:INFO:   <<< features_path: sign_feature/h2s_domain_agnostic
2024-11-04 22:42:32,145:INFO:   <<< features_path_retrain: sign_feature/h2s_domain_aware
2024-11-04 22:42:32,145:INFO:   <<< fp16: True
2024-11-04 22:42:32,145:INFO:   <<< fp16_opt_level: O1
2024-11-04 22:42:32,145:INFO:   <<< freeze_layer_num: 0
2024-11-04 22:42:32,146:INFO:   <<< gpu_ids: [0, 1]
2024-11-04 22:42:32,146:INFO:   <<< gradient_accumulation_steps: 1
2024-11-04 22:42:32,146:INFO:   <<< hard_negative_rate: 0.5
2024-11-04 22:42:32,146:INFO:   <<< init_model: chpt/H2S_sota.pth
2024-11-04 22:42:32,146:INFO:   <<< linear_patch: 2d
2024-11-04 22:42:32,146:INFO:   <<< local_rank: 0
2024-11-04 22:42:32,146:INFO:   <<< loose_type: True
2024-11-04 22:42:32,146:INFO:   <<< lr: 1e-05
2024-11-04 22:42:32,146:INFO:   <<< lr_decay: 0.001
2024-11-04 22:42:32,146:INFO:   <<< margin: 0.1
2024-11-04 22:42:32,146:INFO:   <<< max_frames: 128
2024-11-04 22:42:32,146:INFO:   <<< max_words: 32
2024-11-04 22:42:32,146:INFO:   <<< mix_design: balance
2024-11-04 22:42:32,146:INFO:   <<< n_display: 1
2024-11-04 22:42:32,146:INFO:   <<< n_gpu: 1
2024-11-04 22:42:32,146:INFO:   <<< n_pair: 1
2024-11-04 22:42:32,146:INFO:   <<< negative_weighting: 1
2024-11-04 22:42:32,146:INFO:   <<< not_load_visual: False
2024-11-04 22:42:32,147:INFO:   <<< num_thread_reader: 8
2024-11-04 22:42:32,147:INFO:   <<< output_dir: new_experiment
2024-11-04 22:42:32,147:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-11-04 22:42:32,147:INFO:   <<< rank: 0
2024-11-04 22:42:32,147:INFO:   <<< resume_model: None
2024-11-04 22:42:32,147:INFO:   <<< sampled_use_mil: False
2024-11-04 22:42:32,147:INFO:   <<< seed: 42
2024-11-04 22:42:32,147:INFO:   <<< sim_calcu: softmax_max
2024-11-04 22:42:32,147:INFO:   <<< sim_header: Filip
2024-11-04 22:42:32,147:INFO:   <<< slice_framepos: 0
2024-11-04 22:42:32,147:INFO:   <<< task_type: retrieval
2024-11-04 22:42:32,147:INFO:   <<< tau: 0.07
2024-11-04 22:42:32,147:INFO:   <<< text_aug: True
2024-11-04 22:42:32,147:INFO:   <<< text_aug_choosen: random_swap
2024-11-04 22:42:32,147:INFO:   <<< text_num_hidden_layers: 12
2024-11-04 22:42:32,147:INFO:   <<< train_frame_order: 0
2024-11-04 22:42:32,147:INFO:   <<< use_mil: False
2024-11-04 22:42:32,148:INFO:   <<< video_dim: 1024
2024-11-04 22:42:32,148:INFO:   <<< visual_num_hidden_layers: 12
2024-11-04 22:42:32,148:INFO:   <<< warmup_proportion: 0.1
2024-11-04 22:42:32,148:INFO:   <<< world_size: 1
2024-11-04 22:42:32,148:INFO: device: cuda:0 n_gpu: 1
2024-11-04 22:43:28,766:INFO: Effective parameters:
2024-11-04 22:43:28,766:INFO:   <<< alpha: 0.8
2024-11-04 22:43:28,766:INFO:   <<< aug_choose: t2v
2024-11-04 22:43:28,766:INFO:   <<< batch_size: 512
2024-11-04 22:43:28,767:INFO:   <<< batch_size_val: 256
2024-11-04 22:43:28,767:INFO:   <<< cache_dir: 
2024-11-04 22:43:28,767:INFO:   <<< cla_weight_dir: cla_weight
2024-11-04 22:43:28,767:INFO:   <<< coef_lr: 1.0
2024-11-04 22:43:28,767:INFO:   <<< combine_type: sum
2024-11-04 22:43:28,767:INFO:   <<< cross_att_layers: 1
2024-11-04 22:43:28,767:INFO:   <<< cross_model: cross-base
2024-11-04 22:43:28,767:INFO:   <<< cross_num_hidden_layers: 4
2024-11-04 22:43:28,767:INFO:   <<< data_path: data_h2
2024-11-04 22:43:28,767:INFO:   <<< datatype: h2s
2024-11-04 22:43:28,767:INFO:   <<< debug: False
2024-11-04 22:43:28,767:INFO:   <<< distributed: True
2024-11-04 22:43:28,767:INFO:   <<< do_eval: True
2024-11-04 22:43:28,767:INFO:   <<< do_lower_case: False
2024-11-04 22:43:28,767:INFO:   <<< do_pretrain: False
2024-11-04 22:43:28,767:INFO:   <<< do_train: False
2024-11-04 22:43:28,767:INFO:   <<< dual_mix: 0.5
2024-11-04 22:43:28,768:INFO:   <<< epochs: 200
2024-11-04 22:43:28,768:INFO:   <<< eval_frame_order: 0
2024-11-04 22:43:28,768:INFO:   <<< expand_msrvtt_sentences: False
2024-11-04 22:43:28,768:INFO:   <<< feature_framerate: 1
2024-11-04 22:43:28,768:INFO:   <<< feature_len: 64
2024-11-04 22:43:28,768:INFO:   <<< features_path: sign_feature/h2s_domain_agnostic
2024-11-04 22:43:28,768:INFO:   <<< features_path_retrain: sign_feature/h2s_domain_aware
2024-11-04 22:43:28,768:INFO:   <<< fp16: True
2024-11-04 22:43:28,768:INFO:   <<< fp16_opt_level: O1
2024-11-04 22:43:28,768:INFO:   <<< freeze_layer_num: 0
2024-11-04 22:43:28,768:INFO:   <<< gpu_ids: [0, 1]
2024-11-04 22:43:28,768:INFO:   <<< gradient_accumulation_steps: 1
2024-11-04 22:43:28,768:INFO:   <<< hard_negative_rate: 0.5
2024-11-04 22:43:28,768:INFO:   <<< init_model: chpt/H2S_sota.pth
2024-11-04 22:43:28,768:INFO:   <<< linear_patch: 2d
2024-11-04 22:43:28,768:INFO:   <<< local_rank: 0
2024-11-04 22:43:28,768:INFO:   <<< loose_type: True
2024-11-04 22:43:28,768:INFO:   <<< lr: 1e-05
2024-11-04 22:43:28,769:INFO:   <<< lr_decay: 0.001
2024-11-04 22:43:28,769:INFO:   <<< margin: 0.1
2024-11-04 22:43:28,769:INFO:   <<< max_frames: 128
2024-11-04 22:43:28,769:INFO:   <<< max_words: 32
2024-11-04 22:43:28,769:INFO:   <<< mix_design: balance
2024-11-04 22:43:28,769:INFO:   <<< n_display: 1
2024-11-04 22:43:28,769:INFO:   <<< n_gpu: 1
2024-11-04 22:43:28,769:INFO:   <<< n_pair: 1
2024-11-04 22:43:28,769:INFO:   <<< negative_weighting: 1
2024-11-04 22:43:28,769:INFO:   <<< not_load_visual: False
2024-11-04 22:43:28,769:INFO:   <<< num_thread_reader: 8
2024-11-04 22:43:28,769:INFO:   <<< output_dir: new_experiment
2024-11-04 22:43:28,769:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-11-04 22:43:28,769:INFO:   <<< rank: 0
2024-11-04 22:43:28,769:INFO:   <<< resume_model: None
2024-11-04 22:43:28,769:INFO:   <<< sampled_use_mil: False
2024-11-04 22:43:28,769:INFO:   <<< seed: 42
2024-11-04 22:43:28,769:INFO:   <<< sim_calcu: softmax_max
2024-11-04 22:43:28,770:INFO:   <<< sim_header: Filip
2024-11-04 22:43:28,770:INFO:   <<< slice_framepos: 0
2024-11-04 22:43:28,770:INFO:   <<< task_type: retrieval
2024-11-04 22:43:28,770:INFO:   <<< tau: 0.07
2024-11-04 22:43:28,770:INFO:   <<< text_aug: True
2024-11-04 22:43:28,770:INFO:   <<< text_aug_choosen: random_swap
2024-11-04 22:43:28,770:INFO:   <<< text_num_hidden_layers: 12
2024-11-04 22:43:28,770:INFO:   <<< train_frame_order: 0
2024-11-04 22:43:28,770:INFO:   <<< use_mil: False
2024-11-04 22:43:28,770:INFO:   <<< video_dim: 1024
2024-11-04 22:43:28,770:INFO:   <<< visual_num_hidden_layers: 12
2024-11-04 22:43:28,770:INFO:   <<< warmup_proportion: 0.1
2024-11-04 22:43:28,770:INFO:   <<< world_size: 1
2024-11-04 22:43:28,771:INFO: device: cuda:0 n_gpu: 1
2024-11-04 23:08:45,045:INFO: Effective parameters:
2024-11-04 23:08:45,046:INFO:   <<< alpha: 0.8
2024-11-04 23:08:45,046:INFO:   <<< aug_choose: t2v
2024-11-04 23:08:45,046:INFO:   <<< batch_size: 512
2024-11-04 23:08:45,046:INFO:   <<< batch_size_val: 256
2024-11-04 23:08:45,046:INFO:   <<< cache_dir: 
2024-11-04 23:08:45,046:INFO:   <<< cla_weight_dir: cla_weight
2024-11-04 23:08:45,046:INFO:   <<< coef_lr: 1.0
2024-11-04 23:08:45,046:INFO:   <<< combine_type: sum
2024-11-04 23:08:45,046:INFO:   <<< cross_att_layers: 1
2024-11-04 23:08:45,046:INFO:   <<< cross_model: cross-base
2024-11-04 23:08:45,046:INFO:   <<< cross_num_hidden_layers: 4
2024-11-04 23:08:45,046:INFO:   <<< data_path: data_h2
2024-11-04 23:08:45,047:INFO:   <<< datatype: h2s
2024-11-04 23:08:45,047:INFO:   <<< debug: False
2024-11-04 23:08:45,047:INFO:   <<< distributed: True
2024-11-04 23:08:45,047:INFO:   <<< do_eval: True
2024-11-04 23:08:45,047:INFO:   <<< do_lower_case: False
2024-11-04 23:08:45,047:INFO:   <<< do_pretrain: False
2024-11-04 23:08:45,047:INFO:   <<< do_train: False
2024-11-04 23:08:45,047:INFO:   <<< dual_mix: 0.5
2024-11-04 23:08:45,047:INFO:   <<< epochs: 200
2024-11-04 23:08:45,047:INFO:   <<< eval_frame_order: 0
2024-11-04 23:08:45,047:INFO:   <<< expand_msrvtt_sentences: False
2024-11-04 23:08:45,047:INFO:   <<< feature_framerate: 1
2024-11-04 23:08:45,047:INFO:   <<< feature_len: 64
2024-11-04 23:08:45,047:INFO:   <<< features_path: sign_feature/h2s_domain_agnostic
2024-11-04 23:08:45,047:INFO:   <<< features_path_retrain: sign_feature/h2s_domain_aware
2024-11-04 23:08:45,047:INFO:   <<< fp16: True
2024-11-04 23:08:45,047:INFO:   <<< fp16_opt_level: O1
2024-11-04 23:08:45,048:INFO:   <<< freeze_layer_num: 0
2024-11-04 23:08:45,048:INFO:   <<< gpu_ids: [0, 1]
2024-11-04 23:08:45,048:INFO:   <<< gradient_accumulation_steps: 1
2024-11-04 23:08:45,048:INFO:   <<< hard_negative_rate: 0.5
2024-11-04 23:08:45,048:INFO:   <<< init_model: chpt/H2S_sota.pth
2024-11-04 23:08:45,048:INFO:   <<< linear_patch: 2d
2024-11-04 23:08:45,048:INFO:   <<< local_rank: 0
2024-11-04 23:08:45,048:INFO:   <<< loose_type: True
2024-11-04 23:08:45,048:INFO:   <<< lr: 1e-05
2024-11-04 23:08:45,048:INFO:   <<< lr_decay: 0.001
2024-11-04 23:08:45,048:INFO:   <<< margin: 0.1
2024-11-04 23:08:45,048:INFO:   <<< max_frames: 128
2024-11-04 23:08:45,048:INFO:   <<< max_words: 32
2024-11-04 23:08:45,048:INFO:   <<< mix_design: balance
2024-11-04 23:08:45,048:INFO:   <<< n_display: 1
2024-11-04 23:08:45,048:INFO:   <<< n_gpu: 1
2024-11-04 23:08:45,049:INFO:   <<< n_pair: 1
2024-11-04 23:08:45,049:INFO:   <<< negative_weighting: 1
2024-11-04 23:08:45,049:INFO:   <<< not_load_visual: False
2024-11-04 23:08:45,049:INFO:   <<< num_thread_reader: 8
2024-11-04 23:08:45,049:INFO:   <<< output_dir: new_experiment
2024-11-04 23:08:45,049:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-11-04 23:08:45,049:INFO:   <<< rank: 0
2024-11-04 23:08:45,049:INFO:   <<< resume_model: None
2024-11-04 23:08:45,049:INFO:   <<< sampled_use_mil: False
2024-11-04 23:08:45,049:INFO:   <<< seed: 42
2024-11-04 23:08:45,049:INFO:   <<< sim_calcu: softmax_max
2024-11-04 23:08:45,049:INFO:   <<< sim_header: Filip
2024-11-04 23:08:45,049:INFO:   <<< slice_framepos: 0
2024-11-04 23:08:45,049:INFO:   <<< task_type: retrieval
2024-11-04 23:08:45,049:INFO:   <<< tau: 0.07
2024-11-04 23:08:45,049:INFO:   <<< text_aug: True
2024-11-04 23:08:45,049:INFO:   <<< text_aug_choosen: random_swap
2024-11-04 23:08:45,050:INFO:   <<< text_num_hidden_layers: 12
2024-11-04 23:08:45,050:INFO:   <<< train_frame_order: 0
2024-11-04 23:08:45,050:INFO:   <<< use_mil: False
2024-11-04 23:08:45,050:INFO:   <<< video_dim: 1024
2024-11-04 23:08:45,050:INFO:   <<< visual_num_hidden_layers: 12
2024-11-04 23:08:45,050:INFO:   <<< warmup_proportion: 0.1
2024-11-04 23:08:45,050:INFO:   <<< world_size: 1
2024-11-04 23:08:45,050:INFO: device: cuda:0 n_gpu: 1
2024-11-04 23:13:06,198:INFO: Effective parameters:
2024-11-04 23:13:06,198:INFO:   <<< alpha: 0.8
2024-11-04 23:13:06,198:INFO:   <<< aug_choose: t2v
2024-11-04 23:13:06,198:INFO:   <<< batch_size: 512
2024-11-04 23:13:06,198:INFO:   <<< batch_size_val: 256
2024-11-04 23:13:06,198:INFO:   <<< cache_dir: 
2024-11-04 23:13:06,198:INFO:   <<< cla_weight_dir: cla_weight
2024-11-04 23:13:06,198:INFO:   <<< coef_lr: 1.0
2024-11-04 23:13:06,198:INFO:   <<< combine_type: sum
2024-11-04 23:13:06,198:INFO:   <<< cross_att_layers: 1
2024-11-04 23:13:06,199:INFO:   <<< cross_model: cross-base
2024-11-04 23:13:06,199:INFO:   <<< cross_num_hidden_layers: 4
2024-11-04 23:13:06,199:INFO:   <<< data_path: data_h2
2024-11-04 23:13:06,199:INFO:   <<< datatype: h2s
2024-11-04 23:13:06,199:INFO:   <<< debug: False
2024-11-04 23:13:06,199:INFO:   <<< distributed: True
2024-11-04 23:13:06,199:INFO:   <<< do_eval: True
2024-11-04 23:13:06,199:INFO:   <<< do_lower_case: False
2024-11-04 23:13:06,199:INFO:   <<< do_pretrain: False
2024-11-04 23:13:06,199:INFO:   <<< do_train: False
2024-11-04 23:13:06,199:INFO:   <<< dual_mix: 0.5
2024-11-04 23:13:06,199:INFO:   <<< epochs: 200
2024-11-04 23:13:06,199:INFO:   <<< eval_frame_order: 0
2024-11-04 23:13:06,199:INFO:   <<< expand_msrvtt_sentences: False
2024-11-04 23:13:06,199:INFO:   <<< feature_framerate: 1
2024-11-04 23:13:06,199:INFO:   <<< feature_len: 64
2024-11-04 23:13:06,199:INFO:   <<< features_path: sign_feature/h2s_domain_agnostic
2024-11-04 23:13:06,200:INFO:   <<< features_path_retrain: sign_feature/h2s_domain_aware
2024-11-04 23:13:06,200:INFO:   <<< fp16: True
2024-11-04 23:13:06,200:INFO:   <<< fp16_opt_level: O1
2024-11-04 23:13:06,200:INFO:   <<< freeze_layer_num: 0
2024-11-04 23:13:06,200:INFO:   <<< gpu_ids: [0, 1]
2024-11-04 23:13:06,200:INFO:   <<< gradient_accumulation_steps: 1
2024-11-04 23:13:06,200:INFO:   <<< hard_negative_rate: 0.5
2024-11-04 23:13:06,200:INFO:   <<< init_model: chpt/H2S_sota.pth
2024-11-04 23:13:06,200:INFO:   <<< linear_patch: 2d
2024-11-04 23:13:06,200:INFO:   <<< local_rank: 0
2024-11-04 23:13:06,200:INFO:   <<< loose_type: True
2024-11-04 23:13:06,200:INFO:   <<< lr: 1e-05
2024-11-04 23:13:06,200:INFO:   <<< lr_decay: 0.001
2024-11-04 23:13:06,200:INFO:   <<< margin: 0.1
2024-11-04 23:13:06,200:INFO:   <<< max_frames: 128
2024-11-04 23:13:06,200:INFO:   <<< max_words: 32
2024-11-04 23:13:06,200:INFO:   <<< mix_design: balance
2024-11-04 23:13:06,201:INFO:   <<< n_display: 1
2024-11-04 23:13:06,201:INFO:   <<< n_gpu: 1
2024-11-04 23:13:06,201:INFO:   <<< n_pair: 1
2024-11-04 23:13:06,201:INFO:   <<< negative_weighting: 1
2024-11-04 23:13:06,201:INFO:   <<< not_load_visual: False
2024-11-04 23:13:06,201:INFO:   <<< num_thread_reader: 8
2024-11-04 23:13:06,201:INFO:   <<< output_dir: new_experiment
2024-11-04 23:13:06,201:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-11-04 23:13:06,201:INFO:   <<< rank: 0
2024-11-04 23:13:06,201:INFO:   <<< resume_model: None
2024-11-04 23:13:06,201:INFO:   <<< sampled_use_mil: False
2024-11-04 23:13:06,201:INFO:   <<< seed: 42
2024-11-04 23:13:06,201:INFO:   <<< sim_calcu: softmax_max
2024-11-04 23:13:06,201:INFO:   <<< sim_header: Filip
2024-11-04 23:13:06,201:INFO:   <<< slice_framepos: 0
2024-11-04 23:13:06,201:INFO:   <<< task_type: retrieval
2024-11-04 23:13:06,201:INFO:   <<< tau: 0.07
2024-11-04 23:13:06,201:INFO:   <<< text_aug: True
2024-11-04 23:13:06,202:INFO:   <<< text_aug_choosen: random_swap
2024-11-04 23:13:06,202:INFO:   <<< text_num_hidden_layers: 12
2024-11-04 23:13:06,202:INFO:   <<< train_frame_order: 0
2024-11-04 23:13:06,202:INFO:   <<< use_mil: False
2024-11-04 23:13:06,202:INFO:   <<< video_dim: 1024
2024-11-04 23:13:06,202:INFO:   <<< visual_num_hidden_layers: 12
2024-11-04 23:13:06,202:INFO:   <<< warmup_proportion: 0.1
2024-11-04 23:13:06,202:INFO:   <<< world_size: 1
2024-11-04 23:13:06,203:INFO: device: cuda:0 n_gpu: 1
2024-11-04 23:16:23,671:INFO: Effective parameters:
2024-11-04 23:16:23,671:INFO:   <<< alpha: 0.8
2024-11-04 23:16:23,671:INFO:   <<< aug_choose: t2v
2024-11-04 23:16:23,671:INFO:   <<< batch_size: 512
2024-11-04 23:16:23,671:INFO:   <<< batch_size_val: 256
2024-11-04 23:16:23,671:INFO:   <<< cache_dir: 
2024-11-04 23:16:23,671:INFO:   <<< cla_weight_dir: cla_weight
2024-11-04 23:16:23,671:INFO:   <<< coef_lr: 1.0
2024-11-04 23:16:23,671:INFO:   <<< combine_type: sum
2024-11-04 23:16:23,671:INFO:   <<< cross_att_layers: 1
2024-11-04 23:16:23,672:INFO:   <<< cross_model: cross-base
2024-11-04 23:16:23,672:INFO:   <<< cross_num_hidden_layers: 4
2024-11-04 23:16:23,672:INFO:   <<< data_path: data_h2
2024-11-04 23:16:23,672:INFO:   <<< datatype: h2s
2024-11-04 23:16:23,672:INFO:   <<< debug: False
2024-11-04 23:16:23,672:INFO:   <<< distributed: True
2024-11-04 23:16:23,672:INFO:   <<< do_eval: True
2024-11-04 23:16:23,672:INFO:   <<< do_lower_case: False
2024-11-04 23:16:23,672:INFO:   <<< do_pretrain: False
2024-11-04 23:16:23,672:INFO:   <<< do_train: False
2024-11-04 23:16:23,672:INFO:   <<< dual_mix: 0.5
2024-11-04 23:16:23,672:INFO:   <<< epochs: 200
2024-11-04 23:16:23,672:INFO:   <<< eval_frame_order: 0
2024-11-04 23:16:23,672:INFO:   <<< expand_msrvtt_sentences: False
2024-11-04 23:16:23,672:INFO:   <<< feature_framerate: 1
2024-11-04 23:16:23,672:INFO:   <<< feature_len: 64
2024-11-04 23:16:23,672:INFO:   <<< features_path: sign_feature/h2s_domain_agnostic
2024-11-04 23:16:23,673:INFO:   <<< features_path_retrain: sign_feature/h2s_domain_aware
2024-11-04 23:16:23,673:INFO:   <<< fp16: True
2024-11-04 23:16:23,673:INFO:   <<< fp16_opt_level: O1
2024-11-04 23:16:23,673:INFO:   <<< freeze_layer_num: 0
2024-11-04 23:16:23,673:INFO:   <<< gpu_ids: [0, 1]
2024-11-04 23:16:23,673:INFO:   <<< gradient_accumulation_steps: 1
2024-11-04 23:16:23,673:INFO:   <<< hard_negative_rate: 0.5
2024-11-04 23:16:23,673:INFO:   <<< init_model: chpt/H2S_sota.pth
2024-11-04 23:16:23,673:INFO:   <<< linear_patch: 2d
2024-11-04 23:16:23,673:INFO:   <<< local_rank: 0
2024-11-04 23:16:23,673:INFO:   <<< loose_type: True
2024-11-04 23:16:23,673:INFO:   <<< lr: 1e-05
2024-11-04 23:16:23,673:INFO:   <<< lr_decay: 0.001
2024-11-04 23:16:23,673:INFO:   <<< margin: 0.1
2024-11-04 23:16:23,673:INFO:   <<< max_frames: 128
2024-11-04 23:16:23,673:INFO:   <<< max_words: 32
2024-11-04 23:16:23,673:INFO:   <<< mix_design: balance
2024-11-04 23:16:23,674:INFO:   <<< n_display: 1
2024-11-04 23:16:23,674:INFO:   <<< n_gpu: 1
2024-11-04 23:16:23,674:INFO:   <<< n_pair: 1
2024-11-04 23:16:23,674:INFO:   <<< negative_weighting: 1
2024-11-04 23:16:23,674:INFO:   <<< not_load_visual: False
2024-11-04 23:16:23,674:INFO:   <<< num_thread_reader: 8
2024-11-04 23:16:23,674:INFO:   <<< output_dir: new_experiment
2024-11-04 23:16:23,674:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-11-04 23:16:23,674:INFO:   <<< rank: 0
2024-11-04 23:16:23,674:INFO:   <<< resume_model: None
2024-11-04 23:16:23,674:INFO:   <<< sampled_use_mil: False
2024-11-04 23:16:23,674:INFO:   <<< seed: 42
2024-11-04 23:16:23,674:INFO:   <<< sim_calcu: softmax_max
2024-11-04 23:16:23,674:INFO:   <<< sim_header: Filip
2024-11-04 23:16:23,674:INFO:   <<< slice_framepos: 0
2024-11-04 23:16:23,674:INFO:   <<< task_type: retrieval
2024-11-04 23:16:23,674:INFO:   <<< tau: 0.07
2024-11-04 23:16:23,674:INFO:   <<< text_aug: True
2024-11-04 23:16:23,675:INFO:   <<< text_aug_choosen: random_swap
2024-11-04 23:16:23,675:INFO:   <<< text_num_hidden_layers: 12
2024-11-04 23:16:23,675:INFO:   <<< train_frame_order: 0
2024-11-04 23:16:23,675:INFO:   <<< use_mil: False
2024-11-04 23:16:23,675:INFO:   <<< video_dim: 1024
2024-11-04 23:16:23,675:INFO:   <<< visual_num_hidden_layers: 12
2024-11-04 23:16:23,675:INFO:   <<< warmup_proportion: 0.1
2024-11-04 23:16:23,675:INFO:   <<< world_size: 1
2024-11-04 23:16:23,676:INFO: device: cuda:0 n_gpu: 1
2024-11-04 23:19:21,226:INFO: Effective parameters:
2024-11-04 23:19:21,226:INFO:   <<< alpha: 0.8
2024-11-04 23:19:21,226:INFO:   <<< aug_choose: t2v
2024-11-04 23:19:21,227:INFO:   <<< batch_size: 512
2024-11-04 23:19:21,227:INFO:   <<< batch_size_val: 256
2024-11-04 23:19:21,227:INFO:   <<< cache_dir: 
2024-11-04 23:19:21,227:INFO:   <<< cla_weight_dir: cla_weight
2024-11-04 23:19:21,227:INFO:   <<< coef_lr: 1.0
2024-11-04 23:19:21,227:INFO:   <<< combine_type: sum
2024-11-04 23:19:21,227:INFO:   <<< cross_att_layers: 1
2024-11-04 23:19:21,227:INFO:   <<< cross_model: cross-base
2024-11-04 23:19:21,227:INFO:   <<< cross_num_hidden_layers: 4
2024-11-04 23:19:21,227:INFO:   <<< data_path: data_h2
2024-11-04 23:19:21,227:INFO:   <<< datatype: h2s
2024-11-04 23:19:21,227:INFO:   <<< debug: False
2024-11-04 23:19:21,227:INFO:   <<< distributed: True
2024-11-04 23:19:21,227:INFO:   <<< do_eval: True
2024-11-04 23:19:21,227:INFO:   <<< do_lower_case: False
2024-11-04 23:19:21,227:INFO:   <<< do_pretrain: False
2024-11-04 23:19:21,228:INFO:   <<< do_train: False
2024-11-04 23:19:21,228:INFO:   <<< dual_mix: 0.5
2024-11-04 23:19:21,228:INFO:   <<< epochs: 200
2024-11-04 23:19:21,228:INFO:   <<< eval_frame_order: 0
2024-11-04 23:19:21,228:INFO:   <<< expand_msrvtt_sentences: False
2024-11-04 23:19:21,228:INFO:   <<< feature_framerate: 1
2024-11-04 23:19:21,228:INFO:   <<< feature_len: 64
2024-11-04 23:19:21,228:INFO:   <<< features_path: sign_feature/h2s_domain_agnostic
2024-11-04 23:19:21,228:INFO:   <<< features_path_retrain: sign_feature/h2s_domain_aware
2024-11-04 23:19:21,228:INFO:   <<< fp16: True
2024-11-04 23:19:21,228:INFO:   <<< fp16_opt_level: O1
2024-11-04 23:19:21,228:INFO:   <<< freeze_layer_num: 0
2024-11-04 23:19:21,228:INFO:   <<< gpu_ids: [0, 1]
2024-11-04 23:19:21,228:INFO:   <<< gradient_accumulation_steps: 1
2024-11-04 23:19:21,228:INFO:   <<< hard_negative_rate: 0.5
2024-11-04 23:19:21,229:INFO:   <<< init_model: chpt/H2S_sota.pth
2024-11-04 23:19:21,229:INFO:   <<< linear_patch: 2d
2024-11-04 23:19:21,229:INFO:   <<< local_rank: 0
2024-11-04 23:19:21,229:INFO:   <<< loose_type: True
2024-11-04 23:19:21,229:INFO:   <<< lr: 1e-05
2024-11-04 23:19:21,229:INFO:   <<< lr_decay: 0.001
2024-11-04 23:19:21,229:INFO:   <<< margin: 0.1
2024-11-04 23:19:21,229:INFO:   <<< max_frames: 128
2024-11-04 23:19:21,229:INFO:   <<< max_words: 32
2024-11-04 23:19:21,229:INFO:   <<< mix_design: balance
2024-11-04 23:19:21,229:INFO:   <<< n_display: 1
2024-11-04 23:19:21,229:INFO:   <<< n_gpu: 1
2024-11-04 23:19:21,229:INFO:   <<< n_pair: 1
2024-11-04 23:19:21,229:INFO:   <<< negative_weighting: 1
2024-11-04 23:19:21,229:INFO:   <<< not_load_visual: False
2024-11-04 23:19:21,229:INFO:   <<< num_thread_reader: 8
2024-11-04 23:19:21,230:INFO:   <<< output_dir: new_experiment
2024-11-04 23:19:21,230:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-11-04 23:19:21,230:INFO:   <<< rank: 0
2024-11-04 23:19:21,230:INFO:   <<< resume_model: None
2024-11-04 23:19:21,230:INFO:   <<< sampled_use_mil: False
2024-11-04 23:19:21,230:INFO:   <<< seed: 42
2024-11-04 23:19:21,230:INFO:   <<< sim_calcu: softmax_max
2024-11-04 23:19:21,230:INFO:   <<< sim_header: Filip
2024-11-04 23:19:21,230:INFO:   <<< slice_framepos: 0
2024-11-04 23:19:21,230:INFO:   <<< task_type: retrieval
2024-11-04 23:19:21,230:INFO:   <<< tau: 0.07
2024-11-04 23:19:21,230:INFO:   <<< text_aug: True
2024-11-04 23:19:21,230:INFO:   <<< text_aug_choosen: random_swap
2024-11-04 23:19:21,230:INFO:   <<< text_num_hidden_layers: 12
2024-11-04 23:19:21,230:INFO:   <<< train_frame_order: 0
2024-11-04 23:19:21,231:INFO:   <<< use_mil: False
2024-11-04 23:19:21,231:INFO:   <<< video_dim: 1024
2024-11-04 23:19:21,231:INFO:   <<< visual_num_hidden_layers: 12
2024-11-04 23:19:21,231:INFO:   <<< warmup_proportion: 0.1
2024-11-04 23:19:21,231:INFO:   <<< world_size: 1
2024-11-04 23:19:21,231:INFO: device: cuda:0 n_gpu: 1
2024-11-05 08:52:40,172:INFO: Effective parameters:
2024-11-05 08:52:40,173:INFO:   <<< alpha: 0.8
2024-11-05 08:52:40,173:INFO:   <<< aug_choose: t2v
2024-11-05 08:52:40,173:INFO:   <<< batch_size: 512
2024-11-05 08:52:40,173:INFO:   <<< batch_size_val: 256
2024-11-05 08:52:40,173:INFO:   <<< cache_dir: 
2024-11-05 08:52:40,173:INFO:   <<< cla_weight_dir: cla_weight
2024-11-05 08:52:40,173:INFO:   <<< coef_lr: 1.0
2024-11-05 08:52:40,173:INFO:   <<< combine_type: sum
2024-11-05 08:52:40,173:INFO:   <<< cross_att_layers: 1
2024-11-05 08:52:40,173:INFO:   <<< cross_model: cross-base
2024-11-05 08:52:40,173:INFO:   <<< cross_num_hidden_layers: 4
2024-11-05 08:52:40,173:INFO:   <<< data_path: data_h2
2024-11-05 08:52:40,174:INFO:   <<< datatype: h2s
2024-11-05 08:52:40,174:INFO:   <<< debug: False
2024-11-05 08:52:40,174:INFO:   <<< distributed: True
2024-11-05 08:52:40,174:INFO:   <<< do_eval: True
2024-11-05 08:52:40,174:INFO:   <<< do_lower_case: False
2024-11-05 08:52:40,174:INFO:   <<< do_pretrain: False
2024-11-05 08:52:40,174:INFO:   <<< do_train: False
2024-11-05 08:52:40,174:INFO:   <<< dual_mix: 0.5
2024-11-05 08:52:40,174:INFO:   <<< epochs: 200
2024-11-05 08:52:40,174:INFO:   <<< eval_frame_order: 0
2024-11-05 08:52:40,174:INFO:   <<< expand_msrvtt_sentences: False
2024-11-05 08:52:40,174:INFO:   <<< feature_framerate: 1
2024-11-05 08:52:40,175:INFO:   <<< feature_len: 64
2024-11-05 08:52:40,175:INFO:   <<< features_path: sign_feature/h2s_domain_agnostic
2024-11-05 08:52:40,175:INFO:   <<< features_path_retrain: sign_feature/h2s_domain_aware
2024-11-05 08:52:40,175:INFO:   <<< fp16: True
2024-11-05 08:52:40,175:INFO:   <<< fp16_opt_level: O1
2024-11-05 08:52:40,175:INFO:   <<< freeze_layer_num: 0
2024-11-05 08:52:40,175:INFO:   <<< gpu_ids: [0, 1]
2024-11-05 08:52:40,175:INFO:   <<< gradient_accumulation_steps: 1
2024-11-05 08:52:40,175:INFO:   <<< hard_negative_rate: 0.5
2024-11-05 08:52:40,175:INFO:   <<< init_model: chpt/H2S_sota.pth
2024-11-05 08:52:40,175:INFO:   <<< linear_patch: 2d
2024-11-05 08:52:40,175:INFO:   <<< local_rank: 0
2024-11-05 08:52:40,176:INFO:   <<< loose_type: True
2024-11-05 08:52:40,176:INFO:   <<< lr: 1e-05
2024-11-05 08:52:40,176:INFO:   <<< lr_decay: 0.001
2024-11-05 08:52:40,176:INFO:   <<< margin: 0.1
2024-11-05 08:52:40,176:INFO:   <<< max_frames: 128
2024-11-05 08:52:40,176:INFO:   <<< max_words: 32
2024-11-05 08:52:40,176:INFO:   <<< mix_design: balance
2024-11-05 08:52:40,176:INFO:   <<< n_display: 1
2024-11-05 08:52:40,176:INFO:   <<< n_gpu: 1
2024-11-05 08:52:40,176:INFO:   <<< n_pair: 1
2024-11-05 08:52:40,176:INFO:   <<< negative_weighting: 1
2024-11-05 08:52:40,176:INFO:   <<< not_load_visual: False
2024-11-05 08:52:40,176:INFO:   <<< num_thread_reader: 8
2024-11-05 08:52:40,177:INFO:   <<< output_dir: new_experiment
2024-11-05 08:52:40,177:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-11-05 08:52:40,177:INFO:   <<< rank: 0
2024-11-05 08:52:40,177:INFO:   <<< resume_model: None
2024-11-05 08:52:40,177:INFO:   <<< sampled_use_mil: False
2024-11-05 08:52:40,177:INFO:   <<< seed: 42
2024-11-05 08:52:40,177:INFO:   <<< sim_calcu: softmax_max
2024-11-05 08:52:40,177:INFO:   <<< sim_header: Filip
2024-11-05 08:52:40,177:INFO:   <<< slice_framepos: 0
2024-11-05 08:52:40,177:INFO:   <<< task_type: retrieval
2024-11-05 08:52:40,177:INFO:   <<< tau: 0.07
2024-11-05 08:52:40,177:INFO:   <<< text_aug: True
2024-11-05 08:52:40,178:INFO:   <<< text_aug_choosen: random_swap
2024-11-05 08:52:40,178:INFO:   <<< text_num_hidden_layers: 12
2024-11-05 08:52:40,178:INFO:   <<< train_frame_order: 0
2024-11-05 08:52:40,178:INFO:   <<< use_mil: False
2024-11-05 08:52:40,178:INFO:   <<< video_dim: 1024
2024-11-05 08:52:40,178:INFO:   <<< visual_num_hidden_layers: 12
2024-11-05 08:52:40,178:INFO:   <<< warmup_proportion: 0.1
2024-11-05 08:52:40,178:INFO:   <<< world_size: 1
2024-11-05 08:52:40,179:INFO: device: cuda:0 n_gpu: 1
2024-11-05 08:56:41,610:INFO: Effective parameters:
2024-11-05 08:56:41,610:INFO:   <<< alpha: 0.8
2024-11-05 08:56:41,610:INFO:   <<< aug_choose: t2v
2024-11-05 08:56:41,610:INFO:   <<< batch_size: 512
2024-11-05 08:56:41,610:INFO:   <<< batch_size_val: 256
2024-11-05 08:56:41,611:INFO:   <<< cache_dir: 
2024-11-05 08:56:41,611:INFO:   <<< cla_weight_dir: cla_weight
2024-11-05 08:56:41,611:INFO:   <<< coef_lr: 1.0
2024-11-05 08:56:41,611:INFO:   <<< combine_type: sum
2024-11-05 08:56:41,611:INFO:   <<< cross_att_layers: 1
2024-11-05 08:56:41,611:INFO:   <<< cross_model: cross-base
2024-11-05 08:56:41,611:INFO:   <<< cross_num_hidden_layers: 4
2024-11-05 08:56:41,611:INFO:   <<< data_path: data_h2
2024-11-05 08:56:41,611:INFO:   <<< datatype: h2s
2024-11-05 08:56:41,611:INFO:   <<< debug: False
2024-11-05 08:56:41,611:INFO:   <<< distributed: True
2024-11-05 08:56:41,611:INFO:   <<< do_eval: True
2024-11-05 08:56:41,611:INFO:   <<< do_lower_case: False
2024-11-05 08:56:41,611:INFO:   <<< do_pretrain: False
2024-11-05 08:56:41,611:INFO:   <<< do_train: False
2024-11-05 08:56:41,612:INFO:   <<< dual_mix: 0.5
2024-11-05 08:56:41,612:INFO:   <<< epochs: 200
2024-11-05 08:56:41,612:INFO:   <<< eval_frame_order: 0
2024-11-05 08:56:41,612:INFO:   <<< expand_msrvtt_sentences: False
2024-11-05 08:56:41,612:INFO:   <<< feature_framerate: 1
2024-11-05 08:56:41,612:INFO:   <<< feature_len: 64
2024-11-05 08:56:41,612:INFO:   <<< features_path: sign_feature/h2s_domain_agnostic
2024-11-05 08:56:41,612:INFO:   <<< features_path_retrain: sign_feature/h2s_domain_aware
2024-11-05 08:56:41,612:INFO:   <<< fp16: True
2024-11-05 08:56:41,612:INFO:   <<< fp16_opt_level: O1
2024-11-05 08:56:41,612:INFO:   <<< freeze_layer_num: 0
2024-11-05 08:56:41,612:INFO:   <<< gpu_ids: [0, 1]
2024-11-05 08:56:41,612:INFO:   <<< gradient_accumulation_steps: 1
2024-11-05 08:56:41,612:INFO:   <<< hard_negative_rate: 0.5
2024-11-05 08:56:41,612:INFO:   <<< init_model: chpt/H2S_sota.pth
2024-11-05 08:56:41,613:INFO:   <<< linear_patch: 2d
2024-11-05 08:56:41,613:INFO:   <<< local_rank: 0
2024-11-05 08:56:41,613:INFO:   <<< loose_type: True
2024-11-05 08:56:41,613:INFO:   <<< lr: 1e-05
2024-11-05 08:56:41,613:INFO:   <<< lr_decay: 0.001
2024-11-05 08:56:41,613:INFO:   <<< margin: 0.1
2024-11-05 08:56:41,613:INFO:   <<< max_frames: 128
2024-11-05 08:56:41,613:INFO:   <<< max_words: 32
2024-11-05 08:56:41,613:INFO:   <<< mix_design: balance
2024-11-05 08:56:41,613:INFO:   <<< n_display: 1
2024-11-05 08:56:41,613:INFO:   <<< n_gpu: 1
2024-11-05 08:56:41,613:INFO:   <<< n_pair: 1
2024-11-05 08:56:41,613:INFO:   <<< negative_weighting: 1
2024-11-05 08:56:41,613:INFO:   <<< not_load_visual: False
2024-11-05 08:56:41,613:INFO:   <<< num_thread_reader: 8
2024-11-05 08:56:41,613:INFO:   <<< output_dir: new_experiment
2024-11-05 08:56:41,614:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-11-05 08:56:41,614:INFO:   <<< rank: 0
2024-11-05 08:56:41,614:INFO:   <<< resume_model: None
2024-11-05 08:56:41,614:INFO:   <<< sampled_use_mil: False
2024-11-05 08:56:41,614:INFO:   <<< seed: 42
2024-11-05 08:56:41,614:INFO:   <<< sim_calcu: softmax_max
2024-11-05 08:56:41,614:INFO:   <<< sim_header: Filip
2024-11-05 08:56:41,614:INFO:   <<< slice_framepos: 0
2024-11-05 08:56:41,614:INFO:   <<< task_type: retrieval
2024-11-05 08:56:41,614:INFO:   <<< tau: 0.07
2024-11-05 08:56:41,614:INFO:   <<< text_aug: True
2024-11-05 08:56:41,614:INFO:   <<< text_aug_choosen: random_swap
2024-11-05 08:56:41,614:INFO:   <<< text_num_hidden_layers: 12
2024-11-05 08:56:41,614:INFO:   <<< train_frame_order: 0
2024-11-05 08:56:41,614:INFO:   <<< use_mil: False
2024-11-05 08:56:41,615:INFO:   <<< video_dim: 1024
2024-11-05 08:56:41,615:INFO:   <<< visual_num_hidden_layers: 12
2024-11-05 08:56:41,615:INFO:   <<< warmup_proportion: 0.1
2024-11-05 08:56:41,615:INFO:   <<< world_size: 1
2024-11-05 08:56:41,615:INFO: device: cuda:0 n_gpu: 1
2024-11-05 08:58:15,692:INFO: Effective parameters:
2024-11-05 08:58:15,693:INFO:   <<< alpha: 0.8
2024-11-05 08:58:15,693:INFO:   <<< aug_choose: t2v
2024-11-05 08:58:15,693:INFO:   <<< batch_size: 512
2024-11-05 08:58:15,693:INFO:   <<< batch_size_val: 256
2024-11-05 08:58:15,693:INFO:   <<< cache_dir: 
2024-11-05 08:58:15,693:INFO:   <<< cla_weight_dir: cla_weight
2024-11-05 08:58:15,693:INFO:   <<< coef_lr: 1.0
2024-11-05 08:58:15,693:INFO:   <<< combine_type: sum
2024-11-05 08:58:15,693:INFO:   <<< cross_att_layers: 1
2024-11-05 08:58:15,693:INFO:   <<< cross_model: cross-base
2024-11-05 08:58:15,693:INFO:   <<< cross_num_hidden_layers: 4
2024-11-05 08:58:15,694:INFO:   <<< data_path: data_h2
2024-11-05 08:58:15,694:INFO:   <<< datatype: h2s
2024-11-05 08:58:15,694:INFO:   <<< debug: False
2024-11-05 08:58:15,694:INFO:   <<< distributed: True
2024-11-05 08:58:15,694:INFO:   <<< do_eval: True
2024-11-05 08:58:15,694:INFO:   <<< do_lower_case: False
2024-11-05 08:58:15,694:INFO:   <<< do_pretrain: False
2024-11-05 08:58:15,695:INFO:   <<< do_train: False
2024-11-05 08:58:15,695:INFO:   <<< dual_mix: 0.5
2024-11-05 08:58:15,695:INFO:   <<< epochs: 200
2024-11-05 08:58:15,695:INFO:   <<< eval_frame_order: 0
2024-11-05 08:58:15,695:INFO:   <<< expand_msrvtt_sentences: False
2024-11-05 08:58:15,695:INFO:   <<< feature_framerate: 1
2024-11-05 08:58:15,695:INFO:   <<< feature_len: 64
2024-11-05 08:58:15,695:INFO:   <<< features_path: sign_feature/h2s_domain_agnostic
2024-11-05 08:58:15,696:INFO:   <<< features_path_retrain: sign_feature/h2s_domain_aware
2024-11-05 08:58:15,696:INFO:   <<< fp16: True
2024-11-05 08:58:15,696:INFO:   <<< fp16_opt_level: O1
2024-11-05 08:58:15,696:INFO:   <<< freeze_layer_num: 0
2024-11-05 08:58:15,696:INFO:   <<< gpu_ids: [0, 1]
2024-11-05 08:58:15,696:INFO:   <<< gradient_accumulation_steps: 1
2024-11-05 08:58:15,696:INFO:   <<< hard_negative_rate: 0.5
2024-11-05 08:58:15,696:INFO:   <<< init_model: chpt/H2S_sota.pth
2024-11-05 08:58:15,697:INFO:   <<< linear_patch: 2d
2024-11-05 08:58:15,697:INFO:   <<< local_rank: 0
2024-11-05 08:58:15,697:INFO:   <<< loose_type: True
2024-11-05 08:58:15,697:INFO:   <<< lr: 1e-05
2024-11-05 08:58:15,697:INFO:   <<< lr_decay: 0.001
2024-11-05 08:58:15,697:INFO:   <<< margin: 0.1
2024-11-05 08:58:15,697:INFO:   <<< max_frames: 128
2024-11-05 08:58:15,697:INFO:   <<< max_words: 32
2024-11-05 08:58:15,698:INFO:   <<< mix_design: balance
2024-11-05 08:58:15,698:INFO:   <<< n_display: 1
2024-11-05 08:58:15,698:INFO:   <<< n_gpu: 1
2024-11-05 08:58:15,698:INFO:   <<< n_pair: 1
2024-11-05 08:58:15,698:INFO:   <<< negative_weighting: 1
2024-11-05 08:58:15,698:INFO:   <<< not_load_visual: False
2024-11-05 08:58:15,698:INFO:   <<< num_thread_reader: 8
2024-11-05 08:58:15,698:INFO:   <<< output_dir: new_experiment
2024-11-05 08:58:15,699:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-11-05 08:58:15,699:INFO:   <<< rank: 0
2024-11-05 08:58:15,699:INFO:   <<< resume_model: None
2024-11-05 08:58:15,699:INFO:   <<< sampled_use_mil: False
2024-11-05 08:58:15,699:INFO:   <<< seed: 42
2024-11-05 08:58:15,699:INFO:   <<< sim_calcu: softmax_max
2024-11-05 08:58:15,699:INFO:   <<< sim_header: Filip
2024-11-05 08:58:15,699:INFO:   <<< slice_framepos: 0
2024-11-05 08:58:15,700:INFO:   <<< task_type: retrieval
2024-11-05 08:58:15,700:INFO:   <<< tau: 0.07
2024-11-05 08:58:15,700:INFO:   <<< text_aug: True
2024-11-05 08:58:15,700:INFO:   <<< text_aug_choosen: random_swap
2024-11-05 08:58:15,700:INFO:   <<< text_num_hidden_layers: 12
2024-11-05 08:58:15,700:INFO:   <<< train_frame_order: 0
2024-11-05 08:58:15,700:INFO:   <<< use_mil: False
2024-11-05 08:58:15,700:INFO:   <<< video_dim: 1024
2024-11-05 08:58:15,701:INFO:   <<< visual_num_hidden_layers: 12
2024-11-05 08:58:15,701:INFO:   <<< warmup_proportion: 0.1
2024-11-05 08:58:15,701:INFO:   <<< world_size: 1
2024-11-05 08:58:15,702:INFO: device: cuda:0 n_gpu: 1
2024-11-05 08:58:53,849:INFO: Effective parameters:
2024-11-05 08:58:53,850:INFO:   <<< alpha: 0.8
2024-11-05 08:58:53,850:INFO:   <<< aug_choose: t2v
2024-11-05 08:58:53,850:INFO:   <<< batch_size: 512
2024-11-05 08:58:53,850:INFO:   <<< batch_size_val: 256
2024-11-05 08:58:53,850:INFO:   <<< cache_dir: 
2024-11-05 08:58:53,850:INFO:   <<< cla_weight_dir: cla_weight
2024-11-05 08:58:53,850:INFO:   <<< coef_lr: 1.0
2024-11-05 08:58:53,850:INFO:   <<< combine_type: sum
2024-11-05 08:58:53,850:INFO:   <<< cross_att_layers: 1
2024-11-05 08:58:53,850:INFO:   <<< cross_model: cross-base
2024-11-05 08:58:53,850:INFO:   <<< cross_num_hidden_layers: 4
2024-11-05 08:58:53,850:INFO:   <<< data_path: data_h2
2024-11-05 08:58:53,851:INFO:   <<< datatype: h2s
2024-11-05 08:58:53,851:INFO:   <<< debug: False
2024-11-05 08:58:53,851:INFO:   <<< distributed: True
2024-11-05 08:58:53,851:INFO:   <<< do_eval: True
2024-11-05 08:58:53,851:INFO:   <<< do_lower_case: False
2024-11-05 08:58:53,851:INFO:   <<< do_pretrain: False
2024-11-05 08:58:53,851:INFO:   <<< do_train: False
2024-11-05 08:58:53,851:INFO:   <<< dual_mix: 0.5
2024-11-05 08:58:53,851:INFO:   <<< epochs: 200
2024-11-05 08:58:53,851:INFO:   <<< eval_frame_order: 0
2024-11-05 08:58:53,851:INFO:   <<< expand_msrvtt_sentences: False
2024-11-05 08:58:53,851:INFO:   <<< feature_framerate: 1
2024-11-05 08:58:53,851:INFO:   <<< feature_len: 64
2024-11-05 08:58:53,851:INFO:   <<< features_path: sign_feature/h2s_domain_agnostic
2024-11-05 08:58:53,852:INFO:   <<< features_path_retrain: sign_feature/h2s_domain_aware
2024-11-05 08:58:53,852:INFO:   <<< fp16: True
2024-11-05 08:58:53,852:INFO:   <<< fp16_opt_level: O1
2024-11-05 08:58:53,852:INFO:   <<< freeze_layer_num: 0
2024-11-05 08:58:53,852:INFO:   <<< gpu_ids: [0, 1]
2024-11-05 08:58:53,852:INFO:   <<< gradient_accumulation_steps: 1
2024-11-05 08:58:53,852:INFO:   <<< hard_negative_rate: 0.5
2024-11-05 08:58:53,852:INFO:   <<< init_model: chpt/H2S_sota.pth
2024-11-05 08:58:53,852:INFO:   <<< linear_patch: 2d
2024-11-05 08:58:53,852:INFO:   <<< local_rank: 0
2024-11-05 08:58:53,852:INFO:   <<< loose_type: True
2024-11-05 08:58:53,852:INFO:   <<< lr: 1e-05
2024-11-05 08:58:53,852:INFO:   <<< lr_decay: 0.001
2024-11-05 08:58:53,853:INFO:   <<< margin: 0.1
2024-11-05 08:58:53,853:INFO:   <<< max_frames: 128
2024-11-05 08:58:53,853:INFO:   <<< max_words: 32
2024-11-05 08:58:53,853:INFO:   <<< mix_design: balance
2024-11-05 08:58:53,853:INFO:   <<< n_display: 1
2024-11-05 08:58:53,853:INFO:   <<< n_gpu: 1
2024-11-05 08:58:53,853:INFO:   <<< n_pair: 1
2024-11-05 08:58:53,853:INFO:   <<< negative_weighting: 1
2024-11-05 08:58:53,853:INFO:   <<< not_load_visual: False
2024-11-05 08:58:53,853:INFO:   <<< num_thread_reader: 8
2024-11-05 08:58:53,853:INFO:   <<< output_dir: new_experiment
2024-11-05 08:58:53,853:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-11-05 08:58:53,853:INFO:   <<< rank: 0
2024-11-05 08:58:53,853:INFO:   <<< resume_model: None
2024-11-05 08:58:53,854:INFO:   <<< sampled_use_mil: False
2024-11-05 08:58:53,854:INFO:   <<< seed: 42
2024-11-05 08:58:53,854:INFO:   <<< sim_calcu: softmax_max
2024-11-05 08:58:53,854:INFO:   <<< sim_header: Filip
2024-11-05 08:58:53,854:INFO:   <<< slice_framepos: 0
2024-11-05 08:58:53,854:INFO:   <<< task_type: retrieval
2024-11-05 08:58:53,854:INFO:   <<< tau: 0.07
2024-11-05 08:58:53,854:INFO:   <<< text_aug: True
2024-11-05 08:58:53,854:INFO:   <<< text_aug_choosen: random_swap
2024-11-05 08:58:53,854:INFO:   <<< text_num_hidden_layers: 12
2024-11-05 08:58:53,854:INFO:   <<< train_frame_order: 0
2024-11-05 08:58:53,854:INFO:   <<< use_mil: False
2024-11-05 08:58:53,854:INFO:   <<< video_dim: 1024
2024-11-05 08:58:53,855:INFO:   <<< visual_num_hidden_layers: 12
2024-11-05 08:58:53,855:INFO:   <<< warmup_proportion: 0.1
2024-11-05 08:58:53,855:INFO:   <<< world_size: 1
2024-11-05 08:58:53,855:INFO: device: cuda:0 n_gpu: 1
2024-11-05 09:01:10,715:INFO: Effective parameters:
2024-11-05 09:01:10,715:INFO:   <<< alpha: 0.8
2024-11-05 09:01:10,716:INFO:   <<< aug_choose: t2v
2024-11-05 09:01:10,716:INFO:   <<< batch_size: 512
2024-11-05 09:01:10,716:INFO:   <<< batch_size_val: 256
2024-11-05 09:01:10,716:INFO:   <<< cache_dir: 
2024-11-05 09:01:10,716:INFO:   <<< cla_weight_dir: cla_weight
2024-11-05 09:01:10,716:INFO:   <<< coef_lr: 1.0
2024-11-05 09:01:10,716:INFO:   <<< combine_type: sum
2024-11-05 09:01:10,716:INFO:   <<< cross_att_layers: 1
2024-11-05 09:01:10,716:INFO:   <<< cross_model: cross-base
2024-11-05 09:01:10,716:INFO:   <<< cross_num_hidden_layers: 4
2024-11-05 09:01:10,716:INFO:   <<< data_path: data_h2
2024-11-05 09:01:10,716:INFO:   <<< datatype: h2s
2024-11-05 09:01:10,716:INFO:   <<< debug: False
2024-11-05 09:01:10,716:INFO:   <<< distributed: True
2024-11-05 09:01:10,716:INFO:   <<< do_eval: True
2024-11-05 09:01:10,716:INFO:   <<< do_lower_case: False
2024-11-05 09:01:10,717:INFO:   <<< do_pretrain: False
2024-11-05 09:01:10,717:INFO:   <<< do_train: False
2024-11-05 09:01:10,717:INFO:   <<< dual_mix: 0.5
2024-11-05 09:01:10,717:INFO:   <<< epochs: 200
2024-11-05 09:01:10,717:INFO:   <<< eval_frame_order: 0
2024-11-05 09:01:10,717:INFO:   <<< expand_msrvtt_sentences: False
2024-11-05 09:01:10,717:INFO:   <<< feature_framerate: 1
2024-11-05 09:01:10,717:INFO:   <<< feature_len: 64
2024-11-05 09:01:10,717:INFO:   <<< features_path: sign_feature/h2s_domain_agnostic
2024-11-05 09:01:10,717:INFO:   <<< features_path_retrain: sign_feature/h2s_domain_aware
2024-11-05 09:01:10,717:INFO:   <<< fp16: True
2024-11-05 09:01:10,717:INFO:   <<< fp16_opt_level: O1
2024-11-05 09:01:10,717:INFO:   <<< freeze_layer_num: 0
2024-11-05 09:01:10,717:INFO:   <<< gpu_ids: [0, 1]
2024-11-05 09:01:10,717:INFO:   <<< gradient_accumulation_steps: 1
2024-11-05 09:01:10,718:INFO:   <<< hard_negative_rate: 0.5
2024-11-05 09:01:10,718:INFO:   <<< init_model: chpt/H2S_sota.pth
2024-11-05 09:01:10,718:INFO:   <<< linear_patch: 2d
2024-11-05 09:01:10,718:INFO:   <<< local_rank: 0
2024-11-05 09:01:10,718:INFO:   <<< loose_type: True
2024-11-05 09:01:10,718:INFO:   <<< lr: 1e-05
2024-11-05 09:01:10,718:INFO:   <<< lr_decay: 0.001
2024-11-05 09:01:10,718:INFO:   <<< margin: 0.1
2024-11-05 09:01:10,718:INFO:   <<< max_frames: 128
2024-11-05 09:01:10,718:INFO:   <<< max_words: 32
2024-11-05 09:01:10,718:INFO:   <<< mix_design: balance
2024-11-05 09:01:10,718:INFO:   <<< n_display: 1
2024-11-05 09:01:10,718:INFO:   <<< n_gpu: 1
2024-11-05 09:01:10,718:INFO:   <<< n_pair: 1
2024-11-05 09:01:10,718:INFO:   <<< negative_weighting: 1
2024-11-05 09:01:10,718:INFO:   <<< not_load_visual: False
2024-11-05 09:01:10,719:INFO:   <<< num_thread_reader: 8
2024-11-05 09:01:10,719:INFO:   <<< output_dir: new_experiment
2024-11-05 09:01:10,719:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-11-05 09:01:10,719:INFO:   <<< rank: 0
2024-11-05 09:01:10,719:INFO:   <<< resume_model: None
2024-11-05 09:01:10,719:INFO:   <<< sampled_use_mil: False
2024-11-05 09:01:10,719:INFO:   <<< seed: 42
2024-11-05 09:01:10,719:INFO:   <<< sim_calcu: softmax_max
2024-11-05 09:01:10,719:INFO:   <<< sim_header: Filip
2024-11-05 09:01:10,719:INFO:   <<< slice_framepos: 0
2024-11-05 09:01:10,719:INFO:   <<< task_type: retrieval
2024-11-05 09:01:10,719:INFO:   <<< tau: 0.07
2024-11-05 09:01:10,719:INFO:   <<< text_aug: True
2024-11-05 09:01:10,719:INFO:   <<< text_aug_choosen: random_swap
2024-11-05 09:01:10,719:INFO:   <<< text_num_hidden_layers: 12
2024-11-05 09:01:10,719:INFO:   <<< train_frame_order: 0
2024-11-05 09:01:10,720:INFO:   <<< use_mil: False
2024-11-05 09:01:10,720:INFO:   <<< video_dim: 1024
2024-11-05 09:01:10,720:INFO:   <<< visual_num_hidden_layers: 12
2024-11-05 09:01:10,720:INFO:   <<< warmup_proportion: 0.1
2024-11-05 09:01:10,720:INFO:   <<< world_size: 1
2024-11-05 09:01:10,720:INFO: device: cuda:0 n_gpu: 1
2024-11-05 09:02:03,959:INFO: Effective parameters:
2024-11-05 09:02:03,960:INFO:   <<< alpha: 0.8
2024-11-05 09:02:03,960:INFO:   <<< aug_choose: t2v
2024-11-05 09:02:03,960:INFO:   <<< batch_size: 512
2024-11-05 09:02:03,960:INFO:   <<< batch_size_val: 256
2024-11-05 09:02:03,960:INFO:   <<< cache_dir: 
2024-11-05 09:02:03,960:INFO:   <<< cla_weight_dir: cla_weight
2024-11-05 09:02:03,960:INFO:   <<< coef_lr: 1.0
2024-11-05 09:02:03,960:INFO:   <<< combine_type: sum
2024-11-05 09:02:03,960:INFO:   <<< cross_att_layers: 1
2024-11-05 09:02:03,960:INFO:   <<< cross_model: cross-base
2024-11-05 09:02:03,960:INFO:   <<< cross_num_hidden_layers: 4
2024-11-05 09:02:03,960:INFO:   <<< data_path: data_h2
2024-11-05 09:02:03,961:INFO:   <<< datatype: h2s
2024-11-05 09:02:03,961:INFO:   <<< debug: False
2024-11-05 09:02:03,961:INFO:   <<< distributed: True
2024-11-05 09:02:03,961:INFO:   <<< do_eval: True
2024-11-05 09:02:03,961:INFO:   <<< do_lower_case: False
2024-11-05 09:02:03,961:INFO:   <<< do_pretrain: False
2024-11-05 09:02:03,961:INFO:   <<< do_train: False
2024-11-05 09:02:03,961:INFO:   <<< dual_mix: 0.5
2024-11-05 09:02:03,961:INFO:   <<< epochs: 200
2024-11-05 09:02:03,961:INFO:   <<< eval_frame_order: 0
2024-11-05 09:02:03,961:INFO:   <<< expand_msrvtt_sentences: False
2024-11-05 09:02:03,961:INFO:   <<< feature_framerate: 1
2024-11-05 09:02:03,961:INFO:   <<< feature_len: 64
2024-11-05 09:02:03,961:INFO:   <<< features_path: sign_feature/h2s_domain_agnostic
2024-11-05 09:02:03,961:INFO:   <<< features_path_retrain: sign_feature/h2s_domain_aware
2024-11-05 09:02:03,961:INFO:   <<< fp16: True
2024-11-05 09:02:03,962:INFO:   <<< fp16_opt_level: O1
2024-11-05 09:02:03,962:INFO:   <<< freeze_layer_num: 0
2024-11-05 09:02:03,962:INFO:   <<< gpu_ids: [0, 1]
2024-11-05 09:02:03,962:INFO:   <<< gradient_accumulation_steps: 1
2024-11-05 09:02:03,962:INFO:   <<< hard_negative_rate: 0.5
2024-11-05 09:02:03,962:INFO:   <<< init_model: chpt/H2S_sota.pth
2024-11-05 09:02:03,962:INFO:   <<< linear_patch: 2d
2024-11-05 09:02:03,962:INFO:   <<< local_rank: 0
2024-11-05 09:02:03,962:INFO:   <<< loose_type: True
2024-11-05 09:02:03,962:INFO:   <<< lr: 1e-05
2024-11-05 09:02:03,962:INFO:   <<< lr_decay: 0.001
2024-11-05 09:02:03,962:INFO:   <<< margin: 0.1
2024-11-05 09:02:03,962:INFO:   <<< max_frames: 128
2024-11-05 09:02:03,962:INFO:   <<< max_words: 32
2024-11-05 09:02:03,962:INFO:   <<< mix_design: balance
2024-11-05 09:02:03,963:INFO:   <<< n_display: 1
2024-11-05 09:02:03,963:INFO:   <<< n_gpu: 1
2024-11-05 09:02:03,963:INFO:   <<< n_pair: 1
2024-11-05 09:02:03,963:INFO:   <<< negative_weighting: 1
2024-11-05 09:02:03,963:INFO:   <<< not_load_visual: False
2024-11-05 09:02:03,963:INFO:   <<< num_thread_reader: 8
2024-11-05 09:02:03,963:INFO:   <<< output_dir: new_experiment
2024-11-05 09:02:03,963:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-11-05 09:02:03,963:INFO:   <<< rank: 0
2024-11-05 09:02:03,963:INFO:   <<< resume_model: None
2024-11-05 09:02:03,963:INFO:   <<< sampled_use_mil: False
2024-11-05 09:02:03,963:INFO:   <<< seed: 42
2024-11-05 09:02:03,963:INFO:   <<< sim_calcu: softmax_max
2024-11-05 09:02:03,963:INFO:   <<< sim_header: Filip
2024-11-05 09:02:03,963:INFO:   <<< slice_framepos: 0
2024-11-05 09:02:03,963:INFO:   <<< task_type: retrieval
2024-11-05 09:02:03,964:INFO:   <<< tau: 0.07
2024-11-05 09:02:03,964:INFO:   <<< text_aug: True
2024-11-05 09:02:03,964:INFO:   <<< text_aug_choosen: random_swap
2024-11-05 09:02:03,964:INFO:   <<< text_num_hidden_layers: 12
2024-11-05 09:02:03,964:INFO:   <<< train_frame_order: 0
2024-11-05 09:02:03,964:INFO:   <<< use_mil: False
2024-11-05 09:02:03,964:INFO:   <<< video_dim: 1024
2024-11-05 09:02:03,964:INFO:   <<< visual_num_hidden_layers: 12
2024-11-05 09:02:03,964:INFO:   <<< warmup_proportion: 0.1
2024-11-05 09:02:03,964:INFO:   <<< world_size: 1
2024-11-05 09:02:03,965:INFO: device: cuda:0 n_gpu: 1
2024-11-05 09:03:16,174:INFO: Effective parameters:
2024-11-05 09:03:16,174:INFO:   <<< alpha: 0.8
2024-11-05 09:03:16,174:INFO:   <<< aug_choose: t2v
2024-11-05 09:03:16,174:INFO:   <<< batch_size: 512
2024-11-05 09:03:16,174:INFO:   <<< batch_size_val: 256
2024-11-05 09:03:16,174:INFO:   <<< cache_dir: 
2024-11-05 09:03:16,174:INFO:   <<< cla_weight_dir: cla_weight
2024-11-05 09:03:16,174:INFO:   <<< coef_lr: 1.0
2024-11-05 09:03:16,174:INFO:   <<< combine_type: sum
2024-11-05 09:03:16,174:INFO:   <<< cross_att_layers: 1
2024-11-05 09:03:16,175:INFO:   <<< cross_model: cross-base
2024-11-05 09:03:16,175:INFO:   <<< cross_num_hidden_layers: 4
2024-11-05 09:03:16,175:INFO:   <<< data_path: data_h2
2024-11-05 09:03:16,175:INFO:   <<< datatype: h2s
2024-11-05 09:03:16,175:INFO:   <<< debug: False
2024-11-05 09:03:16,175:INFO:   <<< distributed: True
2024-11-05 09:03:16,175:INFO:   <<< do_eval: True
2024-11-05 09:03:16,175:INFO:   <<< do_lower_case: False
2024-11-05 09:03:16,175:INFO:   <<< do_pretrain: False
2024-11-05 09:03:16,175:INFO:   <<< do_train: False
2024-11-05 09:03:16,175:INFO:   <<< dual_mix: 0.5
2024-11-05 09:03:16,175:INFO:   <<< epochs: 200
2024-11-05 09:03:16,175:INFO:   <<< eval_frame_order: 0
2024-11-05 09:03:16,175:INFO:   <<< expand_msrvtt_sentences: False
2024-11-05 09:03:16,176:INFO:   <<< feature_framerate: 1
2024-11-05 09:03:16,176:INFO:   <<< feature_len: 64
2024-11-05 09:03:16,176:INFO:   <<< features_path: sign_feature/h2s_domain_agnostic
2024-11-05 09:03:16,176:INFO:   <<< features_path_retrain: sign_feature/h2s_domain_aware
2024-11-05 09:03:16,176:INFO:   <<< fp16: True
2024-11-05 09:03:16,176:INFO:   <<< fp16_opt_level: O1
2024-11-05 09:03:16,176:INFO:   <<< freeze_layer_num: 0
2024-11-05 09:03:16,176:INFO:   <<< gpu_ids: [0, 1]
2024-11-05 09:03:16,176:INFO:   <<< gradient_accumulation_steps: 1
2024-11-05 09:03:16,176:INFO:   <<< hard_negative_rate: 0.5
2024-11-05 09:03:16,176:INFO:   <<< init_model: chpt/H2S_sota.pth
2024-11-05 09:03:16,176:INFO:   <<< linear_patch: 2d
2024-11-05 09:03:16,176:INFO:   <<< local_rank: 0
2024-11-05 09:03:16,176:INFO:   <<< loose_type: True
2024-11-05 09:03:16,176:INFO:   <<< lr: 1e-05
2024-11-05 09:03:16,176:INFO:   <<< lr_decay: 0.001
2024-11-05 09:03:16,177:INFO:   <<< margin: 0.1
2024-11-05 09:03:16,177:INFO:   <<< max_frames: 128
2024-11-05 09:03:16,177:INFO:   <<< max_words: 32
2024-11-05 09:03:16,177:INFO:   <<< mix_design: balance
2024-11-05 09:03:16,177:INFO:   <<< n_display: 1
2024-11-05 09:03:16,177:INFO:   <<< n_gpu: 1
2024-11-05 09:03:16,177:INFO:   <<< n_pair: 1
2024-11-05 09:03:16,177:INFO:   <<< negative_weighting: 1
2024-11-05 09:03:16,177:INFO:   <<< not_load_visual: False
2024-11-05 09:03:16,177:INFO:   <<< num_thread_reader: 8
2024-11-05 09:03:16,177:INFO:   <<< output_dir: new_experiment
2024-11-05 09:03:16,177:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-11-05 09:03:16,177:INFO:   <<< rank: 0
2024-11-05 09:03:16,177:INFO:   <<< resume_model: None
2024-11-05 09:03:16,177:INFO:   <<< sampled_use_mil: False
2024-11-05 09:03:16,177:INFO:   <<< seed: 42
2024-11-05 09:03:16,178:INFO:   <<< sim_calcu: softmax_max
2024-11-05 09:03:16,178:INFO:   <<< sim_header: Filip
2024-11-05 09:03:16,178:INFO:   <<< slice_framepos: 0
2024-11-05 09:03:16,178:INFO:   <<< task_type: retrieval
2024-11-05 09:03:16,178:INFO:   <<< tau: 0.07
2024-11-05 09:03:16,178:INFO:   <<< text_aug: True
2024-11-05 09:03:16,178:INFO:   <<< text_aug_choosen: random_swap
2024-11-05 09:03:16,178:INFO:   <<< text_num_hidden_layers: 12
2024-11-05 09:03:16,178:INFO:   <<< train_frame_order: 0
2024-11-05 09:03:16,178:INFO:   <<< use_mil: False
2024-11-05 09:03:16,178:INFO:   <<< video_dim: 1024
2024-11-05 09:03:16,178:INFO:   <<< visual_num_hidden_layers: 12
2024-11-05 09:03:16,178:INFO:   <<< warmup_proportion: 0.1
2024-11-05 09:03:16,178:INFO:   <<< world_size: 1
2024-11-05 09:03:16,179:INFO: device: cuda:0 n_gpu: 1
2024-11-05 09:06:21,699:INFO: Effective parameters:
2024-11-05 09:06:21,699:INFO:   <<< alpha: 0.8
2024-11-05 09:06:21,699:INFO:   <<< aug_choose: t2v
2024-11-05 09:06:21,699:INFO:   <<< batch_size: 512
2024-11-05 09:06:21,699:INFO:   <<< batch_size_val: 256
2024-11-05 09:06:21,699:INFO:   <<< cache_dir: 
2024-11-05 09:06:21,699:INFO:   <<< cla_weight_dir: cla_weight
2024-11-05 09:06:21,700:INFO:   <<< coef_lr: 1.0
2024-11-05 09:06:21,700:INFO:   <<< combine_type: sum
2024-11-05 09:06:21,700:INFO:   <<< cross_att_layers: 1
2024-11-05 09:06:21,700:INFO:   <<< cross_model: cross-base
2024-11-05 09:06:21,700:INFO:   <<< cross_num_hidden_layers: 4
2024-11-05 09:06:21,700:INFO:   <<< data_path: data_h2
2024-11-05 09:06:21,700:INFO:   <<< datatype: h2s
2024-11-05 09:06:21,700:INFO:   <<< debug: False
2024-11-05 09:06:21,700:INFO:   <<< distributed: True
2024-11-05 09:06:21,700:INFO:   <<< do_eval: True
2024-11-05 09:06:21,700:INFO:   <<< do_lower_case: False
2024-11-05 09:06:21,700:INFO:   <<< do_pretrain: False
2024-11-05 09:06:21,700:INFO:   <<< do_train: False
2024-11-05 09:06:21,700:INFO:   <<< dual_mix: 0.5
2024-11-05 09:06:21,700:INFO:   <<< epochs: 200
2024-11-05 09:06:21,700:INFO:   <<< eval_frame_order: 0
2024-11-05 09:06:21,700:INFO:   <<< expand_msrvtt_sentences: False
2024-11-05 09:06:21,701:INFO:   <<< feature_framerate: 1
2024-11-05 09:06:21,701:INFO:   <<< feature_len: 64
2024-11-05 09:06:21,701:INFO:   <<< features_path: sign_feature/h2s_domain_agnostic
2024-11-05 09:06:21,701:INFO:   <<< features_path_retrain: sign_feature/h2s_domain_aware
2024-11-05 09:06:21,701:INFO:   <<< fp16: True
2024-11-05 09:06:21,701:INFO:   <<< fp16_opt_level: O1
2024-11-05 09:06:21,701:INFO:   <<< freeze_layer_num: 0
2024-11-05 09:06:21,701:INFO:   <<< gpu_ids: [0, 1]
2024-11-05 09:06:21,701:INFO:   <<< gradient_accumulation_steps: 1
2024-11-05 09:06:21,701:INFO:   <<< hard_negative_rate: 0.5
2024-11-05 09:06:21,701:INFO:   <<< init_model: chpt/H2S_sota.pth
2024-11-05 09:06:21,701:INFO:   <<< linear_patch: 2d
2024-11-05 09:06:21,701:INFO:   <<< local_rank: 0
2024-11-05 09:06:21,701:INFO:   <<< loose_type: True
2024-11-05 09:06:21,701:INFO:   <<< lr: 1e-05
2024-11-05 09:06:21,702:INFO:   <<< lr_decay: 0.001
2024-11-05 09:06:21,702:INFO:   <<< margin: 0.1
2024-11-05 09:06:21,702:INFO:   <<< max_frames: 128
2024-11-05 09:06:21,702:INFO:   <<< max_words: 32
2024-11-05 09:06:21,702:INFO:   <<< mix_design: balance
2024-11-05 09:06:21,702:INFO:   <<< n_display: 1
2024-11-05 09:06:21,702:INFO:   <<< n_gpu: 1
2024-11-05 09:06:21,702:INFO:   <<< n_pair: 1
2024-11-05 09:06:21,702:INFO:   <<< negative_weighting: 1
2024-11-05 09:06:21,702:INFO:   <<< not_load_visual: False
2024-11-05 09:06:21,702:INFO:   <<< num_thread_reader: 8
2024-11-05 09:06:21,702:INFO:   <<< output_dir: new_experiment
2024-11-05 09:06:21,702:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-11-05 09:06:21,702:INFO:   <<< rank: 0
2024-11-05 09:06:21,702:INFO:   <<< resume_model: None
2024-11-05 09:06:21,703:INFO:   <<< sampled_use_mil: False
2024-11-05 09:06:21,703:INFO:   <<< seed: 42
2024-11-05 09:06:21,703:INFO:   <<< sim_calcu: softmax_max
2024-11-05 09:06:21,703:INFO:   <<< sim_header: Filip
2024-11-05 09:06:21,703:INFO:   <<< slice_framepos: 0
2024-11-05 09:06:21,703:INFO:   <<< task_type: retrieval
2024-11-05 09:06:21,703:INFO:   <<< tau: 0.07
2024-11-05 09:06:21,703:INFO:   <<< text_aug: True
2024-11-05 09:06:21,703:INFO:   <<< text_aug_choosen: random_swap
2024-11-05 09:06:21,703:INFO:   <<< text_num_hidden_layers: 12
2024-11-05 09:06:21,703:INFO:   <<< train_frame_order: 0
2024-11-05 09:06:21,703:INFO:   <<< use_mil: False
2024-11-05 09:06:21,703:INFO:   <<< video_dim: 1024
2024-11-05 09:06:21,703:INFO:   <<< visual_num_hidden_layers: 12
2024-11-05 09:06:21,703:INFO:   <<< warmup_proportion: 0.1
2024-11-05 09:06:21,703:INFO:   <<< world_size: 1
2024-11-05 09:06:21,704:INFO: device: cuda:0 n_gpu: 1
2024-11-05 09:10:31,876:INFO: Effective parameters:
2024-11-05 09:10:31,877:INFO:   <<< alpha: 0.8
2024-11-05 09:10:31,877:INFO:   <<< aug_choose: t2v
2024-11-05 09:10:31,877:INFO:   <<< batch_size: 512
2024-11-05 09:10:31,877:INFO:   <<< batch_size_val: 256
2024-11-05 09:10:31,877:INFO:   <<< cache_dir: 
2024-11-05 09:10:31,877:INFO:   <<< cla_weight_dir: cla_weight
2024-11-05 09:10:31,877:INFO:   <<< coef_lr: 1.0
2024-11-05 09:10:31,877:INFO:   <<< combine_type: sum
2024-11-05 09:10:31,877:INFO:   <<< cross_att_layers: 1
2024-11-05 09:10:31,877:INFO:   <<< cross_model: cross-base
2024-11-05 09:10:31,877:INFO:   <<< cross_num_hidden_layers: 4
2024-11-05 09:10:31,877:INFO:   <<< data_path: data_h2
2024-11-05 09:10:31,877:INFO:   <<< datatype: h2s
2024-11-05 09:10:31,877:INFO:   <<< debug: False
2024-11-05 09:10:31,878:INFO:   <<< distributed: True
2024-11-05 09:10:31,878:INFO:   <<< do_eval: True
2024-11-05 09:10:31,878:INFO:   <<< do_lower_case: False
2024-11-05 09:10:31,878:INFO:   <<< do_pretrain: False
2024-11-05 09:10:31,878:INFO:   <<< do_train: False
2024-11-05 09:10:31,878:INFO:   <<< dual_mix: 0.5
2024-11-05 09:10:31,878:INFO:   <<< epochs: 200
2024-11-05 09:10:31,878:INFO:   <<< eval_frame_order: 0
2024-11-05 09:10:31,878:INFO:   <<< expand_msrvtt_sentences: False
2024-11-05 09:10:31,878:INFO:   <<< feature_framerate: 1
2024-11-05 09:10:31,878:INFO:   <<< feature_len: 64
2024-11-05 09:10:31,878:INFO:   <<< features_path: sign_feature/h2s_domain_agnostic
2024-11-05 09:10:31,878:INFO:   <<< features_path_retrain: sign_feature/h2s_domain_aware
2024-11-05 09:10:31,878:INFO:   <<< fp16: True
2024-11-05 09:10:31,878:INFO:   <<< fp16_opt_level: O1
2024-11-05 09:10:31,879:INFO:   <<< freeze_layer_num: 0
2024-11-05 09:10:31,879:INFO:   <<< gpu_ids: [0, 1]
2024-11-05 09:10:31,879:INFO:   <<< gradient_accumulation_steps: 1
2024-11-05 09:10:31,879:INFO:   <<< hard_negative_rate: 0.5
2024-11-05 09:10:31,879:INFO:   <<< init_model: chpt/H2S_sota.pth
2024-11-05 09:10:31,879:INFO:   <<< linear_patch: 2d
2024-11-05 09:10:31,879:INFO:   <<< local_rank: 0
2024-11-05 09:10:31,879:INFO:   <<< loose_type: True
2024-11-05 09:10:31,879:INFO:   <<< lr: 1e-05
2024-11-05 09:10:31,879:INFO:   <<< lr_decay: 0.001
2024-11-05 09:10:31,879:INFO:   <<< margin: 0.1
2024-11-05 09:10:31,879:INFO:   <<< max_frames: 128
2024-11-05 09:10:31,879:INFO:   <<< max_words: 32
2024-11-05 09:10:31,879:INFO:   <<< mix_design: balance
2024-11-05 09:10:31,879:INFO:   <<< n_display: 1
2024-11-05 09:10:31,880:INFO:   <<< n_gpu: 1
2024-11-05 09:10:31,880:INFO:   <<< n_pair: 1
2024-11-05 09:10:31,880:INFO:   <<< negative_weighting: 1
2024-11-05 09:10:31,880:INFO:   <<< not_load_visual: False
2024-11-05 09:10:31,880:INFO:   <<< num_thread_reader: 8
2024-11-05 09:10:31,880:INFO:   <<< output_dir: new_experiment
2024-11-05 09:10:31,880:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-11-05 09:10:31,880:INFO:   <<< rank: 0
2024-11-05 09:10:31,880:INFO:   <<< resume_model: None
2024-11-05 09:10:31,880:INFO:   <<< sampled_use_mil: False
2024-11-05 09:10:31,880:INFO:   <<< seed: 42
2024-11-05 09:10:31,880:INFO:   <<< sim_calcu: softmax_max
2024-11-05 09:10:31,880:INFO:   <<< sim_header: Filip
2024-11-05 09:10:31,880:INFO:   <<< slice_framepos: 0
2024-11-05 09:10:31,880:INFO:   <<< task_type: retrieval
2024-11-05 09:10:31,880:INFO:   <<< tau: 0.07
2024-11-05 09:10:31,881:INFO:   <<< text_aug: True
2024-11-05 09:10:31,881:INFO:   <<< text_aug_choosen: random_swap
2024-11-05 09:10:31,881:INFO:   <<< text_num_hidden_layers: 12
2024-11-05 09:10:31,881:INFO:   <<< train_frame_order: 0
2024-11-05 09:10:31,881:INFO:   <<< use_mil: False
2024-11-05 09:10:31,881:INFO:   <<< video_dim: 1024
2024-11-05 09:10:31,881:INFO:   <<< visual_num_hidden_layers: 12
2024-11-05 09:10:31,881:INFO:   <<< warmup_proportion: 0.1
2024-11-05 09:10:31,881:INFO:   <<< world_size: 1
2024-11-05 09:10:31,882:INFO: device: cuda:0 n_gpu: 1
2024-11-05 09:11:07,649:INFO: Effective parameters:
2024-11-05 09:11:07,649:INFO:   <<< alpha: 0.8
2024-11-05 09:11:07,649:INFO:   <<< aug_choose: t2v
2024-11-05 09:11:07,649:INFO:   <<< batch_size: 512
2024-11-05 09:11:07,649:INFO:   <<< batch_size_val: 256
2024-11-05 09:11:07,649:INFO:   <<< cache_dir: 
2024-11-05 09:11:07,649:INFO:   <<< cla_weight_dir: cla_weight
2024-11-05 09:11:07,649:INFO:   <<< coef_lr: 1.0
2024-11-05 09:11:07,649:INFO:   <<< combine_type: sum
2024-11-05 09:11:07,649:INFO:   <<< cross_att_layers: 1
2024-11-05 09:11:07,650:INFO:   <<< cross_model: cross-base
2024-11-05 09:11:07,650:INFO:   <<< cross_num_hidden_layers: 4
2024-11-05 09:11:07,650:INFO:   <<< data_path: data_h2
2024-11-05 09:11:07,650:INFO:   <<< datatype: h2s
2024-11-05 09:11:07,650:INFO:   <<< debug: False
2024-11-05 09:11:07,650:INFO:   <<< distributed: True
2024-11-05 09:11:07,650:INFO:   <<< do_eval: True
2024-11-05 09:11:07,650:INFO:   <<< do_lower_case: False
2024-11-05 09:11:07,650:INFO:   <<< do_pretrain: False
2024-11-05 09:11:07,650:INFO:   <<< do_train: False
2024-11-05 09:11:07,650:INFO:   <<< dual_mix: 0.5
2024-11-05 09:11:07,650:INFO:   <<< epochs: 200
2024-11-05 09:11:07,650:INFO:   <<< eval_frame_order: 0
2024-11-05 09:11:07,650:INFO:   <<< expand_msrvtt_sentences: False
2024-11-05 09:11:07,650:INFO:   <<< feature_framerate: 1
2024-11-05 09:11:07,650:INFO:   <<< feature_len: 64
2024-11-05 09:11:07,650:INFO:   <<< features_path: sign_feature/h2s_domain_agnostic
2024-11-05 09:11:07,651:INFO:   <<< features_path_retrain: sign_feature/h2s_domain_aware
2024-11-05 09:11:07,651:INFO:   <<< fp16: True
2024-11-05 09:11:07,651:INFO:   <<< fp16_opt_level: O1
2024-11-05 09:11:07,651:INFO:   <<< freeze_layer_num: 0
2024-11-05 09:11:07,651:INFO:   <<< gpu_ids: [0, 1]
2024-11-05 09:11:07,651:INFO:   <<< gradient_accumulation_steps: 1
2024-11-05 09:11:07,651:INFO:   <<< hard_negative_rate: 0.5
2024-11-05 09:11:07,651:INFO:   <<< init_model: chpt/H2S_sota.pth
2024-11-05 09:11:07,651:INFO:   <<< linear_patch: 2d
2024-11-05 09:11:07,651:INFO:   <<< local_rank: 0
2024-11-05 09:11:07,651:INFO:   <<< loose_type: True
2024-11-05 09:11:07,651:INFO:   <<< lr: 1e-05
2024-11-05 09:11:07,651:INFO:   <<< lr_decay: 0.001
2024-11-05 09:11:07,651:INFO:   <<< margin: 0.1
2024-11-05 09:11:07,651:INFO:   <<< max_frames: 128
2024-11-05 09:11:07,651:INFO:   <<< max_words: 32
2024-11-05 09:11:07,651:INFO:   <<< mix_design: balance
2024-11-05 09:11:07,652:INFO:   <<< n_display: 1
2024-11-05 09:11:07,652:INFO:   <<< n_gpu: 1
2024-11-05 09:11:07,652:INFO:   <<< n_pair: 1
2024-11-05 09:11:07,652:INFO:   <<< negative_weighting: 1
2024-11-05 09:11:07,652:INFO:   <<< not_load_visual: False
2024-11-05 09:11:07,652:INFO:   <<< num_thread_reader: 8
2024-11-05 09:11:07,652:INFO:   <<< output_dir: new_experiment
2024-11-05 09:11:07,652:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-11-05 09:11:07,652:INFO:   <<< rank: 0
2024-11-05 09:11:07,652:INFO:   <<< resume_model: None
2024-11-05 09:11:07,652:INFO:   <<< sampled_use_mil: False
2024-11-05 09:11:07,652:INFO:   <<< seed: 42
2024-11-05 09:11:07,652:INFO:   <<< sim_calcu: softmax_max
2024-11-05 09:11:07,652:INFO:   <<< sim_header: Filip
2024-11-05 09:11:07,652:INFO:   <<< slice_framepos: 0
2024-11-05 09:11:07,652:INFO:   <<< task_type: retrieval
2024-11-05 09:11:07,653:INFO:   <<< tau: 0.07
2024-11-05 09:11:07,653:INFO:   <<< text_aug: True
2024-11-05 09:11:07,653:INFO:   <<< text_aug_choosen: random_swap
2024-11-05 09:11:07,653:INFO:   <<< text_num_hidden_layers: 12
2024-11-05 09:11:07,653:INFO:   <<< train_frame_order: 0
2024-11-05 09:11:07,653:INFO:   <<< use_mil: False
2024-11-05 09:11:07,653:INFO:   <<< video_dim: 1024
2024-11-05 09:11:07,653:INFO:   <<< visual_num_hidden_layers: 12
2024-11-05 09:11:07,653:INFO:   <<< warmup_proportion: 0.1
2024-11-05 09:11:07,653:INFO:   <<< world_size: 1
2024-11-05 09:11:07,654:INFO: device: cuda:0 n_gpu: 1
2024-11-05 09:12:46,231:INFO: Effective parameters:
2024-11-05 09:12:46,232:INFO:   <<< alpha: 0.8
2024-11-05 09:12:46,232:INFO:   <<< aug_choose: t2v
2024-11-05 09:12:46,232:INFO:   <<< batch_size: 512
2024-11-05 09:12:46,232:INFO:   <<< batch_size_val: 256
2024-11-05 09:12:46,232:INFO:   <<< cache_dir: 
2024-11-05 09:12:46,232:INFO:   <<< cla_weight_dir: cla_weight
2024-11-05 09:12:46,232:INFO:   <<< coef_lr: 1.0
2024-11-05 09:12:46,232:INFO:   <<< combine_type: sum
2024-11-05 09:12:46,232:INFO:   <<< cross_att_layers: 1
2024-11-05 09:12:46,232:INFO:   <<< cross_model: cross-base
2024-11-05 09:12:46,232:INFO:   <<< cross_num_hidden_layers: 4
2024-11-05 09:12:46,232:INFO:   <<< data_path: data_h2
2024-11-05 09:12:46,232:INFO:   <<< datatype: h2s
2024-11-05 09:12:46,233:INFO:   <<< debug: False
2024-11-05 09:12:46,233:INFO:   <<< distributed: True
2024-11-05 09:12:46,233:INFO:   <<< do_eval: True
2024-11-05 09:12:46,233:INFO:   <<< do_lower_case: False
2024-11-05 09:12:46,233:INFO:   <<< do_pretrain: False
2024-11-05 09:12:46,233:INFO:   <<< do_train: False
2024-11-05 09:12:46,233:INFO:   <<< dual_mix: 0.5
2024-11-05 09:12:46,233:INFO:   <<< epochs: 200
2024-11-05 09:12:46,233:INFO:   <<< eval_frame_order: 0
2024-11-05 09:12:46,233:INFO:   <<< expand_msrvtt_sentences: False
2024-11-05 09:12:46,233:INFO:   <<< feature_framerate: 1
2024-11-05 09:12:46,233:INFO:   <<< feature_len: 64
2024-11-05 09:12:46,233:INFO:   <<< features_path: sign_feature/h2s_domain_agnostic
2024-11-05 09:12:46,233:INFO:   <<< features_path_retrain: sign_feature/h2s_domain_aware
2024-11-05 09:12:46,234:INFO:   <<< fp16: True
2024-11-05 09:12:46,234:INFO:   <<< fp16_opt_level: O1
2024-11-05 09:12:46,234:INFO:   <<< freeze_layer_num: 0
2024-11-05 09:12:46,234:INFO:   <<< gpu_ids: [0, 1]
2024-11-05 09:12:46,234:INFO:   <<< gradient_accumulation_steps: 1
2024-11-05 09:12:46,234:INFO:   <<< hard_negative_rate: 0.5
2024-11-05 09:12:46,234:INFO:   <<< init_model: chpt/H2S_sota.pth
2024-11-05 09:12:46,234:INFO:   <<< linear_patch: 2d
2024-11-05 09:12:46,234:INFO:   <<< local_rank: 0
2024-11-05 09:12:46,234:INFO:   <<< loose_type: True
2024-11-05 09:12:46,234:INFO:   <<< lr: 1e-05
2024-11-05 09:12:46,234:INFO:   <<< lr_decay: 0.001
2024-11-05 09:12:46,234:INFO:   <<< margin: 0.1
2024-11-05 09:12:46,234:INFO:   <<< max_frames: 128
2024-11-05 09:12:46,234:INFO:   <<< max_words: 32
2024-11-05 09:12:46,235:INFO:   <<< mix_design: balance
2024-11-05 09:12:46,235:INFO:   <<< n_display: 1
2024-11-05 09:12:46,235:INFO:   <<< n_gpu: 1
2024-11-05 09:12:46,235:INFO:   <<< n_pair: 1
2024-11-05 09:12:46,235:INFO:   <<< negative_weighting: 1
2024-11-05 09:12:46,235:INFO:   <<< not_load_visual: False
2024-11-05 09:12:46,235:INFO:   <<< num_thread_reader: 8
2024-11-05 09:12:46,235:INFO:   <<< output_dir: new_experiment
2024-11-05 09:12:46,235:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-11-05 09:12:46,235:INFO:   <<< rank: 0
2024-11-05 09:12:46,235:INFO:   <<< resume_model: None
2024-11-05 09:12:46,235:INFO:   <<< sampled_use_mil: False
2024-11-05 09:12:46,235:INFO:   <<< seed: 42
2024-11-05 09:12:46,235:INFO:   <<< sim_calcu: softmax_max
2024-11-05 09:12:46,235:INFO:   <<< sim_header: Filip
2024-11-05 09:12:46,236:INFO:   <<< slice_framepos: 0
2024-11-05 09:12:46,236:INFO:   <<< task_type: retrieval
2024-11-05 09:12:46,236:INFO:   <<< tau: 0.07
2024-11-05 09:12:46,236:INFO:   <<< text_aug: True
2024-11-05 09:12:46,236:INFO:   <<< text_aug_choosen: random_swap
2024-11-05 09:12:46,236:INFO:   <<< text_num_hidden_layers: 12
2024-11-05 09:12:46,236:INFO:   <<< train_frame_order: 0
2024-11-05 09:12:46,236:INFO:   <<< use_mil: False
2024-11-05 09:12:46,236:INFO:   <<< video_dim: 1024
2024-11-05 09:12:46,236:INFO:   <<< visual_num_hidden_layers: 12
2024-11-05 09:12:46,236:INFO:   <<< warmup_proportion: 0.1
2024-11-05 09:12:46,236:INFO:   <<< world_size: 1
2024-11-05 09:12:46,237:INFO: device: cuda:0 n_gpu: 1
2024-11-05 09:14:52,338:INFO: Effective parameters:
2024-11-05 09:14:52,339:INFO:   <<< alpha: 0.8
2024-11-05 09:14:52,339:INFO:   <<< aug_choose: t2v
2024-11-05 09:14:52,339:INFO:   <<< batch_size: 512
2024-11-05 09:14:52,339:INFO:   <<< batch_size_val: 256
2024-11-05 09:14:52,339:INFO:   <<< cache_dir: 
2024-11-05 09:14:52,339:INFO:   <<< cla_weight_dir: cla_weight
2024-11-05 09:14:52,339:INFO:   <<< coef_lr: 1.0
2024-11-05 09:14:52,339:INFO:   <<< combine_type: sum
2024-11-05 09:14:52,339:INFO:   <<< cross_att_layers: 1
2024-11-05 09:14:52,339:INFO:   <<< cross_model: cross-base
2024-11-05 09:14:52,339:INFO:   <<< cross_num_hidden_layers: 4
2024-11-05 09:14:52,339:INFO:   <<< data_path: data_h2
2024-11-05 09:14:52,339:INFO:   <<< datatype: h2s
2024-11-05 09:14:52,339:INFO:   <<< debug: False
2024-11-05 09:14:52,340:INFO:   <<< distributed: True
2024-11-05 09:14:52,340:INFO:   <<< do_eval: True
2024-11-05 09:14:52,340:INFO:   <<< do_lower_case: False
2024-11-05 09:14:52,340:INFO:   <<< do_pretrain: False
2024-11-05 09:14:52,340:INFO:   <<< do_train: False
2024-11-05 09:14:52,340:INFO:   <<< dual_mix: 0.5
2024-11-05 09:14:52,340:INFO:   <<< epochs: 200
2024-11-05 09:14:52,340:INFO:   <<< eval_frame_order: 0
2024-11-05 09:14:52,340:INFO:   <<< expand_msrvtt_sentences: False
2024-11-05 09:14:52,340:INFO:   <<< feature_framerate: 1
2024-11-05 09:14:52,340:INFO:   <<< feature_len: 64
2024-11-05 09:14:52,340:INFO:   <<< features_path: sign_feature/h2s_domain_agnostic
2024-11-05 09:14:52,340:INFO:   <<< features_path_retrain: sign_feature/h2s_domain_aware
2024-11-05 09:14:52,340:INFO:   <<< fp16: True
2024-11-05 09:14:52,340:INFO:   <<< fp16_opt_level: O1
2024-11-05 09:14:52,341:INFO:   <<< freeze_layer_num: 0
2024-11-05 09:14:52,341:INFO:   <<< gpu_ids: [0, 1]
2024-11-05 09:14:52,341:INFO:   <<< gradient_accumulation_steps: 1
2024-11-05 09:14:52,341:INFO:   <<< hard_negative_rate: 0.5
2024-11-05 09:14:52,341:INFO:   <<< init_model: chpt/H2S_sota.pth
2024-11-05 09:14:52,341:INFO:   <<< linear_patch: 2d
2024-11-05 09:14:52,341:INFO:   <<< local_rank: 0
2024-11-05 09:14:52,341:INFO:   <<< loose_type: True
2024-11-05 09:14:52,341:INFO:   <<< lr: 1e-05
2024-11-05 09:14:52,341:INFO:   <<< lr_decay: 0.001
2024-11-05 09:14:52,341:INFO:   <<< margin: 0.1
2024-11-05 09:14:52,341:INFO:   <<< max_frames: 128
2024-11-05 09:14:52,341:INFO:   <<< max_words: 32
2024-11-05 09:14:52,341:INFO:   <<< mix_design: balance
2024-11-05 09:14:52,341:INFO:   <<< n_display: 1
2024-11-05 09:14:52,342:INFO:   <<< n_gpu: 1
2024-11-05 09:14:52,342:INFO:   <<< n_pair: 1
2024-11-05 09:14:52,342:INFO:   <<< negative_weighting: 1
2024-11-05 09:14:52,342:INFO:   <<< not_load_visual: False
2024-11-05 09:14:52,342:INFO:   <<< num_thread_reader: 8
2024-11-05 09:14:52,342:INFO:   <<< output_dir: new_experiment
2024-11-05 09:14:52,342:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-11-05 09:14:52,342:INFO:   <<< rank: 0
2024-11-05 09:14:52,342:INFO:   <<< resume_model: None
2024-11-05 09:14:52,342:INFO:   <<< sampled_use_mil: False
2024-11-05 09:14:52,342:INFO:   <<< seed: 42
2024-11-05 09:14:52,342:INFO:   <<< sim_calcu: softmax_max
2024-11-05 09:14:52,342:INFO:   <<< sim_header: Filip
2024-11-05 09:14:52,342:INFO:   <<< slice_framepos: 0
2024-11-05 09:14:52,342:INFO:   <<< task_type: retrieval
2024-11-05 09:14:52,342:INFO:   <<< tau: 0.07
2024-11-05 09:14:52,343:INFO:   <<< text_aug: True
2024-11-05 09:14:52,343:INFO:   <<< text_aug_choosen: random_swap
2024-11-05 09:14:52,343:INFO:   <<< text_num_hidden_layers: 12
2024-11-05 09:14:52,343:INFO:   <<< train_frame_order: 0
2024-11-05 09:14:52,343:INFO:   <<< use_mil: False
2024-11-05 09:14:52,343:INFO:   <<< video_dim: 1024
2024-11-05 09:14:52,343:INFO:   <<< visual_num_hidden_layers: 12
2024-11-05 09:14:52,343:INFO:   <<< warmup_proportion: 0.1
2024-11-05 09:14:52,343:INFO:   <<< world_size: 1
2024-11-05 09:14:52,344:INFO: device: cuda:0 n_gpu: 1
2024-11-05 09:15:44,512:INFO: Effective parameters:
2024-11-05 09:15:44,512:INFO:   <<< alpha: 0.8
2024-11-05 09:15:44,512:INFO:   <<< aug_choose: t2v
2024-11-05 09:15:44,512:INFO:   <<< batch_size: 512
2024-11-05 09:15:44,512:INFO:   <<< batch_size_val: 256
2024-11-05 09:15:44,512:INFO:   <<< cache_dir: 
2024-11-05 09:15:44,513:INFO:   <<< cla_weight_dir: cla_weight
2024-11-05 09:15:44,513:INFO:   <<< coef_lr: 1.0
2024-11-05 09:15:44,513:INFO:   <<< combine_type: sum
2024-11-05 09:15:44,513:INFO:   <<< cross_att_layers: 1
2024-11-05 09:15:44,513:INFO:   <<< cross_model: cross-base
2024-11-05 09:15:44,513:INFO:   <<< cross_num_hidden_layers: 4
2024-11-05 09:15:44,513:INFO:   <<< data_path: data_h2
2024-11-05 09:15:44,513:INFO:   <<< datatype: h2s
2024-11-05 09:15:44,513:INFO:   <<< debug: False
2024-11-05 09:15:44,513:INFO:   <<< distributed: True
2024-11-05 09:15:44,513:INFO:   <<< do_eval: True
2024-11-05 09:15:44,513:INFO:   <<< do_lower_case: False
2024-11-05 09:15:44,513:INFO:   <<< do_pretrain: False
2024-11-05 09:15:44,513:INFO:   <<< do_train: False
2024-11-05 09:15:44,513:INFO:   <<< dual_mix: 0.5
2024-11-05 09:15:44,513:INFO:   <<< epochs: 200
2024-11-05 09:15:44,514:INFO:   <<< eval_frame_order: 0
2024-11-05 09:15:44,514:INFO:   <<< expand_msrvtt_sentences: False
2024-11-05 09:15:44,514:INFO:   <<< feature_framerate: 1
2024-11-05 09:15:44,514:INFO:   <<< feature_len: 64
2024-11-05 09:15:44,514:INFO:   <<< features_path: sign_feature/h2s_domain_agnostic
2024-11-05 09:15:44,514:INFO:   <<< features_path_retrain: sign_feature/h2s_domain_aware
2024-11-05 09:15:44,514:INFO:   <<< fp16: True
2024-11-05 09:15:44,514:INFO:   <<< fp16_opt_level: O1
2024-11-05 09:15:44,514:INFO:   <<< freeze_layer_num: 0
2024-11-05 09:15:44,514:INFO:   <<< gpu_ids: [0, 1]
2024-11-05 09:15:44,514:INFO:   <<< gradient_accumulation_steps: 1
2024-11-05 09:15:44,514:INFO:   <<< hard_negative_rate: 0.5
2024-11-05 09:15:44,514:INFO:   <<< init_model: chpt/H2S_sota.pth
2024-11-05 09:15:44,514:INFO:   <<< linear_patch: 2d
2024-11-05 09:15:44,514:INFO:   <<< local_rank: 0
2024-11-05 09:15:44,514:INFO:   <<< loose_type: True
2024-11-05 09:15:44,514:INFO:   <<< lr: 1e-05
2024-11-05 09:15:44,515:INFO:   <<< lr_decay: 0.001
2024-11-05 09:15:44,515:INFO:   <<< margin: 0.1
2024-11-05 09:15:44,515:INFO:   <<< max_frames: 128
2024-11-05 09:15:44,515:INFO:   <<< max_words: 32
2024-11-05 09:15:44,515:INFO:   <<< mix_design: balance
2024-11-05 09:15:44,515:INFO:   <<< n_display: 1
2024-11-05 09:15:44,515:INFO:   <<< n_gpu: 1
2024-11-05 09:15:44,515:INFO:   <<< n_pair: 1
2024-11-05 09:15:44,515:INFO:   <<< negative_weighting: 1
2024-11-05 09:15:44,515:INFO:   <<< not_load_visual: False
2024-11-05 09:15:44,515:INFO:   <<< num_thread_reader: 8
2024-11-05 09:15:44,515:INFO:   <<< output_dir: new_experiment
2024-11-05 09:15:44,515:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-11-05 09:15:44,515:INFO:   <<< rank: 0
2024-11-05 09:15:44,515:INFO:   <<< resume_model: None
2024-11-05 09:15:44,515:INFO:   <<< sampled_use_mil: False
2024-11-05 09:15:44,516:INFO:   <<< seed: 42
2024-11-05 09:15:44,516:INFO:   <<< sim_calcu: softmax_max
2024-11-05 09:15:44,516:INFO:   <<< sim_header: Filip
2024-11-05 09:15:44,516:INFO:   <<< slice_framepos: 0
2024-11-05 09:15:44,516:INFO:   <<< task_type: retrieval
2024-11-05 09:15:44,516:INFO:   <<< tau: 0.07
2024-11-05 09:15:44,516:INFO:   <<< text_aug: True
2024-11-05 09:15:44,516:INFO:   <<< text_aug_choosen: random_swap
2024-11-05 09:15:44,516:INFO:   <<< text_num_hidden_layers: 12
2024-11-05 09:15:44,516:INFO:   <<< train_frame_order: 0
2024-11-05 09:15:44,516:INFO:   <<< use_mil: False
2024-11-05 09:15:44,516:INFO:   <<< video_dim: 1024
2024-11-05 09:15:44,516:INFO:   <<< visual_num_hidden_layers: 12
2024-11-05 09:15:44,516:INFO:   <<< warmup_proportion: 0.1
2024-11-05 09:15:44,516:INFO:   <<< world_size: 1
2024-11-05 09:15:44,517:INFO: device: cuda:0 n_gpu: 1
2024-11-05 09:21:59,074:INFO: Effective parameters:
2024-11-05 09:21:59,074:INFO:   <<< alpha: 0.8
2024-11-05 09:21:59,074:INFO:   <<< aug_choose: t2v
2024-11-05 09:21:59,074:INFO:   <<< batch_size: 512
2024-11-05 09:21:59,074:INFO:   <<< batch_size_val: 256
2024-11-05 09:21:59,074:INFO:   <<< cache_dir: 
2024-11-05 09:21:59,074:INFO:   <<< cla_weight_dir: cla_weight
2024-11-05 09:21:59,075:INFO:   <<< coef_lr: 1.0
2024-11-05 09:21:59,075:INFO:   <<< combine_type: sum
2024-11-05 09:21:59,075:INFO:   <<< cross_att_layers: 1
2024-11-05 09:21:59,075:INFO:   <<< cross_model: cross-base
2024-11-05 09:21:59,075:INFO:   <<< cross_num_hidden_layers: 4
2024-11-05 09:21:59,075:INFO:   <<< data_path: data_h2
2024-11-05 09:21:59,075:INFO:   <<< datatype: h2s
2024-11-05 09:21:59,075:INFO:   <<< debug: False
2024-11-05 09:21:59,075:INFO:   <<< distributed: True
2024-11-05 09:21:59,075:INFO:   <<< do_eval: True
2024-11-05 09:21:59,075:INFO:   <<< do_lower_case: False
2024-11-05 09:21:59,075:INFO:   <<< do_pretrain: False
2024-11-05 09:21:59,075:INFO:   <<< do_train: False
2024-11-05 09:21:59,075:INFO:   <<< dual_mix: 0.5
2024-11-05 09:21:59,075:INFO:   <<< epochs: 200
2024-11-05 09:21:59,076:INFO:   <<< eval_frame_order: 0
2024-11-05 09:21:59,076:INFO:   <<< expand_msrvtt_sentences: False
2024-11-05 09:21:59,076:INFO:   <<< feature_framerate: 1
2024-11-05 09:21:59,076:INFO:   <<< feature_len: 64
2024-11-05 09:21:59,076:INFO:   <<< features_path: sign_feature/h2s_domain_agnostic
2024-11-05 09:21:59,076:INFO:   <<< features_path_retrain: sign_feature/h2s_domain_aware
2024-11-05 09:21:59,076:INFO:   <<< fp16: True
2024-11-05 09:21:59,076:INFO:   <<< fp16_opt_level: O1
2024-11-05 09:21:59,076:INFO:   <<< freeze_layer_num: 0
2024-11-05 09:21:59,076:INFO:   <<< gpu_ids: [0, 1]
2024-11-05 09:21:59,076:INFO:   <<< gradient_accumulation_steps: 1
2024-11-05 09:21:59,076:INFO:   <<< hard_negative_rate: 0.5
2024-11-05 09:21:59,076:INFO:   <<< init_model: chpt/H2S_sota.pth
2024-11-05 09:21:59,076:INFO:   <<< linear_patch: 2d
2024-11-05 09:21:59,076:INFO:   <<< local_rank: 0
2024-11-05 09:21:59,076:INFO:   <<< loose_type: True
2024-11-05 09:21:59,077:INFO:   <<< lr: 1e-05
2024-11-05 09:21:59,077:INFO:   <<< lr_decay: 0.001
2024-11-05 09:21:59,077:INFO:   <<< margin: 0.1
2024-11-05 09:21:59,077:INFO:   <<< max_frames: 128
2024-11-05 09:21:59,077:INFO:   <<< max_words: 32
2024-11-05 09:21:59,077:INFO:   <<< mix_design: balance
2024-11-05 09:21:59,077:INFO:   <<< n_display: 1
2024-11-05 09:21:59,077:INFO:   <<< n_gpu: 1
2024-11-05 09:21:59,077:INFO:   <<< n_pair: 1
2024-11-05 09:21:59,077:INFO:   <<< negative_weighting: 1
2024-11-05 09:21:59,077:INFO:   <<< not_load_visual: False
2024-11-05 09:21:59,077:INFO:   <<< num_thread_reader: 8
2024-11-05 09:21:59,077:INFO:   <<< output_dir: new_experiment
2024-11-05 09:21:59,077:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-11-05 09:21:59,077:INFO:   <<< rank: 0
2024-11-05 09:21:59,077:INFO:   <<< resume_model: None
2024-11-05 09:21:59,077:INFO:   <<< sampled_use_mil: False
2024-11-05 09:21:59,078:INFO:   <<< seed: 42
2024-11-05 09:21:59,078:INFO:   <<< sim_calcu: softmax_max
2024-11-05 09:21:59,078:INFO:   <<< sim_header: Filip
2024-11-05 09:21:59,078:INFO:   <<< slice_framepos: 0
2024-11-05 09:21:59,078:INFO:   <<< task_type: retrieval
2024-11-05 09:21:59,078:INFO:   <<< tau: 0.07
2024-11-05 09:21:59,078:INFO:   <<< text_aug: True
2024-11-05 09:21:59,078:INFO:   <<< text_aug_choosen: random_swap
2024-11-05 09:21:59,078:INFO:   <<< text_num_hidden_layers: 12
2024-11-05 09:21:59,078:INFO:   <<< train_frame_order: 0
2024-11-05 09:21:59,078:INFO:   <<< use_mil: False
2024-11-05 09:21:59,078:INFO:   <<< video_dim: 1024
2024-11-05 09:21:59,078:INFO:   <<< visual_num_hidden_layers: 12
2024-11-05 09:21:59,078:INFO:   <<< warmup_proportion: 0.1
2024-11-05 09:21:59,078:INFO:   <<< world_size: 1
2024-11-05 09:21:59,079:INFO: device: cuda:0 n_gpu: 1
2024-11-05 09:25:53,387:INFO: Effective parameters:
2024-11-05 09:25:53,387:INFO:   <<< alpha: 0.8
2024-11-05 09:25:53,387:INFO:   <<< aug_choose: t2v
2024-11-05 09:25:53,387:INFO:   <<< batch_size: 512
2024-11-05 09:25:53,387:INFO:   <<< batch_size_val: 256
2024-11-05 09:25:53,387:INFO:   <<< cache_dir: 
2024-11-05 09:25:53,387:INFO:   <<< cla_weight_dir: cla_weight
2024-11-05 09:25:53,388:INFO:   <<< coef_lr: 1.0
2024-11-05 09:25:53,388:INFO:   <<< combine_type: sum
2024-11-05 09:25:53,388:INFO:   <<< cross_att_layers: 1
2024-11-05 09:25:53,388:INFO:   <<< cross_model: cross-base
2024-11-05 09:25:53,388:INFO:   <<< cross_num_hidden_layers: 4
2024-11-05 09:25:53,388:INFO:   <<< data_path: data_h2
2024-11-05 09:25:53,388:INFO:   <<< datatype: h2s
2024-11-05 09:25:53,388:INFO:   <<< debug: False
2024-11-05 09:25:53,388:INFO:   <<< distributed: True
2024-11-05 09:25:53,388:INFO:   <<< do_eval: True
2024-11-05 09:25:53,388:INFO:   <<< do_lower_case: False
2024-11-05 09:25:53,388:INFO:   <<< do_pretrain: False
2024-11-05 09:25:53,388:INFO:   <<< do_train: False
2024-11-05 09:25:53,388:INFO:   <<< dual_mix: 0.5
2024-11-05 09:25:53,388:INFO:   <<< epochs: 200
2024-11-05 09:25:53,388:INFO:   <<< eval_frame_order: 0
2024-11-05 09:25:53,388:INFO:   <<< expand_msrvtt_sentences: False
2024-11-05 09:25:53,388:INFO:   <<< feature_framerate: 1
2024-11-05 09:25:53,389:INFO:   <<< feature_len: 64
2024-11-05 09:25:53,389:INFO:   <<< features_path: sign_feature/h2s_domain_agnostic
2024-11-05 09:25:53,389:INFO:   <<< features_path_retrain: sign_feature/h2s_domain_aware
2024-11-05 09:25:53,389:INFO:   <<< fp16: True
2024-11-05 09:25:53,389:INFO:   <<< fp16_opt_level: O1
2024-11-05 09:25:53,389:INFO:   <<< freeze_layer_num: 0
2024-11-05 09:25:53,389:INFO:   <<< gpu_ids: [0, 1]
2024-11-05 09:25:53,389:INFO:   <<< gradient_accumulation_steps: 1
2024-11-05 09:25:53,389:INFO:   <<< hard_negative_rate: 0.5
2024-11-05 09:25:53,389:INFO:   <<< init_model: chpt/H2S_sota.pth
2024-11-05 09:25:53,389:INFO:   <<< linear_patch: 2d
2024-11-05 09:25:53,389:INFO:   <<< local_rank: 0
2024-11-05 09:25:53,389:INFO:   <<< loose_type: True
2024-11-05 09:25:53,389:INFO:   <<< lr: 1e-05
2024-11-05 09:25:53,389:INFO:   <<< lr_decay: 0.001
2024-11-05 09:25:53,389:INFO:   <<< margin: 0.1
2024-11-05 09:25:53,389:INFO:   <<< max_frames: 128
2024-11-05 09:25:53,389:INFO:   <<< max_words: 32
2024-11-05 09:25:53,389:INFO:   <<< mix_design: balance
2024-11-05 09:25:53,389:INFO:   <<< n_display: 1
2024-11-05 09:25:53,390:INFO:   <<< n_gpu: 1
2024-11-05 09:25:53,390:INFO:   <<< n_pair: 1
2024-11-05 09:25:53,390:INFO:   <<< negative_weighting: 1
2024-11-05 09:25:53,390:INFO:   <<< not_load_visual: False
2024-11-05 09:25:53,390:INFO:   <<< num_thread_reader: 8
2024-11-05 09:25:53,390:INFO:   <<< output_dir: new_experiment
2024-11-05 09:25:53,390:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-11-05 09:25:53,390:INFO:   <<< rank: 0
2024-11-05 09:25:53,390:INFO:   <<< resume_model: None
2024-11-05 09:25:53,390:INFO:   <<< sampled_use_mil: False
2024-11-05 09:25:53,390:INFO:   <<< seed: 42
2024-11-05 09:25:53,390:INFO:   <<< sim_calcu: softmax_max
2024-11-05 09:25:53,390:INFO:   <<< sim_header: Filip
2024-11-05 09:25:53,390:INFO:   <<< slice_framepos: 0
2024-11-05 09:25:53,390:INFO:   <<< task_type: retrieval
2024-11-05 09:25:53,390:INFO:   <<< tau: 0.07
2024-11-05 09:25:53,390:INFO:   <<< text_aug: True
2024-11-05 09:25:53,390:INFO:   <<< text_aug_choosen: random_swap
2024-11-05 09:25:53,390:INFO:   <<< text_num_hidden_layers: 12
2024-11-05 09:25:53,391:INFO:   <<< train_frame_order: 0
2024-11-05 09:25:53,391:INFO:   <<< use_mil: False
2024-11-05 09:25:53,391:INFO:   <<< video_dim: 1024
2024-11-05 09:25:53,391:INFO:   <<< visual_num_hidden_layers: 12
2024-11-05 09:25:53,391:INFO:   <<< warmup_proportion: 0.1
2024-11-05 09:25:53,391:INFO:   <<< world_size: 1
2024-11-05 09:25:53,391:INFO: device: cuda:0 n_gpu: 1
2024-11-05 09:32:39,048:INFO: Effective parameters:
2024-11-05 09:32:39,049:INFO:   <<< alpha: 0.8
2024-11-05 09:32:39,049:INFO:   <<< aug_choose: t2v
2024-11-05 09:32:39,049:INFO:   <<< batch_size: 512
2024-11-05 09:32:39,049:INFO:   <<< batch_size_val: 256
2024-11-05 09:32:39,049:INFO:   <<< cache_dir: 
2024-11-05 09:32:39,049:INFO:   <<< cla_weight_dir: cla_weight
2024-11-05 09:32:39,049:INFO:   <<< coef_lr: 1.0
2024-11-05 09:32:39,049:INFO:   <<< combine_type: sum
2024-11-05 09:32:39,049:INFO:   <<< cross_att_layers: 1
2024-11-05 09:32:39,049:INFO:   <<< cross_model: cross-base
2024-11-05 09:32:39,049:INFO:   <<< cross_num_hidden_layers: 4
2024-11-05 09:32:39,049:INFO:   <<< data_path: data_h2
2024-11-05 09:32:39,049:INFO:   <<< datatype: h2s
2024-11-05 09:32:39,049:INFO:   <<< debug: False
2024-11-05 09:32:39,049:INFO:   <<< distributed: True
2024-11-05 09:32:39,049:INFO:   <<< do_eval: True
2024-11-05 09:32:39,049:INFO:   <<< do_lower_case: False
2024-11-05 09:32:39,050:INFO:   <<< do_pretrain: False
2024-11-05 09:32:39,050:INFO:   <<< do_train: False
2024-11-05 09:32:39,050:INFO:   <<< dual_mix: 0.5
2024-11-05 09:32:39,050:INFO:   <<< epochs: 200
2024-11-05 09:32:39,050:INFO:   <<< eval_frame_order: 0
2024-11-05 09:32:39,050:INFO:   <<< expand_msrvtt_sentences: False
2024-11-05 09:32:39,050:INFO:   <<< feature_framerate: 1
2024-11-05 09:32:39,050:INFO:   <<< feature_len: 64
2024-11-05 09:32:39,050:INFO:   <<< features_path: sign_feature/h2s_domain_agnostic
2024-11-05 09:32:39,050:INFO:   <<< features_path_retrain: sign_feature/h2s_domain_aware
2024-11-05 09:32:39,050:INFO:   <<< fp16: True
2024-11-05 09:32:39,050:INFO:   <<< fp16_opt_level: O1
2024-11-05 09:32:39,050:INFO:   <<< freeze_layer_num: 0
2024-11-05 09:32:39,050:INFO:   <<< gpu_ids: [0, 1]
2024-11-05 09:32:39,050:INFO:   <<< gradient_accumulation_steps: 1
2024-11-05 09:32:39,050:INFO:   <<< hard_negative_rate: 0.5
2024-11-05 09:32:39,050:INFO:   <<< init_model: chpt/H2S_sota.pth
2024-11-05 09:32:39,050:INFO:   <<< linear_patch: 2d
2024-11-05 09:32:39,050:INFO:   <<< local_rank: 0
2024-11-05 09:32:39,051:INFO:   <<< loose_type: True
2024-11-05 09:32:39,051:INFO:   <<< lr: 1e-05
2024-11-05 09:32:39,051:INFO:   <<< lr_decay: 0.001
2024-11-05 09:32:39,051:INFO:   <<< margin: 0.1
2024-11-05 09:32:39,051:INFO:   <<< max_frames: 128
2024-11-05 09:32:39,051:INFO:   <<< max_words: 32
2024-11-05 09:32:39,051:INFO:   <<< mix_design: balance
2024-11-05 09:32:39,051:INFO:   <<< n_display: 1
2024-11-05 09:32:39,051:INFO:   <<< n_gpu: 1
2024-11-05 09:32:39,051:INFO:   <<< n_pair: 1
2024-11-05 09:32:39,051:INFO:   <<< negative_weighting: 1
2024-11-05 09:32:39,051:INFO:   <<< not_load_visual: False
2024-11-05 09:32:39,051:INFO:   <<< num_thread_reader: 8
2024-11-05 09:32:39,051:INFO:   <<< output_dir: new_experiment
2024-11-05 09:32:39,051:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-11-05 09:32:39,051:INFO:   <<< rank: 0
2024-11-05 09:32:39,051:INFO:   <<< resume_model: None
2024-11-05 09:32:39,051:INFO:   <<< sampled_use_mil: False
2024-11-05 09:32:39,051:INFO:   <<< seed: 42
2024-11-05 09:32:39,052:INFO:   <<< sim_calcu: softmax_max
2024-11-05 09:32:39,052:INFO:   <<< sim_header: Filip
2024-11-05 09:32:39,052:INFO:   <<< slice_framepos: 0
2024-11-05 09:32:39,052:INFO:   <<< task_type: retrieval
2024-11-05 09:32:39,052:INFO:   <<< tau: 0.07
2024-11-05 09:32:39,052:INFO:   <<< text_aug: True
2024-11-05 09:32:39,052:INFO:   <<< text_aug_choosen: random_swap
2024-11-05 09:32:39,052:INFO:   <<< text_num_hidden_layers: 12
2024-11-05 09:32:39,052:INFO:   <<< train_frame_order: 0
2024-11-05 09:32:39,052:INFO:   <<< use_mil: False
2024-11-05 09:32:39,052:INFO:   <<< video_dim: 1024
2024-11-05 09:32:39,052:INFO:   <<< visual_num_hidden_layers: 12
2024-11-05 09:32:39,052:INFO:   <<< warmup_proportion: 0.1
2024-11-05 09:32:39,052:INFO:   <<< world_size: 1
2024-11-05 09:32:39,053:INFO: device: cuda:0 n_gpu: 1
2024-11-05 09:43:44,235:INFO: Effective parameters:
2024-11-05 09:43:44,235:INFO:   <<< alpha: 0.8
2024-11-05 09:43:44,235:INFO:   <<< aug_choose: t2v
2024-11-05 09:43:44,236:INFO:   <<< batch_size: 512
2024-11-05 09:43:44,236:INFO:   <<< batch_size_val: 256
2024-11-05 09:43:44,236:INFO:   <<< cache_dir: 
2024-11-05 09:43:44,236:INFO:   <<< cla_weight_dir: cla_weight
2024-11-05 09:43:44,236:INFO:   <<< coef_lr: 1.0
2024-11-05 09:43:44,236:INFO:   <<< combine_type: sum
2024-11-05 09:43:44,236:INFO:   <<< cross_att_layers: 1
2024-11-05 09:43:44,236:INFO:   <<< cross_model: cross-base
2024-11-05 09:43:44,236:INFO:   <<< cross_num_hidden_layers: 4
2024-11-05 09:43:44,236:INFO:   <<< data_path: data_h2
2024-11-05 09:43:44,236:INFO:   <<< datatype: h2s
2024-11-05 09:43:44,236:INFO:   <<< debug: False
2024-11-05 09:43:44,237:INFO:   <<< distributed: True
2024-11-05 09:43:44,237:INFO:   <<< do_eval: True
2024-11-05 09:43:44,237:INFO:   <<< do_lower_case: False
2024-11-05 09:43:44,237:INFO:   <<< do_pretrain: False
2024-11-05 09:43:44,237:INFO:   <<< do_train: False
2024-11-05 09:43:44,237:INFO:   <<< dual_mix: 0.5
2024-11-05 09:43:44,237:INFO:   <<< epochs: 200
2024-11-05 09:43:44,237:INFO:   <<< eval_frame_order: 0
2024-11-05 09:43:44,237:INFO:   <<< expand_msrvtt_sentences: False
2024-11-05 09:43:44,237:INFO:   <<< feature_framerate: 1
2024-11-05 09:43:44,237:INFO:   <<< feature_len: 64
2024-11-05 09:43:44,238:INFO:   <<< features_path: sign_feature/h2s_domain_agnostic
2024-11-05 09:43:44,238:INFO:   <<< features_path_retrain: sign_feature/h2s_domain_aware
2024-11-05 09:43:44,238:INFO:   <<< fp16: True
2024-11-05 09:43:44,238:INFO:   <<< fp16_opt_level: O1
2024-11-05 09:43:44,238:INFO:   <<< freeze_layer_num: 0
2024-11-05 09:43:44,238:INFO:   <<< gpu_ids: [0, 1]
2024-11-05 09:43:44,238:INFO:   <<< gradient_accumulation_steps: 1
2024-11-05 09:43:44,238:INFO:   <<< hard_negative_rate: 0.5
2024-11-05 09:43:44,238:INFO:   <<< init_model: chpt/H2S_sota.pth
2024-11-05 09:43:44,238:INFO:   <<< linear_patch: 2d
2024-11-05 09:43:44,238:INFO:   <<< local_rank: 0
2024-11-05 09:43:44,238:INFO:   <<< loose_type: True
2024-11-05 09:43:44,239:INFO:   <<< lr: 1e-05
2024-11-05 09:43:44,239:INFO:   <<< lr_decay: 0.001
2024-11-05 09:43:44,239:INFO:   <<< margin: 0.1
2024-11-05 09:43:44,239:INFO:   <<< max_frames: 128
2024-11-05 09:43:44,239:INFO:   <<< max_words: 32
2024-11-05 09:43:44,239:INFO:   <<< mix_design: balance
2024-11-05 09:43:44,239:INFO:   <<< n_display: 1
2024-11-05 09:43:44,239:INFO:   <<< n_gpu: 1
2024-11-05 09:43:44,239:INFO:   <<< n_pair: 1
2024-11-05 09:43:44,239:INFO:   <<< negative_weighting: 1
2024-11-05 09:43:44,239:INFO:   <<< not_load_visual: False
2024-11-05 09:43:44,240:INFO:   <<< num_thread_reader: 8
2024-11-05 09:43:44,240:INFO:   <<< output_dir: new_experiment
2024-11-05 09:43:44,240:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-11-05 09:43:44,240:INFO:   <<< rank: 0
2024-11-05 09:43:44,240:INFO:   <<< resume_model: None
2024-11-05 09:43:44,240:INFO:   <<< sampled_use_mil: False
2024-11-05 09:43:44,240:INFO:   <<< seed: 42
2024-11-05 09:43:44,240:INFO:   <<< sim_calcu: softmax_max
2024-11-05 09:43:44,240:INFO:   <<< sim_header: Filip
2024-11-05 09:43:44,240:INFO:   <<< slice_framepos: 0
2024-11-05 09:43:44,240:INFO:   <<< task_type: retrieval
2024-11-05 09:43:44,240:INFO:   <<< tau: 0.07
2024-11-05 09:43:44,241:INFO:   <<< text_aug: True
2024-11-05 09:43:44,241:INFO:   <<< text_aug_choosen: random_swap
2024-11-05 09:43:44,241:INFO:   <<< text_num_hidden_layers: 12
2024-11-05 09:43:44,241:INFO:   <<< train_frame_order: 0
2024-11-05 09:43:44,241:INFO:   <<< use_mil: False
2024-11-05 09:43:44,241:INFO:   <<< video_dim: 1024
2024-11-05 09:43:44,241:INFO:   <<< visual_num_hidden_layers: 12
2024-11-05 09:43:44,241:INFO:   <<< warmup_proportion: 0.1
2024-11-05 09:43:44,241:INFO:   <<< world_size: 1
2024-11-05 09:43:44,242:INFO: device: cuda:0 n_gpu: 1
2024-11-05 09:44:46,661:INFO: Effective parameters:
2024-11-05 09:44:46,661:INFO:   <<< alpha: 0.8
2024-11-05 09:44:46,661:INFO:   <<< aug_choose: t2v
2024-11-05 09:44:46,661:INFO:   <<< batch_size: 512
2024-11-05 09:44:46,661:INFO:   <<< batch_size_val: 256
2024-11-05 09:44:46,661:INFO:   <<< cache_dir: 
2024-11-05 09:44:46,661:INFO:   <<< cla_weight_dir: cla_weight
2024-11-05 09:44:46,661:INFO:   <<< coef_lr: 1.0
2024-11-05 09:44:46,661:INFO:   <<< combine_type: sum
2024-11-05 09:44:46,661:INFO:   <<< cross_att_layers: 1
2024-11-05 09:44:46,661:INFO:   <<< cross_model: cross-base
2024-11-05 09:44:46,661:INFO:   <<< cross_num_hidden_layers: 4
2024-11-05 09:44:46,661:INFO:   <<< data_path: data_h2
2024-11-05 09:44:46,661:INFO:   <<< datatype: h2s
2024-11-05 09:44:46,662:INFO:   <<< debug: False
2024-11-05 09:44:46,662:INFO:   <<< distributed: True
2024-11-05 09:44:46,662:INFO:   <<< do_eval: True
2024-11-05 09:44:46,662:INFO:   <<< do_lower_case: False
2024-11-05 09:44:46,662:INFO:   <<< do_pretrain: False
2024-11-05 09:44:46,662:INFO:   <<< do_train: False
2024-11-05 09:44:46,662:INFO:   <<< dual_mix: 0.5
2024-11-05 09:44:46,662:INFO:   <<< epochs: 200
2024-11-05 09:44:46,662:INFO:   <<< eval_frame_order: 0
2024-11-05 09:44:46,662:INFO:   <<< expand_msrvtt_sentences: False
2024-11-05 09:44:46,662:INFO:   <<< feature_framerate: 1
2024-11-05 09:44:46,662:INFO:   <<< feature_len: 64
2024-11-05 09:44:46,662:INFO:   <<< features_path: sign_feature/h2s_domain_agnostic
2024-11-05 09:44:46,662:INFO:   <<< features_path_retrain: sign_feature/h2s_domain_aware
2024-11-05 09:44:46,662:INFO:   <<< fp16: True
2024-11-05 09:44:46,662:INFO:   <<< fp16_opt_level: O1
2024-11-05 09:44:46,662:INFO:   <<< freeze_layer_num: 0
2024-11-05 09:44:46,662:INFO:   <<< gpu_ids: [0, 1]
2024-11-05 09:44:46,662:INFO:   <<< gradient_accumulation_steps: 1
2024-11-05 09:44:46,662:INFO:   <<< hard_negative_rate: 0.5
2024-11-05 09:44:46,663:INFO:   <<< init_model: chpt/H2S_sota.pth
2024-11-05 09:44:46,663:INFO:   <<< linear_patch: 2d
2024-11-05 09:44:46,663:INFO:   <<< local_rank: 0
2024-11-05 09:44:46,663:INFO:   <<< loose_type: True
2024-11-05 09:44:46,663:INFO:   <<< lr: 1e-05
2024-11-05 09:44:46,663:INFO:   <<< lr_decay: 0.001
2024-11-05 09:44:46,663:INFO:   <<< margin: 0.1
2024-11-05 09:44:46,663:INFO:   <<< max_frames: 128
2024-11-05 09:44:46,663:INFO:   <<< max_words: 32
2024-11-05 09:44:46,663:INFO:   <<< mix_design: balance
2024-11-05 09:44:46,663:INFO:   <<< n_display: 1
2024-11-05 09:44:46,663:INFO:   <<< n_gpu: 1
2024-11-05 09:44:46,663:INFO:   <<< n_pair: 1
2024-11-05 09:44:46,663:INFO:   <<< negative_weighting: 1
2024-11-05 09:44:46,663:INFO:   <<< not_load_visual: False
2024-11-05 09:44:46,663:INFO:   <<< num_thread_reader: 8
2024-11-05 09:44:46,663:INFO:   <<< output_dir: new_experiment
2024-11-05 09:44:46,663:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-11-05 09:44:46,663:INFO:   <<< rank: 0
2024-11-05 09:44:46,663:INFO:   <<< resume_model: None
2024-11-05 09:44:46,664:INFO:   <<< sampled_use_mil: False
2024-11-05 09:44:46,664:INFO:   <<< seed: 42
2024-11-05 09:44:46,664:INFO:   <<< sim_calcu: softmax_max
2024-11-05 09:44:46,664:INFO:   <<< sim_header: Filip
2024-11-05 09:44:46,664:INFO:   <<< slice_framepos: 0
2024-11-05 09:44:46,664:INFO:   <<< task_type: retrieval
2024-11-05 09:44:46,664:INFO:   <<< tau: 0.07
2024-11-05 09:44:46,664:INFO:   <<< text_aug: True
2024-11-05 09:44:46,664:INFO:   <<< text_aug_choosen: random_swap
2024-11-05 09:44:46,664:INFO:   <<< text_num_hidden_layers: 12
2024-11-05 09:44:46,664:INFO:   <<< train_frame_order: 0
2024-11-05 09:44:46,664:INFO:   <<< use_mil: False
2024-11-05 09:44:46,664:INFO:   <<< video_dim: 1024
2024-11-05 09:44:46,664:INFO:   <<< visual_num_hidden_layers: 12
2024-11-05 09:44:46,664:INFO:   <<< warmup_proportion: 0.1
2024-11-05 09:44:46,664:INFO:   <<< world_size: 1
2024-11-05 09:44:46,665:INFO: device: cuda:0 n_gpu: 1
2024-11-05 09:45:47,327:INFO: Effective parameters:
2024-11-05 09:45:47,328:INFO:   <<< alpha: 0.8
2024-11-05 09:45:47,328:INFO:   <<< aug_choose: t2v
2024-11-05 09:45:47,328:INFO:   <<< batch_size: 512
2024-11-05 09:45:47,328:INFO:   <<< batch_size_val: 256
2024-11-05 09:45:47,328:INFO:   <<< cache_dir: 
2024-11-05 09:45:47,328:INFO:   <<< cla_weight_dir: cla_weight
2024-11-05 09:45:47,328:INFO:   <<< coef_lr: 1.0
2024-11-05 09:45:47,328:INFO:   <<< combine_type: sum
2024-11-05 09:45:47,328:INFO:   <<< cross_att_layers: 1
2024-11-05 09:45:47,328:INFO:   <<< cross_model: cross-base
2024-11-05 09:45:47,328:INFO:   <<< cross_num_hidden_layers: 4
2024-11-05 09:45:47,328:INFO:   <<< data_path: data_h2
2024-11-05 09:45:47,328:INFO:   <<< datatype: h2s
2024-11-05 09:45:47,328:INFO:   <<< debug: False
2024-11-05 09:45:47,328:INFO:   <<< distributed: True
2024-11-05 09:45:47,328:INFO:   <<< do_eval: True
2024-11-05 09:45:47,328:INFO:   <<< do_lower_case: False
2024-11-05 09:45:47,329:INFO:   <<< do_pretrain: False
2024-11-05 09:45:47,329:INFO:   <<< do_train: False
2024-11-05 09:45:47,329:INFO:   <<< dual_mix: 0.5
2024-11-05 09:45:47,329:INFO:   <<< epochs: 200
2024-11-05 09:45:47,329:INFO:   <<< eval_frame_order: 0
2024-11-05 09:45:47,329:INFO:   <<< expand_msrvtt_sentences: False
2024-11-05 09:45:47,329:INFO:   <<< feature_framerate: 1
2024-11-05 09:45:47,329:INFO:   <<< feature_len: 64
2024-11-05 09:45:47,329:INFO:   <<< features_path: sign_feature/h2s_domain_agnostic
2024-11-05 09:45:47,329:INFO:   <<< features_path_retrain: sign_feature/h2s_domain_aware
2024-11-05 09:45:47,329:INFO:   <<< fp16: True
2024-11-05 09:45:47,329:INFO:   <<< fp16_opt_level: O1
2024-11-05 09:45:47,329:INFO:   <<< freeze_layer_num: 0
2024-11-05 09:45:47,329:INFO:   <<< gpu_ids: [0, 1]
2024-11-05 09:45:47,329:INFO:   <<< gradient_accumulation_steps: 1
2024-11-05 09:45:47,329:INFO:   <<< hard_negative_rate: 0.5
2024-11-05 09:45:47,329:INFO:   <<< init_model: chpt/H2S_sota.pth
2024-11-05 09:45:47,329:INFO:   <<< linear_patch: 2d
2024-11-05 09:45:47,329:INFO:   <<< local_rank: 0
2024-11-05 09:45:47,329:INFO:   <<< loose_type: True
2024-11-05 09:45:47,329:INFO:   <<< lr: 1e-05
2024-11-05 09:45:47,330:INFO:   <<< lr_decay: 0.001
2024-11-05 09:45:47,330:INFO:   <<< margin: 0.1
2024-11-05 09:45:47,330:INFO:   <<< max_frames: 128
2024-11-05 09:45:47,330:INFO:   <<< max_words: 32
2024-11-05 09:45:47,330:INFO:   <<< mix_design: balance
2024-11-05 09:45:47,330:INFO:   <<< n_display: 1
2024-11-05 09:45:47,330:INFO:   <<< n_gpu: 1
2024-11-05 09:45:47,330:INFO:   <<< n_pair: 1
2024-11-05 09:45:47,330:INFO:   <<< negative_weighting: 1
2024-11-05 09:45:47,330:INFO:   <<< not_load_visual: False
2024-11-05 09:45:47,330:INFO:   <<< num_thread_reader: 8
2024-11-05 09:45:47,330:INFO:   <<< output_dir: new_experiment
2024-11-05 09:45:47,330:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-11-05 09:45:47,330:INFO:   <<< rank: 0
2024-11-05 09:45:47,330:INFO:   <<< resume_model: None
2024-11-05 09:45:47,330:INFO:   <<< sampled_use_mil: False
2024-11-05 09:45:47,330:INFO:   <<< seed: 42
2024-11-05 09:45:47,330:INFO:   <<< sim_calcu: softmax_max
2024-11-05 09:45:47,330:INFO:   <<< sim_header: Filip
2024-11-05 09:45:47,330:INFO:   <<< slice_framepos: 0
2024-11-05 09:45:47,331:INFO:   <<< task_type: retrieval
2024-11-05 09:45:47,331:INFO:   <<< tau: 0.07
2024-11-05 09:45:47,331:INFO:   <<< text_aug: True
2024-11-05 09:45:47,331:INFO:   <<< text_aug_choosen: random_swap
2024-11-05 09:45:47,331:INFO:   <<< text_num_hidden_layers: 12
2024-11-05 09:45:47,331:INFO:   <<< train_frame_order: 0
2024-11-05 09:45:47,331:INFO:   <<< use_mil: False
2024-11-05 09:45:47,331:INFO:   <<< video_dim: 1024
2024-11-05 09:45:47,331:INFO:   <<< visual_num_hidden_layers: 12
2024-11-05 09:45:47,331:INFO:   <<< warmup_proportion: 0.1
2024-11-05 09:45:47,331:INFO:   <<< world_size: 1
2024-11-05 09:45:47,331:INFO: device: cuda:0 n_gpu: 1
2024-11-05 09:45:49,225:INFO: loading archive file /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base
2024-11-05 09:45:49,228:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-11-05 09:45:49,229:INFO: Weight doesn't exsits. /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base/cross_pytorch_model.bin
2024-11-05 09:45:49,229:WARNING: Stage-One:True, Stage-Two:False
2024-11-05 09:45:49,229:WARNING: Test retrieval by loose type.
2024-11-05 09:45:49,229:WARNING: 	 embed_dim: 512
2024-11-05 09:45:49,229:WARNING: 	 image_resolution: 224
2024-11-05 09:45:49,229:WARNING: 	 vision_layers: 12
2024-11-05 09:45:49,229:WARNING: 	 vision_width: 768
2024-11-05 09:45:49,229:WARNING: 	 vision_patch_size: 32
2024-11-05 09:45:49,229:WARNING: 	 context_length: 77
2024-11-05 09:45:49,229:WARNING: 	 vocab_size: 49408
2024-11-05 09:45:49,229:WARNING: 	 transformer_width: 512
2024-11-05 09:45:49,230:WARNING: 	 transformer_heads: 8
2024-11-05 09:45:49,230:WARNING: 	 transformer_layers: 12
2024-11-05 09:45:49,230:WARNING: 		 linear_patch: 2d
2024-11-05 09:45:49,230:WARNING: 	 cut_top_layer: 0
2024-11-05 09:45:51,191:WARNING: 	 sim_header: Filip
2024-11-05 09:45:58,467:INFO: --------------------
2024-11-05 09:45:58,468:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-11-05 09:45:58,588:INFO: ***** Running test *****
2024-11-05 09:45:58,588:INFO:   Num examples = 2348
2024-11-05 09:45:58,588:INFO:   Batch size = 256
2024-11-05 09:45:58,588:INFO:   Num steps = 10
2024-11-05 09:45:58,999:WARNING: Eval under the multi-sentence per video clip setting.
2024-11-05 09:45:59,000:WARNING: sentence num: 1969, video num: 2348
2024-11-05 09:50:45,513:INFO: Effective parameters:
2024-11-05 09:50:45,513:INFO:   <<< alpha: 0.8
2024-11-05 09:50:45,513:INFO:   <<< aug_choose: t2v
2024-11-05 09:50:45,513:INFO:   <<< batch_size: 512
2024-11-05 09:50:45,513:INFO:   <<< batch_size_val: 256
2024-11-05 09:50:45,513:INFO:   <<< cache_dir: 
2024-11-05 09:50:45,513:INFO:   <<< cla_weight_dir: cla_weight
2024-11-05 09:50:45,513:INFO:   <<< coef_lr: 1.0
2024-11-05 09:50:45,513:INFO:   <<< combine_type: sum
2024-11-05 09:50:45,513:INFO:   <<< cross_att_layers: 1
2024-11-05 09:50:45,513:INFO:   <<< cross_model: cross-base
2024-11-05 09:50:45,513:INFO:   <<< cross_num_hidden_layers: 4
2024-11-05 09:50:45,513:INFO:   <<< data_path: data_h2
2024-11-05 09:50:45,513:INFO:   <<< datatype: h2s
2024-11-05 09:50:45,513:INFO:   <<< debug: False
2024-11-05 09:50:45,513:INFO:   <<< distributed: True
2024-11-05 09:50:45,514:INFO:   <<< do_eval: True
2024-11-05 09:50:45,514:INFO:   <<< do_lower_case: False
2024-11-05 09:50:45,514:INFO:   <<< do_pretrain: False
2024-11-05 09:50:45,514:INFO:   <<< do_train: False
2024-11-05 09:50:45,514:INFO:   <<< dual_mix: 0.5
2024-11-05 09:50:45,514:INFO:   <<< epochs: 200
2024-11-05 09:50:45,514:INFO:   <<< eval_frame_order: 0
2024-11-05 09:50:45,514:INFO:   <<< expand_msrvtt_sentences: False
2024-11-05 09:50:45,514:INFO:   <<< feature_framerate: 1
2024-11-05 09:50:45,514:INFO:   <<< feature_len: 64
2024-11-05 09:50:45,514:INFO:   <<< features_path: sign_feature/h2s_domain_agnostic
2024-11-05 09:50:45,514:INFO:   <<< features_path_retrain: sign_feature/h2s_domain_aware
2024-11-05 09:50:45,514:INFO:   <<< fp16: True
2024-11-05 09:50:45,514:INFO:   <<< fp16_opt_level: O1
2024-11-05 09:50:45,514:INFO:   <<< freeze_layer_num: 0
2024-11-05 09:50:45,514:INFO:   <<< gpu_ids: [0, 1]
2024-11-05 09:50:45,514:INFO:   <<< gradient_accumulation_steps: 1
2024-11-05 09:50:45,514:INFO:   <<< hard_negative_rate: 0.5
2024-11-05 09:50:45,514:INFO:   <<< init_model: chpt/H2S_sota.pth
2024-11-05 09:50:45,514:INFO:   <<< linear_patch: 2d
2024-11-05 09:50:45,514:INFO:   <<< local_rank: 0
2024-11-05 09:50:45,514:INFO:   <<< loose_type: True
2024-11-05 09:50:45,515:INFO:   <<< lr: 1e-05
2024-11-05 09:50:45,515:INFO:   <<< lr_decay: 0.001
2024-11-05 09:50:45,515:INFO:   <<< margin: 0.1
2024-11-05 09:50:45,515:INFO:   <<< max_frames: 128
2024-11-05 09:50:45,515:INFO:   <<< max_words: 32
2024-11-05 09:50:45,515:INFO:   <<< mix_design: balance
2024-11-05 09:50:45,515:INFO:   <<< n_display: 1
2024-11-05 09:50:45,515:INFO:   <<< n_gpu: 1
2024-11-05 09:50:45,515:INFO:   <<< n_pair: 1
2024-11-05 09:50:45,515:INFO:   <<< negative_weighting: 1
2024-11-05 09:50:45,515:INFO:   <<< not_load_visual: False
2024-11-05 09:50:45,515:INFO:   <<< num_thread_reader: 8
2024-11-05 09:50:45,515:INFO:   <<< output_dir: new_experiment
2024-11-05 09:50:45,515:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-11-05 09:50:45,515:INFO:   <<< rank: 0
2024-11-05 09:50:45,515:INFO:   <<< resume_model: None
2024-11-05 09:50:45,515:INFO:   <<< sampled_use_mil: False
2024-11-05 09:50:45,515:INFO:   <<< seed: 42
2024-11-05 09:50:45,515:INFO:   <<< sim_calcu: softmax_max
2024-11-05 09:50:45,515:INFO:   <<< sim_header: Filip
2024-11-05 09:50:45,515:INFO:   <<< slice_framepos: 0
2024-11-05 09:50:45,515:INFO:   <<< task_type: retrieval
2024-11-05 09:50:45,516:INFO:   <<< tau: 0.07
2024-11-05 09:50:45,516:INFO:   <<< text_aug: True
2024-11-05 09:50:45,516:INFO:   <<< text_aug_choosen: random_swap
2024-11-05 09:50:45,516:INFO:   <<< text_num_hidden_layers: 12
2024-11-05 09:50:45,516:INFO:   <<< train_frame_order: 0
2024-11-05 09:50:45,516:INFO:   <<< use_mil: False
2024-11-05 09:50:45,516:INFO:   <<< video_dim: 1024
2024-11-05 09:50:45,516:INFO:   <<< visual_num_hidden_layers: 12
2024-11-05 09:50:45,516:INFO:   <<< warmup_proportion: 0.1
2024-11-05 09:50:45,516:INFO:   <<< world_size: 1
2024-11-05 09:50:45,516:INFO: device: cuda:0 n_gpu: 1
2024-11-05 09:50:47,454:INFO: loading archive file /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base
2024-11-05 09:50:47,456:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-11-05 09:50:47,457:INFO: Weight doesn't exsits. /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base/cross_pytorch_model.bin
2024-11-05 09:50:47,457:WARNING: Stage-One:True, Stage-Two:False
2024-11-05 09:50:47,457:WARNING: Test retrieval by loose type.
2024-11-05 09:50:47,457:WARNING: 	 embed_dim: 512
2024-11-05 09:50:47,457:WARNING: 	 image_resolution: 224
2024-11-05 09:50:47,457:WARNING: 	 vision_layers: 12
2024-11-05 09:50:47,457:WARNING: 	 vision_width: 768
2024-11-05 09:50:47,457:WARNING: 	 vision_patch_size: 32
2024-11-05 09:50:47,457:WARNING: 	 context_length: 77
2024-11-05 09:50:47,457:WARNING: 	 vocab_size: 49408
2024-11-05 09:50:47,457:WARNING: 	 transformer_width: 512
2024-11-05 09:50:47,457:WARNING: 	 transformer_heads: 8
2024-11-05 09:50:47,458:WARNING: 	 transformer_layers: 12
2024-11-05 09:50:47,458:WARNING: 		 linear_patch: 2d
2024-11-05 09:50:47,458:WARNING: 	 cut_top_layer: 0
2024-11-05 09:50:49,364:WARNING: 	 sim_header: Filip
2024-11-05 09:50:56,595:INFO: --------------------
2024-11-05 09:50:56,595:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-11-05 09:50:56,720:INFO: ***** Running test *****
2024-11-05 09:50:56,720:INFO:   Num examples = 2348
2024-11-05 09:50:56,720:INFO:   Batch size = 256
2024-11-05 09:50:56,721:INFO:   Num steps = 10
2024-11-05 09:50:57,171:WARNING: Eval under the multi-sentence per video clip setting.
2024-11-05 09:50:57,171:WARNING: sentence num: 1969, video num: 2348
2024-11-05 09:54:04,029:INFO: Effective parameters:
2024-11-05 09:54:04,029:INFO:   <<< alpha: 0.8
2024-11-05 09:54:04,029:INFO:   <<< aug_choose: t2v
2024-11-05 09:54:04,029:INFO:   <<< batch_size: 512
2024-11-05 09:54:04,029:INFO:   <<< batch_size_val: 256
2024-11-05 09:54:04,029:INFO:   <<< cache_dir: 
2024-11-05 09:54:04,029:INFO:   <<< cla_weight_dir: cla_weight
2024-11-05 09:54:04,029:INFO:   <<< coef_lr: 1.0
2024-11-05 09:54:04,029:INFO:   <<< combine_type: sum
2024-11-05 09:54:04,029:INFO:   <<< cross_att_layers: 1
2024-11-05 09:54:04,030:INFO:   <<< cross_model: cross-base
2024-11-05 09:54:04,030:INFO:   <<< cross_num_hidden_layers: 4
2024-11-05 09:54:04,030:INFO:   <<< data_path: data_h2
2024-11-05 09:54:04,030:INFO:   <<< datatype: h2s
2024-11-05 09:54:04,030:INFO:   <<< debug: False
2024-11-05 09:54:04,030:INFO:   <<< distributed: True
2024-11-05 09:54:04,030:INFO:   <<< do_eval: True
2024-11-05 09:54:04,030:INFO:   <<< do_lower_case: False
2024-11-05 09:54:04,030:INFO:   <<< do_pretrain: False
2024-11-05 09:54:04,030:INFO:   <<< do_train: False
2024-11-05 09:54:04,030:INFO:   <<< dual_mix: 0.5
2024-11-05 09:54:04,030:INFO:   <<< epochs: 200
2024-11-05 09:54:04,030:INFO:   <<< eval_frame_order: 0
2024-11-05 09:54:04,030:INFO:   <<< expand_msrvtt_sentences: False
2024-11-05 09:54:04,030:INFO:   <<< feature_framerate: 1
2024-11-05 09:54:04,030:INFO:   <<< feature_len: 64
2024-11-05 09:54:04,030:INFO:   <<< features_path: sign_feature/h2s_domain_agnostic
2024-11-05 09:54:04,030:INFO:   <<< features_path_retrain: sign_feature/h2s_domain_aware
2024-11-05 09:54:04,030:INFO:   <<< fp16: True
2024-11-05 09:54:04,030:INFO:   <<< fp16_opt_level: O1
2024-11-05 09:54:04,030:INFO:   <<< freeze_layer_num: 0
2024-11-05 09:54:04,031:INFO:   <<< gpu_ids: [0, 1]
2024-11-05 09:54:04,031:INFO:   <<< gradient_accumulation_steps: 1
2024-11-05 09:54:04,031:INFO:   <<< hard_negative_rate: 0.5
2024-11-05 09:54:04,031:INFO:   <<< init_model: chpt/H2S_sota.pth
2024-11-05 09:54:04,031:INFO:   <<< linear_patch: 2d
2024-11-05 09:54:04,031:INFO:   <<< local_rank: 0
2024-11-05 09:54:04,031:INFO:   <<< loose_type: True
2024-11-05 09:54:04,031:INFO:   <<< lr: 1e-05
2024-11-05 09:54:04,031:INFO:   <<< lr_decay: 0.001
2024-11-05 09:54:04,031:INFO:   <<< margin: 0.1
2024-11-05 09:54:04,031:INFO:   <<< max_frames: 128
2024-11-05 09:54:04,031:INFO:   <<< max_words: 32
2024-11-05 09:54:04,031:INFO:   <<< mix_design: balance
2024-11-05 09:54:04,031:INFO:   <<< n_display: 1
2024-11-05 09:54:04,031:INFO:   <<< n_gpu: 1
2024-11-05 09:54:04,031:INFO:   <<< n_pair: 1
2024-11-05 09:54:04,031:INFO:   <<< negative_weighting: 1
2024-11-05 09:54:04,031:INFO:   <<< not_load_visual: False
2024-11-05 09:54:04,031:INFO:   <<< num_thread_reader: 8
2024-11-05 09:54:04,031:INFO:   <<< output_dir: new_experiment
2024-11-05 09:54:04,032:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-11-05 09:54:04,032:INFO:   <<< rank: 0
2024-11-05 09:54:04,032:INFO:   <<< resume_model: None
2024-11-05 09:54:04,032:INFO:   <<< sampled_use_mil: False
2024-11-05 09:54:04,032:INFO:   <<< seed: 42
2024-11-05 09:54:04,032:INFO:   <<< sim_calcu: softmax_max
2024-11-05 09:54:04,032:INFO:   <<< sim_header: Filip
2024-11-05 09:54:04,032:INFO:   <<< slice_framepos: 0
2024-11-05 09:54:04,032:INFO:   <<< task_type: retrieval
2024-11-05 09:54:04,032:INFO:   <<< tau: 0.07
2024-11-05 09:54:04,032:INFO:   <<< text_aug: True
2024-11-05 09:54:04,032:INFO:   <<< text_aug_choosen: random_swap
2024-11-05 09:54:04,032:INFO:   <<< text_num_hidden_layers: 12
2024-11-05 09:54:04,032:INFO:   <<< train_frame_order: 0
2024-11-05 09:54:04,032:INFO:   <<< use_mil: False
2024-11-05 09:54:04,032:INFO:   <<< video_dim: 1024
2024-11-05 09:54:04,032:INFO:   <<< visual_num_hidden_layers: 12
2024-11-05 09:54:04,032:INFO:   <<< warmup_proportion: 0.1
2024-11-05 09:54:04,032:INFO:   <<< world_size: 1
2024-11-05 09:54:04,033:INFO: device: cuda:0 n_gpu: 1
2024-11-05 09:54:05,941:INFO: loading archive file /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base
2024-11-05 09:54:05,942:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-11-05 09:54:05,942:INFO: Weight doesn't exsits. /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base/cross_pytorch_model.bin
2024-11-05 09:54:05,942:WARNING: Stage-One:True, Stage-Two:False
2024-11-05 09:54:05,942:WARNING: Test retrieval by loose type.
2024-11-05 09:54:05,943:WARNING: 	 embed_dim: 512
2024-11-05 09:54:05,943:WARNING: 	 image_resolution: 224
2024-11-05 09:54:05,943:WARNING: 	 vision_layers: 12
2024-11-05 09:54:05,943:WARNING: 	 vision_width: 768
2024-11-05 09:54:05,943:WARNING: 	 vision_patch_size: 32
2024-11-05 09:54:05,943:WARNING: 	 context_length: 77
2024-11-05 09:54:05,943:WARNING: 	 vocab_size: 49408
2024-11-05 09:54:05,943:WARNING: 	 transformer_width: 512
2024-11-05 09:54:05,943:WARNING: 	 transformer_heads: 8
2024-11-05 09:54:05,943:WARNING: 	 transformer_layers: 12
2024-11-05 09:54:05,943:WARNING: 		 linear_patch: 2d
2024-11-05 09:54:05,943:WARNING: 	 cut_top_layer: 0
2024-11-05 09:54:07,862:WARNING: 	 sim_header: Filip
2024-11-05 09:54:15,101:INFO: --------------------
2024-11-05 09:54:15,102:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-11-05 09:54:15,216:INFO: ***** Running test *****
2024-11-05 09:54:15,216:INFO:   Num examples = 2348
2024-11-05 09:54:15,216:INFO:   Batch size = 256
2024-11-05 09:54:15,216:INFO:   Num steps = 10
2024-11-05 09:54:15,530:WARNING: Eval under the multi-sentence per video clip setting.
2024-11-05 09:54:15,530:WARNING: sentence num: 1969, video num: 2348
2024-11-05 09:54:42,307:INFO: Effective parameters:
2024-11-05 09:54:42,307:INFO:   <<< alpha: 0.8
2024-11-05 09:54:42,308:INFO:   <<< aug_choose: t2v
2024-11-05 09:54:42,308:INFO:   <<< batch_size: 512
2024-11-05 09:54:42,308:INFO:   <<< batch_size_val: 256
2024-11-05 09:54:42,308:INFO:   <<< cache_dir: 
2024-11-05 09:54:42,308:INFO:   <<< cla_weight_dir: cla_weight
2024-11-05 09:54:42,308:INFO:   <<< coef_lr: 1.0
2024-11-05 09:54:42,308:INFO:   <<< combine_type: sum
2024-11-05 09:54:42,308:INFO:   <<< cross_att_layers: 1
2024-11-05 09:54:42,308:INFO:   <<< cross_model: cross-base
2024-11-05 09:54:42,308:INFO:   <<< cross_num_hidden_layers: 4
2024-11-05 09:54:42,308:INFO:   <<< data_path: data_h2
2024-11-05 09:54:42,308:INFO:   <<< datatype: h2s
2024-11-05 09:54:42,308:INFO:   <<< debug: False
2024-11-05 09:54:42,308:INFO:   <<< distributed: True
2024-11-05 09:54:42,308:INFO:   <<< do_eval: True
2024-11-05 09:54:42,308:INFO:   <<< do_lower_case: False
2024-11-05 09:54:42,308:INFO:   <<< do_pretrain: False
2024-11-05 09:54:42,308:INFO:   <<< do_train: False
2024-11-05 09:54:42,308:INFO:   <<< dual_mix: 0.5
2024-11-05 09:54:42,308:INFO:   <<< epochs: 200
2024-11-05 09:54:42,309:INFO:   <<< eval_frame_order: 0
2024-11-05 09:54:42,309:INFO:   <<< expand_msrvtt_sentences: False
2024-11-05 09:54:42,309:INFO:   <<< feature_framerate: 1
2024-11-05 09:54:42,309:INFO:   <<< feature_len: 64
2024-11-05 09:54:42,309:INFO:   <<< features_path: sign_feature/h2s_domain_agnostic
2024-11-05 09:54:42,309:INFO:   <<< features_path_retrain: sign_feature/h2s_domain_aware
2024-11-05 09:54:42,309:INFO:   <<< fp16: True
2024-11-05 09:54:42,309:INFO:   <<< fp16_opt_level: O1
2024-11-05 09:54:42,309:INFO:   <<< freeze_layer_num: 0
2024-11-05 09:54:42,309:INFO:   <<< gpu_ids: [0, 1]
2024-11-05 09:54:42,309:INFO:   <<< gradient_accumulation_steps: 1
2024-11-05 09:54:42,309:INFO:   <<< hard_negative_rate: 0.5
2024-11-05 09:54:42,309:INFO:   <<< init_model: chpt/H2S_sota.pth
2024-11-05 09:54:42,309:INFO:   <<< linear_patch: 2d
2024-11-05 09:54:42,309:INFO:   <<< local_rank: 0
2024-11-05 09:54:42,309:INFO:   <<< loose_type: True
2024-11-05 09:54:42,309:INFO:   <<< lr: 1e-05
2024-11-05 09:54:42,309:INFO:   <<< lr_decay: 0.001
2024-11-05 09:54:42,309:INFO:   <<< margin: 0.1
2024-11-05 09:54:42,309:INFO:   <<< max_frames: 128
2024-11-05 09:54:42,310:INFO:   <<< max_words: 32
2024-11-05 09:54:42,310:INFO:   <<< mix_design: balance
2024-11-05 09:54:42,310:INFO:   <<< n_display: 1
2024-11-05 09:54:42,310:INFO:   <<< n_gpu: 1
2024-11-05 09:54:42,310:INFO:   <<< n_pair: 1
2024-11-05 09:54:42,310:INFO:   <<< negative_weighting: 1
2024-11-05 09:54:42,310:INFO:   <<< not_load_visual: False
2024-11-05 09:54:42,310:INFO:   <<< num_thread_reader: 8
2024-11-05 09:54:42,310:INFO:   <<< output_dir: new_experiment
2024-11-05 09:54:42,310:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-11-05 09:54:42,310:INFO:   <<< rank: 0
2024-11-05 09:54:42,310:INFO:   <<< resume_model: None
2024-11-05 09:54:42,310:INFO:   <<< sampled_use_mil: False
2024-11-05 09:54:42,310:INFO:   <<< seed: 42
2024-11-05 09:54:42,310:INFO:   <<< sim_calcu: softmax_max
2024-11-05 09:54:42,310:INFO:   <<< sim_header: Filip
2024-11-05 09:54:42,310:INFO:   <<< slice_framepos: 0
2024-11-05 09:54:42,310:INFO:   <<< task_type: retrieval
2024-11-05 09:54:42,310:INFO:   <<< tau: 0.07
2024-11-05 09:54:42,310:INFO:   <<< text_aug: True
2024-11-05 09:54:42,311:INFO:   <<< text_aug_choosen: random_swap
2024-11-05 09:54:42,311:INFO:   <<< text_num_hidden_layers: 12
2024-11-05 09:54:42,311:INFO:   <<< train_frame_order: 0
2024-11-05 09:54:42,311:INFO:   <<< use_mil: False
2024-11-05 09:54:42,311:INFO:   <<< video_dim: 1024
2024-11-05 09:54:42,311:INFO:   <<< visual_num_hidden_layers: 12
2024-11-05 09:54:42,311:INFO:   <<< warmup_proportion: 0.1
2024-11-05 09:54:42,311:INFO:   <<< world_size: 1
2024-11-05 09:54:42,311:INFO: device: cuda:0 n_gpu: 1
2024-11-05 10:01:30,240:INFO: Effective parameters:
2024-11-05 10:01:30,240:INFO:   <<< alpha: 0.8
2024-11-05 10:01:30,240:INFO:   <<< aug_choose: t2v
2024-11-05 10:01:30,240:INFO:   <<< batch_size: 512
2024-11-05 10:01:30,240:INFO:   <<< batch_size_val: 256
2024-11-05 10:01:30,240:INFO:   <<< cache_dir: 
2024-11-05 10:01:30,240:INFO:   <<< cla_weight_dir: cla_weight
2024-11-05 10:01:30,240:INFO:   <<< coef_lr: 1.0
2024-11-05 10:01:30,240:INFO:   <<< combine_type: sum
2024-11-05 10:01:30,240:INFO:   <<< cross_att_layers: 1
2024-11-05 10:01:30,240:INFO:   <<< cross_model: cross-base
2024-11-05 10:01:30,240:INFO:   <<< cross_num_hidden_layers: 4
2024-11-05 10:01:30,240:INFO:   <<< data_path: data_h2
2024-11-05 10:01:30,240:INFO:   <<< datatype: h2s
2024-11-05 10:01:30,241:INFO:   <<< debug: False
2024-11-05 10:01:30,241:INFO:   <<< distributed: True
2024-11-05 10:01:30,241:INFO:   <<< do_eval: True
2024-11-05 10:01:30,241:INFO:   <<< do_lower_case: False
2024-11-05 10:01:30,241:INFO:   <<< do_pretrain: False
2024-11-05 10:01:30,241:INFO:   <<< do_train: False
2024-11-05 10:01:30,241:INFO:   <<< dual_mix: 0.5
2024-11-05 10:01:30,241:INFO:   <<< epochs: 200
2024-11-05 10:01:30,241:INFO:   <<< eval_frame_order: 0
2024-11-05 10:01:30,241:INFO:   <<< expand_msrvtt_sentences: False
2024-11-05 10:01:30,241:INFO:   <<< feature_framerate: 1
2024-11-05 10:01:30,241:INFO:   <<< feature_len: 64
2024-11-05 10:01:30,241:INFO:   <<< features_path: sign_feature/h2s_domain_agnostic
2024-11-05 10:01:30,241:INFO:   <<< features_path_retrain: sign_feature/h2s_domain_aware
2024-11-05 10:01:30,241:INFO:   <<< fp16: True
2024-11-05 10:01:30,241:INFO:   <<< fp16_opt_level: O1
2024-11-05 10:01:30,241:INFO:   <<< freeze_layer_num: 0
2024-11-05 10:01:30,241:INFO:   <<< gpu_ids: [0, 1]
2024-11-05 10:01:30,241:INFO:   <<< gradient_accumulation_steps: 1
2024-11-05 10:01:30,241:INFO:   <<< hard_negative_rate: 0.5
2024-11-05 10:01:30,241:INFO:   <<< init_model: chpt/H2S_sota.pth
2024-11-05 10:01:30,241:INFO:   <<< linear_patch: 2d
2024-11-05 10:01:30,242:INFO:   <<< local_rank: 0
2024-11-05 10:01:30,242:INFO:   <<< loose_type: True
2024-11-05 10:01:30,242:INFO:   <<< lr: 1e-05
2024-11-05 10:01:30,242:INFO:   <<< lr_decay: 0.001
2024-11-05 10:01:30,242:INFO:   <<< margin: 0.1
2024-11-05 10:01:30,242:INFO:   <<< max_frames: 128
2024-11-05 10:01:30,242:INFO:   <<< max_words: 32
2024-11-05 10:01:30,242:INFO:   <<< mix_design: balance
2024-11-05 10:01:30,242:INFO:   <<< n_display: 1
2024-11-05 10:01:30,242:INFO:   <<< n_gpu: 1
2024-11-05 10:01:30,242:INFO:   <<< n_pair: 1
2024-11-05 10:01:30,242:INFO:   <<< negative_weighting: 1
2024-11-05 10:01:30,242:INFO:   <<< not_load_visual: False
2024-11-05 10:01:30,242:INFO:   <<< num_thread_reader: 8
2024-11-05 10:01:30,242:INFO:   <<< output_dir: new_experiment
2024-11-05 10:01:30,242:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-11-05 10:01:30,242:INFO:   <<< rank: 0
2024-11-05 10:01:30,242:INFO:   <<< resume_model: None
2024-11-05 10:01:30,242:INFO:   <<< sampled_use_mil: False
2024-11-05 10:01:30,242:INFO:   <<< seed: 42
2024-11-05 10:01:30,242:INFO:   <<< sim_calcu: softmax_max
2024-11-05 10:01:30,242:INFO:   <<< sim_header: Filip
2024-11-05 10:01:30,243:INFO:   <<< slice_framepos: 0
2024-11-05 10:01:30,243:INFO:   <<< task_type: retrieval
2024-11-05 10:01:30,243:INFO:   <<< tau: 0.07
2024-11-05 10:01:30,243:INFO:   <<< text_aug: True
2024-11-05 10:01:30,243:INFO:   <<< text_aug_choosen: random_swap
2024-11-05 10:01:30,243:INFO:   <<< text_num_hidden_layers: 12
2024-11-05 10:01:30,243:INFO:   <<< train_frame_order: 0
2024-11-05 10:01:30,243:INFO:   <<< use_mil: False
2024-11-05 10:01:30,243:INFO:   <<< video_dim: 1024
2024-11-05 10:01:30,243:INFO:   <<< visual_num_hidden_layers: 12
2024-11-05 10:01:30,243:INFO:   <<< warmup_proportion: 0.1
2024-11-05 10:01:30,243:INFO:   <<< world_size: 1
2024-11-05 10:01:30,243:INFO: device: cuda:0 n_gpu: 1
2024-11-05 10:08:30,913:INFO: Effective parameters:
2024-11-05 10:08:30,913:INFO:   <<< alpha: 0.8
2024-11-05 10:08:30,913:INFO:   <<< aug_choose: t2v
2024-11-05 10:08:30,913:INFO:   <<< batch_size: 512
2024-11-05 10:08:30,913:INFO:   <<< batch_size_val: 256
2024-11-05 10:08:30,913:INFO:   <<< cache_dir: 
2024-11-05 10:08:30,913:INFO:   <<< cla_weight_dir: cla_weight
2024-11-05 10:08:30,913:INFO:   <<< coef_lr: 1.0
2024-11-05 10:08:30,914:INFO:   <<< combine_type: sum
2024-11-05 10:08:30,914:INFO:   <<< cross_att_layers: 1
2024-11-05 10:08:30,914:INFO:   <<< cross_model: cross-base
2024-11-05 10:08:30,914:INFO:   <<< cross_num_hidden_layers: 4
2024-11-05 10:08:30,914:INFO:   <<< data_path: data_h2
2024-11-05 10:08:30,914:INFO:   <<< datatype: h2s
2024-11-05 10:08:30,914:INFO:   <<< debug: False
2024-11-05 10:08:30,914:INFO:   <<< distributed: True
2024-11-05 10:08:30,914:INFO:   <<< do_eval: True
2024-11-05 10:08:30,914:INFO:   <<< do_lower_case: False
2024-11-05 10:08:30,914:INFO:   <<< do_pretrain: False
2024-11-05 10:08:30,914:INFO:   <<< do_train: False
2024-11-05 10:08:30,914:INFO:   <<< dual_mix: 0.5
2024-11-05 10:08:30,914:INFO:   <<< epochs: 200
2024-11-05 10:08:30,914:INFO:   <<< eval_frame_order: 0
2024-11-05 10:08:30,914:INFO:   <<< expand_msrvtt_sentences: False
2024-11-05 10:08:30,914:INFO:   <<< feature_framerate: 1
2024-11-05 10:08:30,914:INFO:   <<< feature_len: 64
2024-11-05 10:08:30,914:INFO:   <<< features_path: sign_feature/h2s_domain_agnostic
2024-11-05 10:08:30,914:INFO:   <<< features_path_retrain: sign_feature/h2s_domain_aware
2024-11-05 10:08:30,915:INFO:   <<< fp16: True
2024-11-05 10:08:30,915:INFO:   <<< fp16_opt_level: O1
2024-11-05 10:08:30,915:INFO:   <<< freeze_layer_num: 0
2024-11-05 10:08:30,915:INFO:   <<< gpu_ids: [0, 1]
2024-11-05 10:08:30,915:INFO:   <<< gradient_accumulation_steps: 1
2024-11-05 10:08:30,915:INFO:   <<< hard_negative_rate: 0.5
2024-11-05 10:08:30,915:INFO:   <<< init_model: chpt/H2S_sota.pth
2024-11-05 10:08:30,915:INFO:   <<< linear_patch: 2d
2024-11-05 10:08:30,915:INFO:   <<< local_rank: 0
2024-11-05 10:08:30,915:INFO:   <<< loose_type: True
2024-11-05 10:08:30,915:INFO:   <<< lr: 1e-05
2024-11-05 10:08:30,915:INFO:   <<< lr_decay: 0.001
2024-11-05 10:08:30,915:INFO:   <<< margin: 0.1
2024-11-05 10:08:30,915:INFO:   <<< max_frames: 128
2024-11-05 10:08:30,915:INFO:   <<< max_words: 32
2024-11-05 10:08:30,915:INFO:   <<< mix_design: balance
2024-11-05 10:08:30,915:INFO:   <<< n_display: 1
2024-11-05 10:08:30,915:INFO:   <<< n_gpu: 1
2024-11-05 10:08:30,915:INFO:   <<< n_pair: 1
2024-11-05 10:08:30,915:INFO:   <<< negative_weighting: 1
2024-11-05 10:08:30,915:INFO:   <<< not_load_visual: False
2024-11-05 10:08:30,916:INFO:   <<< num_thread_reader: 8
2024-11-05 10:08:30,916:INFO:   <<< output_dir: new_experiment
2024-11-05 10:08:30,916:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-11-05 10:08:30,916:INFO:   <<< rank: 0
2024-11-05 10:08:30,916:INFO:   <<< resume_model: None
2024-11-05 10:08:30,916:INFO:   <<< sampled_use_mil: False
2024-11-05 10:08:30,916:INFO:   <<< seed: 42
2024-11-05 10:08:30,916:INFO:   <<< sim_calcu: softmax_max
2024-11-05 10:08:30,916:INFO:   <<< sim_header: Filip
2024-11-05 10:08:30,916:INFO:   <<< slice_framepos: 0
2024-11-05 10:08:30,916:INFO:   <<< task_type: retrieval
2024-11-05 10:08:30,916:INFO:   <<< tau: 0.07
2024-11-05 10:08:30,916:INFO:   <<< text_aug: True
2024-11-05 10:08:30,916:INFO:   <<< text_aug_choosen: random_swap
2024-11-05 10:08:30,916:INFO:   <<< text_num_hidden_layers: 12
2024-11-05 10:08:30,916:INFO:   <<< train_frame_order: 0
2024-11-05 10:08:30,916:INFO:   <<< use_mil: False
2024-11-05 10:08:30,916:INFO:   <<< video_dim: 1024
2024-11-05 10:08:30,916:INFO:   <<< visual_num_hidden_layers: 12
2024-11-05 10:08:30,916:INFO:   <<< warmup_proportion: 0.1
2024-11-05 10:08:30,916:INFO:   <<< world_size: 1
2024-11-05 10:08:30,917:INFO: device: cuda:0 n_gpu: 1
2024-11-05 10:08:32,843:INFO: loading archive file /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base
2024-11-05 10:08:32,845:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-11-05 10:08:32,845:INFO: Weight doesn't exsits. /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base/cross_pytorch_model.bin
2024-11-05 10:08:32,845:WARNING: Stage-One:True, Stage-Two:False
2024-11-05 10:08:32,845:WARNING: Test retrieval by loose type.
2024-11-05 10:08:32,845:WARNING: 	 embed_dim: 512
2024-11-05 10:08:32,845:WARNING: 	 image_resolution: 224
2024-11-05 10:08:32,845:WARNING: 	 vision_layers: 12
2024-11-05 10:08:32,846:WARNING: 	 vision_width: 768
2024-11-05 10:08:32,846:WARNING: 	 vision_patch_size: 32
2024-11-05 10:08:32,846:WARNING: 	 context_length: 77
2024-11-05 10:08:32,846:WARNING: 	 vocab_size: 49408
2024-11-05 10:08:32,846:WARNING: 	 transformer_width: 512
2024-11-05 10:08:32,846:WARNING: 	 transformer_heads: 8
2024-11-05 10:08:32,846:WARNING: 	 transformer_layers: 12
2024-11-05 10:08:32,846:WARNING: 		 linear_patch: 2d
2024-11-05 10:08:32,846:WARNING: 	 cut_top_layer: 0
2024-11-05 10:08:34,817:WARNING: 	 sim_header: Filip
2024-11-05 10:08:42,054:INFO: --------------------
2024-11-05 10:08:42,055:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-11-05 10:08:42,164:INFO: ***** Running test *****
2024-11-05 10:08:42,164:INFO:   Num examples = 2348
2024-11-05 10:08:42,164:INFO:   Batch size = 256
2024-11-05 10:08:42,164:INFO:   Num steps = 10
2024-11-05 10:08:42,465:WARNING: Eval under the multi-sentence per video clip setting.
2024-11-05 10:08:42,465:WARNING: sentence num: 1969, video num: 2348
2024-11-05 12:58:50,923:INFO: Effective parameters:
2024-11-05 12:58:50,923:INFO:   <<< alpha: 0.8
2024-11-05 12:58:50,924:INFO:   <<< aug_choose: t2v
2024-11-05 12:58:50,924:INFO:   <<< batch_size: 512
2024-11-05 12:58:50,924:INFO:   <<< batch_size_val: 256
2024-11-05 12:58:50,924:INFO:   <<< cache_dir: 
2024-11-05 12:58:50,924:INFO:   <<< cla_weight_dir: cla_weight
2024-11-05 12:58:50,924:INFO:   <<< coef_lr: 1.0
2024-11-05 12:58:50,924:INFO:   <<< combine_type: sum
2024-11-05 12:58:50,924:INFO:   <<< cross_att_layers: 1
2024-11-05 12:58:50,924:INFO:   <<< cross_model: cross-base
2024-11-05 12:58:50,924:INFO:   <<< cross_num_hidden_layers: 4
2024-11-05 12:58:50,924:INFO:   <<< data_path: data_h2
2024-11-05 12:58:50,924:INFO:   <<< datatype: h2s
2024-11-05 12:58:50,924:INFO:   <<< debug: False
2024-11-05 12:58:50,924:INFO:   <<< distributed: True
2024-11-05 12:58:50,924:INFO:   <<< do_eval: True
2024-11-05 12:58:50,924:INFO:   <<< do_lower_case: False
2024-11-05 12:58:50,925:INFO:   <<< do_pretrain: False
2024-11-05 12:58:50,925:INFO:   <<< do_train: False
2024-11-05 12:58:50,925:INFO:   <<< dual_mix: 0.5
2024-11-05 12:58:50,925:INFO:   <<< epochs: 200
2024-11-05 12:58:50,925:INFO:   <<< eval_frame_order: 0
2024-11-05 12:58:50,925:INFO:   <<< expand_msrvtt_sentences: False
2024-11-05 12:58:50,925:INFO:   <<< feature_framerate: 1
2024-11-05 12:58:50,925:INFO:   <<< feature_len: 64
2024-11-05 12:58:50,925:INFO:   <<< features_path: sign_feature/h2s_domain_agnostic
2024-11-05 12:58:50,925:INFO:   <<< features_path_retrain: sign_feature/h2s_domain_aware
2024-11-05 12:58:50,925:INFO:   <<< fp16: True
2024-11-05 12:58:50,925:INFO:   <<< fp16_opt_level: O1
2024-11-05 12:58:50,925:INFO:   <<< freeze_layer_num: 0
2024-11-05 12:58:50,925:INFO:   <<< gpu_ids: [0, 1]
2024-11-05 12:58:50,925:INFO:   <<< gradient_accumulation_steps: 1
2024-11-05 12:58:50,925:INFO:   <<< hard_negative_rate: 0.5
2024-11-05 12:58:50,925:INFO:   <<< init_model: chpt/H2S_sota.pth
2024-11-05 12:58:50,926:INFO:   <<< linear_patch: 2d
2024-11-05 12:58:50,926:INFO:   <<< local_rank: 0
2024-11-05 12:58:50,926:INFO:   <<< loose_type: True
2024-11-05 12:58:50,926:INFO:   <<< lr: 1e-05
2024-11-05 12:58:50,926:INFO:   <<< lr_decay: 0.001
2024-11-05 12:58:50,926:INFO:   <<< margin: 0.1
2024-11-05 12:58:50,926:INFO:   <<< max_frames: 128
2024-11-05 12:58:50,926:INFO:   <<< max_words: 32
2024-11-05 12:58:50,926:INFO:   <<< mix_design: balance
2024-11-05 12:58:50,926:INFO:   <<< n_display: 1
2024-11-05 12:58:50,926:INFO:   <<< n_gpu: 1
2024-11-05 12:58:50,926:INFO:   <<< n_pair: 1
2024-11-05 12:58:50,926:INFO:   <<< negative_weighting: 1
2024-11-05 12:58:50,926:INFO:   <<< not_load_visual: False
2024-11-05 12:58:50,926:INFO:   <<< num_thread_reader: 8
2024-11-05 12:58:50,926:INFO:   <<< output_dir: new_experiment
2024-11-05 12:58:50,926:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-11-05 12:58:50,927:INFO:   <<< rank: 0
2024-11-05 12:58:50,927:INFO:   <<< resume_model: None
2024-11-05 12:58:50,927:INFO:   <<< sampled_use_mil: False
2024-11-05 12:58:50,927:INFO:   <<< seed: 42
2024-11-05 12:58:50,927:INFO:   <<< sim_calcu: softmax_max
2024-11-05 12:58:50,927:INFO:   <<< sim_header: Filip
2024-11-05 12:58:50,927:INFO:   <<< slice_framepos: 0
2024-11-05 12:58:50,927:INFO:   <<< task_type: retrieval
2024-11-05 12:58:50,927:INFO:   <<< tau: 0.07
2024-11-05 12:58:50,927:INFO:   <<< text_aug: True
2024-11-05 12:58:50,927:INFO:   <<< text_aug_choosen: random_swap
2024-11-05 12:58:50,927:INFO:   <<< text_num_hidden_layers: 12
2024-11-05 12:58:50,927:INFO:   <<< train_frame_order: 0
2024-11-05 12:58:50,927:INFO:   <<< use_mil: False
2024-11-05 12:58:50,927:INFO:   <<< video_dim: 1024
2024-11-05 12:58:50,927:INFO:   <<< visual_num_hidden_layers: 12
2024-11-05 12:58:50,927:INFO:   <<< warmup_proportion: 0.1
2024-11-05 12:58:50,928:INFO:   <<< world_size: 1
2024-11-05 12:58:50,928:INFO: device: cuda:0 n_gpu: 1
2024-11-05 12:58:53,134:INFO: loading archive file /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base
2024-11-05 12:58:53,137:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-11-05 12:58:53,138:INFO: Weight doesn't exsits. /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base/cross_pytorch_model.bin
2024-11-05 12:58:53,138:WARNING: Stage-One:True, Stage-Two:False
2024-11-05 12:58:53,138:WARNING: Test retrieval by loose type.
2024-11-05 12:58:53,138:WARNING: 	 embed_dim: 512
2024-11-05 12:58:53,138:WARNING: 	 image_resolution: 224
2024-11-05 12:58:53,138:WARNING: 	 vision_layers: 12
2024-11-05 12:58:53,138:WARNING: 	 vision_width: 768
2024-11-05 12:58:53,139:WARNING: 	 vision_patch_size: 32
2024-11-05 12:58:53,139:WARNING: 	 context_length: 77
2024-11-05 12:58:53,139:WARNING: 	 vocab_size: 49408
2024-11-05 12:58:53,139:WARNING: 	 transformer_width: 512
2024-11-05 12:58:53,139:WARNING: 	 transformer_heads: 8
2024-11-05 12:58:53,139:WARNING: 	 transformer_layers: 12
2024-11-05 12:58:53,139:WARNING: 		 linear_patch: 2d
2024-11-05 12:58:53,139:WARNING: 	 cut_top_layer: 0
2024-11-05 12:58:55,369:WARNING: 	 sim_header: Filip
2024-11-05 12:59:03,223:INFO: --------------------
2024-11-05 12:59:03,224:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-11-05 12:59:03,344:INFO: ***** Running test *****
2024-11-05 12:59:03,344:INFO:   Num examples = 2348
2024-11-05 12:59:03,344:INFO:   Batch size = 256
2024-11-05 12:59:03,344:INFO:   Num steps = 10
2024-11-05 12:59:04,298:WARNING: Eval under the multi-sentence per video clip setting.
2024-11-05 12:59:04,298:WARNING: sentence num: 1969, video num: 2348
2024-11-05 13:38:55,554:INFO: Effective parameters:
2024-11-05 13:38:55,556:INFO:   <<< alpha: 0.8
2024-11-05 13:38:55,557:INFO:   <<< aug_choose: t2v
2024-11-05 13:38:55,558:INFO:   <<< batch_size: 512
2024-11-05 13:38:55,559:INFO:   <<< batch_size_val: 256
2024-11-05 13:38:55,560:INFO:   <<< cache_dir: 
2024-11-05 13:38:55,561:INFO:   <<< cla_weight_dir: cla_weight
2024-11-05 13:38:55,562:INFO:   <<< coef_lr: 1.0
2024-11-05 13:38:55,563:INFO:   <<< combine_type: sum
2024-11-05 13:38:55,565:INFO:   <<< cross_att_layers: 1
2024-11-05 13:38:55,565:INFO:   <<< cross_model: cross-base
2024-11-05 13:38:55,566:INFO:   <<< cross_num_hidden_layers: 4
2024-11-05 13:38:55,567:INFO:   <<< data_path: data_h2
2024-11-05 13:38:55,568:INFO:   <<< datatype: h2s
2024-11-05 13:38:55,569:INFO:   <<< debug: False
2024-11-05 13:38:55,570:INFO:   <<< distributed: True
2024-11-05 13:38:55,571:INFO:   <<< do_eval: True
2024-11-05 13:38:55,572:INFO:   <<< do_lower_case: False
2024-11-05 13:38:55,573:INFO:   <<< do_pretrain: False
2024-11-05 13:38:55,574:INFO:   <<< do_train: False
2024-11-05 13:38:55,575:INFO:   <<< dual_mix: 0.5
2024-11-05 13:38:55,576:INFO:   <<< epochs: 200
2024-11-05 13:38:55,577:INFO:   <<< eval_frame_order: 0
2024-11-05 13:38:55,578:INFO:   <<< expand_msrvtt_sentences: False
2024-11-05 13:38:55,579:INFO:   <<< feature_framerate: 1
2024-11-05 13:38:55,580:INFO:   <<< feature_len: 64
2024-11-05 13:38:55,581:INFO:   <<< features_path: sign_feature/h2s_domain_agnostic
2024-11-05 13:38:55,582:INFO:   <<< features_path_retrain: sign_feature/h2s_domain_aware
2024-11-05 13:38:55,583:INFO:   <<< fp16: True
2024-11-05 13:38:55,584:INFO:   <<< fp16_opt_level: O1
2024-11-05 13:38:55,585:INFO:   <<< freeze_layer_num: 0
2024-11-05 13:38:55,586:INFO:   <<< gpu_ids: [0, 1]
2024-11-05 13:38:55,587:INFO:   <<< gradient_accumulation_steps: 1
2024-11-05 13:38:55,588:INFO:   <<< hard_negative_rate: 0.5
2024-11-05 13:38:55,589:INFO:   <<< init_model: chpt/H2S_sota.pth
2024-11-05 13:38:55,590:INFO:   <<< linear_patch: 2d
2024-11-05 13:38:55,591:INFO:   <<< local_rank: 0
2024-11-05 13:38:55,592:INFO:   <<< loose_type: True
2024-11-05 13:38:55,592:INFO:   <<< lr: 1e-05
2024-11-05 13:38:55,593:INFO:   <<< lr_decay: 0.001
2024-11-05 13:38:55,594:INFO:   <<< margin: 0.1
2024-11-05 13:38:55,595:INFO:   <<< max_frames: 128
2024-11-05 13:38:55,596:INFO:   <<< max_words: 32
2024-11-05 13:38:55,597:INFO:   <<< mix_design: balance
2024-11-05 13:38:55,598:INFO:   <<< n_display: 1
2024-11-05 13:38:55,599:INFO:   <<< n_gpu: 1
2024-11-05 13:38:55,600:INFO:   <<< n_pair: 1
2024-11-05 13:38:55,601:INFO:   <<< negative_weighting: 1
2024-11-05 13:38:55,602:INFO:   <<< not_load_visual: False
2024-11-05 13:38:55,603:INFO:   <<< num_thread_reader: 8
2024-11-05 13:38:55,604:INFO:   <<< output_dir: new_experiment
2024-11-05 13:38:55,605:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-11-05 13:38:55,606:INFO:   <<< rank: 0
2024-11-05 13:38:55,607:INFO:   <<< resume_model: None
2024-11-05 13:38:55,608:INFO:   <<< sampled_use_mil: False
2024-11-05 13:38:55,609:INFO:   <<< seed: 42
2024-11-05 13:38:55,610:INFO:   <<< sim_calcu: softmax_max
2024-11-05 13:38:55,611:INFO:   <<< sim_header: Filip
2024-11-05 13:38:55,612:INFO:   <<< slice_framepos: 0
2024-11-05 13:38:55,613:INFO:   <<< task_type: retrieval
2024-11-05 13:38:55,614:INFO:   <<< tau: 0.07
2024-11-05 13:38:55,615:INFO:   <<< text_aug: True
2024-11-05 13:38:55,616:INFO:   <<< text_aug_choosen: random_swap
2024-11-05 13:38:55,617:INFO:   <<< text_num_hidden_layers: 12
2024-11-05 13:38:55,618:INFO:   <<< train_frame_order: 0
2024-11-05 13:38:55,619:INFO:   <<< use_mil: False
2024-11-05 13:38:55,620:INFO:   <<< video_dim: 1024
2024-11-05 13:38:55,621:INFO:   <<< visual_num_hidden_layers: 12
2024-11-05 13:38:55,622:INFO:   <<< warmup_proportion: 0.1
2024-11-05 13:38:55,623:INFO:   <<< world_size: 1
2024-11-05 13:38:55,641:INFO: device: cuda:0 n_gpu: 1
2024-11-05 13:39:06,675:INFO: loading archive file /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base
2024-11-05 13:39:06,683:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-11-05 13:39:06,686:INFO: Weight doesn't exsits. /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base/cross_pytorch_model.bin
2024-11-05 13:39:06,688:WARNING: Stage-One:True, Stage-Two:False
2024-11-05 13:39:06,688:WARNING: Test retrieval by loose type.
2024-11-05 13:39:06,690:WARNING: 	 embed_dim: 512
2024-11-05 13:39:06,691:WARNING: 	 image_resolution: 224
2024-11-05 13:39:06,691:WARNING: 	 vision_layers: 12
2024-11-05 13:39:06,692:WARNING: 	 vision_width: 768
2024-11-05 13:39:06,692:WARNING: 	 vision_patch_size: 32
2024-11-05 13:39:06,692:WARNING: 	 context_length: 77
2024-11-05 13:39:06,693:WARNING: 	 vocab_size: 49408
2024-11-05 13:39:06,693:WARNING: 	 transformer_width: 512
2024-11-05 13:39:06,694:WARNING: 	 transformer_heads: 8
2024-11-05 13:39:06,694:WARNING: 	 transformer_layers: 12
2024-11-05 13:39:06,694:WARNING: 		 linear_patch: 2d
2024-11-05 13:39:06,695:WARNING: 	 cut_top_layer: 0
2024-11-05 13:39:21,016:WARNING: 	 sim_header: Filip
2024-11-05 13:40:27,420:INFO: --------------------
2024-11-05 13:40:27,423:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-11-05 13:40:28,466:INFO: ***** Running test *****
2024-11-05 13:40:28,468:INFO:   Num examples = 2348
2024-11-05 13:40:28,468:INFO:   Batch size = 256
2024-11-05 13:40:28,469:INFO:   Num steps = 10
2024-11-05 13:40:29,620:WARNING: Eval under the multi-sentence per video clip setting.
2024-11-05 13:40:29,621:WARNING: sentence num: 1969, video num: 2348
2024-11-05 13:41:03,347:INFO: before reshape, sim matrix size: 2348 x 1969
2024-11-05 13:41:04,522:INFO: after reshape, sim matrix size: 1969 x 3 x 1969
2024-11-05 13:41:14,821:INFO: Mix_Text-to-Video:
2024-11-05 13:41:14,823:INFO: 	>>>  R@1: 56.7 - R@5: 69.9 - R@10: 74.7 - Median R: 1.0 - Mean R: 64.1
2024-11-05 13:41:14,824:INFO: Mix_Video-to-Text:
2024-11-05 13:41:14,825:INFO: 	>>>  V2T$R@1: 51.5 - V2T$R@5: 64.9 - V2T$R@10: 70.2 - V2T$Median R: 1.0 - V2T$Mean R: 77.5
2024-11-05 13:43:24,966:INFO: Effective parameters:
2024-11-05 13:43:24,967:INFO:   <<< alpha: 0.9
2024-11-05 13:43:24,968:INFO:   <<< aug_choose: t2v
2024-11-05 13:43:24,968:INFO:   <<< batch_size: 512
2024-11-05 13:43:24,969:INFO:   <<< batch_size_val: 256
2024-11-05 13:43:24,969:INFO:   <<< cache_dir: 
2024-11-05 13:43:24,970:INFO:   <<< cla_weight_dir: cla_weight
2024-11-05 13:43:24,970:INFO:   <<< coef_lr: 1.0
2024-11-05 13:43:24,971:INFO:   <<< combine_type: sum
2024-11-05 13:43:24,971:INFO:   <<< cross_att_layers: 1
2024-11-05 13:43:24,971:INFO:   <<< cross_model: cross-base
2024-11-05 13:43:24,972:INFO:   <<< cross_num_hidden_layers: 4
2024-11-05 13:43:24,972:INFO:   <<< data_path: data_ph
2024-11-05 13:43:24,973:INFO:   <<< datatype: ph
2024-11-05 13:43:24,973:INFO:   <<< debug: False
2024-11-05 13:43:24,973:INFO:   <<< distributed: True
2024-11-05 13:43:24,974:INFO:   <<< do_eval: True
2024-11-05 13:43:24,974:INFO:   <<< do_lower_case: False
2024-11-05 13:43:24,975:INFO:   <<< do_pretrain: False
2024-11-05 13:43:24,975:INFO:   <<< do_train: False
2024-11-05 13:43:24,975:INFO:   <<< dual_mix: 0.5
2024-11-05 13:43:24,976:INFO:   <<< epochs: 200
2024-11-05 13:43:24,976:INFO:   <<< eval_frame_order: 0
2024-11-05 13:43:24,977:INFO:   <<< expand_msrvtt_sentences: False
2024-11-05 13:43:24,977:INFO:   <<< feature_framerate: 1
2024-11-05 13:43:24,978:INFO:   <<< feature_len: 64
2024-11-05 13:43:24,978:INFO:   <<< features_path: sign_feature/ph_domain_agnostic
2024-11-05 13:43:24,978:INFO:   <<< features_path_retrain: sign_feature/ph_domain_aware
2024-11-05 13:43:24,979:INFO:   <<< fp16: True
2024-11-05 13:43:24,979:INFO:   <<< fp16_opt_level: O1
2024-11-05 13:43:24,980:INFO:   <<< freeze_layer_num: 0
2024-11-05 13:43:24,980:INFO:   <<< gpu_ids: [0, 1]
2024-11-05 13:43:24,981:INFO:   <<< gradient_accumulation_steps: 1
2024-11-05 13:43:24,981:INFO:   <<< hard_negative_rate: 0.5
2024-11-05 13:43:24,981:INFO:   <<< init_model: chpt/ph_sota.pth
2024-11-05 13:43:24,982:INFO:   <<< linear_patch: 2d
2024-11-05 13:43:24,982:INFO:   <<< local_rank: 0
2024-11-05 13:43:24,983:INFO:   <<< loose_type: True
2024-11-05 13:43:24,983:INFO:   <<< lr: 1e-05
2024-11-05 13:43:24,983:INFO:   <<< lr_decay: 0.001
2024-11-05 13:43:24,984:INFO:   <<< margin: 0.1
2024-11-05 13:43:24,984:INFO:   <<< max_frames: 128
2024-11-05 13:43:24,985:INFO:   <<< max_words: 32
2024-11-05 13:43:24,985:INFO:   <<< mix_design: balance
2024-11-05 13:43:24,985:INFO:   <<< n_display: 1
2024-11-05 13:43:24,986:INFO:   <<< n_gpu: 1
2024-11-05 13:43:24,986:INFO:   <<< n_pair: 1
2024-11-05 13:43:24,987:INFO:   <<< negative_weighting: 1
2024-11-05 13:43:24,987:INFO:   <<< not_load_visual: False
2024-11-05 13:43:24,987:INFO:   <<< num_thread_reader: 8
2024-11-05 13:43:24,988:INFO:   <<< output_dir: new_experiment
2024-11-05 13:43:24,988:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-11-05 13:43:24,989:INFO:   <<< rank: 0
2024-11-05 13:43:24,989:INFO:   <<< resume_model: None
2024-11-05 13:43:24,990:INFO:   <<< sampled_use_mil: False
2024-11-05 13:43:24,990:INFO:   <<< seed: 42
2024-11-05 13:43:24,990:INFO:   <<< sim_calcu: softmax_max
2024-11-05 13:43:24,991:INFO:   <<< sim_header: Filip
2024-11-05 13:43:24,991:INFO:   <<< slice_framepos: 0
2024-11-05 13:43:24,992:INFO:   <<< task_type: retrieval
2024-11-05 13:43:24,992:INFO:   <<< tau: 0.07
2024-11-05 13:43:24,992:INFO:   <<< text_aug: True
2024-11-05 13:43:24,993:INFO:   <<< text_aug_choosen: random_swap
2024-11-05 13:43:24,993:INFO:   <<< text_num_hidden_layers: 12
2024-11-05 13:43:24,994:INFO:   <<< train_frame_order: 0
2024-11-05 13:43:24,994:INFO:   <<< use_mil: False
2024-11-05 13:43:24,994:INFO:   <<< video_dim: 1024
2024-11-05 13:43:24,995:INFO:   <<< visual_num_hidden_layers: 12
2024-11-05 13:43:24,995:INFO:   <<< warmup_proportion: 0.1
2024-11-05 13:43:24,996:INFO:   <<< world_size: 1
2024-11-05 13:43:24,999:INFO: device: cuda:0 n_gpu: 1
2024-11-05 13:47:31,926:INFO: Effective parameters:
2024-11-05 13:47:31,927:INFO:   <<< alpha: 0.9
2024-11-05 13:47:31,928:INFO:   <<< aug_choose: t2v
2024-11-05 13:47:31,928:INFO:   <<< batch_size: 512
2024-11-05 13:47:31,929:INFO:   <<< batch_size_val: 256
2024-11-05 13:47:31,929:INFO:   <<< cache_dir: 
2024-11-05 13:47:31,930:INFO:   <<< cla_weight_dir: cla_weight
2024-11-05 13:47:31,930:INFO:   <<< coef_lr: 1.0
2024-11-05 13:47:31,931:INFO:   <<< combine_type: sum
2024-11-05 13:47:31,931:INFO:   <<< cross_att_layers: 1
2024-11-05 13:47:31,932:INFO:   <<< cross_model: cross-base
2024-11-05 13:47:31,932:INFO:   <<< cross_num_hidden_layers: 4
2024-11-05 13:47:31,932:INFO:   <<< data_path: data_ph
2024-11-05 13:47:31,933:INFO:   <<< datatype: ph
2024-11-05 13:47:31,933:INFO:   <<< debug: False
2024-11-05 13:47:31,933:INFO:   <<< distributed: True
2024-11-05 13:47:31,934:INFO:   <<< do_eval: True
2024-11-05 13:47:31,934:INFO:   <<< do_lower_case: False
2024-11-05 13:47:31,935:INFO:   <<< do_pretrain: False
2024-11-05 13:47:31,935:INFO:   <<< do_train: False
2024-11-05 13:47:31,935:INFO:   <<< dual_mix: 0.5
2024-11-05 13:47:31,936:INFO:   <<< epochs: 200
2024-11-05 13:47:31,936:INFO:   <<< eval_frame_order: 0
2024-11-05 13:47:31,937:INFO:   <<< expand_msrvtt_sentences: False
2024-11-05 13:47:31,937:INFO:   <<< feature_framerate: 1
2024-11-05 13:47:31,937:INFO:   <<< feature_len: 64
2024-11-05 13:47:31,938:INFO:   <<< features_path: sign_feature/ph_domain_agnostic
2024-11-05 13:47:31,938:INFO:   <<< features_path_retrain: sign_feature/ph_domain_aware
2024-11-05 13:47:31,939:INFO:   <<< fp16: True
2024-11-05 13:47:31,939:INFO:   <<< fp16_opt_level: O1
2024-11-05 13:47:31,939:INFO:   <<< freeze_layer_num: 0
2024-11-05 13:47:31,940:INFO:   <<< gpu_ids: [0, 1]
2024-11-05 13:47:31,940:INFO:   <<< gradient_accumulation_steps: 1
2024-11-05 13:47:31,941:INFO:   <<< hard_negative_rate: 0.5
2024-11-05 13:47:31,941:INFO:   <<< init_model: chpt/ph_sota.pth
2024-11-05 13:47:31,941:INFO:   <<< linear_patch: 2d
2024-11-05 13:47:31,942:INFO:   <<< local_rank: 0
2024-11-05 13:47:31,942:INFO:   <<< loose_type: True
2024-11-05 13:47:31,943:INFO:   <<< lr: 1e-05
2024-11-05 13:47:31,943:INFO:   <<< lr_decay: 0.001
2024-11-05 13:47:31,944:INFO:   <<< margin: 0.1
2024-11-05 13:47:31,944:INFO:   <<< max_frames: 128
2024-11-05 13:47:31,944:INFO:   <<< max_words: 32
2024-11-05 13:47:31,945:INFO:   <<< mix_design: balance
2024-11-05 13:47:31,945:INFO:   <<< n_display: 1
2024-11-05 13:47:31,945:INFO:   <<< n_gpu: 1
2024-11-05 13:47:31,946:INFO:   <<< n_pair: 1
2024-11-05 13:47:31,946:INFO:   <<< negative_weighting: 1
2024-11-05 13:47:31,947:INFO:   <<< not_load_visual: False
2024-11-05 13:47:31,947:INFO:   <<< num_thread_reader: 8
2024-11-05 13:47:31,947:INFO:   <<< output_dir: new_experiment
2024-11-05 13:47:31,948:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-11-05 13:47:31,948:INFO:   <<< rank: 0
2024-11-05 13:47:31,949:INFO:   <<< resume_model: None
2024-11-05 13:47:31,949:INFO:   <<< sampled_use_mil: False
2024-11-05 13:47:31,950:INFO:   <<< seed: 42
2024-11-05 13:47:31,950:INFO:   <<< sim_calcu: softmax_max
2024-11-05 13:47:31,950:INFO:   <<< sim_header: Filip
2024-11-05 13:47:31,951:INFO:   <<< slice_framepos: 0
2024-11-05 13:47:31,951:INFO:   <<< task_type: retrieval
2024-11-05 13:47:31,952:INFO:   <<< tau: 0.07
2024-11-05 13:47:31,952:INFO:   <<< text_aug: True
2024-11-05 13:47:31,952:INFO:   <<< text_aug_choosen: random_swap
2024-11-05 13:47:31,953:INFO:   <<< text_num_hidden_layers: 12
2024-11-05 13:47:31,953:INFO:   <<< train_frame_order: 0
2024-11-05 13:47:31,953:INFO:   <<< use_mil: False
2024-11-05 13:47:31,954:INFO:   <<< video_dim: 1024
2024-11-05 13:47:31,954:INFO:   <<< visual_num_hidden_layers: 12
2024-11-05 13:47:31,955:INFO:   <<< warmup_proportion: 0.1
2024-11-05 13:47:31,955:INFO:   <<< world_size: 1
2024-11-05 13:47:31,958:INFO: device: cuda:0 n_gpu: 1
2024-11-05 13:47:42,253:INFO: loading archive file /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base
2024-11-05 13:47:42,260:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-11-05 13:47:42,264:INFO: Weight doesn't exsits. /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base/cross_pytorch_model.bin
2024-11-05 13:47:42,265:WARNING: Stage-One:True, Stage-Two:False
2024-11-05 13:47:42,265:WARNING: Test retrieval by loose type.
2024-11-05 13:47:42,267:WARNING: 	 embed_dim: 512
2024-11-05 13:47:42,268:WARNING: 	 image_resolution: 224
2024-11-05 13:47:42,268:WARNING: 	 vision_layers: 12
2024-11-05 13:47:42,269:WARNING: 	 vision_width: 768
2024-11-05 13:47:42,269:WARNING: 	 vision_patch_size: 32
2024-11-05 13:47:42,270:WARNING: 	 context_length: 77
2024-11-05 13:47:42,270:WARNING: 	 vocab_size: 49408
2024-11-05 13:47:42,271:WARNING: 	 transformer_width: 512
2024-11-05 13:47:42,271:WARNING: 	 transformer_heads: 8
2024-11-05 13:47:42,272:WARNING: 	 transformer_layers: 12
2024-11-05 13:47:42,272:WARNING: 		 linear_patch: 2d
2024-11-05 13:47:42,273:WARNING: 	 cut_top_layer: 0
2024-11-05 13:47:56,081:WARNING: 	 sim_header: Filip
2024-11-05 13:48:56,867:INFO: --------------------
2024-11-05 13:48:56,869:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-11-05 13:48:57,457:INFO: ***** Running test *****
2024-11-05 13:48:57,458:INFO:   Num examples = 642
2024-11-05 13:48:57,459:INFO:   Batch size = 256
2024-11-05 13:48:57,460:INFO:   Num steps = 3
2024-11-05 13:48:58,983:WARNING: Eval under the multi-sentence per video clip setting.
2024-11-05 13:48:58,984:WARNING: sentence num: 642, video num: 642
2024-11-05 13:49:15,785:INFO: before reshape, sim matrix size: 642 x 642
2024-11-05 13:49:15,882:INFO: after reshape, sim matrix size: 642 x 1 x 642
2024-11-05 13:49:16,476:INFO: Mix_Text-to-Video:
2024-11-05 13:49:16,478:INFO: 	>>>  R@1: 69.5 - R@5: 86.6 - R@10: 92.1 - Median R: 1.0 - Mean R: 5.1
2024-11-05 13:49:16,479:INFO: Mix_Video-to-Text:
2024-11-05 13:49:16,480:INFO: 	>>>  V2T$R@1: 70.4 - V2T$R@5: 88.0 - V2T$R@10: 92.7 - V2T$Median R: 1.0 - V2T$Mean R: 5.8
2024-11-05 13:52:55,692:INFO: Effective parameters:
2024-11-05 13:52:55,694:INFO:   <<< alpha: 0.8
2024-11-05 13:52:55,696:INFO:   <<< aug_choose: t2v
2024-11-05 13:52:55,697:INFO:   <<< batch_size: 512
2024-11-05 13:52:55,698:INFO:   <<< batch_size_val: 256
2024-11-05 13:52:55,699:INFO:   <<< cache_dir: 
2024-11-05 13:52:55,700:INFO:   <<< cla_weight_dir: cla_weight
2024-11-05 13:52:55,701:INFO:   <<< coef_lr: 1.0
2024-11-05 13:52:55,703:INFO:   <<< combine_type: sum
2024-11-05 13:52:55,703:INFO:   <<< cross_att_layers: 1
2024-11-05 13:52:55,704:INFO:   <<< cross_model: cross-base
2024-11-05 13:52:55,705:INFO:   <<< cross_num_hidden_layers: 4
2024-11-05 13:52:55,706:INFO:   <<< data_path: data_csl
2024-11-05 13:52:55,707:INFO:   <<< datatype: csl
2024-11-05 13:52:55,708:INFO:   <<< debug: False
2024-11-05 13:52:55,709:INFO:   <<< distributed: True
2024-11-05 13:52:55,710:INFO:   <<< do_eval: True
2024-11-05 13:52:55,711:INFO:   <<< do_lower_case: False
2024-11-05 13:52:55,712:INFO:   <<< do_pretrain: False
2024-11-05 13:52:55,713:INFO:   <<< do_train: False
2024-11-05 13:52:55,714:INFO:   <<< dual_mix: 0.5
2024-11-05 13:52:55,715:INFO:   <<< epochs: 200
2024-11-05 13:52:55,716:INFO:   <<< eval_frame_order: 0
2024-11-05 13:52:55,717:INFO:   <<< expand_msrvtt_sentences: False
2024-11-05 13:52:55,718:INFO:   <<< feature_framerate: 1
2024-11-05 13:52:55,719:INFO:   <<< feature_len: 64
2024-11-05 13:52:55,720:INFO:   <<< features_path: sign_feature/csl_domain_agnostic
2024-11-05 13:52:55,721:INFO:   <<< features_path_retrain: sign_feature/csl_domain_aware
2024-11-05 13:52:55,722:INFO:   <<< fp16: True
2024-11-05 13:52:55,723:INFO:   <<< fp16_opt_level: O1
2024-11-05 13:52:55,724:INFO:   <<< freeze_layer_num: 0
2024-11-05 13:52:55,725:INFO:   <<< gpu_ids: [0, 1]
2024-11-05 13:52:55,726:INFO:   <<< gradient_accumulation_steps: 1
2024-11-05 13:52:55,727:INFO:   <<< hard_negative_rate: 0.5
2024-11-05 13:52:55,727:INFO:   <<< init_model: chpt/csl_sota.pth
2024-11-05 13:52:55,728:INFO:   <<< linear_patch: 2d
2024-11-05 13:52:55,729:INFO:   <<< local_rank: 0
2024-11-05 13:52:55,730:INFO:   <<< loose_type: True
2024-11-05 13:52:55,731:INFO:   <<< lr: 1e-05
2024-11-05 13:52:55,732:INFO:   <<< lr_decay: 0.001
2024-11-05 13:52:55,733:INFO:   <<< margin: 0.1
2024-11-05 13:52:55,735:INFO:   <<< max_frames: 128
2024-11-05 13:52:55,736:INFO:   <<< max_words: 32
2024-11-05 13:52:55,737:INFO:   <<< mix_design: balance
2024-11-05 13:52:55,738:INFO:   <<< n_display: 1
2024-11-05 13:52:55,739:INFO:   <<< n_gpu: 1
2024-11-05 13:52:55,740:INFO:   <<< n_pair: 1
2024-11-05 13:52:55,741:INFO:   <<< negative_weighting: 1
2024-11-05 13:52:55,742:INFO:   <<< not_load_visual: False
2024-11-05 13:52:55,743:INFO:   <<< num_thread_reader: 8
2024-11-05 13:52:55,744:INFO:   <<< output_dir: new_experiment
2024-11-05 13:52:55,745:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-11-05 13:52:55,746:INFO:   <<< rank: 0
2024-11-05 13:52:55,747:INFO:   <<< resume_model: None
2024-11-05 13:52:55,748:INFO:   <<< sampled_use_mil: False
2024-11-05 13:52:55,749:INFO:   <<< seed: 42
2024-11-05 13:52:55,750:INFO:   <<< sim_calcu: softmax_max
2024-11-05 13:52:55,751:INFO:   <<< sim_header: Filip
2024-11-05 13:52:55,752:INFO:   <<< slice_framepos: 0
2024-11-05 13:52:55,753:INFO:   <<< task_type: retrieval
2024-11-05 13:52:55,754:INFO:   <<< tau: 0.07
2024-11-05 13:52:55,755:INFO:   <<< text_aug: True
2024-11-05 13:52:55,756:INFO:   <<< text_aug_choosen: random_swap
2024-11-05 13:52:55,757:INFO:   <<< text_num_hidden_layers: 12
2024-11-05 13:52:55,758:INFO:   <<< train_frame_order: 0
2024-11-05 13:52:55,759:INFO:   <<< use_mil: False
2024-11-05 13:52:55,760:INFO:   <<< video_dim: 1024
2024-11-05 13:52:55,761:INFO:   <<< visual_num_hidden_layers: 12
2024-11-05 13:52:55,762:INFO:   <<< warmup_proportion: 0.1
2024-11-05 13:52:55,763:INFO:   <<< world_size: 1
2024-11-05 13:52:55,767:INFO: device: cuda:0 n_gpu: 1
2024-11-05 13:53:05,931:INFO: loading archive file /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base
2024-11-05 13:53:05,949:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-11-05 13:53:05,961:INFO: Weight doesn't exsits. /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base/cross_pytorch_model.bin
2024-11-05 13:53:05,963:WARNING: Stage-One:True, Stage-Two:False
2024-11-05 13:53:05,964:WARNING: Test retrieval by loose type.
2024-11-05 13:53:05,967:WARNING: 	 embed_dim: 512
2024-11-05 13:53:05,968:WARNING: 	 image_resolution: 224
2024-11-05 13:53:05,969:WARNING: 	 vision_layers: 12
2024-11-05 13:53:05,971:WARNING: 	 vision_width: 768
2024-11-05 13:53:05,972:WARNING: 	 vision_patch_size: 32
2024-11-05 13:53:05,974:WARNING: 	 context_length: 77
2024-11-05 13:53:05,975:WARNING: 	 vocab_size: 49408
2024-11-05 13:53:05,976:WARNING: 	 transformer_width: 512
2024-11-05 13:53:05,978:WARNING: 	 transformer_heads: 8
2024-11-05 13:53:05,979:WARNING: 	 transformer_layers: 12
2024-11-05 13:53:05,980:WARNING: 		 linear_patch: 2d
2024-11-05 13:53:05,982:WARNING: 	 cut_top_layer: 0
2024-11-05 13:53:20,787:WARNING: 	 sim_header: Filip
2024-11-05 13:54:24,340:INFO: --------------------
2024-11-05 13:54:24,344:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-11-05 13:54:25,131:INFO: ***** Running test *****
2024-11-05 13:54:25,132:INFO:   Num examples = 1176
2024-11-05 13:54:25,134:INFO:   Batch size = 256
2024-11-05 13:54:25,135:INFO:   Num steps = 5
2024-11-05 13:54:27,821:WARNING: Eval under the multi-sentence per video clip setting.
2024-11-05 13:54:27,822:WARNING: sentence num: 798, video num: 1176
2024-11-05 13:54:52,983:INFO: before reshape, sim matrix size: 1176 x 798
2024-11-05 13:54:53,191:INFO: after reshape, sim matrix size: 798 x 2 x 798
2024-11-05 13:54:54,474:INFO: Mix_Text-to-Video:
2024-11-05 13:54:54,475:INFO: 	>>>  R@1: 75.1 - R@5: 87.6 - R@10: 91.6 - Median R: 1.0 - Mean R: 6.0
2024-11-05 13:54:54,477:INFO: Mix_Video-to-Text:
2024-11-05 13:54:54,478:INFO: 	>>>  V2T$R@1: 74.9 - V2T$R@5: 88.9 - V2T$R@10: 92.3 - V2T$Median R: 1.0 - V2T$Mean R: 6.0
2024-11-05 14:03:52,175:INFO: Effective parameters:
2024-11-05 14:03:52,176:INFO:   <<< alpha: 0.8
2024-11-05 14:03:52,177:INFO:   <<< aug_choose: t2v
2024-11-05 14:03:52,177:INFO:   <<< batch_size: 512
2024-11-05 14:03:52,178:INFO:   <<< batch_size_val: 256
2024-11-05 14:03:52,178:INFO:   <<< cache_dir: 
2024-11-05 14:03:52,178:INFO:   <<< cla_weight_dir: cla_weight
2024-11-05 14:03:52,179:INFO:   <<< coef_lr: 1.0
2024-11-05 14:03:52,179:INFO:   <<< combine_type: sum
2024-11-05 14:03:52,180:INFO:   <<< cross_att_layers: 1
2024-11-05 14:03:52,180:INFO:   <<< cross_model: cross-base
2024-11-05 14:03:52,180:INFO:   <<< cross_num_hidden_layers: 4
2024-11-05 14:03:52,181:INFO:   <<< data_path: data_csl
2024-11-05 14:03:52,181:INFO:   <<< datatype: csl
2024-11-05 14:03:52,182:INFO:   <<< debug: False
2024-11-05 14:03:52,182:INFO:   <<< distributed: True
2024-11-05 14:03:52,182:INFO:   <<< do_eval: True
2024-11-05 14:03:52,183:INFO:   <<< do_lower_case: False
2024-11-05 14:03:52,183:INFO:   <<< do_pretrain: False
2024-11-05 14:03:52,184:INFO:   <<< do_train: False
2024-11-05 14:03:52,184:INFO:   <<< dual_mix: 0.5
2024-11-05 14:03:52,184:INFO:   <<< epochs: 200
2024-11-05 14:03:52,185:INFO:   <<< eval_frame_order: 0
2024-11-05 14:03:52,185:INFO:   <<< expand_msrvtt_sentences: False
2024-11-05 14:03:52,186:INFO:   <<< feature_framerate: 1
2024-11-05 14:03:52,186:INFO:   <<< feature_len: 64
2024-11-05 14:03:52,187:INFO:   <<< features_path: sign_feature/csl_domain_agnostic
2024-11-05 14:03:52,187:INFO:   <<< features_path_retrain: sign_feature/csl_domain_aware
2024-11-05 14:03:52,187:INFO:   <<< fp16: True
2024-11-05 14:03:52,188:INFO:   <<< fp16_opt_level: O1
2024-11-05 14:03:52,188:INFO:   <<< freeze_layer_num: 0
2024-11-05 14:03:52,189:INFO:   <<< gpu_ids: [0, 1]
2024-11-05 14:03:52,189:INFO:   <<< gradient_accumulation_steps: 1
2024-11-05 14:03:52,189:INFO:   <<< hard_negative_rate: 0.5
2024-11-05 14:03:52,190:INFO:   <<< init_model: chpt/csl_sota.pth
2024-11-05 14:03:52,190:INFO:   <<< linear_patch: 2d
2024-11-05 14:03:52,191:INFO:   <<< local_rank: 0
2024-11-05 14:03:52,191:INFO:   <<< loose_type: True
2024-11-05 14:03:52,191:INFO:   <<< lr: 1e-05
2024-11-05 14:03:52,192:INFO:   <<< lr_decay: 0.001
2024-11-05 14:03:52,192:INFO:   <<< margin: 0.1
2024-11-05 14:03:52,193:INFO:   <<< max_frames: 128
2024-11-05 14:03:52,193:INFO:   <<< max_words: 32
2024-11-05 14:03:52,193:INFO:   <<< mix_design: balance
2024-11-05 14:03:52,194:INFO:   <<< n_display: 1
2024-11-05 14:03:52,194:INFO:   <<< n_gpu: 1
2024-11-05 14:03:52,195:INFO:   <<< n_pair: 1
2024-11-05 14:03:52,195:INFO:   <<< negative_weighting: 1
2024-11-05 14:03:52,195:INFO:   <<< not_load_visual: False
2024-11-05 14:03:52,196:INFO:   <<< num_thread_reader: 8
2024-11-05 14:03:52,196:INFO:   <<< output_dir: new_experiment
2024-11-05 14:03:52,197:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-11-05 14:03:52,197:INFO:   <<< rank: 0
2024-11-05 14:03:52,197:INFO:   <<< resume_model: None
2024-11-05 14:03:52,198:INFO:   <<< sampled_use_mil: False
2024-11-05 14:03:52,198:INFO:   <<< seed: 42
2024-11-05 14:03:52,199:INFO:   <<< sim_calcu: softmax_max
2024-11-05 14:03:52,199:INFO:   <<< sim_header: Filip
2024-11-05 14:03:52,199:INFO:   <<< slice_framepos: 0
2024-11-05 14:03:52,200:INFO:   <<< task_type: retrieval
2024-11-05 14:03:52,200:INFO:   <<< tau: 0.07
2024-11-05 14:03:52,201:INFO:   <<< text_aug: True
2024-11-05 14:03:52,201:INFO:   <<< text_aug_choosen: random_swap
2024-11-05 14:03:52,201:INFO:   <<< text_num_hidden_layers: 12
2024-11-05 14:03:52,202:INFO:   <<< train_frame_order: 0
2024-11-05 14:03:52,202:INFO:   <<< use_mil: False
2024-11-05 14:03:52,203:INFO:   <<< video_dim: 1024
2024-11-05 14:03:52,203:INFO:   <<< visual_num_hidden_layers: 12
2024-11-05 14:03:52,203:INFO:   <<< warmup_proportion: 0.1
2024-11-05 14:03:52,204:INFO:   <<< world_size: 1
2024-11-05 14:03:52,207:INFO: device: cuda:0 n_gpu: 1
2024-11-05 14:04:01,807:INFO: loading archive file /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base
2024-11-05 14:04:01,825:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-11-05 14:04:01,836:INFO: Weight doesn't exsits. /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base/cross_pytorch_model.bin
2024-11-05 14:04:01,838:WARNING: Stage-One:True, Stage-Two:False
2024-11-05 14:04:01,839:WARNING: Test retrieval by loose type.
2024-11-05 14:04:01,841:WARNING: 	 embed_dim: 512
2024-11-05 14:04:01,842:WARNING: 	 image_resolution: 224
2024-11-05 14:04:01,842:WARNING: 	 vision_layers: 12
2024-11-05 14:04:01,843:WARNING: 	 vision_width: 768
2024-11-05 14:04:01,843:WARNING: 	 vision_patch_size: 32
2024-11-05 14:04:01,844:WARNING: 	 context_length: 77
2024-11-05 14:04:01,844:WARNING: 	 vocab_size: 49408
2024-11-05 14:04:01,845:WARNING: 	 transformer_width: 512
2024-11-05 14:04:01,845:WARNING: 	 transformer_heads: 8
2024-11-05 14:04:01,846:WARNING: 	 transformer_layers: 12
2024-11-05 14:04:01,846:WARNING: 		 linear_patch: 2d
2024-11-05 14:04:01,847:WARNING: 	 cut_top_layer: 0
2024-11-05 14:04:16,251:WARNING: 	 sim_header: Filip
2024-11-05 14:05:18,862:INFO: --------------------
2024-11-05 14:05:18,866:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-11-05 14:05:19,597:INFO: ***** Running test *****
2024-11-05 14:05:19,597:INFO:   Num examples = 1176
2024-11-05 14:05:19,598:INFO:   Batch size = 256
2024-11-05 14:05:19,598:INFO:   Num steps = 5
2024-11-05 14:05:21,491:WARNING: Eval under the multi-sentence per video clip setting.
2024-11-05 14:05:21,492:WARNING: sentence num: 798, video num: 1176
2024-11-05 14:05:35,528:INFO: before reshape, sim matrix size: 1176 x 798
2024-11-05 14:05:35,988:INFO: after reshape, sim matrix size: 798 x 2 x 798
2024-11-05 14:05:37,360:INFO: Mix_Text-to-Video:
2024-11-05 14:05:37,363:INFO: 	>>>  R@1: 75.1 - R@5: 87.6 - R@10: 91.6 - Median R: 1.0 - Mean R: 6.0
2024-11-05 14:05:37,364:INFO: Mix_Video-to-Text:
2024-11-05 14:05:37,364:INFO: 	>>>  V2T$R@1: 74.9 - V2T$R@5: 88.9 - V2T$R@10: 92.3 - V2T$Median R: 1.0 - V2T$Mean R: 6.0
2024-11-05 15:30:23,642:INFO: Effective parameters:
2024-11-05 15:30:23,644:INFO:   <<< alpha: 0.8
2024-11-05 15:30:23,644:INFO:   <<< aug_choose: t2v
2024-11-05 15:30:23,645:INFO:   <<< batch_size: 512
2024-11-05 15:30:23,645:INFO:   <<< batch_size_val: 256
2024-11-05 15:30:23,645:INFO:   <<< cache_dir: 
2024-11-05 15:30:23,646:INFO:   <<< cla_weight_dir: cla_weight
2024-11-05 15:30:23,646:INFO:   <<< coef_lr: 1.0
2024-11-05 15:30:23,647:INFO:   <<< combine_type: sum
2024-11-05 15:30:23,647:INFO:   <<< cross_att_layers: 1
2024-11-05 15:30:23,648:INFO:   <<< cross_model: cross-base
2024-11-05 15:30:23,648:INFO:   <<< cross_num_hidden_layers: 4
2024-11-05 15:30:23,649:INFO:   <<< data_path: data_h2
2024-11-05 15:30:23,649:INFO:   <<< datatype: h2s
2024-11-05 15:30:23,649:INFO:   <<< debug: False
2024-11-05 15:30:23,650:INFO:   <<< distributed: True
2024-11-05 15:30:23,650:INFO:   <<< do_eval: True
2024-11-05 15:30:23,651:INFO:   <<< do_lower_case: False
2024-11-05 15:30:23,651:INFO:   <<< do_pretrain: False
2024-11-05 15:30:23,651:INFO:   <<< do_train: False
2024-11-05 15:30:23,652:INFO:   <<< dual_mix: 0.5
2024-11-05 15:30:23,652:INFO:   <<< epochs: 200
2024-11-05 15:30:23,653:INFO:   <<< eval_frame_order: 0
2024-11-05 15:30:23,653:INFO:   <<< expand_msrvtt_sentences: False
2024-11-05 15:30:23,653:INFO:   <<< feature_framerate: 1
2024-11-05 15:30:23,654:INFO:   <<< feature_len: 64
2024-11-05 15:30:23,654:INFO:   <<< features_path: sign_feature/h2s_domain_agnostic
2024-11-05 15:30:23,655:INFO:   <<< features_path_retrain: sign_feature/h2s_domain_aware
2024-11-05 15:30:23,655:INFO:   <<< fp16: True
2024-11-05 15:30:23,655:INFO:   <<< fp16_opt_level: O1
2024-11-05 15:30:23,656:INFO:   <<< freeze_layer_num: 0
2024-11-05 15:30:23,656:INFO:   <<< gpu_ids: [0, 1]
2024-11-05 15:30:23,657:INFO:   <<< gradient_accumulation_steps: 1
2024-11-05 15:30:23,657:INFO:   <<< hard_negative_rate: 0.5
2024-11-05 15:30:23,658:INFO:   <<< init_model: chpt/H2S_sota.pth
2024-11-05 15:30:23,658:INFO:   <<< linear_patch: 2d
2024-11-05 15:30:23,658:INFO:   <<< local_rank: 0
2024-11-05 15:30:23,659:INFO:   <<< loose_type: True
2024-11-05 15:30:23,659:INFO:   <<< lr: 1e-05
2024-11-05 15:30:23,660:INFO:   <<< lr_decay: 0.001
2024-11-05 15:30:23,660:INFO:   <<< margin: 0.1
2024-11-05 15:30:23,660:INFO:   <<< max_frames: 128
2024-11-05 15:30:23,661:INFO:   <<< max_words: 32
2024-11-05 15:30:23,661:INFO:   <<< mix_design: balance
2024-11-05 15:30:23,662:INFO:   <<< n_display: 1
2024-11-05 15:30:23,662:INFO:   <<< n_gpu: 1
2024-11-05 15:30:23,662:INFO:   <<< n_pair: 1
2024-11-05 15:30:23,663:INFO:   <<< negative_weighting: 1
2024-11-05 15:30:23,663:INFO:   <<< not_load_visual: False
2024-11-05 15:30:23,664:INFO:   <<< num_thread_reader: 8
2024-11-05 15:30:23,664:INFO:   <<< output_dir: new_experiment
2024-11-05 15:30:23,664:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-11-05 15:30:23,665:INFO:   <<< rank: 0
2024-11-05 15:30:23,665:INFO:   <<< resume_model: None
2024-11-05 15:30:23,666:INFO:   <<< sampled_use_mil: False
2024-11-05 15:30:23,666:INFO:   <<< seed: 42
2024-11-05 15:30:23,667:INFO:   <<< sim_calcu: softmax_max
2024-11-05 15:30:23,667:INFO:   <<< sim_header: Filip
2024-11-05 15:30:23,667:INFO:   <<< slice_framepos: 0
2024-11-05 15:30:23,668:INFO:   <<< task_type: retrieval
2024-11-05 15:30:23,668:INFO:   <<< tau: 0.07
2024-11-05 15:30:23,669:INFO:   <<< text_aug: True
2024-11-05 15:30:23,669:INFO:   <<< text_aug_choosen: random_swap
2024-11-05 15:30:23,669:INFO:   <<< text_num_hidden_layers: 12
2024-11-05 15:30:23,670:INFO:   <<< train_frame_order: 0
2024-11-05 15:30:23,670:INFO:   <<< use_mil: False
2024-11-05 15:30:23,671:INFO:   <<< video_dim: 1024
2024-11-05 15:30:23,671:INFO:   <<< visual_num_hidden_layers: 12
2024-11-05 15:30:23,671:INFO:   <<< warmup_proportion: 0.1
2024-11-05 15:30:23,672:INFO:   <<< world_size: 1
2024-11-05 15:30:23,675:INFO: device: cuda:0 n_gpu: 1
2024-11-05 15:30:33,239:INFO: loading archive file /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base
2024-11-05 15:30:33,248:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-11-05 15:30:33,250:INFO: Weight doesn't exsits. /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base/cross_pytorch_model.bin
2024-11-05 15:30:33,252:WARNING: Stage-One:True, Stage-Two:False
2024-11-05 15:30:33,252:WARNING: Test retrieval by loose type.
2024-11-05 15:30:33,254:WARNING: 	 embed_dim: 512
2024-11-05 15:30:33,255:WARNING: 	 image_resolution: 224
2024-11-05 15:30:33,255:WARNING: 	 vision_layers: 12
2024-11-05 15:30:33,256:WARNING: 	 vision_width: 768
2024-11-05 15:30:33,256:WARNING: 	 vision_patch_size: 32
2024-11-05 15:30:33,257:WARNING: 	 context_length: 77
2024-11-05 15:30:33,257:WARNING: 	 vocab_size: 49408
2024-11-05 15:30:33,258:WARNING: 	 transformer_width: 512
2024-11-05 15:30:33,258:WARNING: 	 transformer_heads: 8
2024-11-05 15:30:33,259:WARNING: 	 transformer_layers: 12
2024-11-05 15:30:33,259:WARNING: 		 linear_patch: 2d
2024-11-05 15:30:33,260:WARNING: 	 cut_top_layer: 0
2024-11-05 15:30:48,349:WARNING: 	 sim_header: Filip
2024-11-05 15:31:51,016:INFO: --------------------
2024-11-05 15:31:51,021:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-11-05 15:31:51,851:INFO: ***** Running test *****
2024-11-05 15:31:51,852:INFO:   Num examples = 2348
2024-11-05 15:31:51,852:INFO:   Batch size = 256
2024-11-05 15:31:51,853:INFO:   Num steps = 10
2024-11-05 15:31:53,407:WARNING: Eval under the multi-sentence per video clip setting.
2024-11-05 15:31:53,408:WARNING: sentence num: 1969, video num: 2348
2024-11-05 15:34:43,823:INFO: Effective parameters:
2024-11-05 15:34:43,824:INFO:   <<< alpha: 0.8
2024-11-05 15:34:43,825:INFO:   <<< aug_choose: t2v
2024-11-05 15:34:43,825:INFO:   <<< batch_size: 512
2024-11-05 15:34:43,825:INFO:   <<< batch_size_val: 256
2024-11-05 15:34:43,826:INFO:   <<< cache_dir: 
2024-11-05 15:34:43,827:INFO:   <<< cla_weight_dir: cla_weight
2024-11-05 15:34:43,828:INFO:   <<< coef_lr: 1.0
2024-11-05 15:34:43,828:INFO:   <<< combine_type: sum
2024-11-05 15:34:43,829:INFO:   <<< cross_att_layers: 1
2024-11-05 15:34:43,830:INFO:   <<< cross_model: cross-base
2024-11-05 15:34:43,831:INFO:   <<< cross_num_hidden_layers: 4
2024-11-05 15:34:43,833:INFO:   <<< data_path: data_h2
2024-11-05 15:34:43,834:INFO:   <<< datatype: h2s
2024-11-05 15:34:43,835:INFO:   <<< debug: False
2024-11-05 15:34:43,836:INFO:   <<< distributed: True
2024-11-05 15:34:43,837:INFO:   <<< do_eval: True
2024-11-05 15:34:43,838:INFO:   <<< do_lower_case: False
2024-11-05 15:34:43,839:INFO:   <<< do_pretrain: False
2024-11-05 15:34:43,840:INFO:   <<< do_train: False
2024-11-05 15:34:43,841:INFO:   <<< dual_mix: 0.5
2024-11-05 15:34:43,842:INFO:   <<< epochs: 200
2024-11-05 15:34:43,843:INFO:   <<< eval_frame_order: 0
2024-11-05 15:34:43,844:INFO:   <<< expand_msrvtt_sentences: False
2024-11-05 15:34:43,845:INFO:   <<< feature_framerate: 1
2024-11-05 15:34:43,846:INFO:   <<< feature_len: 64
2024-11-05 15:34:43,847:INFO:   <<< features_path: sign_feature/h2s_domain_agnostic
2024-11-05 15:34:43,848:INFO:   <<< features_path_retrain: sign_feature/h2s_domain_aware
2024-11-05 15:34:43,849:INFO:   <<< fp16: True
2024-11-05 15:34:43,850:INFO:   <<< fp16_opt_level: O1
2024-11-05 15:34:43,851:INFO:   <<< freeze_layer_num: 0
2024-11-05 15:34:43,852:INFO:   <<< gpu_ids: [0, 1]
2024-11-05 15:34:43,853:INFO:   <<< gradient_accumulation_steps: 1
2024-11-05 15:34:43,854:INFO:   <<< hard_negative_rate: 0.5
2024-11-05 15:34:43,855:INFO:   <<< init_model: chpt/H2S_sota.pth
2024-11-05 15:34:43,856:INFO:   <<< linear_patch: 2d
2024-11-05 15:34:43,857:INFO:   <<< local_rank: 0
2024-11-05 15:34:43,858:INFO:   <<< loose_type: True
2024-11-05 15:34:43,859:INFO:   <<< lr: 1e-05
2024-11-05 15:34:43,860:INFO:   <<< lr_decay: 0.001
2024-11-05 15:34:43,861:INFO:   <<< margin: 0.1
2024-11-05 15:34:43,862:INFO:   <<< max_frames: 128
2024-11-05 15:34:43,863:INFO:   <<< max_words: 32
2024-11-05 15:34:43,864:INFO:   <<< mix_design: balance
2024-11-05 15:34:43,865:INFO:   <<< n_display: 1
2024-11-05 15:34:43,866:INFO:   <<< n_gpu: 1
2024-11-05 15:34:43,867:INFO:   <<< n_pair: 1
2024-11-05 15:34:43,868:INFO:   <<< negative_weighting: 1
2024-11-05 15:34:43,869:INFO:   <<< not_load_visual: False
2024-11-05 15:34:43,870:INFO:   <<< num_thread_reader: 8
2024-11-05 15:34:43,871:INFO:   <<< output_dir: new_experiment
2024-11-05 15:34:43,872:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-11-05 15:34:43,873:INFO:   <<< rank: 0
2024-11-05 15:34:43,874:INFO:   <<< resume_model: None
2024-11-05 15:34:43,875:INFO:   <<< sampled_use_mil: False
2024-11-05 15:34:43,876:INFO:   <<< seed: 42
2024-11-05 15:34:43,877:INFO:   <<< sim_calcu: softmax_max
2024-11-05 15:34:43,878:INFO:   <<< sim_header: Filip
2024-11-05 15:34:43,879:INFO:   <<< slice_framepos: 0
2024-11-05 15:34:43,880:INFO:   <<< task_type: retrieval
2024-11-05 15:34:43,882:INFO:   <<< tau: 0.07
2024-11-05 15:34:43,883:INFO:   <<< text_aug: True
2024-11-05 15:34:43,884:INFO:   <<< text_aug_choosen: random_swap
2024-11-05 15:34:43,885:INFO:   <<< text_num_hidden_layers: 12
2024-11-05 15:34:43,886:INFO:   <<< train_frame_order: 0
2024-11-05 15:34:43,887:INFO:   <<< use_mil: False
2024-11-05 15:34:43,887:INFO:   <<< video_dim: 1024
2024-11-05 15:34:43,888:INFO:   <<< visual_num_hidden_layers: 12
2024-11-05 15:34:43,888:INFO:   <<< warmup_proportion: 0.1
2024-11-05 15:34:43,889:INFO:   <<< world_size: 1
2024-11-05 15:34:43,892:INFO: device: cuda:0 n_gpu: 1
2024-11-05 15:34:53,078:INFO: loading archive file /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base
2024-11-05 15:34:53,088:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-11-05 15:34:53,090:INFO: Weight doesn't exsits. /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base/cross_pytorch_model.bin
2024-11-05 15:34:53,091:WARNING: Stage-One:True, Stage-Two:False
2024-11-05 15:34:53,092:WARNING: Test retrieval by loose type.
2024-11-05 15:34:53,094:WARNING: 	 embed_dim: 512
2024-11-05 15:34:53,094:WARNING: 	 image_resolution: 224
2024-11-05 15:34:53,095:WARNING: 	 vision_layers: 12
2024-11-05 15:34:53,095:WARNING: 	 vision_width: 768
2024-11-05 15:34:53,096:WARNING: 	 vision_patch_size: 32
2024-11-05 15:34:53,096:WARNING: 	 context_length: 77
2024-11-05 15:34:53,097:WARNING: 	 vocab_size: 49408
2024-11-05 15:34:53,097:WARNING: 	 transformer_width: 512
2024-11-05 15:34:53,098:WARNING: 	 transformer_heads: 8
2024-11-05 15:34:53,098:WARNING: 	 transformer_layers: 12
2024-11-05 15:34:53,099:WARNING: 		 linear_patch: 2d
2024-11-05 15:34:53,099:WARNING: 	 cut_top_layer: 0
2024-11-05 15:35:07,501:WARNING: 	 sim_header: Filip
2024-11-05 15:36:03,307:INFO: Effective parameters:
2024-11-05 15:36:03,307:INFO:   <<< alpha: 0.8
2024-11-05 15:36:03,307:INFO:   <<< aug_choose: t2v
2024-11-05 15:36:03,307:INFO:   <<< batch_size: 512
2024-11-05 15:36:03,307:INFO:   <<< batch_size_val: 256
2024-11-05 15:36:03,308:INFO:   <<< cache_dir: 
2024-11-05 15:36:03,308:INFO:   <<< cla_weight_dir: cla_weight
2024-11-05 15:36:03,308:INFO:   <<< coef_lr: 1.0
2024-11-05 15:36:03,308:INFO:   <<< combine_type: sum
2024-11-05 15:36:03,308:INFO:   <<< cross_att_layers: 1
2024-11-05 15:36:03,308:INFO:   <<< cross_model: cross-base
2024-11-05 15:36:03,308:INFO:   <<< cross_num_hidden_layers: 4
2024-11-05 15:36:03,308:INFO:   <<< data_path: data_h2
2024-11-05 15:36:03,308:INFO:   <<< datatype: h2s
2024-11-05 15:36:03,308:INFO:   <<< debug: False
2024-11-05 15:36:03,308:INFO:   <<< distributed: True
2024-11-05 15:36:03,308:INFO:   <<< do_eval: True
2024-11-05 15:36:03,308:INFO:   <<< do_lower_case: False
2024-11-05 15:36:03,308:INFO:   <<< do_pretrain: False
2024-11-05 15:36:03,308:INFO:   <<< do_train: False
2024-11-05 15:36:03,308:INFO:   <<< dual_mix: 0.5
2024-11-05 15:36:03,308:INFO:   <<< epochs: 200
2024-11-05 15:36:03,308:INFO:   <<< eval_frame_order: 0
2024-11-05 15:36:03,308:INFO:   <<< expand_msrvtt_sentences: False
2024-11-05 15:36:03,308:INFO:   <<< feature_framerate: 1
2024-11-05 15:36:03,308:INFO:   <<< feature_len: 64
2024-11-05 15:36:03,308:INFO:   <<< features_path: sign_feature/h2s_domain_agnostic
2024-11-05 15:36:03,308:INFO:   <<< features_path_retrain: sign_feature/h2s_domain_aware
2024-11-05 15:36:03,308:INFO:   <<< fp16: True
2024-11-05 15:36:03,308:INFO:   <<< fp16_opt_level: O1
2024-11-05 15:36:03,308:INFO:   <<< freeze_layer_num: 0
2024-11-05 15:36:03,308:INFO:   <<< gpu_ids: [0, 1]
2024-11-05 15:36:03,308:INFO:   <<< gradient_accumulation_steps: 1
2024-11-05 15:36:03,308:INFO:   <<< hard_negative_rate: 0.5
2024-11-05 15:36:03,308:INFO:   <<< init_model: chpt/H2S_sota.pth
2024-11-05 15:36:03,308:INFO:   <<< linear_patch: 2d
2024-11-05 15:36:03,308:INFO:   <<< local_rank: 0
2024-11-05 15:36:03,308:INFO:   <<< loose_type: True
2024-11-05 15:36:03,308:INFO:   <<< lr: 1e-05
2024-11-05 15:36:03,308:INFO:   <<< lr_decay: 0.001
2024-11-05 15:36:03,308:INFO:   <<< margin: 0.1
2024-11-05 15:36:03,309:INFO:   <<< max_frames: 128
2024-11-05 15:36:03,309:INFO:   <<< max_words: 32
2024-11-05 15:36:03,309:INFO:   <<< mix_design: balance
2024-11-05 15:36:03,309:INFO:   <<< n_display: 1
2024-11-05 15:36:03,309:INFO:   <<< n_gpu: 1
2024-11-05 15:36:03,309:INFO:   <<< n_pair: 1
2024-11-05 15:36:03,309:INFO:   <<< negative_weighting: 1
2024-11-05 15:36:03,309:INFO:   <<< not_load_visual: False
2024-11-05 15:36:03,309:INFO:   <<< num_thread_reader: 8
2024-11-05 15:36:03,309:INFO:   <<< output_dir: new_experiment
2024-11-05 15:36:03,309:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-11-05 15:36:03,309:INFO:   <<< rank: 0
2024-11-05 15:36:03,309:INFO:   <<< resume_model: None
2024-11-05 15:36:03,309:INFO:   <<< sampled_use_mil: False
2024-11-05 15:36:03,309:INFO:   <<< seed: 42
2024-11-05 15:36:03,309:INFO:   <<< sim_calcu: softmax_max
2024-11-05 15:36:03,309:INFO:   <<< sim_header: Filip
2024-11-05 15:36:03,309:INFO:   <<< slice_framepos: 0
2024-11-05 15:36:03,309:INFO:   <<< task_type: retrieval
2024-11-05 15:36:03,309:INFO:   <<< tau: 0.07
2024-11-05 15:36:03,309:INFO:   <<< text_aug: True
2024-11-05 15:36:03,309:INFO:   <<< text_aug_choosen: random_swap
2024-11-05 15:36:03,309:INFO:   <<< text_num_hidden_layers: 12
2024-11-05 15:36:03,309:INFO:   <<< train_frame_order: 0
2024-11-05 15:36:03,309:INFO:   <<< use_mil: False
2024-11-05 15:36:03,309:INFO:   <<< video_dim: 1024
2024-11-05 15:36:03,309:INFO:   <<< visual_num_hidden_layers: 12
2024-11-05 15:36:03,309:INFO:   <<< warmup_proportion: 0.1
2024-11-05 15:36:03,309:INFO:   <<< world_size: 1
2024-11-05 15:36:03,310:INFO: device: cuda:0 n_gpu: 1
2024-11-05 15:36:05,078:INFO: loading archive file /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base
2024-11-05 15:36:05,080:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-11-05 15:36:05,080:INFO: Weight doesn't exsits. /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base/cross_pytorch_model.bin
2024-11-05 15:36:05,081:WARNING: Stage-One:True, Stage-Two:False
2024-11-05 15:36:05,081:WARNING: Test retrieval by loose type.
2024-11-05 15:36:05,081:WARNING: 	 embed_dim: 512
2024-11-05 15:36:05,081:WARNING: 	 image_resolution: 224
2024-11-05 15:36:05,081:WARNING: 	 vision_layers: 12
2024-11-05 15:36:05,081:WARNING: 	 vision_width: 768
2024-11-05 15:36:05,081:WARNING: 	 vision_patch_size: 32
2024-11-05 15:36:05,081:WARNING: 	 context_length: 77
2024-11-05 15:36:05,081:WARNING: 	 vocab_size: 49408
2024-11-05 15:36:05,081:WARNING: 	 transformer_width: 512
2024-11-05 15:36:05,081:WARNING: 	 transformer_heads: 8
2024-11-05 15:36:05,081:WARNING: 	 transformer_layers: 12
2024-11-05 15:36:05,081:WARNING: 		 linear_patch: 2d
2024-11-05 15:36:05,081:WARNING: 	 cut_top_layer: 0
2024-11-05 15:36:06,311:WARNING: 	 sim_header: Filip
2024-11-05 15:36:08,861:INFO: --------------------
2024-11-05 15:36:08,865:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-11-05 15:36:09,537:INFO: ***** Running test *****
2024-11-05 15:36:09,539:INFO:   Num examples = 2348
2024-11-05 15:36:09,540:INFO:   Batch size = 256
2024-11-05 15:36:09,541:INFO:   Num steps = 10
2024-11-05 15:36:11,514:WARNING: Eval under the multi-sentence per video clip setting.
2024-11-05 15:36:11,515:WARNING: sentence num: 1969, video num: 2348
2024-11-05 15:37:30,885:INFO: Effective parameters:
2024-11-05 15:37:30,885:INFO:   <<< alpha: 0.8
2024-11-05 15:37:30,885:INFO:   <<< aug_choose: t2v
2024-11-05 15:37:30,885:INFO:   <<< batch_size: 512
2024-11-05 15:37:30,885:INFO:   <<< batch_size_val: 256
2024-11-05 15:37:30,885:INFO:   <<< cache_dir: 
2024-11-05 15:37:30,885:INFO:   <<< cla_weight_dir: cla_weight
2024-11-05 15:37:30,885:INFO:   <<< coef_lr: 1.0
2024-11-05 15:37:30,885:INFO:   <<< combine_type: sum
2024-11-05 15:37:30,885:INFO:   <<< cross_att_layers: 1
2024-11-05 15:37:30,885:INFO:   <<< cross_model: cross-base
2024-11-05 15:37:30,885:INFO:   <<< cross_num_hidden_layers: 4
2024-11-05 15:37:30,885:INFO:   <<< data_path: data_h2
2024-11-05 15:37:30,885:INFO:   <<< datatype: h2s
2024-11-05 15:37:30,885:INFO:   <<< debug: False
2024-11-05 15:37:30,885:INFO:   <<< distributed: True
2024-11-05 15:37:30,885:INFO:   <<< do_eval: True
2024-11-05 15:37:30,885:INFO:   <<< do_lower_case: False
2024-11-05 15:37:30,885:INFO:   <<< do_pretrain: False
2024-11-05 15:37:30,885:INFO:   <<< do_train: False
2024-11-05 15:37:30,885:INFO:   <<< dual_mix: 0.5
2024-11-05 15:37:30,885:INFO:   <<< epochs: 200
2024-11-05 15:37:30,885:INFO:   <<< eval_frame_order: 0
2024-11-05 15:37:30,885:INFO:   <<< expand_msrvtt_sentences: False
2024-11-05 15:37:30,885:INFO:   <<< feature_framerate: 1
2024-11-05 15:37:30,885:INFO:   <<< feature_len: 64
2024-11-05 15:37:30,885:INFO:   <<< features_path: sign_feature/h2s_domain_agnostic
2024-11-05 15:37:30,885:INFO:   <<< features_path_retrain: sign_feature/h2s_domain_aware
2024-11-05 15:37:30,885:INFO:   <<< fp16: True
2024-11-05 15:37:30,886:INFO:   <<< fp16_opt_level: O1
2024-11-05 15:37:30,886:INFO:   <<< freeze_layer_num: 0
2024-11-05 15:37:30,886:INFO:   <<< gpu_ids: [0, 1]
2024-11-05 15:37:30,886:INFO:   <<< gradient_accumulation_steps: 1
2024-11-05 15:37:30,886:INFO:   <<< hard_negative_rate: 0.5
2024-11-05 15:37:30,886:INFO:   <<< init_model: chpt/H2S_sota.pth
2024-11-05 15:37:30,886:INFO:   <<< linear_patch: 2d
2024-11-05 15:37:30,886:INFO:   <<< local_rank: 0
2024-11-05 15:37:30,886:INFO:   <<< loose_type: True
2024-11-05 15:37:30,886:INFO:   <<< lr: 1e-05
2024-11-05 15:37:30,886:INFO:   <<< lr_decay: 0.001
2024-11-05 15:37:30,886:INFO:   <<< margin: 0.1
2024-11-05 15:37:30,886:INFO:   <<< max_frames: 128
2024-11-05 15:37:30,886:INFO:   <<< max_words: 32
2024-11-05 15:37:30,886:INFO:   <<< mix_design: balance
2024-11-05 15:37:30,886:INFO:   <<< n_display: 1
2024-11-05 15:37:30,886:INFO:   <<< n_gpu: 1
2024-11-05 15:37:30,886:INFO:   <<< n_pair: 1
2024-11-05 15:37:30,886:INFO:   <<< negative_weighting: 1
2024-11-05 15:37:30,886:INFO:   <<< not_load_visual: False
2024-11-05 15:37:30,886:INFO:   <<< num_thread_reader: 8
2024-11-05 15:37:30,886:INFO:   <<< output_dir: new_experiment
2024-11-05 15:37:30,886:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-11-05 15:37:30,886:INFO:   <<< rank: 0
2024-11-05 15:37:30,886:INFO:   <<< resume_model: None
2024-11-05 15:37:30,886:INFO:   <<< sampled_use_mil: False
2024-11-05 15:37:30,886:INFO:   <<< seed: 42
2024-11-05 15:37:30,886:INFO:   <<< sim_calcu: softmax_max
2024-11-05 15:37:30,886:INFO:   <<< sim_header: Filip
2024-11-05 15:37:30,886:INFO:   <<< slice_framepos: 0
2024-11-05 15:37:30,886:INFO:   <<< task_type: retrieval
2024-11-05 15:37:30,886:INFO:   <<< tau: 0.07
2024-11-05 15:37:30,886:INFO:   <<< text_aug: True
2024-11-05 15:37:30,886:INFO:   <<< text_aug_choosen: random_swap
2024-11-05 15:37:30,886:INFO:   <<< text_num_hidden_layers: 12
2024-11-05 15:37:30,886:INFO:   <<< train_frame_order: 0
2024-11-05 15:37:30,886:INFO:   <<< use_mil: False
2024-11-05 15:37:30,886:INFO:   <<< video_dim: 1024
2024-11-05 15:37:30,887:INFO:   <<< visual_num_hidden_layers: 12
2024-11-05 15:37:30,887:INFO:   <<< warmup_proportion: 0.1
2024-11-05 15:37:30,887:INFO:   <<< world_size: 1
2024-11-05 15:37:30,887:INFO: device: cuda:0 n_gpu: 1
2024-11-05 15:37:31,686:INFO: loading archive file /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base
2024-11-05 15:37:31,688:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-11-05 15:37:31,688:INFO: Weight doesn't exsits. /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base/cross_pytorch_model.bin
2024-11-05 15:37:31,689:WARNING: Stage-One:True, Stage-Two:False
2024-11-05 15:37:31,689:WARNING: Test retrieval by loose type.
2024-11-05 15:37:31,689:WARNING: 	 embed_dim: 512
2024-11-05 15:37:31,689:WARNING: 	 image_resolution: 224
2024-11-05 15:37:31,689:WARNING: 	 vision_layers: 12
2024-11-05 15:37:31,689:WARNING: 	 vision_width: 768
2024-11-05 15:37:31,689:WARNING: 	 vision_patch_size: 32
2024-11-05 15:37:31,689:WARNING: 	 context_length: 77
2024-11-05 15:37:31,689:WARNING: 	 vocab_size: 49408
2024-11-05 15:37:31,689:WARNING: 	 transformer_width: 512
2024-11-05 15:37:31,689:WARNING: 	 transformer_heads: 8
2024-11-05 15:37:31,689:WARNING: 	 transformer_layers: 12
2024-11-05 15:37:31,689:WARNING: 		 linear_patch: 2d
2024-11-05 15:37:31,689:WARNING: 	 cut_top_layer: 0
2024-11-05 15:37:32,916:WARNING: 	 sim_header: Filip
2024-11-05 15:37:39,650:INFO: --------------------
2024-11-05 15:37:39,651:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-11-05 15:37:39,738:INFO: ***** Running test *****
2024-11-05 15:37:39,738:INFO:   Num examples = 2348
2024-11-05 15:37:39,738:INFO:   Batch size = 256
2024-11-05 15:37:39,738:INFO:   Num steps = 10
2024-11-05 15:37:40,444:WARNING: Eval under the multi-sentence per video clip setting.
2024-11-05 15:37:40,444:WARNING: sentence num: 1969, video num: 2348
2024-11-05 15:37:44,336:INFO: before reshape, sim matrix size: 2348 x 1969
2024-11-05 15:37:44,771:INFO: after reshape, sim matrix size: 1969 x 3 x 1969
2024-11-05 15:37:45,676:INFO: Mix_Text-to-Video:
2024-11-05 15:37:45,677:INFO: 	>>>  R@1: 56.6 - R@5: 70.0 - R@10: 74.7 - Median R: 1.0 - Mean R: 64.1
2024-11-05 15:37:45,677:INFO: Mix_Video-to-Text:
2024-11-05 15:37:45,677:INFO: 	>>>  V2T$R@1: 51.6 - V2T$R@5: 64.7 - V2T$R@10: 70.0 - V2T$Median R: 1.0 - V2T$Mean R: 77.5
2024-11-05 15:43:45,486:INFO: Effective parameters:
2024-11-05 15:43:45,486:INFO:   <<< alpha: 0.8
2024-11-05 15:43:45,486:INFO:   <<< aug_choose: t2v
2024-11-05 15:43:45,486:INFO:   <<< batch_size: 512
2024-11-05 15:43:45,486:INFO:   <<< batch_size_val: 256
2024-11-05 15:43:45,486:INFO:   <<< cache_dir: 
2024-11-05 15:43:45,487:INFO:   <<< cla_weight_dir: cla_weight
2024-11-05 15:43:45,487:INFO:   <<< coef_lr: 1.0
2024-11-05 15:43:45,487:INFO:   <<< combine_type: sum
2024-11-05 15:43:45,487:INFO:   <<< cross_att_layers: 1
2024-11-05 15:43:45,487:INFO:   <<< cross_model: cross-base
2024-11-05 15:43:45,487:INFO:   <<< cross_num_hidden_layers: 4
2024-11-05 15:43:45,487:INFO:   <<< data_path: data_h2
2024-11-05 15:43:45,487:INFO:   <<< datatype: h2s
2024-11-05 15:43:45,487:INFO:   <<< debug: False
2024-11-05 15:43:45,487:INFO:   <<< distributed: True
2024-11-05 15:43:45,487:INFO:   <<< do_eval: True
2024-11-05 15:43:45,487:INFO:   <<< do_lower_case: False
2024-11-05 15:43:45,487:INFO:   <<< do_pretrain: False
2024-11-05 15:43:45,487:INFO:   <<< do_train: False
2024-11-05 15:43:45,487:INFO:   <<< dual_mix: 0.5
2024-11-05 15:43:45,487:INFO:   <<< epochs: 200
2024-11-05 15:43:45,487:INFO:   <<< eval_frame_order: 0
2024-11-05 15:43:45,487:INFO:   <<< expand_msrvtt_sentences: False
2024-11-05 15:43:45,487:INFO:   <<< feature_framerate: 1
2024-11-05 15:43:45,487:INFO:   <<< feature_len: 64
2024-11-05 15:43:45,487:INFO:   <<< features_path: sign_feature/h2s_domain_agnostic
2024-11-05 15:43:45,487:INFO:   <<< features_path_retrain: sign_feature/h2s_domain_aware
2024-11-05 15:43:45,487:INFO:   <<< fp16: True
2024-11-05 15:43:45,487:INFO:   <<< fp16_opt_level: O1
2024-11-05 15:43:45,487:INFO:   <<< freeze_layer_num: 0
2024-11-05 15:43:45,487:INFO:   <<< gpu_ids: [0, 1]
2024-11-05 15:43:45,487:INFO:   <<< gradient_accumulation_steps: 1
2024-11-05 15:43:45,487:INFO:   <<< hard_negative_rate: 0.5
2024-11-05 15:43:45,487:INFO:   <<< init_model: chpt/H2S_sota.pth
2024-11-05 15:43:45,487:INFO:   <<< linear_patch: 2d
2024-11-05 15:43:45,487:INFO:   <<< local_rank: 0
2024-11-05 15:43:45,487:INFO:   <<< loose_type: True
2024-11-05 15:43:45,487:INFO:   <<< lr: 1e-05
2024-11-05 15:43:45,487:INFO:   <<< lr_decay: 0.001
2024-11-05 15:43:45,487:INFO:   <<< margin: 0.1
2024-11-05 15:43:45,487:INFO:   <<< max_frames: 128
2024-11-05 15:43:45,487:INFO:   <<< max_words: 32
2024-11-05 15:43:45,488:INFO:   <<< mix_design: balance
2024-11-05 15:43:45,488:INFO:   <<< n_display: 1
2024-11-05 15:43:45,488:INFO:   <<< n_gpu: 1
2024-11-05 15:43:45,488:INFO:   <<< n_pair: 1
2024-11-05 15:43:45,488:INFO:   <<< negative_weighting: 1
2024-11-05 15:43:45,488:INFO:   <<< not_load_visual: False
2024-11-05 15:43:45,488:INFO:   <<< num_thread_reader: 8
2024-11-05 15:43:45,488:INFO:   <<< output_dir: new_experiment
2024-11-05 15:43:45,488:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-11-05 15:43:45,488:INFO:   <<< rank: 0
2024-11-05 15:43:45,488:INFO:   <<< resume_model: None
2024-11-05 15:43:45,488:INFO:   <<< sampled_use_mil: False
2024-11-05 15:43:45,488:INFO:   <<< seed: 42
2024-11-05 15:43:45,488:INFO:   <<< sim_calcu: softmax_max
2024-11-05 15:43:45,488:INFO:   <<< sim_header: Filip
2024-11-05 15:43:45,488:INFO:   <<< slice_framepos: 0
2024-11-05 15:43:45,488:INFO:   <<< task_type: retrieval
2024-11-05 15:43:45,488:INFO:   <<< tau: 0.07
2024-11-05 15:43:45,488:INFO:   <<< text_aug: True
2024-11-05 15:43:45,488:INFO:   <<< text_aug_choosen: random_swap
2024-11-05 15:43:45,488:INFO:   <<< text_num_hidden_layers: 12
2024-11-05 15:43:45,488:INFO:   <<< train_frame_order: 0
2024-11-05 15:43:45,488:INFO:   <<< use_mil: False
2024-11-05 15:43:45,488:INFO:   <<< video_dim: 1024
2024-11-05 15:43:45,488:INFO:   <<< visual_num_hidden_layers: 12
2024-11-05 15:43:45,488:INFO:   <<< warmup_proportion: 0.1
2024-11-05 15:43:45,488:INFO:   <<< world_size: 1
2024-11-05 15:43:45,488:INFO: device: cuda:0 n_gpu: 1
2024-11-05 15:43:46,284:INFO: loading archive file /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base
2024-11-05 15:43:46,287:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-11-05 15:43:46,287:INFO: Weight doesn't exsits. /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base/cross_pytorch_model.bin
2024-11-05 15:43:46,288:WARNING: Stage-One:True, Stage-Two:False
2024-11-05 15:43:46,288:WARNING: Test retrieval by loose type.
2024-11-05 15:43:46,288:WARNING: 	 embed_dim: 512
2024-11-05 15:43:46,288:WARNING: 	 image_resolution: 224
2024-11-05 15:43:46,288:WARNING: 	 vision_layers: 12
2024-11-05 15:43:46,288:WARNING: 	 vision_width: 768
2024-11-05 15:43:46,288:WARNING: 	 vision_patch_size: 32
2024-11-05 15:43:46,288:WARNING: 	 context_length: 77
2024-11-05 15:43:46,288:WARNING: 	 vocab_size: 49408
2024-11-05 15:43:46,288:WARNING: 	 transformer_width: 512
2024-11-05 15:43:46,288:WARNING: 	 transformer_heads: 8
2024-11-05 15:43:46,288:WARNING: 	 transformer_layers: 12
2024-11-05 15:43:46,288:WARNING: 		 linear_patch: 2d
2024-11-05 15:43:46,288:WARNING: 	 cut_top_layer: 0
2024-11-05 15:43:47,517:WARNING: 	 sim_header: Filip
2024-11-05 15:43:54,235:INFO: --------------------
2024-11-05 15:43:54,236:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-11-05 15:43:54,319:INFO: ***** Running test *****
2024-11-05 15:43:54,320:INFO:   Num examples = 2348
2024-11-05 15:43:54,320:INFO:   Batch size = 256
2024-11-05 15:43:54,320:INFO:   Num steps = 10
2024-11-05 15:43:54,874:WARNING: Eval under the multi-sentence per video clip setting.
2024-11-05 15:43:54,874:WARNING: sentence num: 1969, video num: 2348
2024-11-05 15:44:24,761:INFO: Effective parameters:
2024-11-05 15:44:24,762:INFO:   <<< alpha: 0.8
2024-11-05 15:44:24,762:INFO:   <<< aug_choose: t2v
2024-11-05 15:44:24,762:INFO:   <<< batch_size: 512
2024-11-05 15:44:24,762:INFO:   <<< batch_size_val: 256
2024-11-05 15:44:24,762:INFO:   <<< cache_dir: 
2024-11-05 15:44:24,762:INFO:   <<< cla_weight_dir: cla_weight
2024-11-05 15:44:24,762:INFO:   <<< coef_lr: 1.0
2024-11-05 15:44:24,762:INFO:   <<< combine_type: sum
2024-11-05 15:44:24,762:INFO:   <<< cross_att_layers: 1
2024-11-05 15:44:24,762:INFO:   <<< cross_model: cross-base
2024-11-05 15:44:24,762:INFO:   <<< cross_num_hidden_layers: 4
2024-11-05 15:44:24,762:INFO:   <<< data_path: data_h2
2024-11-05 15:44:24,762:INFO:   <<< datatype: h2s
2024-11-05 15:44:24,762:INFO:   <<< debug: False
2024-11-05 15:44:24,762:INFO:   <<< distributed: True
2024-11-05 15:44:24,762:INFO:   <<< do_eval: True
2024-11-05 15:44:24,762:INFO:   <<< do_lower_case: False
2024-11-05 15:44:24,762:INFO:   <<< do_pretrain: False
2024-11-05 15:44:24,762:INFO:   <<< do_train: False
2024-11-05 15:44:24,762:INFO:   <<< dual_mix: 0.5
2024-11-05 15:44:24,762:INFO:   <<< epochs: 200
2024-11-05 15:44:24,762:INFO:   <<< eval_frame_order: 0
2024-11-05 15:44:24,762:INFO:   <<< expand_msrvtt_sentences: False
2024-11-05 15:44:24,762:INFO:   <<< feature_framerate: 1
2024-11-05 15:44:24,762:INFO:   <<< feature_len: 64
2024-11-05 15:44:24,762:INFO:   <<< features_path: sign_feature/h2s_domain_agnostic
2024-11-05 15:44:24,762:INFO:   <<< features_path_retrain: sign_feature/h2s_domain_aware
2024-11-05 15:44:24,762:INFO:   <<< fp16: True
2024-11-05 15:44:24,762:INFO:   <<< fp16_opt_level: O1
2024-11-05 15:44:24,762:INFO:   <<< freeze_layer_num: 0
2024-11-05 15:44:24,763:INFO:   <<< gpu_ids: [0, 1]
2024-11-05 15:44:24,763:INFO:   <<< gradient_accumulation_steps: 1
2024-11-05 15:44:24,763:INFO:   <<< hard_negative_rate: 0.5
2024-11-05 15:44:24,763:INFO:   <<< init_model: chpt/H2S_sota.pth
2024-11-05 15:44:24,763:INFO:   <<< linear_patch: 2d
2024-11-05 15:44:24,763:INFO:   <<< local_rank: 0
2024-11-05 15:44:24,763:INFO:   <<< loose_type: True
2024-11-05 15:44:24,763:INFO:   <<< lr: 1e-05
2024-11-05 15:44:24,763:INFO:   <<< lr_decay: 0.001
2024-11-05 15:44:24,763:INFO:   <<< margin: 0.1
2024-11-05 15:44:24,763:INFO:   <<< max_frames: 128
2024-11-05 15:44:24,763:INFO:   <<< max_words: 32
2024-11-05 15:44:24,763:INFO:   <<< mix_design: balance
2024-11-05 15:44:24,763:INFO:   <<< n_display: 1
2024-11-05 15:44:24,763:INFO:   <<< n_gpu: 1
2024-11-05 15:44:24,763:INFO:   <<< n_pair: 1
2024-11-05 15:44:24,763:INFO:   <<< negative_weighting: 1
2024-11-05 15:44:24,763:INFO:   <<< not_load_visual: False
2024-11-05 15:44:24,763:INFO:   <<< num_thread_reader: 8
2024-11-05 15:44:24,763:INFO:   <<< output_dir: new_experiment
2024-11-05 15:44:24,763:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-11-05 15:44:24,763:INFO:   <<< rank: 0
2024-11-05 15:44:24,763:INFO:   <<< resume_model: None
2024-11-05 15:44:24,763:INFO:   <<< sampled_use_mil: False
2024-11-05 15:44:24,763:INFO:   <<< seed: 42
2024-11-05 15:44:24,763:INFO:   <<< sim_calcu: softmax_max
2024-11-05 15:44:24,763:INFO:   <<< sim_header: Filip
2024-11-05 15:44:24,763:INFO:   <<< slice_framepos: 0
2024-11-05 15:44:24,763:INFO:   <<< task_type: retrieval
2024-11-05 15:44:24,763:INFO:   <<< tau: 0.07
2024-11-05 15:44:24,763:INFO:   <<< text_aug: True
2024-11-05 15:44:24,763:INFO:   <<< text_aug_choosen: random_swap
2024-11-05 15:44:24,763:INFO:   <<< text_num_hidden_layers: 12
2024-11-05 15:44:24,763:INFO:   <<< train_frame_order: 0
2024-11-05 15:44:24,763:INFO:   <<< use_mil: False
2024-11-05 15:44:24,764:INFO:   <<< video_dim: 1024
2024-11-05 15:44:24,764:INFO:   <<< visual_num_hidden_layers: 12
2024-11-05 15:44:24,764:INFO:   <<< warmup_proportion: 0.1
2024-11-05 15:44:24,764:INFO:   <<< world_size: 1
2024-11-05 15:44:24,764:INFO: device: cuda:0 n_gpu: 1
2024-11-05 15:44:25,561:INFO: loading archive file /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base
2024-11-05 15:44:25,562:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-11-05 15:44:25,563:INFO: Weight doesn't exsits. /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base/cross_pytorch_model.bin
2024-11-05 15:44:25,563:WARNING: Stage-One:True, Stage-Two:False
2024-11-05 15:44:25,563:WARNING: Test retrieval by loose type.
2024-11-05 15:44:25,563:WARNING: 	 embed_dim: 512
2024-11-05 15:44:25,563:WARNING: 	 image_resolution: 224
2024-11-05 15:44:25,563:WARNING: 	 vision_layers: 12
2024-11-05 15:44:25,563:WARNING: 	 vision_width: 768
2024-11-05 15:44:25,563:WARNING: 	 vision_patch_size: 32
2024-11-05 15:44:25,563:WARNING: 	 context_length: 77
2024-11-05 15:44:25,563:WARNING: 	 vocab_size: 49408
2024-11-05 15:44:25,563:WARNING: 	 transformer_width: 512
2024-11-05 15:44:25,563:WARNING: 	 transformer_heads: 8
2024-11-05 15:44:25,563:WARNING: 	 transformer_layers: 12
2024-11-05 15:44:25,563:WARNING: 		 linear_patch: 2d
2024-11-05 15:44:25,563:WARNING: 	 cut_top_layer: 0
2024-11-05 15:44:26,785:WARNING: 	 sim_header: Filip
2024-11-05 15:44:33,518:INFO: --------------------
2024-11-05 15:44:33,520:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-11-05 15:44:33,598:INFO: ***** Running test *****
2024-11-05 15:44:33,598:INFO:   Num examples = 2348
2024-11-05 15:44:33,598:INFO:   Batch size = 256
2024-11-05 15:44:33,598:INFO:   Num steps = 10
2024-11-05 15:44:34,055:WARNING: Eval under the multi-sentence per video clip setting.
2024-11-05 15:44:34,055:WARNING: sentence num: 1969, video num: 2348
2024-11-05 15:45:38,031:INFO: Effective parameters:
2024-11-05 15:45:38,031:INFO:   <<< alpha: 0.8
2024-11-05 15:45:38,031:INFO:   <<< aug_choose: t2v
2024-11-05 15:45:38,031:INFO:   <<< batch_size: 512
2024-11-05 15:45:38,031:INFO:   <<< batch_size_val: 256
2024-11-05 15:45:38,031:INFO:   <<< cache_dir: 
2024-11-05 15:45:38,031:INFO:   <<< cla_weight_dir: cla_weight
2024-11-05 15:45:38,031:INFO:   <<< coef_lr: 1.0
2024-11-05 15:45:38,031:INFO:   <<< combine_type: sum
2024-11-05 15:45:38,031:INFO:   <<< cross_att_layers: 1
2024-11-05 15:45:38,031:INFO:   <<< cross_model: cross-base
2024-11-05 15:45:38,031:INFO:   <<< cross_num_hidden_layers: 4
2024-11-05 15:45:38,031:INFO:   <<< data_path: data_h2
2024-11-05 15:45:38,031:INFO:   <<< datatype: h2s
2024-11-05 15:45:38,031:INFO:   <<< debug: False
2024-11-05 15:45:38,031:INFO:   <<< distributed: True
2024-11-05 15:45:38,031:INFO:   <<< do_eval: True
2024-11-05 15:45:38,031:INFO:   <<< do_lower_case: False
2024-11-05 15:45:38,032:INFO:   <<< do_pretrain: False
2024-11-05 15:45:38,032:INFO:   <<< do_train: False
2024-11-05 15:45:38,032:INFO:   <<< dual_mix: 0.5
2024-11-05 15:45:38,032:INFO:   <<< epochs: 200
2024-11-05 15:45:38,032:INFO:   <<< eval_frame_order: 0
2024-11-05 15:45:38,032:INFO:   <<< expand_msrvtt_sentences: False
2024-11-05 15:45:38,032:INFO:   <<< feature_framerate: 1
2024-11-05 15:45:38,032:INFO:   <<< feature_len: 64
2024-11-05 15:45:38,032:INFO:   <<< features_path: sign_feature/h2s_domain_agnostic
2024-11-05 15:45:38,032:INFO:   <<< features_path_retrain: sign_feature/h2s_domain_aware
2024-11-05 15:45:38,032:INFO:   <<< fp16: True
2024-11-05 15:45:38,032:INFO:   <<< fp16_opt_level: O1
2024-11-05 15:45:38,032:INFO:   <<< freeze_layer_num: 0
2024-11-05 15:45:38,032:INFO:   <<< gpu_ids: [0, 1]
2024-11-05 15:45:38,032:INFO:   <<< gradient_accumulation_steps: 1
2024-11-05 15:45:38,032:INFO:   <<< hard_negative_rate: 0.5
2024-11-05 15:45:38,032:INFO:   <<< init_model: chpt/H2S_sota.pth
2024-11-05 15:45:38,032:INFO:   <<< linear_patch: 2d
2024-11-05 15:45:38,032:INFO:   <<< local_rank: 0
2024-11-05 15:45:38,032:INFO:   <<< loose_type: True
2024-11-05 15:45:38,032:INFO:   <<< lr: 1e-05
2024-11-05 15:45:38,032:INFO:   <<< lr_decay: 0.001
2024-11-05 15:45:38,032:INFO:   <<< margin: 0.1
2024-11-05 15:45:38,032:INFO:   <<< max_frames: 128
2024-11-05 15:45:38,032:INFO:   <<< max_words: 32
2024-11-05 15:45:38,032:INFO:   <<< mix_design: balance
2024-11-05 15:45:38,032:INFO:   <<< n_display: 1
2024-11-05 15:45:38,032:INFO:   <<< n_gpu: 1
2024-11-05 15:45:38,032:INFO:   <<< n_pair: 1
2024-11-05 15:45:38,032:INFO:   <<< negative_weighting: 1
2024-11-05 15:45:38,032:INFO:   <<< not_load_visual: False
2024-11-05 15:45:38,032:INFO:   <<< num_thread_reader: 8
2024-11-05 15:45:38,032:INFO:   <<< output_dir: new_experiment
2024-11-05 15:45:38,032:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-11-05 15:45:38,033:INFO:   <<< rank: 0
2024-11-05 15:45:38,033:INFO:   <<< resume_model: None
2024-11-05 15:45:38,033:INFO:   <<< sampled_use_mil: False
2024-11-05 15:45:38,033:INFO:   <<< seed: 42
2024-11-05 15:45:38,033:INFO:   <<< sim_calcu: softmax_max
2024-11-05 15:45:38,033:INFO:   <<< sim_header: Filip
2024-11-05 15:45:38,033:INFO:   <<< slice_framepos: 0
2024-11-05 15:45:38,033:INFO:   <<< task_type: retrieval
2024-11-05 15:45:38,033:INFO:   <<< tau: 0.07
2024-11-05 15:45:38,033:INFO:   <<< text_aug: True
2024-11-05 15:45:38,033:INFO:   <<< text_aug_choosen: random_swap
2024-11-05 15:45:38,033:INFO:   <<< text_num_hidden_layers: 12
2024-11-05 15:45:38,033:INFO:   <<< train_frame_order: 0
2024-11-05 15:45:38,033:INFO:   <<< use_mil: False
2024-11-05 15:45:38,033:INFO:   <<< video_dim: 1024
2024-11-05 15:45:38,033:INFO:   <<< visual_num_hidden_layers: 12
2024-11-05 15:45:38,033:INFO:   <<< warmup_proportion: 0.1
2024-11-05 15:45:38,033:INFO:   <<< world_size: 1
2024-11-05 15:45:38,033:INFO: device: cuda:0 n_gpu: 1
2024-11-05 15:45:38,830:INFO: loading archive file /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base
2024-11-05 15:45:38,833:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-11-05 15:45:38,833:INFO: Weight doesn't exsits. /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base/cross_pytorch_model.bin
2024-11-05 15:45:38,833:WARNING: Stage-One:True, Stage-Two:False
2024-11-05 15:45:38,833:WARNING: Test retrieval by loose type.
2024-11-05 15:45:38,833:WARNING: 	 embed_dim: 512
2024-11-05 15:45:38,833:WARNING: 	 image_resolution: 224
2024-11-05 15:45:38,833:WARNING: 	 vision_layers: 12
2024-11-05 15:45:38,833:WARNING: 	 vision_width: 768
2024-11-05 15:45:38,833:WARNING: 	 vision_patch_size: 32
2024-11-05 15:45:38,833:WARNING: 	 context_length: 77
2024-11-05 15:45:38,834:WARNING: 	 vocab_size: 49408
2024-11-05 15:45:38,834:WARNING: 	 transformer_width: 512
2024-11-05 15:45:38,834:WARNING: 	 transformer_heads: 8
2024-11-05 15:45:38,834:WARNING: 	 transformer_layers: 12
2024-11-05 15:45:38,834:WARNING: 		 linear_patch: 2d
2024-11-05 15:45:38,834:WARNING: 	 cut_top_layer: 0
2024-11-05 15:45:40,060:WARNING: 	 sim_header: Filip
2024-11-05 15:45:46,784:INFO: --------------------
2024-11-05 15:45:46,785:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-11-05 15:45:46,866:INFO: ***** Running test *****
2024-11-05 15:45:46,866:INFO:   Num examples = 2348
2024-11-05 15:45:46,866:INFO:   Batch size = 256
2024-11-05 15:45:46,866:INFO:   Num steps = 10
2024-11-05 15:45:47,725:WARNING: Eval under the multi-sentence per video clip setting.
2024-11-05 15:45:47,725:WARNING: sentence num: 1969, video num: 2348
2024-11-05 15:47:52,159:INFO: Effective parameters:
2024-11-05 15:47:52,159:INFO:   <<< alpha: 0.8
2024-11-05 15:47:52,159:INFO:   <<< aug_choose: t2v
2024-11-05 15:47:52,159:INFO:   <<< batch_size: 512
2024-11-05 15:47:52,159:INFO:   <<< batch_size_val: 256
2024-11-05 15:47:52,160:INFO:   <<< cache_dir: 
2024-11-05 15:47:52,160:INFO:   <<< cla_weight_dir: cla_weight
2024-11-05 15:47:52,160:INFO:   <<< coef_lr: 1.0
2024-11-05 15:47:52,160:INFO:   <<< combine_type: sum
2024-11-05 15:47:52,160:INFO:   <<< cross_att_layers: 1
2024-11-05 15:47:52,160:INFO:   <<< cross_model: cross-base
2024-11-05 15:47:52,160:INFO:   <<< cross_num_hidden_layers: 4
2024-11-05 15:47:52,160:INFO:   <<< data_path: data_h2
2024-11-05 15:47:52,160:INFO:   <<< datatype: h2s
2024-11-05 15:47:52,160:INFO:   <<< debug: False
2024-11-05 15:47:52,160:INFO:   <<< distributed: True
2024-11-05 15:47:52,160:INFO:   <<< do_eval: True
2024-11-05 15:47:52,160:INFO:   <<< do_lower_case: False
2024-11-05 15:47:52,160:INFO:   <<< do_pretrain: False
2024-11-05 15:47:52,160:INFO:   <<< do_train: False
2024-11-05 15:47:52,160:INFO:   <<< dual_mix: 0.5
2024-11-05 15:47:52,160:INFO:   <<< epochs: 200
2024-11-05 15:47:52,160:INFO:   <<< eval_frame_order: 0
2024-11-05 15:47:52,160:INFO:   <<< expand_msrvtt_sentences: False
2024-11-05 15:47:52,160:INFO:   <<< feature_framerate: 1
2024-11-05 15:47:52,160:INFO:   <<< feature_len: 64
2024-11-05 15:47:52,160:INFO:   <<< features_path: sign_feature/h2s_domain_agnostic
2024-11-05 15:47:52,160:INFO:   <<< features_path_retrain: sign_feature/h2s_domain_aware
2024-11-05 15:47:52,160:INFO:   <<< fp16: True
2024-11-05 15:47:52,160:INFO:   <<< fp16_opt_level: O1
2024-11-05 15:47:52,160:INFO:   <<< freeze_layer_num: 0
2024-11-05 15:47:52,160:INFO:   <<< gpu_ids: [0, 1]
2024-11-05 15:47:52,160:INFO:   <<< gradient_accumulation_steps: 1
2024-11-05 15:47:52,160:INFO:   <<< hard_negative_rate: 0.5
2024-11-05 15:47:52,160:INFO:   <<< init_model: chpt/H2S_sota.pth
2024-11-05 15:47:52,160:INFO:   <<< linear_patch: 2d
2024-11-05 15:47:52,160:INFO:   <<< local_rank: 0
2024-11-05 15:47:52,160:INFO:   <<< loose_type: True
2024-11-05 15:47:52,160:INFO:   <<< lr: 1e-05
2024-11-05 15:47:52,160:INFO:   <<< lr_decay: 0.001
2024-11-05 15:47:52,160:INFO:   <<< margin: 0.1
2024-11-05 15:47:52,160:INFO:   <<< max_frames: 128
2024-11-05 15:47:52,161:INFO:   <<< max_words: 32
2024-11-05 15:47:52,161:INFO:   <<< mix_design: balance
2024-11-05 15:47:52,161:INFO:   <<< n_display: 1
2024-11-05 15:47:52,161:INFO:   <<< n_gpu: 1
2024-11-05 15:47:52,161:INFO:   <<< n_pair: 1
2024-11-05 15:47:52,161:INFO:   <<< negative_weighting: 1
2024-11-05 15:47:52,161:INFO:   <<< not_load_visual: False
2024-11-05 15:47:52,161:INFO:   <<< num_thread_reader: 8
2024-11-05 15:47:52,161:INFO:   <<< output_dir: new_experiment
2024-11-05 15:47:52,161:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-11-05 15:47:52,161:INFO:   <<< rank: 0
2024-11-05 15:47:52,161:INFO:   <<< resume_model: None
2024-11-05 15:47:52,161:INFO:   <<< sampled_use_mil: False
2024-11-05 15:47:52,161:INFO:   <<< seed: 42
2024-11-05 15:47:52,161:INFO:   <<< sim_calcu: softmax_max
2024-11-05 15:47:52,161:INFO:   <<< sim_header: Filip
2024-11-05 15:47:52,161:INFO:   <<< slice_framepos: 0
2024-11-05 15:47:52,161:INFO:   <<< task_type: retrieval
2024-11-05 15:47:52,161:INFO:   <<< tau: 0.07
2024-11-05 15:47:52,161:INFO:   <<< text_aug: True
2024-11-05 15:47:52,161:INFO:   <<< text_aug_choosen: random_swap
2024-11-05 15:47:52,161:INFO:   <<< text_num_hidden_layers: 12
2024-11-05 15:47:52,161:INFO:   <<< train_frame_order: 0
2024-11-05 15:47:52,161:INFO:   <<< use_mil: False
2024-11-05 15:47:52,161:INFO:   <<< video_dim: 1024
2024-11-05 15:47:52,161:INFO:   <<< visual_num_hidden_layers: 12
2024-11-05 15:47:52,161:INFO:   <<< warmup_proportion: 0.1
2024-11-05 15:47:52,161:INFO:   <<< world_size: 1
2024-11-05 15:47:52,161:INFO: device: cuda:0 n_gpu: 1
2024-11-05 15:47:52,963:INFO: loading archive file /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base
2024-11-05 15:47:52,969:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-11-05 15:47:52,969:INFO: Weight doesn't exsits. /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base/cross_pytorch_model.bin
2024-11-05 15:47:52,970:WARNING: Stage-One:True, Stage-Two:False
2024-11-05 15:47:52,970:WARNING: Test retrieval by loose type.
2024-11-05 15:47:52,970:WARNING: 	 embed_dim: 512
2024-11-05 15:47:52,970:WARNING: 	 image_resolution: 224
2024-11-05 15:47:52,970:WARNING: 	 vision_layers: 12
2024-11-05 15:47:52,970:WARNING: 	 vision_width: 768
2024-11-05 15:47:52,970:WARNING: 	 vision_patch_size: 32
2024-11-05 15:47:52,970:WARNING: 	 context_length: 77
2024-11-05 15:47:52,970:WARNING: 	 vocab_size: 49408
2024-11-05 15:47:52,970:WARNING: 	 transformer_width: 512
2024-11-05 15:47:52,970:WARNING: 	 transformer_heads: 8
2024-11-05 15:47:52,970:WARNING: 	 transformer_layers: 12
2024-11-05 15:47:52,970:WARNING: 		 linear_patch: 2d
2024-11-05 15:47:52,970:WARNING: 	 cut_top_layer: 0
2024-11-05 15:47:54,192:WARNING: 	 sim_header: Filip
2024-11-05 15:48:00,919:INFO: --------------------
2024-11-05 15:48:00,920:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-11-05 15:48:01,007:INFO: ***** Running test *****
2024-11-05 15:48:01,008:INFO:   Num examples = 2348
2024-11-05 15:48:01,008:INFO:   Batch size = 256
2024-11-05 15:48:01,008:INFO:   Num steps = 10
2024-11-05 15:48:01,799:WARNING: Eval under the multi-sentence per video clip setting.
2024-11-05 15:48:01,799:WARNING: sentence num: 1969, video num: 2348
2024-11-05 15:48:05,907:INFO: before reshape, sim matrix size: 2348 x 1969
2024-11-05 15:48:06,318:INFO: after reshape, sim matrix size: 1969 x 3 x 1969
2024-11-05 15:48:07,188:INFO: Mix_Text-to-Video:
2024-11-05 15:48:07,188:INFO: 	>>>  R@1: 56.6 - R@5: 70.0 - R@10: 74.7 - Median R: 1.0 - Mean R: 64.1
2024-11-05 15:48:07,188:INFO: Mix_Video-to-Text:
2024-11-05 15:48:07,188:INFO: 	>>>  V2T$R@1: 51.6 - V2T$R@5: 64.7 - V2T$R@10: 70.0 - V2T$Median R: 1.0 - V2T$Mean R: 77.5
2024-11-05 15:50:11,474:INFO: Effective parameters:
2024-11-05 15:50:11,475:INFO:   <<< alpha: 0.8
2024-11-05 15:50:11,475:INFO:   <<< aug_choose: t2v
2024-11-05 15:50:11,475:INFO:   <<< batch_size: 512
2024-11-05 15:50:11,475:INFO:   <<< batch_size_val: 256
2024-11-05 15:50:11,475:INFO:   <<< cache_dir: 
2024-11-05 15:50:11,475:INFO:   <<< cla_weight_dir: cla_weight
2024-11-05 15:50:11,475:INFO:   <<< coef_lr: 1.0
2024-11-05 15:50:11,475:INFO:   <<< combine_type: sum
2024-11-05 15:50:11,475:INFO:   <<< cross_att_layers: 1
2024-11-05 15:50:11,475:INFO:   <<< cross_model: cross-base
2024-11-05 15:50:11,475:INFO:   <<< cross_num_hidden_layers: 4
2024-11-05 15:50:11,475:INFO:   <<< data_path: data_h2
2024-11-05 15:50:11,475:INFO:   <<< datatype: h2s
2024-11-05 15:50:11,475:INFO:   <<< debug: False
2024-11-05 15:50:11,475:INFO:   <<< distributed: True
2024-11-05 15:50:11,475:INFO:   <<< do_eval: True
2024-11-05 15:50:11,475:INFO:   <<< do_lower_case: False
2024-11-05 15:50:11,475:INFO:   <<< do_pretrain: False
2024-11-05 15:50:11,475:INFO:   <<< do_train: False
2024-11-05 15:50:11,475:INFO:   <<< dual_mix: 0.5
2024-11-05 15:50:11,475:INFO:   <<< epochs: 200
2024-11-05 15:50:11,475:INFO:   <<< eval_frame_order: 0
2024-11-05 15:50:11,475:INFO:   <<< expand_msrvtt_sentences: False
2024-11-05 15:50:11,475:INFO:   <<< feature_framerate: 1
2024-11-05 15:50:11,476:INFO:   <<< feature_len: 64
2024-11-05 15:50:11,476:INFO:   <<< features_path: sign_feature/h2s_domain_agnostic
2024-11-05 15:50:11,476:INFO:   <<< features_path_retrain: sign_feature/h2s_domain_aware
2024-11-05 15:50:11,476:INFO:   <<< fp16: True
2024-11-05 15:50:11,476:INFO:   <<< fp16_opt_level: O1
2024-11-05 15:50:11,476:INFO:   <<< freeze_layer_num: 0
2024-11-05 15:50:11,476:INFO:   <<< gpu_ids: [0, 1]
2024-11-05 15:50:11,476:INFO:   <<< gradient_accumulation_steps: 1
2024-11-05 15:50:11,476:INFO:   <<< hard_negative_rate: 0.5
2024-11-05 15:50:11,476:INFO:   <<< init_model: chpt/H2S_sota.pth
2024-11-05 15:50:11,476:INFO:   <<< linear_patch: 2d
2024-11-05 15:50:11,476:INFO:   <<< local_rank: 0
2024-11-05 15:50:11,476:INFO:   <<< loose_type: True
2024-11-05 15:50:11,476:INFO:   <<< lr: 1e-05
2024-11-05 15:50:11,476:INFO:   <<< lr_decay: 0.001
2024-11-05 15:50:11,476:INFO:   <<< margin: 0.1
2024-11-05 15:50:11,476:INFO:   <<< max_frames: 128
2024-11-05 15:50:11,476:INFO:   <<< max_words: 32
2024-11-05 15:50:11,476:INFO:   <<< mix_design: balance
2024-11-05 15:50:11,476:INFO:   <<< n_display: 1
2024-11-05 15:50:11,476:INFO:   <<< n_gpu: 1
2024-11-05 15:50:11,476:INFO:   <<< n_pair: 1
2024-11-05 15:50:11,476:INFO:   <<< negative_weighting: 1
2024-11-05 15:50:11,476:INFO:   <<< not_load_visual: False
2024-11-05 15:50:11,476:INFO:   <<< num_thread_reader: 8
2024-11-05 15:50:11,476:INFO:   <<< output_dir: new_experiment
2024-11-05 15:50:11,476:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-11-05 15:50:11,476:INFO:   <<< rank: 0
2024-11-05 15:50:11,476:INFO:   <<< resume_model: None
2024-11-05 15:50:11,476:INFO:   <<< sampled_use_mil: False
2024-11-05 15:50:11,476:INFO:   <<< seed: 42
2024-11-05 15:50:11,476:INFO:   <<< sim_calcu: softmax_max
2024-11-05 15:50:11,476:INFO:   <<< sim_header: Filip
2024-11-05 15:50:11,476:INFO:   <<< slice_framepos: 0
2024-11-05 15:50:11,476:INFO:   <<< task_type: retrieval
2024-11-05 15:50:11,477:INFO:   <<< tau: 0.07
2024-11-05 15:50:11,477:INFO:   <<< text_aug: True
2024-11-05 15:50:11,477:INFO:   <<< text_aug_choosen: random_swap
2024-11-05 15:50:11,477:INFO:   <<< text_num_hidden_layers: 12
2024-11-05 15:50:11,477:INFO:   <<< train_frame_order: 0
2024-11-05 15:50:11,477:INFO:   <<< use_mil: False
2024-11-05 15:50:11,477:INFO:   <<< video_dim: 1024
2024-11-05 15:50:11,477:INFO:   <<< visual_num_hidden_layers: 12
2024-11-05 15:50:11,477:INFO:   <<< warmup_proportion: 0.1
2024-11-05 15:50:11,477:INFO:   <<< world_size: 1
2024-11-05 15:50:11,477:INFO: device: cuda:0 n_gpu: 1
2024-11-05 15:50:12,269:INFO: loading archive file /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base
2024-11-05 15:50:12,271:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-11-05 15:50:12,271:INFO: Weight doesn't exsits. /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base/cross_pytorch_model.bin
2024-11-05 15:50:12,271:WARNING: Stage-One:True, Stage-Two:False
2024-11-05 15:50:12,271:WARNING: Test retrieval by loose type.
2024-11-05 15:50:12,271:WARNING: 	 embed_dim: 512
2024-11-05 15:50:12,271:WARNING: 	 image_resolution: 224
2024-11-05 15:50:12,271:WARNING: 	 vision_layers: 12
2024-11-05 15:50:12,271:WARNING: 	 vision_width: 768
2024-11-05 15:50:12,271:WARNING: 	 vision_patch_size: 32
2024-11-05 15:50:12,271:WARNING: 	 context_length: 77
2024-11-05 15:50:12,271:WARNING: 	 vocab_size: 49408
2024-11-05 15:50:12,271:WARNING: 	 transformer_width: 512
2024-11-05 15:50:12,271:WARNING: 	 transformer_heads: 8
2024-11-05 15:50:12,271:WARNING: 	 transformer_layers: 12
2024-11-05 15:50:12,271:WARNING: 		 linear_patch: 2d
2024-11-05 15:50:12,271:WARNING: 	 cut_top_layer: 0
2024-11-05 15:50:13,496:WARNING: 	 sim_header: Filip
2024-11-05 15:50:20,220:INFO: --------------------
2024-11-05 15:50:20,221:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-11-05 15:50:20,298:INFO: ***** Running test *****
2024-11-05 15:50:20,298:INFO:   Num examples = 2348
2024-11-05 15:50:20,298:INFO:   Batch size = 256
2024-11-05 15:50:20,298:INFO:   Num steps = 10
2024-11-05 15:50:20,852:WARNING: Eval under the multi-sentence per video clip setting.
2024-11-05 15:50:20,853:WARNING: sentence num: 1969, video num: 2348
2024-11-05 15:50:24,989:INFO: before reshape, sim matrix size: 2348 x 1969
2024-11-05 15:50:25,425:INFO: after reshape, sim matrix size: 1969 x 3 x 1969
2024-11-05 15:50:26,266:INFO: Mix_Text-to-Video:
2024-11-05 15:50:26,266:INFO: 	>>>  R@1: 56.6 - R@5: 70.0 - R@10: 74.7 - Median R: 1.0 - Mean R: 64.1
2024-11-05 15:50:26,266:INFO: Mix_Video-to-Text:
2024-11-05 15:50:26,266:INFO: 	>>>  V2T$R@1: 51.6 - V2T$R@5: 64.7 - V2T$R@10: 70.0 - V2T$Median R: 1.0 - V2T$Mean R: 77.5
2024-11-05 15:56:38,760:INFO: Effective parameters:
2024-11-05 15:56:38,760:INFO:   <<< alpha: 0.8
2024-11-05 15:56:38,760:INFO:   <<< aug_choose: t2v
2024-11-05 15:56:38,760:INFO:   <<< batch_size: 512
2024-11-05 15:56:38,760:INFO:   <<< batch_size_val: 256
2024-11-05 15:56:38,760:INFO:   <<< cache_dir: 
2024-11-05 15:56:38,760:INFO:   <<< cla_weight_dir: cla_weight
2024-11-05 15:56:38,760:INFO:   <<< coef_lr: 1.0
2024-11-05 15:56:38,760:INFO:   <<< combine_type: sum
2024-11-05 15:56:38,760:INFO:   <<< cross_att_layers: 1
2024-11-05 15:56:38,760:INFO:   <<< cross_model: cross-base
2024-11-05 15:56:38,760:INFO:   <<< cross_num_hidden_layers: 4
2024-11-05 15:56:38,760:INFO:   <<< data_path: data_h2
2024-11-05 15:56:38,760:INFO:   <<< datatype: h2s
2024-11-05 15:56:38,760:INFO:   <<< debug: False
2024-11-05 15:56:38,760:INFO:   <<< distributed: True
2024-11-05 15:56:38,760:INFO:   <<< do_eval: True
2024-11-05 15:56:38,760:INFO:   <<< do_lower_case: False
2024-11-05 15:56:38,760:INFO:   <<< do_pretrain: False
2024-11-05 15:56:38,760:INFO:   <<< do_train: False
2024-11-05 15:56:38,760:INFO:   <<< dual_mix: 0.5
2024-11-05 15:56:38,760:INFO:   <<< epochs: 200
2024-11-05 15:56:38,760:INFO:   <<< eval_frame_order: 0
2024-11-05 15:56:38,760:INFO:   <<< expand_msrvtt_sentences: False
2024-11-05 15:56:38,761:INFO:   <<< feature_framerate: 1
2024-11-05 15:56:38,761:INFO:   <<< feature_len: 64
2024-11-05 15:56:38,761:INFO:   <<< features_path: sign_feature/h2s_domain_agnostic
2024-11-05 15:56:38,761:INFO:   <<< features_path_retrain: sign_feature/h2s_domain_aware
2024-11-05 15:56:38,761:INFO:   <<< fp16: True
2024-11-05 15:56:38,761:INFO:   <<< fp16_opt_level: O1
2024-11-05 15:56:38,761:INFO:   <<< freeze_layer_num: 0
2024-11-05 15:56:38,761:INFO:   <<< gpu_ids: [0, 1]
2024-11-05 15:56:38,761:INFO:   <<< gradient_accumulation_steps: 1
2024-11-05 15:56:38,761:INFO:   <<< hard_negative_rate: 0.5
2024-11-05 15:56:38,761:INFO:   <<< init_model: chpt/H2S_sota.pth
2024-11-05 15:56:38,761:INFO:   <<< linear_patch: 2d
2024-11-05 15:56:38,761:INFO:   <<< local_rank: 0
2024-11-05 15:56:38,761:INFO:   <<< loose_type: True
2024-11-05 15:56:38,761:INFO:   <<< lr: 1e-05
2024-11-05 15:56:38,761:INFO:   <<< lr_decay: 0.001
2024-11-05 15:56:38,761:INFO:   <<< margin: 0.1
2024-11-05 15:56:38,761:INFO:   <<< max_frames: 128
2024-11-05 15:56:38,761:INFO:   <<< max_words: 32
2024-11-05 15:56:38,761:INFO:   <<< mix_design: balance
2024-11-05 15:56:38,761:INFO:   <<< n_display: 1
2024-11-05 15:56:38,761:INFO:   <<< n_gpu: 1
2024-11-05 15:56:38,761:INFO:   <<< n_pair: 1
2024-11-05 15:56:38,761:INFO:   <<< negative_weighting: 1
2024-11-05 15:56:38,761:INFO:   <<< not_load_visual: False
2024-11-05 15:56:38,761:INFO:   <<< num_thread_reader: 8
2024-11-05 15:56:38,761:INFO:   <<< output_dir: new_experiment
2024-11-05 15:56:38,761:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-11-05 15:56:38,761:INFO:   <<< rank: 0
2024-11-05 15:56:38,761:INFO:   <<< resume_model: None
2024-11-05 15:56:38,761:INFO:   <<< sampled_use_mil: False
2024-11-05 15:56:38,761:INFO:   <<< seed: 42
2024-11-05 15:56:38,761:INFO:   <<< sim_calcu: softmax_max
2024-11-05 15:56:38,761:INFO:   <<< sim_header: Filip
2024-11-05 15:56:38,762:INFO:   <<< slice_framepos: 0
2024-11-05 15:56:38,762:INFO:   <<< task_type: retrieval
2024-11-05 15:56:38,762:INFO:   <<< tau: 0.07
2024-11-05 15:56:38,762:INFO:   <<< text_aug: True
2024-11-05 15:56:38,762:INFO:   <<< text_aug_choosen: random_swap
2024-11-05 15:56:38,762:INFO:   <<< text_num_hidden_layers: 12
2024-11-05 15:56:38,762:INFO:   <<< train_frame_order: 0
2024-11-05 15:56:38,762:INFO:   <<< use_mil: False
2024-11-05 15:56:38,762:INFO:   <<< video_dim: 1024
2024-11-05 15:56:38,762:INFO:   <<< visual_num_hidden_layers: 12
2024-11-05 15:56:38,762:INFO:   <<< warmup_proportion: 0.1
2024-11-05 15:56:38,762:INFO:   <<< world_size: 1
2024-11-05 15:56:38,762:INFO: device: cuda:0 n_gpu: 1
2024-11-05 15:56:39,551:INFO: loading archive file /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base
2024-11-05 15:56:39,553:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-11-05 15:56:39,554:INFO: Weight doesn't exsits. /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base/cross_pytorch_model.bin
2024-11-05 15:56:39,554:WARNING: Stage-One:True, Stage-Two:False
2024-11-05 15:56:39,554:WARNING: Test retrieval by loose type.
2024-11-05 15:56:39,554:WARNING: 	 embed_dim: 512
2024-11-05 15:56:39,554:WARNING: 	 image_resolution: 224
2024-11-05 15:56:39,554:WARNING: 	 vision_layers: 12
2024-11-05 15:56:39,554:WARNING: 	 vision_width: 768
2024-11-05 15:56:39,554:WARNING: 	 vision_patch_size: 32
2024-11-05 15:56:39,554:WARNING: 	 context_length: 77
2024-11-05 15:56:39,554:WARNING: 	 vocab_size: 49408
2024-11-05 15:56:39,554:WARNING: 	 transformer_width: 512
2024-11-05 15:56:39,554:WARNING: 	 transformer_heads: 8
2024-11-05 15:56:39,554:WARNING: 	 transformer_layers: 12
2024-11-05 15:56:39,554:WARNING: 		 linear_patch: 2d
2024-11-05 15:56:39,554:WARNING: 	 cut_top_layer: 0
2024-11-05 15:56:40,778:WARNING: 	 sim_header: Filip
2024-11-05 15:56:47,479:INFO: --------------------
2024-11-05 15:56:47,480:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-11-05 15:56:47,558:INFO: ***** Running test *****
2024-11-05 15:56:47,559:INFO:   Num examples = 2348
2024-11-05 15:56:47,559:INFO:   Batch size = 256
2024-11-05 15:56:47,559:INFO:   Num steps = 10
2024-11-05 15:56:48,042:WARNING: Eval under the multi-sentence per video clip setting.
2024-11-05 15:56:48,043:WARNING: sentence num: 1969, video num: 2348
2024-11-05 15:56:52,049:INFO: Average CLIPScore: 0.1667
2024-11-05 15:56:52,057:INFO: before reshape, sim matrix size: 2348 x 1969
2024-11-05 15:56:52,503:INFO: after reshape, sim matrix size: 1969 x 3 x 1969
2024-11-05 15:56:53,387:INFO: Mix_Text-to-Video:
2024-11-05 15:56:53,387:INFO: 	>>>  R@1: 56.6 - R@5: 70.0 - R@10: 74.7 - Median R: 1.0 - Mean R: 64.1
2024-11-05 15:56:53,387:INFO: Mix_Video-to-Text:
2024-11-05 15:56:53,387:INFO: 	>>>  V2T$R@1: 51.6 - V2T$R@5: 64.7 - V2T$R@10: 70.0 - V2T$Median R: 1.0 - V2T$Mean R: 77.5
2024-11-05 16:02:03,916:INFO: Effective parameters:
2024-11-05 16:02:03,916:INFO:   <<< alpha: 0.8
2024-11-05 16:02:03,916:INFO:   <<< aug_choose: t2v
2024-11-05 16:02:03,916:INFO:   <<< batch_size: 512
2024-11-05 16:02:03,916:INFO:   <<< batch_size_val: 256
2024-11-05 16:02:03,916:INFO:   <<< cache_dir: 
2024-11-05 16:02:03,916:INFO:   <<< cla_weight_dir: cla_weight
2024-11-05 16:02:03,916:INFO:   <<< coef_lr: 1.0
2024-11-05 16:02:03,916:INFO:   <<< combine_type: sum
2024-11-05 16:02:03,916:INFO:   <<< cross_att_layers: 1
2024-11-05 16:02:03,916:INFO:   <<< cross_model: cross-base
2024-11-05 16:02:03,916:INFO:   <<< cross_num_hidden_layers: 4
2024-11-05 16:02:03,917:INFO:   <<< data_path: data_h2
2024-11-05 16:02:03,917:INFO:   <<< datatype: h2s
2024-11-05 16:02:03,917:INFO:   <<< debug: False
2024-11-05 16:02:03,917:INFO:   <<< distributed: True
2024-11-05 16:02:03,917:INFO:   <<< do_eval: True
2024-11-05 16:02:03,917:INFO:   <<< do_lower_case: False
2024-11-05 16:02:03,917:INFO:   <<< do_pretrain: False
2024-11-05 16:02:03,917:INFO:   <<< do_train: False
2024-11-05 16:02:03,917:INFO:   <<< dual_mix: 0.5
2024-11-05 16:02:03,917:INFO:   <<< epochs: 200
2024-11-05 16:02:03,917:INFO:   <<< eval_frame_order: 0
2024-11-05 16:02:03,917:INFO:   <<< expand_msrvtt_sentences: False
2024-11-05 16:02:03,917:INFO:   <<< feature_framerate: 1
2024-11-05 16:02:03,917:INFO:   <<< feature_len: 64
2024-11-05 16:02:03,917:INFO:   <<< features_path: sign_feature/h2s_domain_agnostic
2024-11-05 16:02:03,917:INFO:   <<< features_path_retrain: sign_feature/h2s_domain_aware
2024-11-05 16:02:03,917:INFO:   <<< fp16: True
2024-11-05 16:02:03,917:INFO:   <<< fp16_opt_level: O1
2024-11-05 16:02:03,917:INFO:   <<< freeze_layer_num: 0
2024-11-05 16:02:03,917:INFO:   <<< gpu_ids: [0, 1]
2024-11-05 16:02:03,917:INFO:   <<< gradient_accumulation_steps: 1
2024-11-05 16:02:03,917:INFO:   <<< hard_negative_rate: 0.5
2024-11-05 16:02:03,917:INFO:   <<< init_model: chpt/H2S_sota.pth
2024-11-05 16:02:03,917:INFO:   <<< linear_patch: 2d
2024-11-05 16:02:03,917:INFO:   <<< local_rank: 0
2024-11-05 16:02:03,917:INFO:   <<< loose_type: True
2024-11-05 16:02:03,917:INFO:   <<< lr: 1e-05
2024-11-05 16:02:03,917:INFO:   <<< lr_decay: 0.001
2024-11-05 16:02:03,917:INFO:   <<< margin: 0.1
2024-11-05 16:02:03,917:INFO:   <<< max_frames: 128
2024-11-05 16:02:03,917:INFO:   <<< max_words: 32
2024-11-05 16:02:03,917:INFO:   <<< mix_design: balance
2024-11-05 16:02:03,917:INFO:   <<< n_display: 1
2024-11-05 16:02:03,917:INFO:   <<< n_gpu: 1
2024-11-05 16:02:03,917:INFO:   <<< n_pair: 1
2024-11-05 16:02:03,917:INFO:   <<< negative_weighting: 1
2024-11-05 16:02:03,918:INFO:   <<< not_load_visual: False
2024-11-05 16:02:03,918:INFO:   <<< num_thread_reader: 8
2024-11-05 16:02:03,918:INFO:   <<< output_dir: new_experiment
2024-11-05 16:02:03,918:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-11-05 16:02:03,918:INFO:   <<< rank: 0
2024-11-05 16:02:03,918:INFO:   <<< resume_model: None
2024-11-05 16:02:03,918:INFO:   <<< sampled_use_mil: False
2024-11-05 16:02:03,918:INFO:   <<< seed: 42
2024-11-05 16:02:03,918:INFO:   <<< sim_calcu: softmax_max
2024-11-05 16:02:03,918:INFO:   <<< sim_header: Filip
2024-11-05 16:02:03,918:INFO:   <<< slice_framepos: 0
2024-11-05 16:02:03,918:INFO:   <<< task_type: retrieval
2024-11-05 16:02:03,918:INFO:   <<< tau: 0.07
2024-11-05 16:02:03,918:INFO:   <<< text_aug: True
2024-11-05 16:02:03,918:INFO:   <<< text_aug_choosen: random_swap
2024-11-05 16:02:03,918:INFO:   <<< text_num_hidden_layers: 12
2024-11-05 16:02:03,918:INFO:   <<< train_frame_order: 0
2024-11-05 16:02:03,918:INFO:   <<< use_mil: False
2024-11-05 16:02:03,918:INFO:   <<< video_dim: 1024
2024-11-05 16:02:03,918:INFO:   <<< visual_num_hidden_layers: 12
2024-11-05 16:02:03,918:INFO:   <<< warmup_proportion: 0.1
2024-11-05 16:02:03,918:INFO:   <<< world_size: 1
2024-11-05 16:02:03,918:INFO: device: cuda:0 n_gpu: 1
2024-11-05 16:02:04,704:INFO: loading archive file /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base
2024-11-05 16:02:04,706:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-11-05 16:02:04,706:INFO: Weight doesn't exsits. /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base/cross_pytorch_model.bin
2024-11-05 16:02:04,706:WARNING: Stage-One:True, Stage-Two:False
2024-11-05 16:02:04,706:WARNING: Test retrieval by loose type.
2024-11-05 16:02:04,706:WARNING: 	 embed_dim: 512
2024-11-05 16:02:04,706:WARNING: 	 image_resolution: 224
2024-11-05 16:02:04,707:WARNING: 	 vision_layers: 12
2024-11-05 16:02:04,707:WARNING: 	 vision_width: 768
2024-11-05 16:02:04,707:WARNING: 	 vision_patch_size: 32
2024-11-05 16:02:04,707:WARNING: 	 context_length: 77
2024-11-05 16:02:04,707:WARNING: 	 vocab_size: 49408
2024-11-05 16:02:04,707:WARNING: 	 transformer_width: 512
2024-11-05 16:02:04,707:WARNING: 	 transformer_heads: 8
2024-11-05 16:02:04,707:WARNING: 	 transformer_layers: 12
2024-11-05 16:02:04,707:WARNING: 		 linear_patch: 2d
2024-11-05 16:02:04,707:WARNING: 	 cut_top_layer: 0
2024-11-05 16:02:05,923:WARNING: 	 sim_header: Filip
2024-11-05 16:02:12,647:INFO: --------------------
2024-11-05 16:02:12,648:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-11-05 16:02:12,739:INFO: ***** Running test *****
2024-11-05 16:02:12,739:INFO:   Num examples = 2348
2024-11-05 16:02:12,740:INFO:   Batch size = 256
2024-11-05 16:02:12,740:INFO:   Num steps = 10
2024-11-05 16:02:13,253:WARNING: Eval under the multi-sentence per video clip setting.
2024-11-05 16:02:13,253:WARNING: sentence num: 1969, video num: 2348
2024-11-05 16:05:19,768:INFO: Effective parameters:
2024-11-05 16:05:19,768:INFO:   <<< alpha: 0.8
2024-11-05 16:05:19,768:INFO:   <<< aug_choose: t2v
2024-11-05 16:05:19,768:INFO:   <<< batch_size: 512
2024-11-05 16:05:19,768:INFO:   <<< batch_size_val: 256
2024-11-05 16:05:19,768:INFO:   <<< cache_dir: 
2024-11-05 16:05:19,768:INFO:   <<< cla_weight_dir: cla_weight
2024-11-05 16:05:19,768:INFO:   <<< coef_lr: 1.0
2024-11-05 16:05:19,768:INFO:   <<< combine_type: sum
2024-11-05 16:05:19,768:INFO:   <<< cross_att_layers: 1
2024-11-05 16:05:19,768:INFO:   <<< cross_model: cross-base
2024-11-05 16:05:19,768:INFO:   <<< cross_num_hidden_layers: 4
2024-11-05 16:05:19,768:INFO:   <<< data_path: data_h2
2024-11-05 16:05:19,768:INFO:   <<< datatype: h2s
2024-11-05 16:05:19,768:INFO:   <<< debug: False
2024-11-05 16:05:19,768:INFO:   <<< distributed: True
2024-11-05 16:05:19,768:INFO:   <<< do_eval: True
2024-11-05 16:05:19,768:INFO:   <<< do_lower_case: False
2024-11-05 16:05:19,768:INFO:   <<< do_pretrain: False
2024-11-05 16:05:19,768:INFO:   <<< do_train: False
2024-11-05 16:05:19,768:INFO:   <<< dual_mix: 0.5
2024-11-05 16:05:19,768:INFO:   <<< epochs: 200
2024-11-05 16:05:19,768:INFO:   <<< eval_frame_order: 0
2024-11-05 16:05:19,768:INFO:   <<< expand_msrvtt_sentences: False
2024-11-05 16:05:19,768:INFO:   <<< feature_framerate: 1
2024-11-05 16:05:19,768:INFO:   <<< feature_len: 64
2024-11-05 16:05:19,768:INFO:   <<< features_path: sign_feature/h2s_domain_agnostic
2024-11-05 16:05:19,768:INFO:   <<< features_path_retrain: sign_feature/h2s_domain_aware
2024-11-05 16:05:19,768:INFO:   <<< fp16: True
2024-11-05 16:05:19,768:INFO:   <<< fp16_opt_level: O1
2024-11-05 16:05:19,769:INFO:   <<< freeze_layer_num: 0
2024-11-05 16:05:19,769:INFO:   <<< gpu_ids: [0, 1]
2024-11-05 16:05:19,769:INFO:   <<< gradient_accumulation_steps: 1
2024-11-05 16:05:19,769:INFO:   <<< hard_negative_rate: 0.5
2024-11-05 16:05:19,769:INFO:   <<< init_model: chpt/H2S_sota.pth
2024-11-05 16:05:19,769:INFO:   <<< linear_patch: 2d
2024-11-05 16:05:19,769:INFO:   <<< local_rank: 0
2024-11-05 16:05:19,769:INFO:   <<< loose_type: True
2024-11-05 16:05:19,769:INFO:   <<< lr: 1e-05
2024-11-05 16:05:19,769:INFO:   <<< lr_decay: 0.001
2024-11-05 16:05:19,769:INFO:   <<< margin: 0.1
2024-11-05 16:05:19,769:INFO:   <<< max_frames: 128
2024-11-05 16:05:19,769:INFO:   <<< max_words: 32
2024-11-05 16:05:19,769:INFO:   <<< mix_design: balance
2024-11-05 16:05:19,769:INFO:   <<< n_display: 1
2024-11-05 16:05:19,769:INFO:   <<< n_gpu: 1
2024-11-05 16:05:19,769:INFO:   <<< n_pair: 1
2024-11-05 16:05:19,769:INFO:   <<< negative_weighting: 1
2024-11-05 16:05:19,769:INFO:   <<< not_load_visual: False
2024-11-05 16:05:19,769:INFO:   <<< num_thread_reader: 8
2024-11-05 16:05:19,769:INFO:   <<< output_dir: new_experiment
2024-11-05 16:05:19,769:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-11-05 16:05:19,769:INFO:   <<< rank: 0
2024-11-05 16:05:19,769:INFO:   <<< resume_model: None
2024-11-05 16:05:19,769:INFO:   <<< sampled_use_mil: False
2024-11-05 16:05:19,769:INFO:   <<< seed: 42
2024-11-05 16:05:19,769:INFO:   <<< sim_calcu: softmax_max
2024-11-05 16:05:19,769:INFO:   <<< sim_header: Filip
2024-11-05 16:05:19,769:INFO:   <<< slice_framepos: 0
2024-11-05 16:05:19,769:INFO:   <<< task_type: retrieval
2024-11-05 16:05:19,769:INFO:   <<< tau: 0.07
2024-11-05 16:05:19,769:INFO:   <<< text_aug: True
2024-11-05 16:05:19,769:INFO:   <<< text_aug_choosen: random_swap
2024-11-05 16:05:19,769:INFO:   <<< text_num_hidden_layers: 12
2024-11-05 16:05:19,769:INFO:   <<< train_frame_order: 0
2024-11-05 16:05:19,769:INFO:   <<< use_mil: False
2024-11-05 16:05:19,769:INFO:   <<< video_dim: 1024
2024-11-05 16:05:19,770:INFO:   <<< visual_num_hidden_layers: 12
2024-11-05 16:05:19,770:INFO:   <<< warmup_proportion: 0.1
2024-11-05 16:05:19,770:INFO:   <<< world_size: 1
2024-11-05 16:05:19,770:INFO: device: cuda:0 n_gpu: 1
2024-11-05 16:05:20,560:INFO: loading archive file /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base
2024-11-05 16:05:20,564:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-11-05 16:05:20,564:INFO: Weight doesn't exsits. /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base/cross_pytorch_model.bin
2024-11-05 16:05:20,564:WARNING: Stage-One:True, Stage-Two:False
2024-11-05 16:05:20,565:WARNING: Test retrieval by loose type.
2024-11-05 16:05:20,565:WARNING: 	 embed_dim: 512
2024-11-05 16:05:20,565:WARNING: 	 image_resolution: 224
2024-11-05 16:05:20,565:WARNING: 	 vision_layers: 12
2024-11-05 16:05:20,565:WARNING: 	 vision_width: 768
2024-11-05 16:05:20,565:WARNING: 	 vision_patch_size: 32
2024-11-05 16:05:20,565:WARNING: 	 context_length: 77
2024-11-05 16:05:20,565:WARNING: 	 vocab_size: 49408
2024-11-05 16:05:20,565:WARNING: 	 transformer_width: 512
2024-11-05 16:05:20,565:WARNING: 	 transformer_heads: 8
2024-11-05 16:05:20,565:WARNING: 	 transformer_layers: 12
2024-11-05 16:05:20,565:WARNING: 		 linear_patch: 2d
2024-11-05 16:05:20,565:WARNING: 	 cut_top_layer: 0
2024-11-05 16:05:21,801:WARNING: 	 sim_header: Filip
2024-11-05 16:05:28,509:INFO: --------------------
2024-11-05 16:05:28,510:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-11-05 16:05:28,588:INFO: ***** Running test *****
2024-11-05 16:05:28,588:INFO:   Num examples = 2348
2024-11-05 16:05:28,588:INFO:   Batch size = 256
2024-11-05 16:05:28,588:INFO:   Num steps = 10
2024-11-05 16:05:29,102:WARNING: Eval under the multi-sentence per video clip setting.
2024-11-05 16:05:29,102:WARNING: sentence num: 1969, video num: 2348
2024-11-05 16:39:01,806:INFO: Effective parameters:
2024-11-05 16:39:01,806:INFO:   <<< alpha: 0.8
2024-11-05 16:39:01,806:INFO:   <<< aug_choose: t2v
2024-11-05 16:39:01,806:INFO:   <<< batch_size: 512
2024-11-05 16:39:01,806:INFO:   <<< batch_size_val: 256
2024-11-05 16:39:01,806:INFO:   <<< cache_dir: 
2024-11-05 16:39:01,806:INFO:   <<< cla_weight_dir: cla_weight
2024-11-05 16:39:01,806:INFO:   <<< coef_lr: 1.0
2024-11-05 16:39:01,806:INFO:   <<< combine_type: sum
2024-11-05 16:39:01,806:INFO:   <<< cross_att_layers: 1
2024-11-05 16:39:01,806:INFO:   <<< cross_model: cross-base
2024-11-05 16:39:01,806:INFO:   <<< cross_num_hidden_layers: 4
2024-11-05 16:39:01,806:INFO:   <<< data_path: data_h2
2024-11-05 16:39:01,806:INFO:   <<< datatype: h2s
2024-11-05 16:39:01,806:INFO:   <<< debug: False
2024-11-05 16:39:01,806:INFO:   <<< distributed: True
2024-11-05 16:39:01,806:INFO:   <<< do_eval: True
2024-11-05 16:39:01,806:INFO:   <<< do_lower_case: False
2024-11-05 16:39:01,806:INFO:   <<< do_pretrain: False
2024-11-05 16:39:01,806:INFO:   <<< do_train: False
2024-11-05 16:39:01,806:INFO:   <<< dual_mix: 0.5
2024-11-05 16:39:01,806:INFO:   <<< epochs: 200
2024-11-05 16:39:01,806:INFO:   <<< eval_frame_order: 0
2024-11-05 16:39:01,806:INFO:   <<< expand_msrvtt_sentences: False
2024-11-05 16:39:01,806:INFO:   <<< feature_framerate: 1
2024-11-05 16:39:01,807:INFO:   <<< feature_len: 64
2024-11-05 16:39:01,807:INFO:   <<< features_path: sign_feature/h2s_domain_agnostic
2024-11-05 16:39:01,807:INFO:   <<< features_path_retrain: sign_feature/h2s_domain_aware
2024-11-05 16:39:01,807:INFO:   <<< fp16: True
2024-11-05 16:39:01,807:INFO:   <<< fp16_opt_level: O1
2024-11-05 16:39:01,807:INFO:   <<< freeze_layer_num: 0
2024-11-05 16:39:01,807:INFO:   <<< gpu_ids: [0, 1]
2024-11-05 16:39:01,807:INFO:   <<< gradient_accumulation_steps: 1
2024-11-05 16:39:01,807:INFO:   <<< hard_negative_rate: 0.5
2024-11-05 16:39:01,807:INFO:   <<< init_model: chpt/H2S_sota.pth
2024-11-05 16:39:01,807:INFO:   <<< linear_patch: 2d
2024-11-05 16:39:01,807:INFO:   <<< local_rank: 0
2024-11-05 16:39:01,807:INFO:   <<< loose_type: True
2024-11-05 16:39:01,807:INFO:   <<< lr: 1e-05
2024-11-05 16:39:01,807:INFO:   <<< lr_decay: 0.001
2024-11-05 16:39:01,807:INFO:   <<< margin: 0.1
2024-11-05 16:39:01,807:INFO:   <<< max_frames: 128
2024-11-05 16:39:01,807:INFO:   <<< max_words: 32
2024-11-05 16:39:01,807:INFO:   <<< mix_design: balance
2024-11-05 16:39:01,807:INFO:   <<< n_display: 1
2024-11-05 16:39:01,807:INFO:   <<< n_gpu: 1
2024-11-05 16:39:01,807:INFO:   <<< n_pair: 1
2024-11-05 16:39:01,807:INFO:   <<< negative_weighting: 1
2024-11-05 16:39:01,807:INFO:   <<< not_load_visual: False
2024-11-05 16:39:01,807:INFO:   <<< num_thread_reader: 8
2024-11-05 16:39:01,807:INFO:   <<< output_dir: new_experiment
2024-11-05 16:39:01,807:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-11-05 16:39:01,807:INFO:   <<< rank: 0
2024-11-05 16:39:01,807:INFO:   <<< resume_model: None
2024-11-05 16:39:01,807:INFO:   <<< sampled_use_mil: False
2024-11-05 16:39:01,807:INFO:   <<< seed: 42
2024-11-05 16:39:01,807:INFO:   <<< sim_calcu: softmax_max
2024-11-05 16:39:01,807:INFO:   <<< sim_header: Filip
2024-11-05 16:39:01,807:INFO:   <<< slice_framepos: 0
2024-11-05 16:39:01,807:INFO:   <<< task_type: retrieval
2024-11-05 16:39:01,807:INFO:   <<< tau: 0.07
2024-11-05 16:39:01,808:INFO:   <<< text_aug: True
2024-11-05 16:39:01,808:INFO:   <<< text_aug_choosen: random_swap
2024-11-05 16:39:01,808:INFO:   <<< text_num_hidden_layers: 12
2024-11-05 16:39:01,808:INFO:   <<< train_frame_order: 0
2024-11-05 16:39:01,808:INFO:   <<< use_mil: False
2024-11-05 16:39:01,808:INFO:   <<< video_dim: 1024
2024-11-05 16:39:01,808:INFO:   <<< visual_num_hidden_layers: 12
2024-11-05 16:39:01,808:INFO:   <<< warmup_proportion: 0.1
2024-11-05 16:39:01,808:INFO:   <<< world_size: 1
2024-11-05 16:39:01,808:INFO: device: cuda:0 n_gpu: 1
2024-11-05 16:39:02,566:INFO: loading archive file /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base
2024-11-05 16:39:02,568:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-11-05 16:39:02,568:INFO: Weight doesn't exsits. /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base/cross_pytorch_model.bin
2024-11-05 16:39:02,568:WARNING: Stage-One:True, Stage-Two:False
2024-11-05 16:39:02,568:WARNING: Test retrieval by loose type.
2024-11-05 16:39:02,568:WARNING: 	 embed_dim: 512
2024-11-05 16:39:02,568:WARNING: 	 image_resolution: 224
2024-11-05 16:39:02,568:WARNING: 	 vision_layers: 12
2024-11-05 16:39:02,568:WARNING: 	 vision_width: 768
2024-11-05 16:39:02,568:WARNING: 	 vision_patch_size: 32
2024-11-05 16:39:02,568:WARNING: 	 context_length: 77
2024-11-05 16:39:02,568:WARNING: 	 vocab_size: 49408
2024-11-05 16:39:02,568:WARNING: 	 transformer_width: 512
2024-11-05 16:39:02,568:WARNING: 	 transformer_heads: 8
2024-11-05 16:39:02,568:WARNING: 	 transformer_layers: 12
2024-11-05 16:39:02,568:WARNING: 		 linear_patch: 2d
2024-11-05 16:39:02,568:WARNING: 	 cut_top_layer: 0
2024-11-05 16:39:03,770:WARNING: 	 sim_header: Filip
2024-11-05 16:39:10,462:INFO: --------------------
2024-11-05 16:39:10,463:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-11-05 16:39:10,559:INFO: ***** Running test *****
2024-11-05 16:39:10,559:INFO:   Num examples = 2348
2024-11-05 16:39:10,559:INFO:   Batch size = 256
2024-11-05 16:39:10,559:INFO:   Num steps = 10
2024-11-05 16:39:11,211:WARNING: Eval under the multi-sentence per video clip setting.
2024-11-05 16:39:11,211:WARNING: sentence num: 1969, video num: 2348
2024-11-05 16:40:46,735:INFO: Effective parameters:
2024-11-05 16:40:46,735:INFO:   <<< alpha: 0.8
2024-11-05 16:40:46,735:INFO:   <<< aug_choose: t2v
2024-11-05 16:40:46,735:INFO:   <<< batch_size: 512
2024-11-05 16:40:46,735:INFO:   <<< batch_size_val: 256
2024-11-05 16:40:46,735:INFO:   <<< cache_dir: 
2024-11-05 16:40:46,735:INFO:   <<< cla_weight_dir: cla_weight
2024-11-05 16:40:46,735:INFO:   <<< coef_lr: 1.0
2024-11-05 16:40:46,735:INFO:   <<< combine_type: sum
2024-11-05 16:40:46,735:INFO:   <<< cross_att_layers: 1
2024-11-05 16:40:46,735:INFO:   <<< cross_model: cross-base
2024-11-05 16:40:46,735:INFO:   <<< cross_num_hidden_layers: 4
2024-11-05 16:40:46,735:INFO:   <<< data_path: data_h2
2024-11-05 16:40:46,735:INFO:   <<< datatype: h2s
2024-11-05 16:40:46,735:INFO:   <<< debug: False
2024-11-05 16:40:46,735:INFO:   <<< distributed: True
2024-11-05 16:40:46,735:INFO:   <<< do_eval: True
2024-11-05 16:40:46,735:INFO:   <<< do_lower_case: False
2024-11-05 16:40:46,735:INFO:   <<< do_pretrain: False
2024-11-05 16:40:46,735:INFO:   <<< do_train: False
2024-11-05 16:40:46,736:INFO:   <<< dual_mix: 0.5
2024-11-05 16:40:46,736:INFO:   <<< epochs: 200
2024-11-05 16:40:46,736:INFO:   <<< eval_frame_order: 0
2024-11-05 16:40:46,736:INFO:   <<< expand_msrvtt_sentences: False
2024-11-05 16:40:46,736:INFO:   <<< feature_framerate: 1
2024-11-05 16:40:46,736:INFO:   <<< feature_len: 64
2024-11-05 16:40:46,736:INFO:   <<< features_path: sign_feature/h2s_domain_agnostic
2024-11-05 16:40:46,736:INFO:   <<< features_path_retrain: sign_feature/h2s_domain_aware
2024-11-05 16:40:46,736:INFO:   <<< fp16: True
2024-11-05 16:40:46,736:INFO:   <<< fp16_opt_level: O1
2024-11-05 16:40:46,736:INFO:   <<< freeze_layer_num: 0
2024-11-05 16:40:46,736:INFO:   <<< gpu_ids: [0, 1]
2024-11-05 16:40:46,736:INFO:   <<< gradient_accumulation_steps: 1
2024-11-05 16:40:46,736:INFO:   <<< hard_negative_rate: 0.5
2024-11-05 16:40:46,736:INFO:   <<< init_model: chpt/H2S_sota.pth
2024-11-05 16:40:46,736:INFO:   <<< linear_patch: 2d
2024-11-05 16:40:46,736:INFO:   <<< local_rank: 0
2024-11-05 16:40:46,736:INFO:   <<< loose_type: True
2024-11-05 16:40:46,736:INFO:   <<< lr: 1e-05
2024-11-05 16:40:46,736:INFO:   <<< lr_decay: 0.001
2024-11-05 16:40:46,736:INFO:   <<< margin: 0.1
2024-11-05 16:40:46,736:INFO:   <<< max_frames: 128
2024-11-05 16:40:46,736:INFO:   <<< max_words: 32
2024-11-05 16:40:46,736:INFO:   <<< mix_design: balance
2024-11-05 16:40:46,736:INFO:   <<< n_display: 1
2024-11-05 16:40:46,736:INFO:   <<< n_gpu: 1
2024-11-05 16:40:46,736:INFO:   <<< n_pair: 1
2024-11-05 16:40:46,736:INFO:   <<< negative_weighting: 1
2024-11-05 16:40:46,736:INFO:   <<< not_load_visual: False
2024-11-05 16:40:46,736:INFO:   <<< num_thread_reader: 8
2024-11-05 16:40:46,736:INFO:   <<< output_dir: new_experiment
2024-11-05 16:40:46,736:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-11-05 16:40:46,736:INFO:   <<< rank: 0
2024-11-05 16:40:46,736:INFO:   <<< resume_model: None
2024-11-05 16:40:46,736:INFO:   <<< sampled_use_mil: False
2024-11-05 16:40:46,736:INFO:   <<< seed: 42
2024-11-05 16:40:46,737:INFO:   <<< sim_calcu: softmax_max
2024-11-05 16:40:46,737:INFO:   <<< sim_header: Filip
2024-11-05 16:40:46,737:INFO:   <<< slice_framepos: 0
2024-11-05 16:40:46,737:INFO:   <<< task_type: retrieval
2024-11-05 16:40:46,737:INFO:   <<< tau: 0.07
2024-11-05 16:40:46,737:INFO:   <<< text_aug: True
2024-11-05 16:40:46,737:INFO:   <<< text_aug_choosen: random_swap
2024-11-05 16:40:46,737:INFO:   <<< text_num_hidden_layers: 12
2024-11-05 16:40:46,737:INFO:   <<< train_frame_order: 0
2024-11-05 16:40:46,737:INFO:   <<< use_mil: False
2024-11-05 16:40:46,737:INFO:   <<< video_dim: 1024
2024-11-05 16:40:46,737:INFO:   <<< visual_num_hidden_layers: 12
2024-11-05 16:40:46,737:INFO:   <<< warmup_proportion: 0.1
2024-11-05 16:40:46,737:INFO:   <<< world_size: 1
2024-11-05 16:40:46,737:INFO: device: cuda:0 n_gpu: 1
2024-11-05 16:40:47,506:INFO: loading archive file /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base
2024-11-05 16:40:47,509:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-11-05 16:40:47,509:INFO: Weight doesn't exsits. /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base/cross_pytorch_model.bin
2024-11-05 16:40:47,509:WARNING: Stage-One:True, Stage-Two:False
2024-11-05 16:40:47,509:WARNING: Test retrieval by loose type.
2024-11-05 16:40:47,509:WARNING: 	 embed_dim: 512
2024-11-05 16:40:47,509:WARNING: 	 image_resolution: 224
2024-11-05 16:40:47,509:WARNING: 	 vision_layers: 12
2024-11-05 16:40:47,509:WARNING: 	 vision_width: 768
2024-11-05 16:40:47,509:WARNING: 	 vision_patch_size: 32
2024-11-05 16:40:47,509:WARNING: 	 context_length: 77
2024-11-05 16:40:47,509:WARNING: 	 vocab_size: 49408
2024-11-05 16:40:47,509:WARNING: 	 transformer_width: 512
2024-11-05 16:40:47,509:WARNING: 	 transformer_heads: 8
2024-11-05 16:40:47,509:WARNING: 	 transformer_layers: 12
2024-11-05 16:40:47,509:WARNING: 		 linear_patch: 2d
2024-11-05 16:40:47,509:WARNING: 	 cut_top_layer: 0
2024-11-05 16:40:48,708:WARNING: 	 sim_header: Filip
2024-11-05 16:40:55,404:INFO: --------------------
2024-11-05 16:40:55,405:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-11-05 16:40:55,504:INFO: ***** Running test *****
2024-11-05 16:40:55,504:INFO:   Num examples = 2348
2024-11-05 16:40:55,504:INFO:   Batch size = 256
2024-11-05 16:40:55,504:INFO:   Num steps = 10
2024-11-05 16:40:56,072:WARNING: Eval under the multi-sentence per video clip setting.
2024-11-05 16:40:56,072:WARNING: sentence num: 1969, video num: 2348
2024-11-05 16:41:48,757:INFO: Effective parameters:
2024-11-05 16:41:48,757:INFO:   <<< alpha: 0.8
2024-11-05 16:41:48,757:INFO:   <<< aug_choose: t2v
2024-11-05 16:41:48,757:INFO:   <<< batch_size: 512
2024-11-05 16:41:48,757:INFO:   <<< batch_size_val: 256
2024-11-05 16:41:48,757:INFO:   <<< cache_dir: 
2024-11-05 16:41:48,757:INFO:   <<< cla_weight_dir: cla_weight
2024-11-05 16:41:48,758:INFO:   <<< coef_lr: 1.0
2024-11-05 16:41:48,758:INFO:   <<< combine_type: sum
2024-11-05 16:41:48,758:INFO:   <<< cross_att_layers: 1
2024-11-05 16:41:48,758:INFO:   <<< cross_model: cross-base
2024-11-05 16:41:48,758:INFO:   <<< cross_num_hidden_layers: 4
2024-11-05 16:41:48,758:INFO:   <<< data_path: data_h2
2024-11-05 16:41:48,758:INFO:   <<< datatype: h2s
2024-11-05 16:41:48,758:INFO:   <<< debug: False
2024-11-05 16:41:48,758:INFO:   <<< distributed: True
2024-11-05 16:41:48,758:INFO:   <<< do_eval: True
2024-11-05 16:41:48,758:INFO:   <<< do_lower_case: False
2024-11-05 16:41:48,758:INFO:   <<< do_pretrain: False
2024-11-05 16:41:48,758:INFO:   <<< do_train: False
2024-11-05 16:41:48,758:INFO:   <<< dual_mix: 0.5
2024-11-05 16:41:48,758:INFO:   <<< epochs: 200
2024-11-05 16:41:48,758:INFO:   <<< eval_frame_order: 0
2024-11-05 16:41:48,758:INFO:   <<< expand_msrvtt_sentences: False
2024-11-05 16:41:48,758:INFO:   <<< feature_framerate: 1
2024-11-05 16:41:48,758:INFO:   <<< feature_len: 64
2024-11-05 16:41:48,758:INFO:   <<< features_path: sign_feature/h2s_domain_agnostic
2024-11-05 16:41:48,758:INFO:   <<< features_path_retrain: sign_feature/h2s_domain_aware
2024-11-05 16:41:48,758:INFO:   <<< fp16: True
2024-11-05 16:41:48,758:INFO:   <<< fp16_opt_level: O1
2024-11-05 16:41:48,758:INFO:   <<< freeze_layer_num: 0
2024-11-05 16:41:48,758:INFO:   <<< gpu_ids: [0, 1]
2024-11-05 16:41:48,758:INFO:   <<< gradient_accumulation_steps: 1
2024-11-05 16:41:48,758:INFO:   <<< hard_negative_rate: 0.5
2024-11-05 16:41:48,758:INFO:   <<< init_model: chpt/H2S_sota.pth
2024-11-05 16:41:48,758:INFO:   <<< linear_patch: 2d
2024-11-05 16:41:48,758:INFO:   <<< local_rank: 0
2024-11-05 16:41:48,758:INFO:   <<< loose_type: True
2024-11-05 16:41:48,758:INFO:   <<< lr: 1e-05
2024-11-05 16:41:48,758:INFO:   <<< lr_decay: 0.001
2024-11-05 16:41:48,758:INFO:   <<< margin: 0.1
2024-11-05 16:41:48,758:INFO:   <<< max_frames: 128
2024-11-05 16:41:48,759:INFO:   <<< max_words: 32
2024-11-05 16:41:48,759:INFO:   <<< mix_design: balance
2024-11-05 16:41:48,759:INFO:   <<< n_display: 1
2024-11-05 16:41:48,759:INFO:   <<< n_gpu: 1
2024-11-05 16:41:48,759:INFO:   <<< n_pair: 1
2024-11-05 16:41:48,759:INFO:   <<< negative_weighting: 1
2024-11-05 16:41:48,759:INFO:   <<< not_load_visual: False
2024-11-05 16:41:48,759:INFO:   <<< num_thread_reader: 8
2024-11-05 16:41:48,759:INFO:   <<< output_dir: new_experiment
2024-11-05 16:41:48,759:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-11-05 16:41:48,759:INFO:   <<< rank: 0
2024-11-05 16:41:48,759:INFO:   <<< resume_model: None
2024-11-05 16:41:48,759:INFO:   <<< sampled_use_mil: False
2024-11-05 16:41:48,759:INFO:   <<< seed: 42
2024-11-05 16:41:48,759:INFO:   <<< sim_calcu: softmax_max
2024-11-05 16:41:48,759:INFO:   <<< sim_header: Filip
2024-11-05 16:41:48,759:INFO:   <<< slice_framepos: 0
2024-11-05 16:41:48,759:INFO:   <<< task_type: retrieval
2024-11-05 16:41:48,759:INFO:   <<< tau: 0.07
2024-11-05 16:41:48,759:INFO:   <<< text_aug: True
2024-11-05 16:41:48,759:INFO:   <<< text_aug_choosen: random_swap
2024-11-05 16:41:48,759:INFO:   <<< text_num_hidden_layers: 12
2024-11-05 16:41:48,759:INFO:   <<< train_frame_order: 0
2024-11-05 16:41:48,759:INFO:   <<< use_mil: False
2024-11-05 16:41:48,759:INFO:   <<< video_dim: 1024
2024-11-05 16:41:48,759:INFO:   <<< visual_num_hidden_layers: 12
2024-11-05 16:41:48,759:INFO:   <<< warmup_proportion: 0.1
2024-11-05 16:41:48,759:INFO:   <<< world_size: 1
2024-11-05 16:41:48,760:INFO: device: cuda:0 n_gpu: 1
2024-11-05 16:41:49,519:INFO: loading archive file /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base
2024-11-05 16:41:49,522:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-11-05 16:41:49,522:INFO: Weight doesn't exsits. /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base/cross_pytorch_model.bin
2024-11-05 16:41:49,522:WARNING: Stage-One:True, Stage-Two:False
2024-11-05 16:41:49,522:WARNING: Test retrieval by loose type.
2024-11-05 16:41:49,522:WARNING: 	 embed_dim: 512
2024-11-05 16:41:49,522:WARNING: 	 image_resolution: 224
2024-11-05 16:41:49,522:WARNING: 	 vision_layers: 12
2024-11-05 16:41:49,522:WARNING: 	 vision_width: 768
2024-11-05 16:41:49,522:WARNING: 	 vision_patch_size: 32
2024-11-05 16:41:49,522:WARNING: 	 context_length: 77
2024-11-05 16:41:49,522:WARNING: 	 vocab_size: 49408
2024-11-05 16:41:49,522:WARNING: 	 transformer_width: 512
2024-11-05 16:41:49,522:WARNING: 	 transformer_heads: 8
2024-11-05 16:41:49,522:WARNING: 	 transformer_layers: 12
2024-11-05 16:41:49,522:WARNING: 		 linear_patch: 2d
2024-11-05 16:41:49,522:WARNING: 	 cut_top_layer: 0
2024-11-05 16:41:50,723:WARNING: 	 sim_header: Filip
2024-11-05 16:41:57,410:INFO: --------------------
2024-11-05 16:41:57,411:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-11-05 16:41:57,509:INFO: ***** Running test *****
2024-11-05 16:41:57,509:INFO:   Num examples = 2348
2024-11-05 16:41:57,509:INFO:   Batch size = 256
2024-11-05 16:41:57,509:INFO:   Num steps = 10
2024-11-05 16:41:58,132:WARNING: Eval under the multi-sentence per video clip setting.
2024-11-05 16:41:58,132:WARNING: sentence num: 1969, video num: 2348
2024-11-05 16:43:33,389:INFO: Effective parameters:
2024-11-05 16:43:33,389:INFO:   <<< alpha: 0.8
2024-11-05 16:43:33,389:INFO:   <<< aug_choose: t2v
2024-11-05 16:43:33,389:INFO:   <<< batch_size: 512
2024-11-05 16:43:33,389:INFO:   <<< batch_size_val: 256
2024-11-05 16:43:33,389:INFO:   <<< cache_dir: 
2024-11-05 16:43:33,389:INFO:   <<< cla_weight_dir: cla_weight
2024-11-05 16:43:33,389:INFO:   <<< coef_lr: 1.0
2024-11-05 16:43:33,389:INFO:   <<< combine_type: sum
2024-11-05 16:43:33,389:INFO:   <<< cross_att_layers: 1
2024-11-05 16:43:33,389:INFO:   <<< cross_model: cross-base
2024-11-05 16:43:33,389:INFO:   <<< cross_num_hidden_layers: 4
2024-11-05 16:43:33,389:INFO:   <<< data_path: data_h2
2024-11-05 16:43:33,389:INFO:   <<< datatype: h2s
2024-11-05 16:43:33,389:INFO:   <<< debug: False
2024-11-05 16:43:33,389:INFO:   <<< distributed: True
2024-11-05 16:43:33,389:INFO:   <<< do_eval: True
2024-11-05 16:43:33,389:INFO:   <<< do_lower_case: False
2024-11-05 16:43:33,389:INFO:   <<< do_pretrain: False
2024-11-05 16:43:33,389:INFO:   <<< do_train: False
2024-11-05 16:43:33,389:INFO:   <<< dual_mix: 0.5
2024-11-05 16:43:33,389:INFO:   <<< epochs: 200
2024-11-05 16:43:33,389:INFO:   <<< eval_frame_order: 0
2024-11-05 16:43:33,389:INFO:   <<< expand_msrvtt_sentences: False
2024-11-05 16:43:33,389:INFO:   <<< feature_framerate: 1
2024-11-05 16:43:33,389:INFO:   <<< feature_len: 64
2024-11-05 16:43:33,390:INFO:   <<< features_path: sign_feature/h2s_domain_agnostic
2024-11-05 16:43:33,390:INFO:   <<< features_path_retrain: sign_feature/h2s_domain_aware
2024-11-05 16:43:33,390:INFO:   <<< fp16: True
2024-11-05 16:43:33,390:INFO:   <<< fp16_opt_level: O1
2024-11-05 16:43:33,390:INFO:   <<< freeze_layer_num: 0
2024-11-05 16:43:33,390:INFO:   <<< gpu_ids: [0, 1]
2024-11-05 16:43:33,390:INFO:   <<< gradient_accumulation_steps: 1
2024-11-05 16:43:33,390:INFO:   <<< hard_negative_rate: 0.5
2024-11-05 16:43:33,390:INFO:   <<< init_model: chpt/H2S_sota.pth
2024-11-05 16:43:33,390:INFO:   <<< linear_patch: 2d
2024-11-05 16:43:33,390:INFO:   <<< local_rank: 0
2024-11-05 16:43:33,390:INFO:   <<< loose_type: True
2024-11-05 16:43:33,390:INFO:   <<< lr: 1e-05
2024-11-05 16:43:33,390:INFO:   <<< lr_decay: 0.001
2024-11-05 16:43:33,390:INFO:   <<< margin: 0.1
2024-11-05 16:43:33,390:INFO:   <<< max_frames: 128
2024-11-05 16:43:33,390:INFO:   <<< max_words: 32
2024-11-05 16:43:33,390:INFO:   <<< mix_design: balance
2024-11-05 16:43:33,390:INFO:   <<< n_display: 1
2024-11-05 16:43:33,390:INFO:   <<< n_gpu: 1
2024-11-05 16:43:33,390:INFO:   <<< n_pair: 1
2024-11-05 16:43:33,390:INFO:   <<< negative_weighting: 1
2024-11-05 16:43:33,390:INFO:   <<< not_load_visual: False
2024-11-05 16:43:33,390:INFO:   <<< num_thread_reader: 8
2024-11-05 16:43:33,390:INFO:   <<< output_dir: new_experiment
2024-11-05 16:43:33,390:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-11-05 16:43:33,390:INFO:   <<< rank: 0
2024-11-05 16:43:33,390:INFO:   <<< resume_model: None
2024-11-05 16:43:33,390:INFO:   <<< sampled_use_mil: False
2024-11-05 16:43:33,390:INFO:   <<< seed: 42
2024-11-05 16:43:33,390:INFO:   <<< sim_calcu: softmax_max
2024-11-05 16:43:33,390:INFO:   <<< sim_header: Filip
2024-11-05 16:43:33,390:INFO:   <<< slice_framepos: 0
2024-11-05 16:43:33,390:INFO:   <<< task_type: retrieval
2024-11-05 16:43:33,390:INFO:   <<< tau: 0.07
2024-11-05 16:43:33,391:INFO:   <<< text_aug: True
2024-11-05 16:43:33,391:INFO:   <<< text_aug_choosen: random_swap
2024-11-05 16:43:33,391:INFO:   <<< text_num_hidden_layers: 12
2024-11-05 16:43:33,391:INFO:   <<< train_frame_order: 0
2024-11-05 16:43:33,391:INFO:   <<< use_mil: False
2024-11-05 16:43:33,391:INFO:   <<< video_dim: 1024
2024-11-05 16:43:33,391:INFO:   <<< visual_num_hidden_layers: 12
2024-11-05 16:43:33,391:INFO:   <<< warmup_proportion: 0.1
2024-11-05 16:43:33,391:INFO:   <<< world_size: 1
2024-11-05 16:43:33,391:INFO: device: cuda:0 n_gpu: 1
2024-11-05 16:43:34,150:INFO: loading archive file /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base
2024-11-05 16:43:34,152:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-11-05 16:43:34,152:INFO: Weight doesn't exsits. /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base/cross_pytorch_model.bin
2024-11-05 16:43:34,152:WARNING: Stage-One:True, Stage-Two:False
2024-11-05 16:43:34,152:WARNING: Test retrieval by loose type.
2024-11-05 16:43:34,152:WARNING: 	 embed_dim: 512
2024-11-05 16:43:34,152:WARNING: 	 image_resolution: 224
2024-11-05 16:43:34,152:WARNING: 	 vision_layers: 12
2024-11-05 16:43:34,152:WARNING: 	 vision_width: 768
2024-11-05 16:43:34,152:WARNING: 	 vision_patch_size: 32
2024-11-05 16:43:34,152:WARNING: 	 context_length: 77
2024-11-05 16:43:34,152:WARNING: 	 vocab_size: 49408
2024-11-05 16:43:34,153:WARNING: 	 transformer_width: 512
2024-11-05 16:43:34,153:WARNING: 	 transformer_heads: 8
2024-11-05 16:43:34,153:WARNING: 	 transformer_layers: 12
2024-11-05 16:43:34,153:WARNING: 		 linear_patch: 2d
2024-11-05 16:43:34,153:WARNING: 	 cut_top_layer: 0
2024-11-05 16:43:35,355:WARNING: 	 sim_header: Filip
2024-11-05 16:43:42,080:INFO: --------------------
2024-11-05 16:43:42,081:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-11-05 16:43:42,158:INFO: ***** Running test *****
2024-11-05 16:43:42,158:INFO:   Num examples = 2348
2024-11-05 16:43:42,158:INFO:   Batch size = 256
2024-11-05 16:43:42,158:INFO:   Num steps = 10
2024-11-05 16:43:42,727:WARNING: Eval under the multi-sentence per video clip setting.
2024-11-05 16:43:42,727:WARNING: sentence num: 1969, video num: 2348
2024-11-05 16:44:54,776:INFO: Effective parameters:
2024-11-05 16:44:54,776:INFO:   <<< alpha: 0.8
2024-11-05 16:44:54,776:INFO:   <<< aug_choose: t2v
2024-11-05 16:44:54,776:INFO:   <<< batch_size: 512
2024-11-05 16:44:54,776:INFO:   <<< batch_size_val: 256
2024-11-05 16:44:54,776:INFO:   <<< cache_dir: 
2024-11-05 16:44:54,776:INFO:   <<< cla_weight_dir: cla_weight
2024-11-05 16:44:54,776:INFO:   <<< coef_lr: 1.0
2024-11-05 16:44:54,776:INFO:   <<< combine_type: sum
2024-11-05 16:44:54,776:INFO:   <<< cross_att_layers: 1
2024-11-05 16:44:54,776:INFO:   <<< cross_model: cross-base
2024-11-05 16:44:54,776:INFO:   <<< cross_num_hidden_layers: 4
2024-11-05 16:44:54,776:INFO:   <<< data_path: data_h2
2024-11-05 16:44:54,776:INFO:   <<< datatype: h2s
2024-11-05 16:44:54,776:INFO:   <<< debug: False
2024-11-05 16:44:54,776:INFO:   <<< distributed: True
2024-11-05 16:44:54,776:INFO:   <<< do_eval: True
2024-11-05 16:44:54,776:INFO:   <<< do_lower_case: False
2024-11-05 16:44:54,776:INFO:   <<< do_pretrain: False
2024-11-05 16:44:54,776:INFO:   <<< do_train: False
2024-11-05 16:44:54,776:INFO:   <<< dual_mix: 0.5
2024-11-05 16:44:54,776:INFO:   <<< epochs: 200
2024-11-05 16:44:54,776:INFO:   <<< eval_frame_order: 0
2024-11-05 16:44:54,777:INFO:   <<< expand_msrvtt_sentences: False
2024-11-05 16:44:54,777:INFO:   <<< feature_framerate: 1
2024-11-05 16:44:54,777:INFO:   <<< feature_len: 64
2024-11-05 16:44:54,777:INFO:   <<< features_path: sign_feature/h2s_domain_agnostic
2024-11-05 16:44:54,777:INFO:   <<< features_path_retrain: sign_feature/h2s_domain_aware
2024-11-05 16:44:54,777:INFO:   <<< fp16: True
2024-11-05 16:44:54,777:INFO:   <<< fp16_opt_level: O1
2024-11-05 16:44:54,777:INFO:   <<< freeze_layer_num: 0
2024-11-05 16:44:54,777:INFO:   <<< gpu_ids: [0, 1]
2024-11-05 16:44:54,777:INFO:   <<< gradient_accumulation_steps: 1
2024-11-05 16:44:54,777:INFO:   <<< hard_negative_rate: 0.5
2024-11-05 16:44:54,777:INFO:   <<< init_model: chpt/H2S_sota.pth
2024-11-05 16:44:54,777:INFO:   <<< linear_patch: 2d
2024-11-05 16:44:54,777:INFO:   <<< local_rank: 0
2024-11-05 16:44:54,777:INFO:   <<< loose_type: True
2024-11-05 16:44:54,777:INFO:   <<< lr: 1e-05
2024-11-05 16:44:54,777:INFO:   <<< lr_decay: 0.001
2024-11-05 16:44:54,777:INFO:   <<< margin: 0.1
2024-11-05 16:44:54,777:INFO:   <<< max_frames: 128
2024-11-05 16:44:54,777:INFO:   <<< max_words: 32
2024-11-05 16:44:54,777:INFO:   <<< mix_design: balance
2024-11-05 16:44:54,777:INFO:   <<< n_display: 1
2024-11-05 16:44:54,777:INFO:   <<< n_gpu: 1
2024-11-05 16:44:54,777:INFO:   <<< n_pair: 1
2024-11-05 16:44:54,777:INFO:   <<< negative_weighting: 1
2024-11-05 16:44:54,777:INFO:   <<< not_load_visual: False
2024-11-05 16:44:54,777:INFO:   <<< num_thread_reader: 8
2024-11-05 16:44:54,777:INFO:   <<< output_dir: new_experiment
2024-11-05 16:44:54,777:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-11-05 16:44:54,777:INFO:   <<< rank: 0
2024-11-05 16:44:54,777:INFO:   <<< resume_model: None
2024-11-05 16:44:54,777:INFO:   <<< sampled_use_mil: False
2024-11-05 16:44:54,777:INFO:   <<< seed: 42
2024-11-05 16:44:54,777:INFO:   <<< sim_calcu: softmax_max
2024-11-05 16:44:54,778:INFO:   <<< sim_header: Filip
2024-11-05 16:44:54,778:INFO:   <<< slice_framepos: 0
2024-11-05 16:44:54,778:INFO:   <<< task_type: retrieval
2024-11-05 16:44:54,778:INFO:   <<< tau: 0.07
2024-11-05 16:44:54,778:INFO:   <<< text_aug: True
2024-11-05 16:44:54,778:INFO:   <<< text_aug_choosen: random_swap
2024-11-05 16:44:54,778:INFO:   <<< text_num_hidden_layers: 12
2024-11-05 16:44:54,778:INFO:   <<< train_frame_order: 0
2024-11-05 16:44:54,778:INFO:   <<< use_mil: False
2024-11-05 16:44:54,778:INFO:   <<< video_dim: 1024
2024-11-05 16:44:54,778:INFO:   <<< visual_num_hidden_layers: 12
2024-11-05 16:44:54,778:INFO:   <<< warmup_proportion: 0.1
2024-11-05 16:44:54,778:INFO:   <<< world_size: 1
2024-11-05 16:44:54,778:INFO: device: cuda:0 n_gpu: 1
2024-11-05 16:44:55,535:INFO: loading archive file /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base
2024-11-05 16:44:55,536:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-11-05 16:44:55,536:INFO: Weight doesn't exsits. /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base/cross_pytorch_model.bin
2024-11-05 16:44:55,536:WARNING: Stage-One:True, Stage-Two:False
2024-11-05 16:44:55,536:WARNING: Test retrieval by loose type.
2024-11-05 16:44:55,536:WARNING: 	 embed_dim: 512
2024-11-05 16:44:55,537:WARNING: 	 image_resolution: 224
2024-11-05 16:44:55,537:WARNING: 	 vision_layers: 12
2024-11-05 16:44:55,537:WARNING: 	 vision_width: 768
2024-11-05 16:44:55,537:WARNING: 	 vision_patch_size: 32
2024-11-05 16:44:55,537:WARNING: 	 context_length: 77
2024-11-05 16:44:55,537:WARNING: 	 vocab_size: 49408
2024-11-05 16:44:55,537:WARNING: 	 transformer_width: 512
2024-11-05 16:44:55,537:WARNING: 	 transformer_heads: 8
2024-11-05 16:44:55,537:WARNING: 	 transformer_layers: 12
2024-11-05 16:44:55,537:WARNING: 		 linear_patch: 2d
2024-11-05 16:44:55,537:WARNING: 	 cut_top_layer: 0
2024-11-05 16:44:56,745:WARNING: 	 sim_header: Filip
2024-11-05 16:45:03,432:INFO: --------------------
2024-11-05 16:45:03,433:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-11-05 16:45:03,505:INFO: ***** Running test *****
2024-11-05 16:45:03,505:INFO:   Num examples = 2348
2024-11-05 16:45:03,506:INFO:   Batch size = 256
2024-11-05 16:45:03,506:INFO:   Num steps = 10
2024-11-05 16:45:04,073:WARNING: Eval under the multi-sentence per video clip setting.
2024-11-05 16:45:04,073:WARNING: sentence num: 1969, video num: 2348
2024-11-05 16:55:55,989:INFO: Effective parameters:
2024-11-05 16:55:55,989:INFO:   <<< alpha: 0.8
2024-11-05 16:55:55,989:INFO:   <<< aug_choose: t2v
2024-11-05 16:55:55,989:INFO:   <<< batch_size: 512
2024-11-05 16:55:55,989:INFO:   <<< batch_size_val: 256
2024-11-05 16:55:55,989:INFO:   <<< cache_dir: 
2024-11-05 16:55:55,989:INFO:   <<< cla_weight_dir: cla_weight
2024-11-05 16:55:55,989:INFO:   <<< coef_lr: 1.0
2024-11-05 16:55:55,989:INFO:   <<< combine_type: sum
2024-11-05 16:55:55,989:INFO:   <<< cross_att_layers: 1
2024-11-05 16:55:55,989:INFO:   <<< cross_model: cross-base
2024-11-05 16:55:55,989:INFO:   <<< cross_num_hidden_layers: 4
2024-11-05 16:55:55,989:INFO:   <<< data_path: data_h2
2024-11-05 16:55:55,989:INFO:   <<< datatype: h2s
2024-11-05 16:55:55,989:INFO:   <<< debug: False
2024-11-05 16:55:55,989:INFO:   <<< distributed: True
2024-11-05 16:55:55,989:INFO:   <<< do_eval: True
2024-11-05 16:55:55,989:INFO:   <<< do_lower_case: False
2024-11-05 16:55:55,989:INFO:   <<< do_pretrain: False
2024-11-05 16:55:55,989:INFO:   <<< do_train: False
2024-11-05 16:55:55,989:INFO:   <<< dual_mix: 0.5
2024-11-05 16:55:55,989:INFO:   <<< epochs: 200
2024-11-05 16:55:55,989:INFO:   <<< eval_frame_order: 0
2024-11-05 16:55:55,989:INFO:   <<< expand_msrvtt_sentences: False
2024-11-05 16:55:55,990:INFO:   <<< feature_framerate: 1
2024-11-05 16:55:55,990:INFO:   <<< feature_len: 64
2024-11-05 16:55:55,990:INFO:   <<< features_path: sign_feature/h2s_domain_agnostic
2024-11-05 16:55:55,990:INFO:   <<< features_path_retrain: sign_feature/h2s_domain_aware
2024-11-05 16:55:55,990:INFO:   <<< fp16: True
2024-11-05 16:55:55,990:INFO:   <<< fp16_opt_level: O1
2024-11-05 16:55:55,990:INFO:   <<< freeze_layer_num: 0
2024-11-05 16:55:55,990:INFO:   <<< gpu_ids: [0, 1]
2024-11-05 16:55:55,990:INFO:   <<< gradient_accumulation_steps: 1
2024-11-05 16:55:55,990:INFO:   <<< hard_negative_rate: 0.5
2024-11-05 16:55:55,990:INFO:   <<< init_model: chpt/H2S_sota.pth
2024-11-05 16:55:55,990:INFO:   <<< linear_patch: 2d
2024-11-05 16:55:55,990:INFO:   <<< local_rank: 0
2024-11-05 16:55:55,990:INFO:   <<< loose_type: True
2024-11-05 16:55:55,990:INFO:   <<< lr: 1e-05
2024-11-05 16:55:55,990:INFO:   <<< lr_decay: 0.001
2024-11-05 16:55:55,990:INFO:   <<< margin: 0.1
2024-11-05 16:55:55,990:INFO:   <<< max_frames: 128
2024-11-05 16:55:55,990:INFO:   <<< max_words: 32
2024-11-05 16:55:55,990:INFO:   <<< mix_design: balance
2024-11-05 16:55:55,990:INFO:   <<< n_display: 1
2024-11-05 16:55:55,990:INFO:   <<< n_gpu: 1
2024-11-05 16:55:55,990:INFO:   <<< n_pair: 1
2024-11-05 16:55:55,990:INFO:   <<< negative_weighting: 1
2024-11-05 16:55:55,990:INFO:   <<< not_load_visual: False
2024-11-05 16:55:55,990:INFO:   <<< num_thread_reader: 8
2024-11-05 16:55:55,990:INFO:   <<< output_dir: new_experiment
2024-11-05 16:55:55,990:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-11-05 16:55:55,990:INFO:   <<< rank: 0
2024-11-05 16:55:55,990:INFO:   <<< resume_model: None
2024-11-05 16:55:55,990:INFO:   <<< sampled_use_mil: False
2024-11-05 16:55:55,990:INFO:   <<< seed: 42
2024-11-05 16:55:55,990:INFO:   <<< sim_calcu: softmax_max
2024-11-05 16:55:55,990:INFO:   <<< sim_header: Filip
2024-11-05 16:55:55,990:INFO:   <<< slice_framepos: 0
2024-11-05 16:55:55,990:INFO:   <<< task_type: retrieval
2024-11-05 16:55:55,991:INFO:   <<< tau: 0.07
2024-11-05 16:55:55,991:INFO:   <<< text_aug: True
2024-11-05 16:55:55,991:INFO:   <<< text_aug_choosen: random_swap
2024-11-05 16:55:55,991:INFO:   <<< text_num_hidden_layers: 12
2024-11-05 16:55:55,991:INFO:   <<< train_frame_order: 0
2024-11-05 16:55:55,991:INFO:   <<< use_mil: False
2024-11-05 16:55:55,991:INFO:   <<< video_dim: 1024
2024-11-05 16:55:55,991:INFO:   <<< visual_num_hidden_layers: 12
2024-11-05 16:55:55,991:INFO:   <<< warmup_proportion: 0.1
2024-11-05 16:55:55,991:INFO:   <<< world_size: 1
2024-11-05 16:55:55,991:INFO: device: cuda:0 n_gpu: 1
2024-11-05 16:55:56,749:INFO: loading archive file /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base
2024-11-05 16:55:56,750:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-11-05 16:55:56,750:INFO: Weight doesn't exsits. /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base/cross_pytorch_model.bin
2024-11-05 16:55:56,750:WARNING: Stage-One:True, Stage-Two:False
2024-11-05 16:55:56,750:WARNING: Test retrieval by loose type.
2024-11-05 16:55:56,750:WARNING: 	 embed_dim: 512
2024-11-05 16:55:56,750:WARNING: 	 image_resolution: 224
2024-11-05 16:55:56,750:WARNING: 	 vision_layers: 12
2024-11-05 16:55:56,750:WARNING: 	 vision_width: 768
2024-11-05 16:55:56,750:WARNING: 	 vision_patch_size: 32
2024-11-05 16:55:56,751:WARNING: 	 context_length: 77
2024-11-05 16:55:56,751:WARNING: 	 vocab_size: 49408
2024-11-05 16:55:56,751:WARNING: 	 transformer_width: 512
2024-11-05 16:55:56,751:WARNING: 	 transformer_heads: 8
2024-11-05 16:55:56,751:WARNING: 	 transformer_layers: 12
2024-11-05 16:55:56,751:WARNING: 		 linear_patch: 2d
2024-11-05 16:55:56,751:WARNING: 	 cut_top_layer: 0
2024-11-05 16:55:57,954:WARNING: 	 sim_header: Filip
2024-11-05 16:56:04,646:INFO: --------------------
2024-11-05 16:56:04,647:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-11-05 16:56:04,743:INFO: ***** Running test *****
2024-11-05 16:56:04,743:INFO:   Num examples = 2348
2024-11-05 16:56:04,743:INFO:   Batch size = 256
2024-11-05 16:56:04,743:INFO:   Num steps = 10
2024-11-05 16:56:05,372:WARNING: Eval under the multi-sentence per video clip setting.
2024-11-05 16:56:05,372:WARNING: sentence num: 1969, video num: 2348
2024-11-05 17:06:03,675:INFO: Effective parameters:
2024-11-05 17:06:03,675:INFO:   <<< alpha: 0.8
2024-11-05 17:06:03,675:INFO:   <<< aug_choose: t2v
2024-11-05 17:06:03,675:INFO:   <<< batch_size: 512
2024-11-05 17:06:03,675:INFO:   <<< batch_size_val: 256
2024-11-05 17:06:03,675:INFO:   <<< cache_dir: 
2024-11-05 17:06:03,675:INFO:   <<< cla_weight_dir: cla_weight
2024-11-05 17:06:03,675:INFO:   <<< coef_lr: 1.0
2024-11-05 17:06:03,675:INFO:   <<< combine_type: sum
2024-11-05 17:06:03,675:INFO:   <<< cross_att_layers: 1
2024-11-05 17:06:03,675:INFO:   <<< cross_model: cross-base
2024-11-05 17:06:03,675:INFO:   <<< cross_num_hidden_layers: 4
2024-11-05 17:06:03,675:INFO:   <<< data_path: data_h2
2024-11-05 17:06:03,675:INFO:   <<< datatype: h2s
2024-11-05 17:06:03,676:INFO:   <<< debug: False
2024-11-05 17:06:03,676:INFO:   <<< distributed: True
2024-11-05 17:06:03,676:INFO:   <<< do_eval: True
2024-11-05 17:06:03,676:INFO:   <<< do_lower_case: False
2024-11-05 17:06:03,676:INFO:   <<< do_pretrain: False
2024-11-05 17:06:03,676:INFO:   <<< do_train: False
2024-11-05 17:06:03,676:INFO:   <<< dual_mix: 0.5
2024-11-05 17:06:03,676:INFO:   <<< epochs: 200
2024-11-05 17:06:03,676:INFO:   <<< eval_frame_order: 0
2024-11-05 17:06:03,676:INFO:   <<< expand_msrvtt_sentences: False
2024-11-05 17:06:03,676:INFO:   <<< feature_framerate: 1
2024-11-05 17:06:03,676:INFO:   <<< feature_len: 64
2024-11-05 17:06:03,676:INFO:   <<< features_path: sign_feature/h2s_domain_agnostic
2024-11-05 17:06:03,676:INFO:   <<< features_path_retrain: sign_feature/h2s_domain_aware
2024-11-05 17:06:03,676:INFO:   <<< fp16: True
2024-11-05 17:06:03,676:INFO:   <<< fp16_opt_level: O1
2024-11-05 17:06:03,676:INFO:   <<< freeze_layer_num: 0
2024-11-05 17:06:03,676:INFO:   <<< gpu_ids: [0, 1]
2024-11-05 17:06:03,676:INFO:   <<< gradient_accumulation_steps: 1
2024-11-05 17:06:03,676:INFO:   <<< hard_negative_rate: 0.5
2024-11-05 17:06:03,676:INFO:   <<< init_model: chpt/H2S_sota.pth
2024-11-05 17:06:03,676:INFO:   <<< linear_patch: 2d
2024-11-05 17:06:03,676:INFO:   <<< local_rank: 0
2024-11-05 17:06:03,676:INFO:   <<< loose_type: True
2024-11-05 17:06:03,676:INFO:   <<< lr: 1e-05
2024-11-05 17:06:03,676:INFO:   <<< lr_decay: 0.001
2024-11-05 17:06:03,676:INFO:   <<< margin: 0.1
2024-11-05 17:06:03,676:INFO:   <<< max_frames: 128
2024-11-05 17:06:03,676:INFO:   <<< max_words: 32
2024-11-05 17:06:03,676:INFO:   <<< mix_design: balance
2024-11-05 17:06:03,676:INFO:   <<< n_display: 1
2024-11-05 17:06:03,676:INFO:   <<< n_gpu: 1
2024-11-05 17:06:03,676:INFO:   <<< n_pair: 1
2024-11-05 17:06:03,676:INFO:   <<< negative_weighting: 1
2024-11-05 17:06:03,677:INFO:   <<< not_load_visual: False
2024-11-05 17:06:03,677:INFO:   <<< num_thread_reader: 8
2024-11-05 17:06:03,677:INFO:   <<< output_dir: new_experiment
2024-11-05 17:06:03,677:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-11-05 17:06:03,677:INFO:   <<< rank: 0
2024-11-05 17:06:03,677:INFO:   <<< resume_model: None
2024-11-05 17:06:03,677:INFO:   <<< sampled_use_mil: False
2024-11-05 17:06:03,677:INFO:   <<< seed: 42
2024-11-05 17:06:03,677:INFO:   <<< sim_calcu: softmax_max
2024-11-05 17:06:03,677:INFO:   <<< sim_header: Filip
2024-11-05 17:06:03,677:INFO:   <<< slice_framepos: 0
2024-11-05 17:06:03,677:INFO:   <<< task_type: retrieval
2024-11-05 17:06:03,677:INFO:   <<< tau: 0.07
2024-11-05 17:06:03,677:INFO:   <<< text_aug: True
2024-11-05 17:06:03,677:INFO:   <<< text_aug_choosen: random_swap
2024-11-05 17:06:03,677:INFO:   <<< text_num_hidden_layers: 12
2024-11-05 17:06:03,677:INFO:   <<< train_frame_order: 0
2024-11-05 17:06:03,677:INFO:   <<< use_mil: False
2024-11-05 17:06:03,677:INFO:   <<< video_dim: 1024
2024-11-05 17:06:03,677:INFO:   <<< visual_num_hidden_layers: 12
2024-11-05 17:06:03,677:INFO:   <<< warmup_proportion: 0.1
2024-11-05 17:06:03,677:INFO:   <<< world_size: 1
2024-11-05 17:06:03,677:INFO: device: cuda:0 n_gpu: 1
2024-11-05 17:06:04,435:INFO: loading archive file /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base
2024-11-05 17:06:04,437:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-11-05 17:06:04,437:INFO: Weight doesn't exsits. /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base/cross_pytorch_model.bin
2024-11-05 17:06:04,437:WARNING: Stage-One:True, Stage-Two:False
2024-11-05 17:06:04,437:WARNING: Test retrieval by loose type.
2024-11-05 17:06:04,438:WARNING: 	 embed_dim: 512
2024-11-05 17:06:04,438:WARNING: 	 image_resolution: 224
2024-11-05 17:06:04,438:WARNING: 	 vision_layers: 12
2024-11-05 17:06:04,438:WARNING: 	 vision_width: 768
2024-11-05 17:06:04,438:WARNING: 	 vision_patch_size: 32
2024-11-05 17:06:04,438:WARNING: 	 context_length: 77
2024-11-05 17:06:04,438:WARNING: 	 vocab_size: 49408
2024-11-05 17:06:04,438:WARNING: 	 transformer_width: 512
2024-11-05 17:06:04,438:WARNING: 	 transformer_heads: 8
2024-11-05 17:06:04,438:WARNING: 	 transformer_layers: 12
2024-11-05 17:06:04,438:WARNING: 		 linear_patch: 2d
2024-11-05 17:06:04,438:WARNING: 	 cut_top_layer: 0
2024-11-05 17:06:05,634:WARNING: 	 sim_header: Filip
2024-11-05 17:06:12,322:INFO: --------------------
2024-11-05 17:06:12,324:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-11-05 17:06:12,414:INFO: ***** Running test *****
2024-11-05 17:06:12,414:INFO:   Num examples = 2348
2024-11-05 17:06:12,414:INFO:   Batch size = 256
2024-11-05 17:06:12,414:INFO:   Num steps = 10
2024-11-05 17:06:12,946:WARNING: Eval under the multi-sentence per video clip setting.
2024-11-05 17:06:12,946:WARNING: sentence num: 1969, video num: 2348
2024-11-05 17:09:40,932:INFO: Effective parameters:
2024-11-05 17:09:40,932:INFO:   <<< alpha: 0.8
2024-11-05 17:09:40,932:INFO:   <<< aug_choose: t2v
2024-11-05 17:09:40,932:INFO:   <<< batch_size: 512
2024-11-05 17:09:40,932:INFO:   <<< batch_size_val: 256
2024-11-05 17:09:40,932:INFO:   <<< cache_dir: 
2024-11-05 17:09:40,932:INFO:   <<< cla_weight_dir: cla_weight
2024-11-05 17:09:40,932:INFO:   <<< coef_lr: 1.0
2024-11-05 17:09:40,932:INFO:   <<< combine_type: sum
2024-11-05 17:09:40,933:INFO:   <<< cross_att_layers: 1
2024-11-05 17:09:40,933:INFO:   <<< cross_model: cross-base
2024-11-05 17:09:40,933:INFO:   <<< cross_num_hidden_layers: 4
2024-11-05 17:09:40,933:INFO:   <<< data_path: data_h2
2024-11-05 17:09:40,933:INFO:   <<< datatype: h2s
2024-11-05 17:09:40,933:INFO:   <<< debug: False
2024-11-05 17:09:40,933:INFO:   <<< distributed: True
2024-11-05 17:09:40,933:INFO:   <<< do_eval: True
2024-11-05 17:09:40,933:INFO:   <<< do_lower_case: False
2024-11-05 17:09:40,933:INFO:   <<< do_pretrain: False
2024-11-05 17:09:40,933:INFO:   <<< do_train: False
2024-11-05 17:09:40,933:INFO:   <<< dual_mix: 0.5
2024-11-05 17:09:40,933:INFO:   <<< epochs: 200
2024-11-05 17:09:40,933:INFO:   <<< eval_frame_order: 0
2024-11-05 17:09:40,933:INFO:   <<< expand_msrvtt_sentences: False
2024-11-05 17:09:40,933:INFO:   <<< feature_framerate: 1
2024-11-05 17:09:40,933:INFO:   <<< feature_len: 64
2024-11-05 17:09:40,933:INFO:   <<< features_path: sign_feature/h2s_domain_agnostic
2024-11-05 17:09:40,933:INFO:   <<< features_path_retrain: sign_feature/h2s_domain_aware
2024-11-05 17:09:40,933:INFO:   <<< fp16: True
2024-11-05 17:09:40,933:INFO:   <<< fp16_opt_level: O1
2024-11-05 17:09:40,933:INFO:   <<< freeze_layer_num: 0
2024-11-05 17:09:40,933:INFO:   <<< gpu_ids: [0, 1]
2024-11-05 17:09:40,933:INFO:   <<< gradient_accumulation_steps: 1
2024-11-05 17:09:40,933:INFO:   <<< hard_negative_rate: 0.5
2024-11-05 17:09:40,933:INFO:   <<< init_model: chpt/H2S_sota.pth
2024-11-05 17:09:40,933:INFO:   <<< linear_patch: 2d
2024-11-05 17:09:40,933:INFO:   <<< local_rank: 0
2024-11-05 17:09:40,933:INFO:   <<< loose_type: True
2024-11-05 17:09:40,933:INFO:   <<< lr: 1e-05
2024-11-05 17:09:40,933:INFO:   <<< lr_decay: 0.001
2024-11-05 17:09:40,933:INFO:   <<< margin: 0.1
2024-11-05 17:09:40,933:INFO:   <<< max_frames: 128
2024-11-05 17:09:40,933:INFO:   <<< max_words: 32
2024-11-05 17:09:40,933:INFO:   <<< mix_design: balance
2024-11-05 17:09:40,933:INFO:   <<< n_display: 1
2024-11-05 17:09:40,934:INFO:   <<< n_gpu: 1
2024-11-05 17:09:40,934:INFO:   <<< n_pair: 1
2024-11-05 17:09:40,934:INFO:   <<< negative_weighting: 1
2024-11-05 17:09:40,934:INFO:   <<< not_load_visual: False
2024-11-05 17:09:40,934:INFO:   <<< num_thread_reader: 8
2024-11-05 17:09:40,934:INFO:   <<< output_dir: new_experiment
2024-11-05 17:09:40,934:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-11-05 17:09:40,934:INFO:   <<< rank: 0
2024-11-05 17:09:40,934:INFO:   <<< resume_model: None
2024-11-05 17:09:40,934:INFO:   <<< sampled_use_mil: False
2024-11-05 17:09:40,934:INFO:   <<< seed: 42
2024-11-05 17:09:40,934:INFO:   <<< sim_calcu: softmax_max
2024-11-05 17:09:40,934:INFO:   <<< sim_header: Filip
2024-11-05 17:09:40,934:INFO:   <<< slice_framepos: 0
2024-11-05 17:09:40,934:INFO:   <<< task_type: retrieval
2024-11-05 17:09:40,934:INFO:   <<< tau: 0.07
2024-11-05 17:09:40,934:INFO:   <<< text_aug: True
2024-11-05 17:09:40,934:INFO:   <<< text_aug_choosen: random_swap
2024-11-05 17:09:40,934:INFO:   <<< text_num_hidden_layers: 12
2024-11-05 17:09:40,934:INFO:   <<< train_frame_order: 0
2024-11-05 17:09:40,934:INFO:   <<< use_mil: False
2024-11-05 17:09:40,934:INFO:   <<< video_dim: 1024
2024-11-05 17:09:40,934:INFO:   <<< visual_num_hidden_layers: 12
2024-11-05 17:09:40,934:INFO:   <<< warmup_proportion: 0.1
2024-11-05 17:09:40,934:INFO:   <<< world_size: 1
2024-11-05 17:09:40,934:INFO: device: cuda:0 n_gpu: 1
2024-11-05 17:09:41,689:INFO: loading archive file /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base
2024-11-05 17:09:41,691:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-11-05 17:09:41,691:INFO: Weight doesn't exsits. /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base/cross_pytorch_model.bin
2024-11-05 17:09:41,691:WARNING: Stage-One:True, Stage-Two:False
2024-11-05 17:09:41,691:WARNING: Test retrieval by loose type.
2024-11-05 17:09:41,691:WARNING: 	 embed_dim: 512
2024-11-05 17:09:41,691:WARNING: 	 image_resolution: 224
2024-11-05 17:09:41,691:WARNING: 	 vision_layers: 12
2024-11-05 17:09:41,691:WARNING: 	 vision_width: 768
2024-11-05 17:09:41,691:WARNING: 	 vision_patch_size: 32
2024-11-05 17:09:41,691:WARNING: 	 context_length: 77
2024-11-05 17:09:41,691:WARNING: 	 vocab_size: 49408
2024-11-05 17:09:41,691:WARNING: 	 transformer_width: 512
2024-11-05 17:09:41,691:WARNING: 	 transformer_heads: 8
2024-11-05 17:09:41,691:WARNING: 	 transformer_layers: 12
2024-11-05 17:09:41,691:WARNING: 		 linear_patch: 2d
2024-11-05 17:09:41,691:WARNING: 	 cut_top_layer: 0
2024-11-05 17:09:42,896:WARNING: 	 sim_header: Filip
2024-11-05 17:09:49,519:INFO: --------------------
2024-11-05 17:09:49,520:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-11-05 17:09:49,598:INFO: ***** Running test *****
2024-11-05 17:09:49,598:INFO:   Num examples = 2348
2024-11-05 17:09:49,598:INFO:   Batch size = 256
2024-11-05 17:09:49,598:INFO:   Num steps = 10
2024-11-05 17:09:50,181:WARNING: Eval under the multi-sentence per video clip setting.
2024-11-05 17:09:50,181:WARNING: sentence num: 1969, video num: 2348
2024-11-05 17:09:54,592:INFO: CLIPScore matrix calculated and saved.
2024-11-05 17:09:54,604:INFO: before reshape, sim matrix size: 2348 x 1969
2024-11-05 17:09:55,056:INFO: after reshape, sim matrix size: 1969 x 3 x 1969
2024-11-05 17:09:55,888:INFO: Mix_Text-to-Video:
2024-11-05 17:09:55,888:INFO: 	>>>  R@1: 56.6 - R@5: 70.0 - R@10: 74.7 - Median R: 1.0 - Mean R: 64.1
2024-11-05 17:09:55,888:INFO: Mix_Video-to-Text:
2024-11-05 17:09:55,888:INFO: 	>>>  V2T$R@1: 51.6 - V2T$R@5: 64.7 - V2T$R@10: 70.0 - V2T$Median R: 1.0 - V2T$Mean R: 77.5
2024-11-13 12:32:02,307:INFO: Effective parameters:
2024-11-13 12:32:02,307:INFO:   <<< alpha: 0.9
2024-11-13 12:32:02,307:INFO:   <<< aug_choose: t2v
2024-11-13 12:32:02,307:INFO:   <<< batch_size: 512
2024-11-13 12:32:02,308:INFO:   <<< batch_size_val: 256
2024-11-13 12:32:02,308:INFO:   <<< cache_dir: 
2024-11-13 12:32:02,308:INFO:   <<< cla_weight_dir: cla_weight
2024-11-13 12:32:02,308:INFO:   <<< coef_lr: 1.0
2024-11-13 12:32:02,308:INFO:   <<< combine_type: sum
2024-11-13 12:32:02,308:INFO:   <<< cross_att_layers: 1
2024-11-13 12:32:02,308:INFO:   <<< cross_model: cross-base
2024-11-13 12:32:02,308:INFO:   <<< cross_num_hidden_layers: 4
2024-11-13 12:32:02,308:INFO:   <<< data_path: data_ph
2024-11-13 12:32:02,308:INFO:   <<< datatype: ph
2024-11-13 12:32:02,308:INFO:   <<< debug: False
2024-11-13 12:32:02,308:INFO:   <<< distributed: True
2024-11-13 12:32:02,308:INFO:   <<< do_eval: True
2024-11-13 12:32:02,308:INFO:   <<< do_lower_case: False
2024-11-13 12:32:02,309:INFO:   <<< do_pretrain: False
2024-11-13 12:32:02,309:INFO:   <<< do_train: False
2024-11-13 12:32:02,309:INFO:   <<< dual_mix: 0.5
2024-11-13 12:32:02,309:INFO:   <<< epochs: 200
2024-11-13 12:32:02,309:INFO:   <<< eval_frame_order: 0
2024-11-13 12:32:02,309:INFO:   <<< expand_msrvtt_sentences: False
2024-11-13 12:32:02,309:INFO:   <<< feature_framerate: 1
2024-11-13 12:32:02,309:INFO:   <<< feature_len: 64
2024-11-13 12:32:02,309:INFO:   <<< features_path: sign_feature/ph_domain_agnostic
2024-11-13 12:32:02,309:INFO:   <<< features_path_retrain: sign_feature/ph_domain_aware
2024-11-13 12:32:02,309:INFO:   <<< fp16: True
2024-11-13 12:32:02,309:INFO:   <<< fp16_opt_level: O1
2024-11-13 12:32:02,309:INFO:   <<< freeze_layer_num: 0
2024-11-13 12:32:02,309:INFO:   <<< gpu_ids: [0, 1]
2024-11-13 12:32:02,309:INFO:   <<< gradient_accumulation_steps: 1
2024-11-13 12:32:02,309:INFO:   <<< hard_negative_rate: 0.5
2024-11-13 12:32:02,310:INFO:   <<< init_model: chpt/ph_sota.pth
2024-11-13 12:32:02,310:INFO:   <<< linear_patch: 2d
2024-11-13 12:32:02,310:INFO:   <<< local_rank: 0
2024-11-13 12:32:02,310:INFO:   <<< loose_type: True
2024-11-13 12:32:02,310:INFO:   <<< lr: 1e-05
2024-11-13 12:32:02,310:INFO:   <<< lr_decay: 0.001
2024-11-13 12:32:02,310:INFO:   <<< margin: 0.1
2024-11-13 12:32:02,310:INFO:   <<< max_frames: 128
2024-11-13 12:32:02,310:INFO:   <<< max_words: 32
2024-11-13 12:32:02,310:INFO:   <<< mix_design: balance
2024-11-13 12:32:02,310:INFO:   <<< n_display: 1
2024-11-13 12:32:02,310:INFO:   <<< n_gpu: 1
2024-11-13 12:32:02,310:INFO:   <<< n_pair: 1
2024-11-13 12:32:02,310:INFO:   <<< negative_weighting: 1
2024-11-13 12:32:02,310:INFO:   <<< not_load_visual: False
2024-11-13 12:32:02,310:INFO:   <<< num_thread_reader: 8
2024-11-13 12:32:02,310:INFO:   <<< output_dir: new_experiment
2024-11-13 12:32:02,311:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-11-13 12:32:02,311:INFO:   <<< rank: 0
2024-11-13 12:32:02,311:INFO:   <<< resume_model: None
2024-11-13 12:32:02,311:INFO:   <<< sampled_use_mil: False
2024-11-13 12:32:02,311:INFO:   <<< seed: 42
2024-11-13 12:32:02,311:INFO:   <<< sim_calcu: softmax_max
2024-11-13 12:32:02,311:INFO:   <<< sim_header: Filip
2024-11-13 12:32:02,311:INFO:   <<< slice_framepos: 0
2024-11-13 12:32:02,311:INFO:   <<< task_type: retrieval
2024-11-13 12:32:02,311:INFO:   <<< tau: 0.07
2024-11-13 12:32:02,311:INFO:   <<< text_aug: True
2024-11-13 12:32:02,311:INFO:   <<< text_aug_choosen: random_swap
2024-11-13 12:32:02,311:INFO:   <<< text_num_hidden_layers: 12
2024-11-13 12:32:02,311:INFO:   <<< train_frame_order: 0
2024-11-13 12:32:02,311:INFO:   <<< use_mil: False
2024-11-13 12:32:02,311:INFO:   <<< video_dim: 1024
2024-11-13 12:32:02,312:INFO:   <<< visual_num_hidden_layers: 12
2024-11-13 12:32:02,312:INFO:   <<< warmup_proportion: 0.1
2024-11-13 12:32:02,312:INFO:   <<< world_size: 1
2024-11-13 12:32:02,312:INFO: device: cuda:0 n_gpu: 1
2024-11-13 12:32:04,315:INFO: loading archive file /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base
2024-11-13 12:32:04,327:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-11-13 12:32:04,328:INFO: Weight doesn't exsits. /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base/cross_pytorch_model.bin
2024-11-13 12:32:04,328:WARNING: Stage-One:True, Stage-Two:False
2024-11-13 12:32:04,328:WARNING: Test retrieval by loose type.
2024-11-13 12:32:04,328:WARNING: 	 embed_dim: 512
2024-11-13 12:32:04,328:WARNING: 	 image_resolution: 224
2024-11-13 12:32:04,328:WARNING: 	 vision_layers: 12
2024-11-13 12:32:04,329:WARNING: 	 vision_width: 768
2024-11-13 12:32:04,329:WARNING: 	 vision_patch_size: 32
2024-11-13 12:32:04,329:WARNING: 	 context_length: 77
2024-11-13 12:32:04,329:WARNING: 	 vocab_size: 49408
2024-11-13 12:32:04,329:WARNING: 	 transformer_width: 512
2024-11-13 12:32:04,329:WARNING: 	 transformer_heads: 8
2024-11-13 12:32:04,329:WARNING: 	 transformer_layers: 12
2024-11-13 12:32:04,329:WARNING: 		 linear_patch: 2d
2024-11-13 12:32:04,329:WARNING: 	 cut_top_layer: 0
2024-11-13 12:32:06,945:WARNING: 	 sim_header: Filip
2024-11-13 12:32:13,620:INFO: --------------------
2024-11-13 12:32:13,621:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-11-13 12:32:13,704:INFO: ***** Running test *****
2024-11-13 12:32:13,704:INFO:   Num examples = 642
2024-11-13 12:32:13,704:INFO:   Batch size = 256
2024-11-13 12:32:13,704:INFO:   Num steps = 3
2024-11-13 12:32:14,490:WARNING: Eval under the multi-sentence per video clip setting.
2024-11-13 12:32:14,490:WARNING: sentence num: 642, video num: 642
2024-11-13 12:32:20,605:INFO: CLIPScore matrix calculated and saved.
2024-11-13 12:32:20,607:INFO: before reshape, sim matrix size: 642 x 642
2024-11-13 12:32:20,678:INFO: after reshape, sim matrix size: 642 x 1 x 642
2024-11-13 12:32:20,741:INFO: Mix_Text-to-Video:
2024-11-13 12:32:20,741:INFO: 	>>>  R@1: 69.5 - R@5: 86.6 - R@10: 92.1 - Median R: 1.0 - Mean R: 5.2
2024-11-13 12:32:20,741:INFO: Mix_Video-to-Text:
2024-11-13 12:32:20,741:INFO: 	>>>  V2T$R@1: 70.1 - V2T$R@5: 87.9 - V2T$R@10: 92.7 - V2T$Median R: 1.0 - V2T$Mean R: 5.8
2024-11-13 13:03:29,319:INFO: Effective parameters:
2024-11-13 13:03:29,319:INFO:   <<< alpha: 0.9
2024-11-13 13:03:29,319:INFO:   <<< aug_choose: t2v
2024-11-13 13:03:29,319:INFO:   <<< batch_size: 512
2024-11-13 13:03:29,319:INFO:   <<< batch_size_val: 256
2024-11-13 13:03:29,319:INFO:   <<< cache_dir: 
2024-11-13 13:03:29,319:INFO:   <<< cla_weight_dir: cla_weight
2024-11-13 13:03:29,319:INFO:   <<< coef_lr: 1.0
2024-11-13 13:03:29,319:INFO:   <<< combine_type: sum
2024-11-13 13:03:29,319:INFO:   <<< cross_att_layers: 1
2024-11-13 13:03:29,319:INFO:   <<< cross_model: cross-base
2024-11-13 13:03:29,319:INFO:   <<< cross_num_hidden_layers: 4
2024-11-13 13:03:29,319:INFO:   <<< data_path: data_ph
2024-11-13 13:03:29,319:INFO:   <<< datatype: ph
2024-11-13 13:03:29,319:INFO:   <<< debug: False
2024-11-13 13:03:29,319:INFO:   <<< distributed: True
2024-11-13 13:03:29,319:INFO:   <<< do_eval: True
2024-11-13 13:03:29,319:INFO:   <<< do_lower_case: False
2024-11-13 13:03:29,319:INFO:   <<< do_pretrain: False
2024-11-13 13:03:29,319:INFO:   <<< do_train: False
2024-11-13 13:03:29,319:INFO:   <<< dual_mix: 0.5
2024-11-13 13:03:29,319:INFO:   <<< epochs: 200
2024-11-13 13:03:29,319:INFO:   <<< eval_frame_order: 0
2024-11-13 13:03:29,319:INFO:   <<< expand_msrvtt_sentences: False
2024-11-13 13:03:29,320:INFO:   <<< feature_framerate: 1
2024-11-13 13:03:29,320:INFO:   <<< feature_len: 64
2024-11-13 13:03:29,320:INFO:   <<< features_path: sign_feature/ph_domain_agnostic
2024-11-13 13:03:29,320:INFO:   <<< features_path_retrain: sign_feature/ph_domain_aware
2024-11-13 13:03:29,320:INFO:   <<< fp16: True
2024-11-13 13:03:29,320:INFO:   <<< fp16_opt_level: O1
2024-11-13 13:03:29,320:INFO:   <<< freeze_layer_num: 0
2024-11-13 13:03:29,320:INFO:   <<< gpu_ids: [0, 1]
2024-11-13 13:03:29,320:INFO:   <<< gradient_accumulation_steps: 1
2024-11-13 13:03:29,320:INFO:   <<< hard_negative_rate: 0.5
2024-11-13 13:03:29,320:INFO:   <<< init_model: chpt/ph_sota.pth
2024-11-13 13:03:29,320:INFO:   <<< linear_patch: 2d
2024-11-13 13:03:29,320:INFO:   <<< local_rank: 0
2024-11-13 13:03:29,320:INFO:   <<< loose_type: True
2024-11-13 13:03:29,320:INFO:   <<< lr: 1e-05
2024-11-13 13:03:29,320:INFO:   <<< lr_decay: 0.001
2024-11-13 13:03:29,320:INFO:   <<< margin: 0.1
2024-11-13 13:03:29,320:INFO:   <<< max_frames: 128
2024-11-13 13:03:29,320:INFO:   <<< max_words: 32
2024-11-13 13:03:29,320:INFO:   <<< mix_design: balance
2024-11-13 13:03:29,320:INFO:   <<< n_display: 1
2024-11-13 13:03:29,320:INFO:   <<< n_gpu: 1
2024-11-13 13:03:29,320:INFO:   <<< n_pair: 1
2024-11-13 13:03:29,320:INFO:   <<< negative_weighting: 1
2024-11-13 13:03:29,320:INFO:   <<< not_load_visual: False
2024-11-13 13:03:29,320:INFO:   <<< num_thread_reader: 8
2024-11-13 13:03:29,320:INFO:   <<< output_dir: new_experiment
2024-11-13 13:03:29,320:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-11-13 13:03:29,320:INFO:   <<< rank: 0
2024-11-13 13:03:29,320:INFO:   <<< resume_model: None
2024-11-13 13:03:29,320:INFO:   <<< sampled_use_mil: False
2024-11-13 13:03:29,320:INFO:   <<< seed: 42
2024-11-13 13:03:29,320:INFO:   <<< sim_calcu: softmax_max
2024-11-13 13:03:29,321:INFO:   <<< sim_header: Filip
2024-11-13 13:03:29,321:INFO:   <<< slice_framepos: 0
2024-11-13 13:03:29,321:INFO:   <<< task_type: retrieval
2024-11-13 13:03:29,321:INFO:   <<< tau: 0.07
2024-11-13 13:03:29,321:INFO:   <<< text_aug: True
2024-11-13 13:03:29,321:INFO:   <<< text_aug_choosen: random_swap
2024-11-13 13:03:29,321:INFO:   <<< text_num_hidden_layers: 12
2024-11-13 13:03:29,321:INFO:   <<< train_frame_order: 0
2024-11-13 13:03:29,321:INFO:   <<< use_mil: False
2024-11-13 13:03:29,321:INFO:   <<< video_dim: 1024
2024-11-13 13:03:29,321:INFO:   <<< visual_num_hidden_layers: 12
2024-11-13 13:03:29,321:INFO:   <<< warmup_proportion: 0.1
2024-11-13 13:03:29,321:INFO:   <<< world_size: 1
2024-11-13 13:03:29,321:INFO: device: cuda:0 n_gpu: 1
2024-11-13 13:03:30,345:INFO: loading archive file /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base
2024-11-13 13:03:30,347:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-11-13 13:03:30,348:INFO: Weight doesn't exsits. /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base/cross_pytorch_model.bin
2024-11-13 13:03:30,348:WARNING: Stage-One:True, Stage-Two:False
2024-11-13 13:03:30,348:WARNING: Test retrieval by loose type.
2024-11-13 13:03:30,348:WARNING: 	 embed_dim: 512
2024-11-13 13:03:30,348:WARNING: 	 image_resolution: 224
2024-11-13 13:03:30,348:WARNING: 	 vision_layers: 12
2024-11-13 13:03:30,348:WARNING: 	 vision_width: 768
2024-11-13 13:03:30,348:WARNING: 	 vision_patch_size: 32
2024-11-13 13:03:30,348:WARNING: 	 context_length: 77
2024-11-13 13:03:30,348:WARNING: 	 vocab_size: 49408
2024-11-13 13:03:30,348:WARNING: 	 transformer_width: 512
2024-11-13 13:03:30,349:WARNING: 	 transformer_heads: 8
2024-11-13 13:03:30,349:WARNING: 	 transformer_layers: 12
2024-11-13 13:03:30,349:WARNING: 		 linear_patch: 2d
2024-11-13 13:03:30,349:WARNING: 	 cut_top_layer: 0
2024-11-13 13:03:32,676:WARNING: 	 sim_header: Filip
2024-11-13 13:03:40,105:INFO: --------------------
2024-11-13 13:03:40,106:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-11-13 13:03:40,220:INFO: ***** Running test *****
2024-11-13 13:03:40,221:INFO:   Num examples = 642
2024-11-13 13:03:40,221:INFO:   Batch size = 256
2024-11-13 13:03:40,221:INFO:   Num steps = 3
2024-11-13 13:03:40,779:WARNING: Eval under the multi-sentence per video clip setting.
2024-11-13 13:03:40,779:WARNING: sentence num: 642, video num: 642
2024-11-13 13:03:43,058:INFO: CLIPScore matrix calculated and saved.
2024-11-13 13:03:43,060:INFO: before reshape, sim matrix size: 642 x 642
2024-11-13 13:03:43,128:INFO: after reshape, sim matrix size: 642 x 1 x 642
2024-11-13 13:03:43,283:INFO: Mix_Text-to-Video:
2024-11-13 13:03:43,283:INFO: 	>>>  R@1: 69.5 - R@5: 86.6 - R@10: 92.1 - Median R: 1.0 - Mean R: 5.2
2024-11-13 13:03:43,283:INFO: Mix_Video-to-Text:
2024-11-13 13:03:43,283:INFO: 	>>>  V2T$R@1: 70.1 - V2T$R@5: 87.9 - V2T$R@10: 92.7 - V2T$Median R: 1.0 - V2T$Mean R: 5.8
2024-11-13 13:04:58,536:INFO: Effective parameters:
2024-11-13 13:04:58,537:INFO:   <<< alpha: 0.8
2024-11-13 13:04:58,537:INFO:   <<< aug_choose: t2v
2024-11-13 13:04:58,537:INFO:   <<< batch_size: 512
2024-11-13 13:04:58,537:INFO:   <<< batch_size_val: 256
2024-11-13 13:04:58,537:INFO:   <<< cache_dir: 
2024-11-13 13:04:58,537:INFO:   <<< cla_weight_dir: cla_weight
2024-11-13 13:04:58,537:INFO:   <<< coef_lr: 1.0
2024-11-13 13:04:58,538:INFO:   <<< combine_type: sum
2024-11-13 13:04:58,538:INFO:   <<< cross_att_layers: 1
2024-11-13 13:04:58,538:INFO:   <<< cross_model: cross-base
2024-11-13 13:04:58,538:INFO:   <<< cross_num_hidden_layers: 4
2024-11-13 13:04:58,538:INFO:   <<< data_path: data_csl
2024-11-13 13:04:58,538:INFO:   <<< datatype: csl
2024-11-13 13:04:58,538:INFO:   <<< debug: False
2024-11-13 13:04:58,538:INFO:   <<< distributed: True
2024-11-13 13:04:58,538:INFO:   <<< do_eval: True
2024-11-13 13:04:58,538:INFO:   <<< do_lower_case: False
2024-11-13 13:04:58,538:INFO:   <<< do_pretrain: False
2024-11-13 13:04:58,538:INFO:   <<< do_train: False
2024-11-13 13:04:58,539:INFO:   <<< dual_mix: 0.5
2024-11-13 13:04:58,539:INFO:   <<< epochs: 200
2024-11-13 13:04:58,539:INFO:   <<< eval_frame_order: 0
2024-11-13 13:04:58,539:INFO:   <<< expand_msrvtt_sentences: False
2024-11-13 13:04:58,539:INFO:   <<< feature_framerate: 1
2024-11-13 13:04:58,539:INFO:   <<< feature_len: 64
2024-11-13 13:04:58,539:INFO:   <<< features_path: sign_feature/csl_domain_agnostic
2024-11-13 13:04:58,539:INFO:   <<< features_path_retrain: sign_feature/csl_domain_aware
2024-11-13 13:04:58,539:INFO:   <<< fp16: True
2024-11-13 13:04:58,539:INFO:   <<< fp16_opt_level: O1
2024-11-13 13:04:58,539:INFO:   <<< freeze_layer_num: 0
2024-11-13 13:04:58,539:INFO:   <<< gpu_ids: [0, 1]
2024-11-13 13:04:58,539:INFO:   <<< gradient_accumulation_steps: 1
2024-11-13 13:04:58,539:INFO:   <<< hard_negative_rate: 0.5
2024-11-13 13:04:58,539:INFO:   <<< init_model: chpt/csl_sota.pth
2024-11-13 13:04:58,539:INFO:   <<< linear_patch: 2d
2024-11-13 13:04:58,540:INFO:   <<< local_rank: 0
2024-11-13 13:04:58,540:INFO:   <<< loose_type: True
2024-11-13 13:04:58,540:INFO:   <<< lr: 1e-05
2024-11-13 13:04:58,540:INFO:   <<< lr_decay: 0.001
2024-11-13 13:04:58,540:INFO:   <<< margin: 0.1
2024-11-13 13:04:58,540:INFO:   <<< max_frames: 128
2024-11-13 13:04:58,540:INFO:   <<< max_words: 32
2024-11-13 13:04:58,540:INFO:   <<< mix_design: balance
2024-11-13 13:04:58,540:INFO:   <<< n_display: 1
2024-11-13 13:04:58,540:INFO:   <<< n_gpu: 1
2024-11-13 13:04:58,540:INFO:   <<< n_pair: 1
2024-11-13 13:04:58,540:INFO:   <<< negative_weighting: 1
2024-11-13 13:04:58,540:INFO:   <<< not_load_visual: False
2024-11-13 13:04:58,540:INFO:   <<< num_thread_reader: 8
2024-11-13 13:04:58,540:INFO:   <<< output_dir: new_experiment
2024-11-13 13:04:58,541:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-11-13 13:04:58,541:INFO:   <<< rank: 0
2024-11-13 13:04:58,541:INFO:   <<< resume_model: None
2024-11-13 13:04:58,541:INFO:   <<< sampled_use_mil: False
2024-11-13 13:04:58,541:INFO:   <<< seed: 42
2024-11-13 13:04:58,541:INFO:   <<< sim_calcu: softmax_max
2024-11-13 13:04:58,541:INFO:   <<< sim_header: Filip
2024-11-13 13:04:58,541:INFO:   <<< slice_framepos: 0
2024-11-13 13:04:58,541:INFO:   <<< task_type: retrieval
2024-11-13 13:04:58,541:INFO:   <<< tau: 0.07
2024-11-13 13:04:58,541:INFO:   <<< text_aug: True
2024-11-13 13:04:58,541:INFO:   <<< text_aug_choosen: random_swap
2024-11-13 13:04:58,541:INFO:   <<< text_num_hidden_layers: 12
2024-11-13 13:04:58,541:INFO:   <<< train_frame_order: 0
2024-11-13 13:04:58,541:INFO:   <<< use_mil: False
2024-11-13 13:04:58,541:INFO:   <<< video_dim: 1024
2024-11-13 13:04:58,542:INFO:   <<< visual_num_hidden_layers: 12
2024-11-13 13:04:58,542:INFO:   <<< warmup_proportion: 0.1
2024-11-13 13:04:58,542:INFO:   <<< world_size: 1
2024-11-13 13:04:58,542:INFO: device: cuda:0 n_gpu: 1
2024-11-13 13:05:00,168:INFO: loading archive file /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base
2024-11-13 13:05:00,169:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-11-13 13:05:00,170:INFO: Weight doesn't exsits. /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base/cross_pytorch_model.bin
2024-11-13 13:05:00,170:WARNING: Stage-One:True, Stage-Two:False
2024-11-13 13:05:00,170:WARNING: Test retrieval by loose type.
2024-11-13 13:05:00,170:WARNING: 	 embed_dim: 512
2024-11-13 13:05:00,170:WARNING: 	 image_resolution: 224
2024-11-13 13:05:00,171:WARNING: 	 vision_layers: 12
2024-11-13 13:05:00,171:WARNING: 	 vision_width: 768
2024-11-13 13:05:00,171:WARNING: 	 vision_patch_size: 32
2024-11-13 13:05:00,171:WARNING: 	 context_length: 77
2024-11-13 13:05:00,171:WARNING: 	 vocab_size: 49408
2024-11-13 13:05:00,171:WARNING: 	 transformer_width: 512
2024-11-13 13:05:00,171:WARNING: 	 transformer_heads: 8
2024-11-13 13:05:00,171:WARNING: 	 transformer_layers: 12
2024-11-13 13:05:00,171:WARNING: 		 linear_patch: 2d
2024-11-13 13:05:00,171:WARNING: 	 cut_top_layer: 0
2024-11-13 13:05:01,483:WARNING: 	 sim_header: Filip
2024-11-13 13:05:08,316:INFO: --------------------
2024-11-13 13:05:08,317:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-11-13 13:05:08,386:INFO: ***** Running test *****
2024-11-13 13:05:08,386:INFO:   Num examples = 1176
2024-11-13 13:05:08,386:INFO:   Batch size = 256
2024-11-13 13:05:08,386:INFO:   Num steps = 5
2024-11-13 13:05:08,977:WARNING: Eval under the multi-sentence per video clip setting.
2024-11-13 13:05:08,977:WARNING: sentence num: 798, video num: 1176
2024-11-13 13:05:17,889:INFO: CLIPScore matrix calculated and saved.
2024-11-13 13:05:17,894:INFO: before reshape, sim matrix size: 1176 x 798
2024-11-13 13:05:18,020:INFO: after reshape, sim matrix size: 798 x 2 x 798
2024-11-13 13:05:18,146:INFO: Mix_Text-to-Video:
2024-11-13 13:05:18,147:INFO: 	>>>  R@1: 74.9 - R@5: 87.7 - R@10: 91.7 - Median R: 1.0 - Mean R: 6.0
2024-11-13 13:05:18,147:INFO: Mix_Video-to-Text:
2024-11-13 13:05:18,147:INFO: 	>>>  V2T$R@1: 74.8 - V2T$R@5: 88.9 - V2T$R@10: 92.3 - V2T$Median R: 1.0 - V2T$Mean R: 6.0
2024-11-13 14:22:03,479:INFO: Effective parameters:
2024-11-13 14:22:03,479:INFO:   <<< alpha: 0.9
2024-11-13 14:22:03,479:INFO:   <<< aug_choose: t2v
2024-11-13 14:22:03,479:INFO:   <<< batch_size: 512
2024-11-13 14:22:03,479:INFO:   <<< batch_size_val: 256
2024-11-13 14:22:03,479:INFO:   <<< cache_dir: 
2024-11-13 14:22:03,479:INFO:   <<< cla_weight_dir: cla_weight
2024-11-13 14:22:03,479:INFO:   <<< coef_lr: 1.0
2024-11-13 14:22:03,480:INFO:   <<< combine_type: sum
2024-11-13 14:22:03,480:INFO:   <<< cross_att_layers: 1
2024-11-13 14:22:03,480:INFO:   <<< cross_model: cross-base
2024-11-13 14:22:03,480:INFO:   <<< cross_num_hidden_layers: 4
2024-11-13 14:22:03,480:INFO:   <<< data_path: data_ph
2024-11-13 14:22:03,480:INFO:   <<< datatype: ph
2024-11-13 14:22:03,480:INFO:   <<< debug: False
2024-11-13 14:22:03,480:INFO:   <<< distributed: True
2024-11-13 14:22:03,480:INFO:   <<< do_eval: True
2024-11-13 14:22:03,480:INFO:   <<< do_lower_case: False
2024-11-13 14:22:03,480:INFO:   <<< do_pretrain: False
2024-11-13 14:22:03,480:INFO:   <<< do_train: False
2024-11-13 14:22:03,480:INFO:   <<< dual_mix: 0.5
2024-11-13 14:22:03,480:INFO:   <<< epochs: 200
2024-11-13 14:22:03,480:INFO:   <<< eval_frame_order: 0
2024-11-13 14:22:03,481:INFO:   <<< expand_msrvtt_sentences: False
2024-11-13 14:22:03,481:INFO:   <<< feature_framerate: 1
2024-11-13 14:22:03,481:INFO:   <<< feature_len: 64
2024-11-13 14:22:03,481:INFO:   <<< features_path: sign_feature/ph_domain_agnostic
2024-11-13 14:22:03,481:INFO:   <<< features_path_retrain: sign_feature/ph_domain_aware
2024-11-13 14:22:03,481:INFO:   <<< fp16: True
2024-11-13 14:22:03,481:INFO:   <<< fp16_opt_level: O1
2024-11-13 14:22:03,481:INFO:   <<< freeze_layer_num: 0
2024-11-13 14:22:03,481:INFO:   <<< gpu_ids: [0, 1]
2024-11-13 14:22:03,481:INFO:   <<< gradient_accumulation_steps: 1
2024-11-13 14:22:03,481:INFO:   <<< hard_negative_rate: 0.5
2024-11-13 14:22:03,481:INFO:   <<< init_model: chpt/ph_sota.pth
2024-11-13 14:22:03,481:INFO:   <<< linear_patch: 2d
2024-11-13 14:22:03,481:INFO:   <<< local_rank: 0
2024-11-13 14:22:03,481:INFO:   <<< loose_type: True
2024-11-13 14:22:03,481:INFO:   <<< lr: 1e-05
2024-11-13 14:22:03,482:INFO:   <<< lr_decay: 0.001
2024-11-13 14:22:03,482:INFO:   <<< margin: 0.1
2024-11-13 14:22:03,482:INFO:   <<< max_frames: 128
2024-11-13 14:22:03,482:INFO:   <<< max_words: 32
2024-11-13 14:22:03,482:INFO:   <<< mix_design: balance
2024-11-13 14:22:03,482:INFO:   <<< n_display: 1
2024-11-13 14:22:03,482:INFO:   <<< n_gpu: 1
2024-11-13 14:22:03,482:INFO:   <<< n_pair: 1
2024-11-13 14:22:03,482:INFO:   <<< negative_weighting: 1
2024-11-13 14:22:03,482:INFO:   <<< not_load_visual: False
2024-11-13 14:22:03,482:INFO:   <<< num_thread_reader: 8
2024-11-13 14:22:03,482:INFO:   <<< output_dir: new_experiment
2024-11-13 14:22:03,482:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-11-13 14:22:03,482:INFO:   <<< rank: 0
2024-11-13 14:22:03,482:INFO:   <<< resume_model: None
2024-11-13 14:22:03,483:INFO:   <<< sampled_use_mil: False
2024-11-13 14:22:03,483:INFO:   <<< seed: 42
2024-11-13 14:22:03,483:INFO:   <<< sim_calcu: softmax_max
2024-11-13 14:22:03,483:INFO:   <<< sim_header: Filip
2024-11-13 14:22:03,483:INFO:   <<< slice_framepos: 0
2024-11-13 14:22:03,483:INFO:   <<< task_type: retrieval
2024-11-13 14:22:03,483:INFO:   <<< tau: 0.07
2024-11-13 14:22:03,483:INFO:   <<< text_aug: True
2024-11-13 14:22:03,483:INFO:   <<< text_aug_choosen: random_swap
2024-11-13 14:22:03,483:INFO:   <<< text_num_hidden_layers: 12
2024-11-13 14:22:03,483:INFO:   <<< train_frame_order: 0
2024-11-13 14:22:03,483:INFO:   <<< use_mil: False
2024-11-13 14:22:03,483:INFO:   <<< video_dim: 1024
2024-11-13 14:22:03,483:INFO:   <<< visual_num_hidden_layers: 12
2024-11-13 14:22:03,483:INFO:   <<< warmup_proportion: 0.1
2024-11-13 14:22:03,483:INFO:   <<< world_size: 1
2024-11-13 14:22:03,484:INFO: device: cuda:0 n_gpu: 1
2024-11-13 14:22:05,266:INFO: loading archive file /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base
2024-11-13 14:22:05,269:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-11-13 14:22:05,269:INFO: Weight doesn't exsits. /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base/cross_pytorch_model.bin
2024-11-13 14:22:05,270:WARNING: Stage-One:True, Stage-Two:False
2024-11-13 14:22:05,270:WARNING: Test retrieval by loose type.
2024-11-13 14:22:05,270:WARNING: 	 embed_dim: 512
2024-11-13 14:22:05,270:WARNING: 	 image_resolution: 224
2024-11-13 14:22:05,270:WARNING: 	 vision_layers: 12
2024-11-13 14:22:05,270:WARNING: 	 vision_width: 768
2024-11-13 14:22:05,270:WARNING: 	 vision_patch_size: 32
2024-11-13 14:22:05,270:WARNING: 	 context_length: 77
2024-11-13 14:22:05,270:WARNING: 	 vocab_size: 49408
2024-11-13 14:22:05,271:WARNING: 	 transformer_width: 512
2024-11-13 14:22:05,271:WARNING: 	 transformer_heads: 8
2024-11-13 14:22:05,271:WARNING: 	 transformer_layers: 12
2024-11-13 14:22:05,271:WARNING: 		 linear_patch: 2d
2024-11-13 14:22:05,271:WARNING: 	 cut_top_layer: 0
2024-11-13 14:22:07,955:WARNING: 	 sim_header: Filip
2024-11-13 14:22:14,871:INFO: --------------------
2024-11-13 14:22:14,872:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-11-13 14:22:14,961:INFO: ***** Running test *****
2024-11-13 14:22:14,961:INFO:   Num examples = 642
2024-11-13 14:22:14,961:INFO:   Batch size = 256
2024-11-13 14:22:14,961:INFO:   Num steps = 3
2024-11-13 14:22:15,575:WARNING: Eval under the multi-sentence per video clip setting.
2024-11-13 14:22:15,575:WARNING: sentence num: 642, video num: 642
2024-11-13 14:22:20,756:INFO: CLIPScore matrix calculated and saved.
2024-11-13 14:22:20,758:INFO: before reshape, sim matrix size: 642 x 642
2024-11-13 14:22:20,837:INFO: after reshape, sim matrix size: 642 x 1 x 642
2024-11-13 14:22:20,994:INFO: Mix_Text-to-Video:
2024-11-13 14:22:20,998:INFO: 	>>>  R@1: 69.5 - R@5: 86.6 - R@10: 92.1 - Median R: 1.0 - Mean R: 5.2
2024-11-13 14:22:20,998:INFO: Mix_Video-to-Text:
2024-11-13 14:22:20,998:INFO: 	>>>  V2T$R@1: 70.1 - V2T$R@5: 87.9 - V2T$R@10: 92.7 - V2T$Median R: 1.0 - V2T$Mean R: 5.8
2024-11-13 18:13:35,557:INFO: Effective parameters:
2024-11-13 18:13:35,557:INFO:   <<< alpha: 0.9
2024-11-13 18:13:35,557:INFO:   <<< aug_choose: t2v
2024-11-13 18:13:35,557:INFO:   <<< batch_size: 512
2024-11-13 18:13:35,557:INFO:   <<< batch_size_val: 256
2024-11-13 18:13:35,557:INFO:   <<< cache_dir: 
2024-11-13 18:13:35,557:INFO:   <<< cla_weight_dir: cla_weight
2024-11-13 18:13:35,557:INFO:   <<< coef_lr: 1.0
2024-11-13 18:13:35,557:INFO:   <<< combine_type: sum
2024-11-13 18:13:35,557:INFO:   <<< cross_att_layers: 1
2024-11-13 18:13:35,557:INFO:   <<< cross_model: cross-base
2024-11-13 18:13:35,557:INFO:   <<< cross_num_hidden_layers: 4
2024-11-13 18:13:35,557:INFO:   <<< data_path: data_ph
2024-11-13 18:13:35,557:INFO:   <<< datatype: ph
2024-11-13 18:13:35,557:INFO:   <<< debug: False
2024-11-13 18:13:35,557:INFO:   <<< distributed: True
2024-11-13 18:13:35,557:INFO:   <<< do_eval: True
2024-11-13 18:13:35,557:INFO:   <<< do_lower_case: False
2024-11-13 18:13:35,558:INFO:   <<< do_pretrain: False
2024-11-13 18:13:35,558:INFO:   <<< do_train: False
2024-11-13 18:13:35,558:INFO:   <<< dual_mix: 0.5
2024-11-13 18:13:35,558:INFO:   <<< epochs: 200
2024-11-13 18:13:35,558:INFO:   <<< eval_frame_order: 0
2024-11-13 18:13:35,558:INFO:   <<< expand_msrvtt_sentences: False
2024-11-13 18:13:35,558:INFO:   <<< feature_framerate: 1
2024-11-13 18:13:35,558:INFO:   <<< feature_len: 64
2024-11-13 18:13:35,558:INFO:   <<< features_path: sign_feature/ph_domain_agnostic
2024-11-13 18:13:35,558:INFO:   <<< features_path_retrain: sign_feature/ph_domain_aware
2024-11-13 18:13:35,558:INFO:   <<< fp16: True
2024-11-13 18:13:35,558:INFO:   <<< fp16_opt_level: O1
2024-11-13 18:13:35,558:INFO:   <<< freeze_layer_num: 0
2024-11-13 18:13:35,558:INFO:   <<< gpu_ids: [0, 1]
2024-11-13 18:13:35,558:INFO:   <<< gradient_accumulation_steps: 1
2024-11-13 18:13:35,558:INFO:   <<< hard_negative_rate: 0.5
2024-11-13 18:13:35,558:INFO:   <<< init_model: chpt/ph_sota.pth
2024-11-13 18:13:35,558:INFO:   <<< linear_patch: 2d
2024-11-13 18:13:35,558:INFO:   <<< local_rank: 0
2024-11-13 18:13:35,558:INFO:   <<< loose_type: True
2024-11-13 18:13:35,558:INFO:   <<< lr: 1e-05
2024-11-13 18:13:35,558:INFO:   <<< lr_decay: 0.001
2024-11-13 18:13:35,558:INFO:   <<< margin: 0.1
2024-11-13 18:13:35,558:INFO:   <<< max_frames: 128
2024-11-13 18:13:35,558:INFO:   <<< max_words: 32
2024-11-13 18:13:35,558:INFO:   <<< mix_design: balance
2024-11-13 18:13:35,558:INFO:   <<< n_display: 1
2024-11-13 18:13:35,558:INFO:   <<< n_gpu: 1
2024-11-13 18:13:35,558:INFO:   <<< n_pair: 1
2024-11-13 18:13:35,558:INFO:   <<< negative_weighting: 1
2024-11-13 18:13:35,558:INFO:   <<< not_load_visual: False
2024-11-13 18:13:35,558:INFO:   <<< num_thread_reader: 8
2024-11-13 18:13:35,558:INFO:   <<< output_dir: new_experiment
2024-11-13 18:13:35,558:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-11-13 18:13:35,559:INFO:   <<< rank: 0
2024-11-13 18:13:35,559:INFO:   <<< resume_model: None
2024-11-13 18:13:35,559:INFO:   <<< sampled_use_mil: False
2024-11-13 18:13:35,559:INFO:   <<< seed: 42
2024-11-13 18:13:35,559:INFO:   <<< sim_calcu: softmax_max
2024-11-13 18:13:35,559:INFO:   <<< sim_header: Filip
2024-11-13 18:13:35,559:INFO:   <<< slice_framepos: 0
2024-11-13 18:13:35,559:INFO:   <<< task_type: retrieval
2024-11-13 18:13:35,559:INFO:   <<< tau: 0.07
2024-11-13 18:13:35,559:INFO:   <<< text_aug: True
2024-11-13 18:13:35,559:INFO:   <<< text_aug_choosen: random_swap
2024-11-13 18:13:35,559:INFO:   <<< text_num_hidden_layers: 12
2024-11-13 18:13:35,559:INFO:   <<< train_frame_order: 0
2024-11-13 18:13:35,559:INFO:   <<< use_mil: False
2024-11-13 18:13:35,559:INFO:   <<< video_dim: 1024
2024-11-13 18:13:35,559:INFO:   <<< visual_num_hidden_layers: 12
2024-11-13 18:13:35,559:INFO:   <<< warmup_proportion: 0.1
2024-11-13 18:13:35,559:INFO:   <<< world_size: 1
2024-11-13 18:13:35,559:INFO: device: cuda:0 n_gpu: 1
2024-11-13 18:13:36,767:INFO: loading archive file /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base
2024-11-13 18:13:36,772:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-11-13 18:13:36,775:INFO: Weight doesn't exsits. /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base/cross_pytorch_model.bin
2024-11-13 18:13:36,775:WARNING: Stage-One:True, Stage-Two:False
2024-11-13 18:13:36,775:WARNING: Test retrieval by loose type.
2024-11-13 18:13:36,775:WARNING: 	 embed_dim: 512
2024-11-13 18:13:36,775:WARNING: 	 image_resolution: 224
2024-11-13 18:13:36,775:WARNING: 	 vision_layers: 12
2024-11-13 18:13:36,775:WARNING: 	 vision_width: 768
2024-11-13 18:13:36,775:WARNING: 	 vision_patch_size: 32
2024-11-13 18:13:36,775:WARNING: 	 context_length: 77
2024-11-13 18:13:36,775:WARNING: 	 vocab_size: 49408
2024-11-13 18:13:36,775:WARNING: 	 transformer_width: 512
2024-11-13 18:13:36,775:WARNING: 	 transformer_heads: 8
2024-11-13 18:13:36,775:WARNING: 	 transformer_layers: 12
2024-11-13 18:13:36,775:WARNING: 		 linear_patch: 2d
2024-11-13 18:13:36,775:WARNING: 	 cut_top_layer: 0
2024-11-13 18:13:38,238:WARNING: 	 sim_header: Filip
2024-11-13 18:13:45,076:INFO: --------------------
2024-11-13 18:13:45,078:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-11-13 18:13:45,167:INFO: ***** Running test *****
2024-11-13 18:13:45,167:INFO:   Num examples = 642
2024-11-13 18:13:45,167:INFO:   Batch size = 256
2024-11-13 18:13:45,167:INFO:   Num steps = 3
2024-11-13 18:13:46,013:WARNING: Eval under the multi-sentence per video clip setting.
2024-11-13 18:13:46,013:WARNING: sentence num: 642, video num: 642
2024-11-13 18:19:01,547:INFO: Effective parameters:
2024-11-13 18:19:01,547:INFO:   <<< alpha: 0.9
2024-11-13 18:19:01,547:INFO:   <<< aug_choose: t2v
2024-11-13 18:19:01,547:INFO:   <<< batch_size: 512
2024-11-13 18:19:01,547:INFO:   <<< batch_size_val: 256
2024-11-13 18:19:01,547:INFO:   <<< cache_dir: 
2024-11-13 18:19:01,547:INFO:   <<< cla_weight_dir: cla_weight
2024-11-13 18:19:01,547:INFO:   <<< coef_lr: 1.0
2024-11-13 18:19:01,547:INFO:   <<< combine_type: sum
2024-11-13 18:19:01,547:INFO:   <<< cross_att_layers: 1
2024-11-13 18:19:01,547:INFO:   <<< cross_model: cross-base
2024-11-13 18:19:01,547:INFO:   <<< cross_num_hidden_layers: 4
2024-11-13 18:19:01,547:INFO:   <<< data_path: data_ph
2024-11-13 18:19:01,547:INFO:   <<< datatype: ph
2024-11-13 18:19:01,547:INFO:   <<< debug: False
2024-11-13 18:19:01,547:INFO:   <<< distributed: True
2024-11-13 18:19:01,547:INFO:   <<< do_eval: True
2024-11-13 18:19:01,547:INFO:   <<< do_lower_case: False
2024-11-13 18:19:01,548:INFO:   <<< do_pretrain: False
2024-11-13 18:19:01,548:INFO:   <<< do_train: False
2024-11-13 18:19:01,548:INFO:   <<< dual_mix: 0.5
2024-11-13 18:19:01,548:INFO:   <<< epochs: 200
2024-11-13 18:19:01,548:INFO:   <<< eval_frame_order: 0
2024-11-13 18:19:01,548:INFO:   <<< expand_msrvtt_sentences: False
2024-11-13 18:19:01,548:INFO:   <<< feature_framerate: 1
2024-11-13 18:19:01,548:INFO:   <<< feature_len: 64
2024-11-13 18:19:01,548:INFO:   <<< features_path: sign_feature/ph_domain_agnostic
2024-11-13 18:19:01,548:INFO:   <<< features_path_retrain: sign_feature/ph_domain_aware
2024-11-13 18:19:01,548:INFO:   <<< fp16: True
2024-11-13 18:19:01,548:INFO:   <<< fp16_opt_level: O1
2024-11-13 18:19:01,548:INFO:   <<< freeze_layer_num: 0
2024-11-13 18:19:01,548:INFO:   <<< gpu_ids: [0, 1]
2024-11-13 18:19:01,548:INFO:   <<< gradient_accumulation_steps: 1
2024-11-13 18:19:01,548:INFO:   <<< hard_negative_rate: 0.5
2024-11-13 18:19:01,548:INFO:   <<< init_model: chpt/ph_sota.pth
2024-11-13 18:19:01,548:INFO:   <<< linear_patch: 2d
2024-11-13 18:19:01,548:INFO:   <<< local_rank: 0
2024-11-13 18:19:01,548:INFO:   <<< loose_type: True
2024-11-13 18:19:01,548:INFO:   <<< lr: 1e-05
2024-11-13 18:19:01,548:INFO:   <<< lr_decay: 0.001
2024-11-13 18:19:01,548:INFO:   <<< margin: 0.1
2024-11-13 18:19:01,548:INFO:   <<< max_frames: 128
2024-11-13 18:19:01,548:INFO:   <<< max_words: 32
2024-11-13 18:19:01,548:INFO:   <<< mix_design: balance
2024-11-13 18:19:01,548:INFO:   <<< n_display: 1
2024-11-13 18:19:01,548:INFO:   <<< n_gpu: 1
2024-11-13 18:19:01,548:INFO:   <<< n_pair: 1
2024-11-13 18:19:01,548:INFO:   <<< negative_weighting: 1
2024-11-13 18:19:01,548:INFO:   <<< not_load_visual: False
2024-11-13 18:19:01,548:INFO:   <<< num_thread_reader: 8
2024-11-13 18:19:01,548:INFO:   <<< output_dir: new_experiment
2024-11-13 18:19:01,548:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-11-13 18:19:01,548:INFO:   <<< rank: 0
2024-11-13 18:19:01,549:INFO:   <<< resume_model: None
2024-11-13 18:19:01,549:INFO:   <<< sampled_use_mil: False
2024-11-13 18:19:01,549:INFO:   <<< seed: 42
2024-11-13 18:19:01,549:INFO:   <<< sim_calcu: softmax_max
2024-11-13 18:19:01,549:INFO:   <<< sim_header: Filip
2024-11-13 18:19:01,549:INFO:   <<< slice_framepos: 0
2024-11-13 18:19:01,549:INFO:   <<< task_type: retrieval
2024-11-13 18:19:01,549:INFO:   <<< tau: 0.07
2024-11-13 18:19:01,549:INFO:   <<< text_aug: True
2024-11-13 18:19:01,549:INFO:   <<< text_aug_choosen: random_swap
2024-11-13 18:19:01,549:INFO:   <<< text_num_hidden_layers: 12
2024-11-13 18:19:01,549:INFO:   <<< train_frame_order: 0
2024-11-13 18:19:01,549:INFO:   <<< use_mil: False
2024-11-13 18:19:01,549:INFO:   <<< video_dim: 1024
2024-11-13 18:19:01,549:INFO:   <<< visual_num_hidden_layers: 12
2024-11-13 18:19:01,549:INFO:   <<< warmup_proportion: 0.1
2024-11-13 18:19:01,549:INFO:   <<< world_size: 1
2024-11-13 18:19:01,549:INFO: device: cuda:0 n_gpu: 1
2024-11-13 18:19:02,644:INFO: loading archive file /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base
2024-11-13 18:19:02,646:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-11-13 18:19:02,646:INFO: Weight doesn't exsits. /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base/cross_pytorch_model.bin
2024-11-13 18:19:02,646:WARNING: Stage-One:True, Stage-Two:False
2024-11-13 18:19:02,646:WARNING: Test retrieval by loose type.
2024-11-13 18:19:02,646:WARNING: 	 embed_dim: 512
2024-11-13 18:19:02,646:WARNING: 	 image_resolution: 224
2024-11-13 18:19:02,646:WARNING: 	 vision_layers: 12
2024-11-13 18:19:02,646:WARNING: 	 vision_width: 768
2024-11-13 18:19:02,646:WARNING: 	 vision_patch_size: 32
2024-11-13 18:19:02,646:WARNING: 	 context_length: 77
2024-11-13 18:19:02,646:WARNING: 	 vocab_size: 49408
2024-11-13 18:19:02,647:WARNING: 	 transformer_width: 512
2024-11-13 18:19:02,647:WARNING: 	 transformer_heads: 8
2024-11-13 18:19:02,647:WARNING: 	 transformer_layers: 12
2024-11-13 18:19:02,647:WARNING: 		 linear_patch: 2d
2024-11-13 18:19:02,647:WARNING: 	 cut_top_layer: 0
2024-11-13 18:19:04,286:WARNING: 	 sim_header: Filip
2024-11-13 18:19:11,167:INFO: --------------------
2024-11-13 18:19:11,167:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-11-13 18:19:11,251:INFO: ***** Running test *****
2024-11-13 18:19:11,251:INFO:   Num examples = 642
2024-11-13 18:19:11,252:INFO:   Batch size = 256
2024-11-13 18:19:11,252:INFO:   Num steps = 3
2024-11-13 18:19:11,735:WARNING: Eval under the multi-sentence per video clip setting.
2024-11-13 18:19:11,735:WARNING: sentence num: 642, video num: 642
2024-11-13 18:19:50,266:INFO: Effective parameters:
2024-11-13 18:19:50,266:INFO:   <<< alpha: 0.9
2024-11-13 18:19:50,266:INFO:   <<< aug_choose: t2v
2024-11-13 18:19:50,266:INFO:   <<< batch_size: 512
2024-11-13 18:19:50,266:INFO:   <<< batch_size_val: 256
2024-11-13 18:19:50,266:INFO:   <<< cache_dir: 
2024-11-13 18:19:50,266:INFO:   <<< cla_weight_dir: cla_weight
2024-11-13 18:19:50,267:INFO:   <<< coef_lr: 1.0
2024-11-13 18:19:50,267:INFO:   <<< combine_type: sum
2024-11-13 18:19:50,267:INFO:   <<< cross_att_layers: 1
2024-11-13 18:19:50,267:INFO:   <<< cross_model: cross-base
2024-11-13 18:19:50,267:INFO:   <<< cross_num_hidden_layers: 4
2024-11-13 18:19:50,267:INFO:   <<< data_path: data_ph
2024-11-13 18:19:50,267:INFO:   <<< datatype: ph
2024-11-13 18:19:50,267:INFO:   <<< debug: False
2024-11-13 18:19:50,267:INFO:   <<< distributed: True
2024-11-13 18:19:50,267:INFO:   <<< do_eval: True
2024-11-13 18:19:50,267:INFO:   <<< do_lower_case: False
2024-11-13 18:19:50,267:INFO:   <<< do_pretrain: False
2024-11-13 18:19:50,267:INFO:   <<< do_train: False
2024-11-13 18:19:50,267:INFO:   <<< dual_mix: 0.5
2024-11-13 18:19:50,267:INFO:   <<< epochs: 200
2024-11-13 18:19:50,267:INFO:   <<< eval_frame_order: 0
2024-11-13 18:19:50,267:INFO:   <<< expand_msrvtt_sentences: False
2024-11-13 18:19:50,267:INFO:   <<< feature_framerate: 1
2024-11-13 18:19:50,267:INFO:   <<< feature_len: 64
2024-11-13 18:19:50,267:INFO:   <<< features_path: sign_feature/ph_domain_agnostic
2024-11-13 18:19:50,267:INFO:   <<< features_path_retrain: sign_feature/ph_domain_aware
2024-11-13 18:19:50,267:INFO:   <<< fp16: True
2024-11-13 18:19:50,267:INFO:   <<< fp16_opt_level: O1
2024-11-13 18:19:50,267:INFO:   <<< freeze_layer_num: 0
2024-11-13 18:19:50,267:INFO:   <<< gpu_ids: [0, 1]
2024-11-13 18:19:50,267:INFO:   <<< gradient_accumulation_steps: 1
2024-11-13 18:19:50,267:INFO:   <<< hard_negative_rate: 0.5
2024-11-13 18:19:50,267:INFO:   <<< init_model: chpt/ph_sota.pth
2024-11-13 18:19:50,267:INFO:   <<< linear_patch: 2d
2024-11-13 18:19:50,267:INFO:   <<< local_rank: 0
2024-11-13 18:19:50,267:INFO:   <<< loose_type: True
2024-11-13 18:19:50,267:INFO:   <<< lr: 1e-05
2024-11-13 18:19:50,267:INFO:   <<< lr_decay: 0.001
2024-11-13 18:19:50,267:INFO:   <<< margin: 0.1
2024-11-13 18:19:50,268:INFO:   <<< max_frames: 128
2024-11-13 18:19:50,268:INFO:   <<< max_words: 32
2024-11-13 18:19:50,268:INFO:   <<< mix_design: balance
2024-11-13 18:19:50,268:INFO:   <<< n_display: 1
2024-11-13 18:19:50,268:INFO:   <<< n_gpu: 1
2024-11-13 18:19:50,268:INFO:   <<< n_pair: 1
2024-11-13 18:19:50,268:INFO:   <<< negative_weighting: 1
2024-11-13 18:19:50,268:INFO:   <<< not_load_visual: False
2024-11-13 18:19:50,268:INFO:   <<< num_thread_reader: 8
2024-11-13 18:19:50,268:INFO:   <<< output_dir: new_experiment
2024-11-13 18:19:50,268:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-11-13 18:19:50,268:INFO:   <<< rank: 0
2024-11-13 18:19:50,268:INFO:   <<< resume_model: None
2024-11-13 18:19:50,268:INFO:   <<< sampled_use_mil: False
2024-11-13 18:19:50,268:INFO:   <<< seed: 42
2024-11-13 18:19:50,268:INFO:   <<< sim_calcu: softmax_max
2024-11-13 18:19:50,268:INFO:   <<< sim_header: Filip
2024-11-13 18:19:50,268:INFO:   <<< slice_framepos: 0
2024-11-13 18:19:50,268:INFO:   <<< task_type: retrieval
2024-11-13 18:19:50,268:INFO:   <<< tau: 0.07
2024-11-13 18:19:50,268:INFO:   <<< text_aug: True
2024-11-13 18:19:50,268:INFO:   <<< text_aug_choosen: random_swap
2024-11-13 18:19:50,268:INFO:   <<< text_num_hidden_layers: 12
2024-11-13 18:19:50,268:INFO:   <<< train_frame_order: 0
2024-11-13 18:19:50,268:INFO:   <<< use_mil: False
2024-11-13 18:19:50,268:INFO:   <<< video_dim: 1024
2024-11-13 18:19:50,268:INFO:   <<< visual_num_hidden_layers: 12
2024-11-13 18:19:50,268:INFO:   <<< warmup_proportion: 0.1
2024-11-13 18:19:50,268:INFO:   <<< world_size: 1
2024-11-13 18:19:50,269:INFO: device: cuda:0 n_gpu: 1
2024-11-13 18:19:51,376:INFO: loading archive file /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base
2024-11-13 18:19:51,379:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-11-13 18:19:51,379:INFO: Weight doesn't exsits. /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base/cross_pytorch_model.bin
2024-11-13 18:19:51,379:WARNING: Stage-One:True, Stage-Two:False
2024-11-13 18:19:51,379:WARNING: Test retrieval by loose type.
2024-11-13 18:19:51,379:WARNING: 	 embed_dim: 512
2024-11-13 18:19:51,379:WARNING: 	 image_resolution: 224
2024-11-13 18:19:51,379:WARNING: 	 vision_layers: 12
2024-11-13 18:19:51,379:WARNING: 	 vision_width: 768
2024-11-13 18:19:51,379:WARNING: 	 vision_patch_size: 32
2024-11-13 18:19:51,379:WARNING: 	 context_length: 77
2024-11-13 18:19:51,380:WARNING: 	 vocab_size: 49408
2024-11-13 18:19:51,380:WARNING: 	 transformer_width: 512
2024-11-13 18:19:51,380:WARNING: 	 transformer_heads: 8
2024-11-13 18:19:51,380:WARNING: 	 transformer_layers: 12
2024-11-13 18:19:51,380:WARNING: 		 linear_patch: 2d
2024-11-13 18:19:51,380:WARNING: 	 cut_top_layer: 0
2024-11-13 18:19:52,906:WARNING: 	 sim_header: Filip
2024-11-13 18:19:59,735:INFO: --------------------
2024-11-13 18:19:59,736:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-11-13 18:19:59,822:INFO: ***** Running test *****
2024-11-13 18:19:59,822:INFO:   Num examples = 642
2024-11-13 18:19:59,822:INFO:   Batch size = 256
2024-11-13 18:19:59,822:INFO:   Num steps = 3
2024-11-13 18:20:00,312:WARNING: Eval under the multi-sentence per video clip setting.
2024-11-13 18:20:00,312:WARNING: sentence num: 642, video num: 642
2024-11-13 18:23:16,216:INFO: Effective parameters:
2024-11-13 18:23:16,216:INFO:   <<< alpha: 0.9
2024-11-13 18:23:16,216:INFO:   <<< aug_choose: t2v
2024-11-13 18:23:16,216:INFO:   <<< batch_size: 512
2024-11-13 18:23:16,216:INFO:   <<< batch_size_val: 256
2024-11-13 18:23:16,216:INFO:   <<< cache_dir: 
2024-11-13 18:23:16,216:INFO:   <<< cla_weight_dir: cla_weight
2024-11-13 18:23:16,216:INFO:   <<< coef_lr: 1.0
2024-11-13 18:23:16,216:INFO:   <<< combine_type: sum
2024-11-13 18:23:16,216:INFO:   <<< cross_att_layers: 1
2024-11-13 18:23:16,216:INFO:   <<< cross_model: cross-base
2024-11-13 18:23:16,216:INFO:   <<< cross_num_hidden_layers: 4
2024-11-13 18:23:16,216:INFO:   <<< data_path: data_ph
2024-11-13 18:23:16,216:INFO:   <<< datatype: ph
2024-11-13 18:23:16,216:INFO:   <<< debug: False
2024-11-13 18:23:16,216:INFO:   <<< distributed: True
2024-11-13 18:23:16,216:INFO:   <<< do_eval: True
2024-11-13 18:23:16,216:INFO:   <<< do_lower_case: False
2024-11-13 18:23:16,216:INFO:   <<< do_pretrain: False
2024-11-13 18:23:16,216:INFO:   <<< do_train: False
2024-11-13 18:23:16,216:INFO:   <<< dual_mix: 0.5
2024-11-13 18:23:16,217:INFO:   <<< epochs: 200
2024-11-13 18:23:16,217:INFO:   <<< eval_frame_order: 0
2024-11-13 18:23:16,217:INFO:   <<< expand_msrvtt_sentences: False
2024-11-13 18:23:16,217:INFO:   <<< feature_framerate: 1
2024-11-13 18:23:16,217:INFO:   <<< feature_len: 64
2024-11-13 18:23:16,217:INFO:   <<< features_path: sign_feature/ph_domain_agnostic
2024-11-13 18:23:16,217:INFO:   <<< features_path_retrain: sign_feature/ph_domain_aware
2024-11-13 18:23:16,217:INFO:   <<< fp16: True
2024-11-13 18:23:16,217:INFO:   <<< fp16_opt_level: O1
2024-11-13 18:23:16,217:INFO:   <<< freeze_layer_num: 0
2024-11-13 18:23:16,217:INFO:   <<< gpu_ids: [0, 1]
2024-11-13 18:23:16,217:INFO:   <<< gradient_accumulation_steps: 1
2024-11-13 18:23:16,217:INFO:   <<< hard_negative_rate: 0.5
2024-11-13 18:23:16,217:INFO:   <<< init_model: chpt/ph_sota.pth
2024-11-13 18:23:16,217:INFO:   <<< linear_patch: 2d
2024-11-13 18:23:16,217:INFO:   <<< local_rank: 0
2024-11-13 18:23:16,217:INFO:   <<< loose_type: True
2024-11-13 18:23:16,217:INFO:   <<< lr: 1e-05
2024-11-13 18:23:16,217:INFO:   <<< lr_decay: 0.001
2024-11-13 18:23:16,217:INFO:   <<< margin: 0.1
2024-11-13 18:23:16,217:INFO:   <<< max_frames: 128
2024-11-13 18:23:16,217:INFO:   <<< max_words: 32
2024-11-13 18:23:16,217:INFO:   <<< mix_design: balance
2024-11-13 18:23:16,217:INFO:   <<< n_display: 1
2024-11-13 18:23:16,217:INFO:   <<< n_gpu: 1
2024-11-13 18:23:16,217:INFO:   <<< n_pair: 1
2024-11-13 18:23:16,217:INFO:   <<< negative_weighting: 1
2024-11-13 18:23:16,217:INFO:   <<< not_load_visual: False
2024-11-13 18:23:16,217:INFO:   <<< num_thread_reader: 8
2024-11-13 18:23:16,217:INFO:   <<< output_dir: new_experiment
2024-11-13 18:23:16,217:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-11-13 18:23:16,217:INFO:   <<< rank: 0
2024-11-13 18:23:16,217:INFO:   <<< resume_model: None
2024-11-13 18:23:16,218:INFO:   <<< sampled_use_mil: False
2024-11-13 18:23:16,218:INFO:   <<< seed: 42
2024-11-13 18:23:16,218:INFO:   <<< sim_calcu: softmax_max
2024-11-13 18:23:16,218:INFO:   <<< sim_header: Filip
2024-11-13 18:23:16,218:INFO:   <<< slice_framepos: 0
2024-11-13 18:23:16,218:INFO:   <<< task_type: retrieval
2024-11-13 18:23:16,218:INFO:   <<< tau: 0.07
2024-11-13 18:23:16,218:INFO:   <<< text_aug: True
2024-11-13 18:23:16,218:INFO:   <<< text_aug_choosen: random_swap
2024-11-13 18:23:16,218:INFO:   <<< text_num_hidden_layers: 12
2024-11-13 18:23:16,218:INFO:   <<< train_frame_order: 0
2024-11-13 18:23:16,218:INFO:   <<< use_mil: False
2024-11-13 18:23:16,218:INFO:   <<< video_dim: 1024
2024-11-13 18:23:16,218:INFO:   <<< visual_num_hidden_layers: 12
2024-11-13 18:23:16,218:INFO:   <<< warmup_proportion: 0.1
2024-11-13 18:23:16,218:INFO:   <<< world_size: 1
2024-11-13 18:23:16,218:INFO: device: cuda:0 n_gpu: 1
2024-11-13 18:23:17,296:INFO: loading archive file /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base
2024-11-13 18:23:17,297:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-11-13 18:23:17,297:INFO: Weight doesn't exsits. /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base/cross_pytorch_model.bin
2024-11-13 18:23:17,297:WARNING: Stage-One:True, Stage-Two:False
2024-11-13 18:23:17,297:WARNING: Test retrieval by loose type.
2024-11-13 18:23:17,297:WARNING: 	 embed_dim: 512
2024-11-13 18:23:17,297:WARNING: 	 image_resolution: 224
2024-11-13 18:23:17,297:WARNING: 	 vision_layers: 12
2024-11-13 18:23:17,297:WARNING: 	 vision_width: 768
2024-11-13 18:23:17,297:WARNING: 	 vision_patch_size: 32
2024-11-13 18:23:17,297:WARNING: 	 context_length: 77
2024-11-13 18:23:17,297:WARNING: 	 vocab_size: 49408
2024-11-13 18:23:17,297:WARNING: 	 transformer_width: 512
2024-11-13 18:23:17,297:WARNING: 	 transformer_heads: 8
2024-11-13 18:23:17,297:WARNING: 	 transformer_layers: 12
2024-11-13 18:23:17,298:WARNING: 		 linear_patch: 2d
2024-11-13 18:23:17,298:WARNING: 	 cut_top_layer: 0
2024-11-13 18:23:18,588:WARNING: 	 sim_header: Filip
2024-11-13 18:23:25,319:INFO: --------------------
2024-11-13 18:23:25,320:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-11-13 18:23:25,392:INFO: ***** Running test *****
2024-11-13 18:23:25,392:INFO:   Num examples = 642
2024-11-13 18:23:25,392:INFO:   Batch size = 256
2024-11-13 18:23:25,392:INFO:   Num steps = 3
2024-11-13 18:23:25,677:WARNING: Eval under the multi-sentence per video clip setting.
2024-11-13 18:23:25,677:WARNING: sentence num: 642, video num: 642
2024-11-13 18:25:34,058:INFO: Effective parameters:
2024-11-13 18:25:34,059:INFO:   <<< alpha: 0.9
2024-11-13 18:25:34,059:INFO:   <<< aug_choose: t2v
2024-11-13 18:25:34,059:INFO:   <<< batch_size: 512
2024-11-13 18:25:34,059:INFO:   <<< batch_size_val: 256
2024-11-13 18:25:34,059:INFO:   <<< cache_dir: 
2024-11-13 18:25:34,059:INFO:   <<< cla_weight_dir: cla_weight
2024-11-13 18:25:34,059:INFO:   <<< coef_lr: 1.0
2024-11-13 18:25:34,059:INFO:   <<< combine_type: sum
2024-11-13 18:25:34,059:INFO:   <<< cross_att_layers: 1
2024-11-13 18:25:34,059:INFO:   <<< cross_model: cross-base
2024-11-13 18:25:34,059:INFO:   <<< cross_num_hidden_layers: 4
2024-11-13 18:25:34,059:INFO:   <<< data_path: data_ph
2024-11-13 18:25:34,059:INFO:   <<< datatype: ph
2024-11-13 18:25:34,059:INFO:   <<< debug: False
2024-11-13 18:25:34,059:INFO:   <<< distributed: True
2024-11-13 18:25:34,059:INFO:   <<< do_eval: True
2024-11-13 18:25:34,059:INFO:   <<< do_lower_case: False
2024-11-13 18:25:34,059:INFO:   <<< do_pretrain: False
2024-11-13 18:25:34,059:INFO:   <<< do_train: False
2024-11-13 18:25:34,059:INFO:   <<< dual_mix: 0.5
2024-11-13 18:25:34,059:INFO:   <<< epochs: 200
2024-11-13 18:25:34,059:INFO:   <<< eval_frame_order: 0
2024-11-13 18:25:34,059:INFO:   <<< expand_msrvtt_sentences: False
2024-11-13 18:25:34,059:INFO:   <<< feature_framerate: 1
2024-11-13 18:25:34,059:INFO:   <<< feature_len: 64
2024-11-13 18:25:34,059:INFO:   <<< features_path: sign_feature/ph_domain_agnostic
2024-11-13 18:25:34,059:INFO:   <<< features_path_retrain: sign_feature/ph_domain_aware
2024-11-13 18:25:34,059:INFO:   <<< fp16: True
2024-11-13 18:25:34,059:INFO:   <<< fp16_opt_level: O1
2024-11-13 18:25:34,059:INFO:   <<< freeze_layer_num: 0
2024-11-13 18:25:34,060:INFO:   <<< gpu_ids: [0, 1]
2024-11-13 18:25:34,060:INFO:   <<< gradient_accumulation_steps: 1
2024-11-13 18:25:34,060:INFO:   <<< hard_negative_rate: 0.5
2024-11-13 18:25:34,060:INFO:   <<< init_model: chpt/ph_sota.pth
2024-11-13 18:25:34,060:INFO:   <<< linear_patch: 2d
2024-11-13 18:25:34,060:INFO:   <<< local_rank: 0
2024-11-13 18:25:34,060:INFO:   <<< loose_type: True
2024-11-13 18:25:34,060:INFO:   <<< lr: 1e-05
2024-11-13 18:25:34,060:INFO:   <<< lr_decay: 0.001
2024-11-13 18:25:34,060:INFO:   <<< margin: 0.1
2024-11-13 18:25:34,060:INFO:   <<< max_frames: 128
2024-11-13 18:25:34,060:INFO:   <<< max_words: 32
2024-11-13 18:25:34,060:INFO:   <<< mix_design: balance
2024-11-13 18:25:34,060:INFO:   <<< n_display: 1
2024-11-13 18:25:34,060:INFO:   <<< n_gpu: 1
2024-11-13 18:25:34,060:INFO:   <<< n_pair: 1
2024-11-13 18:25:34,060:INFO:   <<< negative_weighting: 1
2024-11-13 18:25:34,060:INFO:   <<< not_load_visual: False
2024-11-13 18:25:34,060:INFO:   <<< num_thread_reader: 8
2024-11-13 18:25:34,060:INFO:   <<< output_dir: new_experiment
2024-11-13 18:25:34,060:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-11-13 18:25:34,060:INFO:   <<< rank: 0
2024-11-13 18:25:34,060:INFO:   <<< resume_model: None
2024-11-13 18:25:34,060:INFO:   <<< sampled_use_mil: False
2024-11-13 18:25:34,060:INFO:   <<< seed: 42
2024-11-13 18:25:34,060:INFO:   <<< sim_calcu: softmax_max
2024-11-13 18:25:34,060:INFO:   <<< sim_header: Filip
2024-11-13 18:25:34,060:INFO:   <<< slice_framepos: 0
2024-11-13 18:25:34,060:INFO:   <<< task_type: retrieval
2024-11-13 18:25:34,060:INFO:   <<< tau: 0.07
2024-11-13 18:25:34,060:INFO:   <<< text_aug: True
2024-11-13 18:25:34,060:INFO:   <<< text_aug_choosen: random_swap
2024-11-13 18:25:34,060:INFO:   <<< text_num_hidden_layers: 12
2024-11-13 18:25:34,060:INFO:   <<< train_frame_order: 0
2024-11-13 18:25:34,060:INFO:   <<< use_mil: False
2024-11-13 18:25:34,060:INFO:   <<< video_dim: 1024
2024-11-13 18:25:34,060:INFO:   <<< visual_num_hidden_layers: 12
2024-11-13 18:25:34,061:INFO:   <<< warmup_proportion: 0.1
2024-11-13 18:25:34,061:INFO:   <<< world_size: 1
2024-11-13 18:25:34,061:INFO: device: cuda:0 n_gpu: 1
2024-11-13 18:25:35,068:INFO: loading archive file /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base
2024-11-13 18:25:35,069:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-11-13 18:25:35,069:INFO: Weight doesn't exsits. /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base/cross_pytorch_model.bin
2024-11-13 18:25:35,069:WARNING: Stage-One:True, Stage-Two:False
2024-11-13 18:25:35,069:WARNING: Test retrieval by loose type.
2024-11-13 18:25:35,069:WARNING: 	 embed_dim: 512
2024-11-13 18:25:35,069:WARNING: 	 image_resolution: 224
2024-11-13 18:25:35,069:WARNING: 	 vision_layers: 12
2024-11-13 18:25:35,069:WARNING: 	 vision_width: 768
2024-11-13 18:25:35,070:WARNING: 	 vision_patch_size: 32
2024-11-13 18:25:35,070:WARNING: 	 context_length: 77
2024-11-13 18:25:35,070:WARNING: 	 vocab_size: 49408
2024-11-13 18:25:35,070:WARNING: 	 transformer_width: 512
2024-11-13 18:25:35,070:WARNING: 	 transformer_heads: 8
2024-11-13 18:25:35,070:WARNING: 	 transformer_layers: 12
2024-11-13 18:25:35,070:WARNING: 		 linear_patch: 2d
2024-11-13 18:25:35,070:WARNING: 	 cut_top_layer: 0
2024-11-13 18:25:36,291:WARNING: 	 sim_header: Filip
2024-11-13 18:25:42,991:INFO: --------------------
2024-11-13 18:25:42,991:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-11-13 18:25:43,093:INFO: ***** Running test *****
2024-11-13 18:25:43,093:INFO:   Num examples = 642
2024-11-13 18:25:43,093:INFO:   Batch size = 256
2024-11-13 18:25:43,093:INFO:   Num steps = 3
2024-11-13 18:25:43,297:WARNING: Eval under the multi-sentence per video clip setting.
2024-11-13 18:25:43,297:WARNING: sentence num: 642, video num: 642
2024-11-13 18:25:44,762:INFO: before reshape, sim matrix size: 642 x 642
2024-11-13 18:25:44,773:INFO: after reshape, sim matrix size: 642 x 1 x 642
2024-11-13 18:25:44,827:INFO: Mix_Text-to-Video:
2024-11-13 18:25:44,827:INFO: 	>>>  R@1: 69.5 - R@5: 86.6 - R@10: 92.1 - Median R: 1.0 - Mean R: 5.2
2024-11-13 18:25:44,827:INFO: Mix_Video-to-Text:
2024-11-13 18:25:44,827:INFO: 	>>>  V2T$R@1: 70.1 - V2T$R@5: 87.9 - V2T$R@10: 92.7 - V2T$Median R: 1.0 - V2T$Mean R: 5.8
2024-11-13 18:32:47,039:INFO: Effective parameters:
2024-11-13 18:32:47,040:INFO:   <<< alpha: 0.9
2024-11-13 18:32:47,040:INFO:   <<< aug_choose: t2v
2024-11-13 18:32:47,040:INFO:   <<< batch_size: 512
2024-11-13 18:32:47,040:INFO:   <<< batch_size_val: 256
2024-11-13 18:32:47,040:INFO:   <<< cache_dir: 
2024-11-13 18:32:47,040:INFO:   <<< cla_weight_dir: cla_weight
2024-11-13 18:32:47,040:INFO:   <<< coef_lr: 1.0
2024-11-13 18:32:47,040:INFO:   <<< combine_type: sum
2024-11-13 18:32:47,040:INFO:   <<< cross_att_layers: 1
2024-11-13 18:32:47,040:INFO:   <<< cross_model: cross-base
2024-11-13 18:32:47,040:INFO:   <<< cross_num_hidden_layers: 4
2024-11-13 18:32:47,040:INFO:   <<< data_path: data_ph
2024-11-13 18:32:47,040:INFO:   <<< datatype: ph
2024-11-13 18:32:47,040:INFO:   <<< debug: False
2024-11-13 18:32:47,040:INFO:   <<< distributed: True
2024-11-13 18:32:47,040:INFO:   <<< do_eval: True
2024-11-13 18:32:47,040:INFO:   <<< do_lower_case: False
2024-11-13 18:32:47,040:INFO:   <<< do_pretrain: False
2024-11-13 18:32:47,040:INFO:   <<< do_train: False
2024-11-13 18:32:47,040:INFO:   <<< dual_mix: 0.5
2024-11-13 18:32:47,040:INFO:   <<< epochs: 200
2024-11-13 18:32:47,040:INFO:   <<< eval_frame_order: 0
2024-11-13 18:32:47,040:INFO:   <<< expand_msrvtt_sentences: False
2024-11-13 18:32:47,040:INFO:   <<< feature_framerate: 1
2024-11-13 18:32:47,040:INFO:   <<< feature_len: 64
2024-11-13 18:32:47,040:INFO:   <<< features_path: sign_feature/ph_domain_agnostic
2024-11-13 18:32:47,040:INFO:   <<< features_path_retrain: sign_feature/ph_domain_aware
2024-11-13 18:32:47,040:INFO:   <<< fp16: True
2024-11-13 18:32:47,040:INFO:   <<< fp16_opt_level: O1
2024-11-13 18:32:47,040:INFO:   <<< freeze_layer_num: 0
2024-11-13 18:32:47,041:INFO:   <<< gpu_ids: [0, 1]
2024-11-13 18:32:47,041:INFO:   <<< gradient_accumulation_steps: 1
2024-11-13 18:32:47,041:INFO:   <<< hard_negative_rate: 0.5
2024-11-13 18:32:47,041:INFO:   <<< init_model: chpt/ph_sota.pth
2024-11-13 18:32:47,041:INFO:   <<< linear_patch: 2d
2024-11-13 18:32:47,041:INFO:   <<< local_rank: 0
2024-11-13 18:32:47,041:INFO:   <<< loose_type: True
2024-11-13 18:32:47,041:INFO:   <<< lr: 1e-05
2024-11-13 18:32:47,041:INFO:   <<< lr_decay: 0.001
2024-11-13 18:32:47,041:INFO:   <<< margin: 0.1
2024-11-13 18:32:47,041:INFO:   <<< max_frames: 128
2024-11-13 18:32:47,041:INFO:   <<< max_words: 32
2024-11-13 18:32:47,041:INFO:   <<< mix_design: balance
2024-11-13 18:32:47,041:INFO:   <<< n_display: 1
2024-11-13 18:32:47,041:INFO:   <<< n_gpu: 1
2024-11-13 18:32:47,041:INFO:   <<< n_pair: 1
2024-11-13 18:32:47,041:INFO:   <<< negative_weighting: 1
2024-11-13 18:32:47,041:INFO:   <<< not_load_visual: False
2024-11-13 18:32:47,041:INFO:   <<< num_thread_reader: 8
2024-11-13 18:32:47,041:INFO:   <<< output_dir: new_experiment
2024-11-13 18:32:47,041:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-11-13 18:32:47,041:INFO:   <<< rank: 0
2024-11-13 18:32:47,041:INFO:   <<< resume_model: None
2024-11-13 18:32:47,041:INFO:   <<< sampled_use_mil: False
2024-11-13 18:32:47,041:INFO:   <<< seed: 42
2024-11-13 18:32:47,041:INFO:   <<< sim_calcu: softmax_max
2024-11-13 18:32:47,041:INFO:   <<< sim_header: Filip
2024-11-13 18:32:47,041:INFO:   <<< slice_framepos: 0
2024-11-13 18:32:47,041:INFO:   <<< task_type: retrieval
2024-11-13 18:32:47,041:INFO:   <<< tau: 0.07
2024-11-13 18:32:47,041:INFO:   <<< text_aug: True
2024-11-13 18:32:47,041:INFO:   <<< text_aug_choosen: random_swap
2024-11-13 18:32:47,041:INFO:   <<< text_num_hidden_layers: 12
2024-11-13 18:32:47,041:INFO:   <<< train_frame_order: 0
2024-11-13 18:32:47,041:INFO:   <<< use_mil: False
2024-11-13 18:32:47,042:INFO:   <<< video_dim: 1024
2024-11-13 18:32:47,042:INFO:   <<< visual_num_hidden_layers: 12
2024-11-13 18:32:47,042:INFO:   <<< warmup_proportion: 0.1
2024-11-13 18:32:47,042:INFO:   <<< world_size: 1
2024-11-13 18:32:47,042:INFO: device: cuda:0 n_gpu: 1
2024-11-13 18:32:48,049:INFO: loading archive file /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base
2024-11-13 18:32:48,050:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-11-13 18:32:48,050:INFO: Weight doesn't exsits. /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base/cross_pytorch_model.bin
2024-11-13 18:32:48,050:WARNING: Stage-One:True, Stage-Two:False
2024-11-13 18:32:48,050:WARNING: Test retrieval by loose type.
2024-11-13 18:32:48,051:WARNING: 	 embed_dim: 512
2024-11-13 18:32:48,051:WARNING: 	 image_resolution: 224
2024-11-13 18:32:48,051:WARNING: 	 vision_layers: 12
2024-11-13 18:32:48,051:WARNING: 	 vision_width: 768
2024-11-13 18:32:48,051:WARNING: 	 vision_patch_size: 32
2024-11-13 18:32:48,051:WARNING: 	 context_length: 77
2024-11-13 18:32:48,051:WARNING: 	 vocab_size: 49408
2024-11-13 18:32:48,051:WARNING: 	 transformer_width: 512
2024-11-13 18:32:48,051:WARNING: 	 transformer_heads: 8
2024-11-13 18:32:48,051:WARNING: 	 transformer_layers: 12
2024-11-13 18:32:48,051:WARNING: 		 linear_patch: 2d
2024-11-13 18:32:48,051:WARNING: 	 cut_top_layer: 0
2024-11-13 18:32:49,276:WARNING: 	 sim_header: Filip
2024-11-13 18:32:55,991:INFO: --------------------
2024-11-13 18:32:55,992:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-11-13 18:32:56,061:INFO: ***** Running test *****
2024-11-13 18:32:56,061:INFO:   Num examples = 642
2024-11-13 18:32:56,061:INFO:   Batch size = 256
2024-11-13 18:32:56,061:INFO:   Num steps = 3
2024-11-13 18:32:56,455:WARNING: Eval under the multi-sentence per video clip setting.
2024-11-13 18:32:56,455:WARNING: sentence num: 642, video num: 642
2024-11-13 18:34:29,935:INFO: Effective parameters:
2024-11-13 18:34:29,935:INFO:   <<< alpha: 0.9
2024-11-13 18:34:29,935:INFO:   <<< aug_choose: t2v
2024-11-13 18:34:29,936:INFO:   <<< batch_size: 512
2024-11-13 18:34:29,936:INFO:   <<< batch_size_val: 256
2024-11-13 18:34:29,936:INFO:   <<< cache_dir: 
2024-11-13 18:34:29,936:INFO:   <<< cla_weight_dir: cla_weight
2024-11-13 18:34:29,936:INFO:   <<< coef_lr: 1.0
2024-11-13 18:34:29,936:INFO:   <<< combine_type: sum
2024-11-13 18:34:29,936:INFO:   <<< cross_att_layers: 1
2024-11-13 18:34:29,936:INFO:   <<< cross_model: cross-base
2024-11-13 18:34:29,936:INFO:   <<< cross_num_hidden_layers: 4
2024-11-13 18:34:29,936:INFO:   <<< data_path: data_ph
2024-11-13 18:34:29,936:INFO:   <<< datatype: ph
2024-11-13 18:34:29,936:INFO:   <<< debug: False
2024-11-13 18:34:29,936:INFO:   <<< distributed: True
2024-11-13 18:34:29,936:INFO:   <<< do_eval: True
2024-11-13 18:34:29,936:INFO:   <<< do_lower_case: False
2024-11-13 18:34:29,936:INFO:   <<< do_pretrain: False
2024-11-13 18:34:29,936:INFO:   <<< do_train: False
2024-11-13 18:34:29,936:INFO:   <<< dual_mix: 0.5
2024-11-13 18:34:29,936:INFO:   <<< epochs: 200
2024-11-13 18:34:29,936:INFO:   <<< eval_frame_order: 0
2024-11-13 18:34:29,936:INFO:   <<< expand_msrvtt_sentences: False
2024-11-13 18:34:29,936:INFO:   <<< feature_framerate: 1
2024-11-13 18:34:29,936:INFO:   <<< feature_len: 64
2024-11-13 18:34:29,936:INFO:   <<< features_path: sign_feature/ph_domain_agnostic
2024-11-13 18:34:29,936:INFO:   <<< features_path_retrain: sign_feature/ph_domain_aware
2024-11-13 18:34:29,936:INFO:   <<< fp16: True
2024-11-13 18:34:29,936:INFO:   <<< fp16_opt_level: O1
2024-11-13 18:34:29,936:INFO:   <<< freeze_layer_num: 0
2024-11-13 18:34:29,936:INFO:   <<< gpu_ids: [0, 1]
2024-11-13 18:34:29,936:INFO:   <<< gradient_accumulation_steps: 1
2024-11-13 18:34:29,936:INFO:   <<< hard_negative_rate: 0.5
2024-11-13 18:34:29,936:INFO:   <<< init_model: chpt/ph_sota.pth
2024-11-13 18:34:29,936:INFO:   <<< linear_patch: 2d
2024-11-13 18:34:29,936:INFO:   <<< local_rank: 0
2024-11-13 18:34:29,936:INFO:   <<< loose_type: True
2024-11-13 18:34:29,936:INFO:   <<< lr: 1e-05
2024-11-13 18:34:29,937:INFO:   <<< lr_decay: 0.001
2024-11-13 18:34:29,937:INFO:   <<< margin: 0.1
2024-11-13 18:34:29,937:INFO:   <<< max_frames: 128
2024-11-13 18:34:29,937:INFO:   <<< max_words: 32
2024-11-13 18:34:29,937:INFO:   <<< mix_design: balance
2024-11-13 18:34:29,937:INFO:   <<< n_display: 1
2024-11-13 18:34:29,937:INFO:   <<< n_gpu: 1
2024-11-13 18:34:29,937:INFO:   <<< n_pair: 1
2024-11-13 18:34:29,937:INFO:   <<< negative_weighting: 1
2024-11-13 18:34:29,937:INFO:   <<< not_load_visual: False
2024-11-13 18:34:29,937:INFO:   <<< num_thread_reader: 8
2024-11-13 18:34:29,937:INFO:   <<< output_dir: new_experiment
2024-11-13 18:34:29,937:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-11-13 18:34:29,937:INFO:   <<< rank: 0
2024-11-13 18:34:29,937:INFO:   <<< resume_model: None
2024-11-13 18:34:29,937:INFO:   <<< sampled_use_mil: False
2024-11-13 18:34:29,937:INFO:   <<< seed: 42
2024-11-13 18:34:29,937:INFO:   <<< sim_calcu: softmax_max
2024-11-13 18:34:29,937:INFO:   <<< sim_header: Filip
2024-11-13 18:34:29,937:INFO:   <<< slice_framepos: 0
2024-11-13 18:34:29,937:INFO:   <<< task_type: retrieval
2024-11-13 18:34:29,937:INFO:   <<< tau: 0.07
2024-11-13 18:34:29,937:INFO:   <<< text_aug: True
2024-11-13 18:34:29,937:INFO:   <<< text_aug_choosen: random_swap
2024-11-13 18:34:29,937:INFO:   <<< text_num_hidden_layers: 12
2024-11-13 18:34:29,937:INFO:   <<< train_frame_order: 0
2024-11-13 18:34:29,937:INFO:   <<< use_mil: False
2024-11-13 18:34:29,937:INFO:   <<< video_dim: 1024
2024-11-13 18:34:29,937:INFO:   <<< visual_num_hidden_layers: 12
2024-11-13 18:34:29,937:INFO:   <<< warmup_proportion: 0.1
2024-11-13 18:34:29,937:INFO:   <<< world_size: 1
2024-11-13 18:34:29,938:INFO: device: cuda:0 n_gpu: 1
2024-11-13 18:34:30,945:INFO: loading archive file /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base
2024-11-13 18:34:30,947:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-11-13 18:34:30,947:INFO: Weight doesn't exsits. /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base/cross_pytorch_model.bin
2024-11-13 18:34:30,947:WARNING: Stage-One:True, Stage-Two:False
2024-11-13 18:34:30,947:WARNING: Test retrieval by loose type.
2024-11-13 18:34:30,947:WARNING: 	 embed_dim: 512
2024-11-13 18:34:30,947:WARNING: 	 image_resolution: 224
2024-11-13 18:34:30,947:WARNING: 	 vision_layers: 12
2024-11-13 18:34:30,947:WARNING: 	 vision_width: 768
2024-11-13 18:34:30,947:WARNING: 	 vision_patch_size: 32
2024-11-13 18:34:30,947:WARNING: 	 context_length: 77
2024-11-13 18:34:30,947:WARNING: 	 vocab_size: 49408
2024-11-13 18:34:30,948:WARNING: 	 transformer_width: 512
2024-11-13 18:34:30,948:WARNING: 	 transformer_heads: 8
2024-11-13 18:34:30,948:WARNING: 	 transformer_layers: 12
2024-11-13 18:34:30,948:WARNING: 		 linear_patch: 2d
2024-11-13 18:34:30,948:WARNING: 	 cut_top_layer: 0
2024-11-13 18:34:32,173:WARNING: 	 sim_header: Filip
2024-11-13 18:34:38,865:INFO: --------------------
2024-11-13 18:34:38,866:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-11-13 18:34:38,952:INFO: ***** Running test *****
2024-11-13 18:34:38,952:INFO:   Num examples = 642
2024-11-13 18:34:38,952:INFO:   Batch size = 256
2024-11-13 18:34:38,953:INFO:   Num steps = 3
2024-11-13 18:34:39,227:WARNING: Eval under the multi-sentence per video clip setting.
2024-11-13 18:34:39,227:WARNING: sentence num: 642, video num: 642
2024-11-13 18:35:47,359:INFO: Effective parameters:
2024-11-13 18:35:47,359:INFO:   <<< alpha: 0.9
2024-11-13 18:35:47,359:INFO:   <<< aug_choose: t2v
2024-11-13 18:35:47,359:INFO:   <<< batch_size: 512
2024-11-13 18:35:47,359:INFO:   <<< batch_size_val: 256
2024-11-13 18:35:47,359:INFO:   <<< cache_dir: 
2024-11-13 18:35:47,359:INFO:   <<< cla_weight_dir: cla_weight
2024-11-13 18:35:47,359:INFO:   <<< coef_lr: 1.0
2024-11-13 18:35:47,359:INFO:   <<< combine_type: sum
2024-11-13 18:35:47,359:INFO:   <<< cross_att_layers: 1
2024-11-13 18:35:47,359:INFO:   <<< cross_model: cross-base
2024-11-13 18:35:47,359:INFO:   <<< cross_num_hidden_layers: 4
2024-11-13 18:35:47,359:INFO:   <<< data_path: data_ph
2024-11-13 18:35:47,359:INFO:   <<< datatype: ph
2024-11-13 18:35:47,359:INFO:   <<< debug: False
2024-11-13 18:35:47,359:INFO:   <<< distributed: True
2024-11-13 18:35:47,359:INFO:   <<< do_eval: True
2024-11-13 18:35:47,360:INFO:   <<< do_lower_case: False
2024-11-13 18:35:47,360:INFO:   <<< do_pretrain: False
2024-11-13 18:35:47,360:INFO:   <<< do_train: False
2024-11-13 18:35:47,360:INFO:   <<< dual_mix: 0.5
2024-11-13 18:35:47,360:INFO:   <<< epochs: 200
2024-11-13 18:35:47,360:INFO:   <<< eval_frame_order: 0
2024-11-13 18:35:47,360:INFO:   <<< expand_msrvtt_sentences: False
2024-11-13 18:35:47,360:INFO:   <<< feature_framerate: 1
2024-11-13 18:35:47,360:INFO:   <<< feature_len: 64
2024-11-13 18:35:47,360:INFO:   <<< features_path: sign_feature/ph_domain_agnostic
2024-11-13 18:35:47,360:INFO:   <<< features_path_retrain: sign_feature/ph_domain_aware
2024-11-13 18:35:47,360:INFO:   <<< fp16: True
2024-11-13 18:35:47,360:INFO:   <<< fp16_opt_level: O1
2024-11-13 18:35:47,360:INFO:   <<< freeze_layer_num: 0
2024-11-13 18:35:47,360:INFO:   <<< gpu_ids: [0, 1]
2024-11-13 18:35:47,360:INFO:   <<< gradient_accumulation_steps: 1
2024-11-13 18:35:47,360:INFO:   <<< hard_negative_rate: 0.5
2024-11-13 18:35:47,360:INFO:   <<< init_model: chpt/ph_sota.pth
2024-11-13 18:35:47,360:INFO:   <<< linear_patch: 2d
2024-11-13 18:35:47,360:INFO:   <<< local_rank: 0
2024-11-13 18:35:47,360:INFO:   <<< loose_type: True
2024-11-13 18:35:47,360:INFO:   <<< lr: 1e-05
2024-11-13 18:35:47,360:INFO:   <<< lr_decay: 0.001
2024-11-13 18:35:47,360:INFO:   <<< margin: 0.1
2024-11-13 18:35:47,360:INFO:   <<< max_frames: 128
2024-11-13 18:35:47,360:INFO:   <<< max_words: 32
2024-11-13 18:35:47,360:INFO:   <<< mix_design: balance
2024-11-13 18:35:47,360:INFO:   <<< n_display: 1
2024-11-13 18:35:47,360:INFO:   <<< n_gpu: 1
2024-11-13 18:35:47,360:INFO:   <<< n_pair: 1
2024-11-13 18:35:47,360:INFO:   <<< negative_weighting: 1
2024-11-13 18:35:47,360:INFO:   <<< not_load_visual: False
2024-11-13 18:35:47,360:INFO:   <<< num_thread_reader: 8
2024-11-13 18:35:47,360:INFO:   <<< output_dir: new_experiment
2024-11-13 18:35:47,360:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-11-13 18:35:47,360:INFO:   <<< rank: 0
2024-11-13 18:35:47,361:INFO:   <<< resume_model: None
2024-11-13 18:35:47,361:INFO:   <<< sampled_use_mil: False
2024-11-13 18:35:47,361:INFO:   <<< seed: 42
2024-11-13 18:35:47,361:INFO:   <<< sim_calcu: softmax_max
2024-11-13 18:35:47,361:INFO:   <<< sim_header: Filip
2024-11-13 18:35:47,361:INFO:   <<< slice_framepos: 0
2024-11-13 18:35:47,361:INFO:   <<< task_type: retrieval
2024-11-13 18:35:47,361:INFO:   <<< tau: 0.07
2024-11-13 18:35:47,361:INFO:   <<< text_aug: True
2024-11-13 18:35:47,361:INFO:   <<< text_aug_choosen: random_swap
2024-11-13 18:35:47,361:INFO:   <<< text_num_hidden_layers: 12
2024-11-13 18:35:47,361:INFO:   <<< train_frame_order: 0
2024-11-13 18:35:47,361:INFO:   <<< use_mil: False
2024-11-13 18:35:47,361:INFO:   <<< video_dim: 1024
2024-11-13 18:35:47,361:INFO:   <<< visual_num_hidden_layers: 12
2024-11-13 18:35:47,361:INFO:   <<< warmup_proportion: 0.1
2024-11-13 18:35:47,361:INFO:   <<< world_size: 1
2024-11-13 18:35:47,361:INFO: device: cuda:0 n_gpu: 1
2024-11-13 18:35:48,371:INFO: loading archive file /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base
2024-11-13 18:35:48,373:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-11-13 18:35:48,373:INFO: Weight doesn't exsits. /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base/cross_pytorch_model.bin
2024-11-13 18:35:48,373:WARNING: Stage-One:True, Stage-Two:False
2024-11-13 18:35:48,373:WARNING: Test retrieval by loose type.
2024-11-13 18:35:48,373:WARNING: 	 embed_dim: 512
2024-11-13 18:35:48,374:WARNING: 	 image_resolution: 224
2024-11-13 18:35:48,374:WARNING: 	 vision_layers: 12
2024-11-13 18:35:48,374:WARNING: 	 vision_width: 768
2024-11-13 18:35:48,374:WARNING: 	 vision_patch_size: 32
2024-11-13 18:35:48,374:WARNING: 	 context_length: 77
2024-11-13 18:35:48,374:WARNING: 	 vocab_size: 49408
2024-11-13 18:35:48,374:WARNING: 	 transformer_width: 512
2024-11-13 18:35:48,374:WARNING: 	 transformer_heads: 8
2024-11-13 18:35:48,374:WARNING: 	 transformer_layers: 12
2024-11-13 18:35:48,374:WARNING: 		 linear_patch: 2d
2024-11-13 18:35:48,374:WARNING: 	 cut_top_layer: 0
2024-11-13 18:35:49,602:WARNING: 	 sim_header: Filip
2024-11-13 18:35:56,331:INFO: --------------------
2024-11-13 18:35:56,332:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-11-13 18:35:56,412:INFO: ***** Running test *****
2024-11-13 18:35:56,412:INFO:   Num examples = 642
2024-11-13 18:35:56,412:INFO:   Batch size = 256
2024-11-13 18:35:56,412:INFO:   Num steps = 3
2024-11-13 18:35:56,959:WARNING: Eval under the multi-sentence per video clip setting.
2024-11-13 18:35:56,959:WARNING: sentence num: 642, video num: 642
2024-11-13 18:35:58,612:INFO: before reshape, sim matrix size: 642 x 642
2024-11-13 18:35:58,654:INFO: after reshape, sim matrix size: 642 x 1 x 642
2024-11-13 18:35:58,708:INFO: Mix_Text-to-Video:
2024-11-13 18:35:58,708:INFO: 	>>>  R@1: 69.5 - R@5: 86.6 - R@10: 92.1 - Median R: 1.0 - Mean R: 5.2
2024-11-13 18:35:58,708:INFO: Mix_Video-to-Text:
2024-11-13 18:35:58,708:INFO: 	>>>  V2T$R@1: 70.1 - V2T$R@5: 87.9 - V2T$R@10: 92.7 - V2T$Median R: 1.0 - V2T$Mean R: 5.8
2024-11-13 18:57:33,222:INFO: Effective parameters:
2024-11-13 18:57:33,222:INFO:   <<< alpha: 0.9
2024-11-13 18:57:33,222:INFO:   <<< aug_choose: t2v
2024-11-13 18:57:33,222:INFO:   <<< batch_size: 512
2024-11-13 18:57:33,222:INFO:   <<< batch_size_val: 256
2024-11-13 18:57:33,222:INFO:   <<< cache_dir: 
2024-11-13 18:57:33,222:INFO:   <<< cla_weight_dir: cla_weight
2024-11-13 18:57:33,222:INFO:   <<< coef_lr: 1.0
2024-11-13 18:57:33,222:INFO:   <<< combine_type: sum
2024-11-13 18:57:33,222:INFO:   <<< cross_att_layers: 1
2024-11-13 18:57:33,222:INFO:   <<< cross_model: cross-base
2024-11-13 18:57:33,223:INFO:   <<< cross_num_hidden_layers: 4
2024-11-13 18:57:33,223:INFO:   <<< data_path: data_ph
2024-11-13 18:57:33,223:INFO:   <<< datatype: ph
2024-11-13 18:57:33,223:INFO:   <<< debug: False
2024-11-13 18:57:33,223:INFO:   <<< distributed: True
2024-11-13 18:57:33,223:INFO:   <<< do_eval: True
2024-11-13 18:57:33,223:INFO:   <<< do_lower_case: False
2024-11-13 18:57:33,223:INFO:   <<< do_pretrain: False
2024-11-13 18:57:33,223:INFO:   <<< do_train: False
2024-11-13 18:57:33,223:INFO:   <<< dual_mix: 0.5
2024-11-13 18:57:33,223:INFO:   <<< epochs: 200
2024-11-13 18:57:33,223:INFO:   <<< eval_frame_order: 0
2024-11-13 18:57:33,223:INFO:   <<< expand_msrvtt_sentences: False
2024-11-13 18:57:33,223:INFO:   <<< feature_framerate: 1
2024-11-13 18:57:33,223:INFO:   <<< feature_len: 64
2024-11-13 18:57:33,223:INFO:   <<< features_path: sign_feature/ph_domain_agnostic
2024-11-13 18:57:33,223:INFO:   <<< features_path_retrain: sign_feature/ph_domain_aware
2024-11-13 18:57:33,223:INFO:   <<< fp16: True
2024-11-13 18:57:33,223:INFO:   <<< fp16_opt_level: O1
2024-11-13 18:57:33,223:INFO:   <<< freeze_layer_num: 0
2024-11-13 18:57:33,223:INFO:   <<< gpu_ids: [0, 1]
2024-11-13 18:57:33,223:INFO:   <<< gradient_accumulation_steps: 1
2024-11-13 18:57:33,223:INFO:   <<< hard_negative_rate: 0.5
2024-11-13 18:57:33,223:INFO:   <<< init_model: chpt/ph_sota.pth
2024-11-13 18:57:33,223:INFO:   <<< linear_patch: 2d
2024-11-13 18:57:33,223:INFO:   <<< local_rank: 0
2024-11-13 18:57:33,223:INFO:   <<< loose_type: True
2024-11-13 18:57:33,223:INFO:   <<< lr: 1e-05
2024-11-13 18:57:33,223:INFO:   <<< lr_decay: 0.001
2024-11-13 18:57:33,223:INFO:   <<< margin: 0.1
2024-11-13 18:57:33,223:INFO:   <<< max_frames: 128
2024-11-13 18:57:33,223:INFO:   <<< max_words: 32
2024-11-13 18:57:33,223:INFO:   <<< mix_design: balance
2024-11-13 18:57:33,223:INFO:   <<< n_display: 1
2024-11-13 18:57:33,223:INFO:   <<< n_gpu: 1
2024-11-13 18:57:33,224:INFO:   <<< n_pair: 1
2024-11-13 18:57:33,224:INFO:   <<< negative_weighting: 1
2024-11-13 18:57:33,224:INFO:   <<< not_load_visual: False
2024-11-13 18:57:33,224:INFO:   <<< num_thread_reader: 8
2024-11-13 18:57:33,224:INFO:   <<< output_dir: new_experiment
2024-11-13 18:57:33,224:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-11-13 18:57:33,224:INFO:   <<< rank: 0
2024-11-13 18:57:33,224:INFO:   <<< resume_model: None
2024-11-13 18:57:33,224:INFO:   <<< sampled_use_mil: False
2024-11-13 18:57:33,224:INFO:   <<< seed: 42
2024-11-13 18:57:33,224:INFO:   <<< sim_calcu: softmax_max
2024-11-13 18:57:33,224:INFO:   <<< sim_header: Filip
2024-11-13 18:57:33,224:INFO:   <<< slice_framepos: 0
2024-11-13 18:57:33,224:INFO:   <<< task_type: retrieval
2024-11-13 18:57:33,224:INFO:   <<< tau: 0.07
2024-11-13 18:57:33,224:INFO:   <<< text_aug: True
2024-11-13 18:57:33,224:INFO:   <<< text_aug_choosen: random_swap
2024-11-13 18:57:33,224:INFO:   <<< text_num_hidden_layers: 12
2024-11-13 18:57:33,224:INFO:   <<< train_frame_order: 0
2024-11-13 18:57:33,224:INFO:   <<< use_mil: False
2024-11-13 18:57:33,224:INFO:   <<< video_dim: 1024
2024-11-13 18:57:33,224:INFO:   <<< visual_num_hidden_layers: 12
2024-11-13 18:57:33,224:INFO:   <<< warmup_proportion: 0.1
2024-11-13 18:57:33,224:INFO:   <<< world_size: 1
2024-11-13 18:57:33,224:INFO: device: cuda:0 n_gpu: 1
2024-11-13 18:57:34,227:INFO: loading archive file /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base
2024-11-13 18:57:34,228:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-11-13 18:57:34,228:INFO: Weight doesn't exsits. /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base/cross_pytorch_model.bin
2024-11-13 18:57:34,228:WARNING: Stage-One:True, Stage-Two:False
2024-11-13 18:57:34,228:WARNING: Test retrieval by loose type.
2024-11-13 18:57:34,228:WARNING: 	 embed_dim: 512
2024-11-13 18:57:34,228:WARNING: 	 image_resolution: 224
2024-11-13 18:57:34,228:WARNING: 	 vision_layers: 12
2024-11-13 18:57:34,228:WARNING: 	 vision_width: 768
2024-11-13 18:57:34,228:WARNING: 	 vision_patch_size: 32
2024-11-13 18:57:34,229:WARNING: 	 context_length: 77
2024-11-13 18:57:34,229:WARNING: 	 vocab_size: 49408
2024-11-13 18:57:34,229:WARNING: 	 transformer_width: 512
2024-11-13 18:57:34,229:WARNING: 	 transformer_heads: 8
2024-11-13 18:57:34,229:WARNING: 	 transformer_layers: 12
2024-11-13 18:57:34,229:WARNING: 		 linear_patch: 2d
2024-11-13 18:57:34,229:WARNING: 	 cut_top_layer: 0
2024-11-13 18:57:35,698:WARNING: 	 sim_header: Filip
2024-11-13 18:57:42,480:INFO: --------------------
2024-11-13 18:57:42,480:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-11-13 18:57:42,542:INFO: ***** Running test *****
2024-11-13 18:57:42,543:INFO:   Num examples = 642
2024-11-13 18:57:42,543:INFO:   Batch size = 256
2024-11-13 18:57:42,543:INFO:   Num steps = 3
2024-11-13 18:57:42,867:WARNING: Eval under the multi-sentence per video clip setting.
2024-11-13 18:57:42,867:WARNING: sentence num: 642, video num: 642
2024-11-13 18:57:44,466:INFO: before reshape, sim matrix size: 642 x 642
2024-11-13 18:57:44,527:INFO: after reshape, sim matrix size: 642 x 1 x 642
2024-11-13 18:57:44,587:INFO: Mix_Text-to-Video:
2024-11-13 18:57:44,587:INFO: 	>>>  R@1: 69.5 - R@5: 86.6 - R@10: 92.1 - Median R: 1.0 - Mean R: 5.2
2024-11-13 18:57:44,587:INFO: Mix_Video-to-Text:
2024-11-13 18:57:44,587:INFO: 	>>>  V2T$R@1: 70.1 - V2T$R@5: 87.9 - V2T$R@10: 92.7 - V2T$Median R: 1.0 - V2T$Mean R: 5.8
2024-11-13 19:34:29,363:INFO: Effective parameters:
2024-11-13 19:34:29,363:INFO:   <<< alpha: 0.9
2024-11-13 19:34:29,363:INFO:   <<< aug_choose: t2v
2024-11-13 19:34:29,363:INFO:   <<< batch_size: 512
2024-11-13 19:34:29,363:INFO:   <<< batch_size_val: 256
2024-11-13 19:34:29,363:INFO:   <<< cache_dir: 
2024-11-13 19:34:29,363:INFO:   <<< cla_weight_dir: cla_weight
2024-11-13 19:34:29,363:INFO:   <<< coef_lr: 1.0
2024-11-13 19:34:29,363:INFO:   <<< combine_type: sum
2024-11-13 19:34:29,363:INFO:   <<< cross_att_layers: 1
2024-11-13 19:34:29,363:INFO:   <<< cross_model: cross-base
2024-11-13 19:34:29,363:INFO:   <<< cross_num_hidden_layers: 4
2024-11-13 19:34:29,363:INFO:   <<< data_path: data_ph
2024-11-13 19:34:29,363:INFO:   <<< datatype: ph
2024-11-13 19:34:29,363:INFO:   <<< debug: False
2024-11-13 19:34:29,363:INFO:   <<< distributed: True
2024-11-13 19:34:29,363:INFO:   <<< do_eval: True
2024-11-13 19:34:29,363:INFO:   <<< do_lower_case: False
2024-11-13 19:34:29,364:INFO:   <<< do_pretrain: False
2024-11-13 19:34:29,364:INFO:   <<< do_train: False
2024-11-13 19:34:29,364:INFO:   <<< dual_mix: 0.5
2024-11-13 19:34:29,364:INFO:   <<< epochs: 200
2024-11-13 19:34:29,364:INFO:   <<< eval_frame_order: 0
2024-11-13 19:34:29,364:INFO:   <<< expand_msrvtt_sentences: False
2024-11-13 19:34:29,364:INFO:   <<< feature_framerate: 1
2024-11-13 19:34:29,364:INFO:   <<< feature_len: 64
2024-11-13 19:34:29,364:INFO:   <<< features_path: sign_feature/ph_domain_agnostic
2024-11-13 19:34:29,364:INFO:   <<< features_path_retrain: sign_feature/ph_domain_aware
2024-11-13 19:34:29,364:INFO:   <<< fp16: True
2024-11-13 19:34:29,364:INFO:   <<< fp16_opt_level: O1
2024-11-13 19:34:29,364:INFO:   <<< freeze_layer_num: 0
2024-11-13 19:34:29,364:INFO:   <<< gpu_ids: [0, 1]
2024-11-13 19:34:29,364:INFO:   <<< gradient_accumulation_steps: 1
2024-11-13 19:34:29,364:INFO:   <<< hard_negative_rate: 0.5
2024-11-13 19:34:29,364:INFO:   <<< init_model: chpt/ph_sota.pth
2024-11-13 19:34:29,364:INFO:   <<< linear_patch: 2d
2024-11-13 19:34:29,364:INFO:   <<< local_rank: 0
2024-11-13 19:34:29,364:INFO:   <<< loose_type: True
2024-11-13 19:34:29,364:INFO:   <<< lr: 1e-05
2024-11-13 19:34:29,364:INFO:   <<< lr_decay: 0.001
2024-11-13 19:34:29,364:INFO:   <<< margin: 0.1
2024-11-13 19:34:29,364:INFO:   <<< max_frames: 128
2024-11-13 19:34:29,364:INFO:   <<< max_words: 32
2024-11-13 19:34:29,364:INFO:   <<< mix_design: balance
2024-11-13 19:34:29,364:INFO:   <<< n_display: 1
2024-11-13 19:34:29,364:INFO:   <<< n_gpu: 1
2024-11-13 19:34:29,364:INFO:   <<< n_pair: 1
2024-11-13 19:34:29,364:INFO:   <<< negative_weighting: 1
2024-11-13 19:34:29,364:INFO:   <<< not_load_visual: False
2024-11-13 19:34:29,364:INFO:   <<< num_thread_reader: 8
2024-11-13 19:34:29,364:INFO:   <<< output_dir: new_experiment
2024-11-13 19:34:29,364:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-11-13 19:34:29,364:INFO:   <<< rank: 0
2024-11-13 19:34:29,364:INFO:   <<< resume_model: None
2024-11-13 19:34:29,365:INFO:   <<< sampled_use_mil: False
2024-11-13 19:34:29,365:INFO:   <<< seed: 42
2024-11-13 19:34:29,365:INFO:   <<< sim_calcu: softmax_max
2024-11-13 19:34:29,365:INFO:   <<< sim_header: Filip
2024-11-13 19:34:29,365:INFO:   <<< slice_framepos: 0
2024-11-13 19:34:29,365:INFO:   <<< task_type: retrieval
2024-11-13 19:34:29,365:INFO:   <<< tau: 0.07
2024-11-13 19:34:29,365:INFO:   <<< text_aug: True
2024-11-13 19:34:29,365:INFO:   <<< text_aug_choosen: random_swap
2024-11-13 19:34:29,365:INFO:   <<< text_num_hidden_layers: 12
2024-11-13 19:34:29,365:INFO:   <<< train_frame_order: 0
2024-11-13 19:34:29,365:INFO:   <<< use_mil: False
2024-11-13 19:34:29,365:INFO:   <<< video_dim: 1024
2024-11-13 19:34:29,365:INFO:   <<< visual_num_hidden_layers: 12
2024-11-13 19:34:29,365:INFO:   <<< warmup_proportion: 0.1
2024-11-13 19:34:29,365:INFO:   <<< world_size: 1
2024-11-13 19:34:29,365:INFO: device: cuda:0 n_gpu: 1
2024-11-13 19:34:30,396:INFO: loading archive file /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base
2024-11-13 19:34:30,398:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-11-13 19:34:30,398:INFO: Weight doesn't exsits. /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base/cross_pytorch_model.bin
2024-11-13 19:34:30,398:WARNING: Stage-One:True, Stage-Two:False
2024-11-13 19:34:30,398:WARNING: Test retrieval by loose type.
2024-11-13 19:34:30,398:WARNING: 	 embed_dim: 512
2024-11-13 19:34:30,399:WARNING: 	 image_resolution: 224
2024-11-13 19:34:30,399:WARNING: 	 vision_layers: 12
2024-11-13 19:34:30,399:WARNING: 	 vision_width: 768
2024-11-13 19:34:30,399:WARNING: 	 vision_patch_size: 32
2024-11-13 19:34:30,399:WARNING: 	 context_length: 77
2024-11-13 19:34:30,399:WARNING: 	 vocab_size: 49408
2024-11-13 19:34:30,399:WARNING: 	 transformer_width: 512
2024-11-13 19:34:30,399:WARNING: 	 transformer_heads: 8
2024-11-13 19:34:30,399:WARNING: 	 transformer_layers: 12
2024-11-13 19:34:30,399:WARNING: 		 linear_patch: 2d
2024-11-13 19:34:30,399:WARNING: 	 cut_top_layer: 0
2024-11-13 19:34:31,794:WARNING: 	 sim_header: Filip
2024-11-13 19:34:38,584:INFO: --------------------
2024-11-13 19:34:38,585:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-11-13 19:34:38,646:INFO: ***** Running test *****
2024-11-13 19:34:38,646:INFO:   Num examples = 642
2024-11-13 19:34:38,646:INFO:   Batch size = 256
2024-11-13 19:34:38,646:INFO:   Num steps = 3
2024-11-13 19:34:39,441:WARNING: Eval under the multi-sentence per video clip setting.
2024-11-13 19:34:39,441:WARNING: sentence num: 642, video num: 642
2024-11-13 19:34:41,847:INFO: before reshape, sim matrix size: 642 x 642
2024-11-13 19:34:41,944:INFO: after reshape, sim matrix size: 642 x 1 x 642
2024-11-13 19:34:42,021:INFO: Mix_Text-to-Video:
2024-11-13 19:34:42,021:INFO: 	>>>  R@1: 69.5 - R@5: 86.6 - R@10: 92.1 - Median R: 1.0 - Mean R: 5.2
2024-11-13 19:34:42,021:INFO: Mix_Video-to-Text:
2024-11-13 19:34:42,021:INFO: 	>>>  V2T$R@1: 70.1 - V2T$R@5: 87.9 - V2T$R@10: 92.7 - V2T$Median R: 1.0 - V2T$Mean R: 5.8
2024-11-13 19:37:26,807:INFO: Effective parameters:
2024-11-13 19:37:26,807:INFO:   <<< alpha: 0.9
2024-11-13 19:37:26,807:INFO:   <<< aug_choose: t2v
2024-11-13 19:37:26,807:INFO:   <<< batch_size: 512
2024-11-13 19:37:26,807:INFO:   <<< batch_size_val: 256
2024-11-13 19:37:26,807:INFO:   <<< cache_dir: 
2024-11-13 19:37:26,807:INFO:   <<< cla_weight_dir: cla_weight
2024-11-13 19:37:26,807:INFO:   <<< coef_lr: 1.0
2024-11-13 19:37:26,807:INFO:   <<< combine_type: sum
2024-11-13 19:37:26,807:INFO:   <<< cross_att_layers: 1
2024-11-13 19:37:26,807:INFO:   <<< cross_model: cross-base
2024-11-13 19:37:26,807:INFO:   <<< cross_num_hidden_layers: 4
2024-11-13 19:37:26,807:INFO:   <<< data_path: data_ph
2024-11-13 19:37:26,807:INFO:   <<< datatype: ph
2024-11-13 19:37:26,807:INFO:   <<< debug: False
2024-11-13 19:37:26,808:INFO:   <<< distributed: True
2024-11-13 19:37:26,808:INFO:   <<< do_eval: True
2024-11-13 19:37:26,808:INFO:   <<< do_lower_case: False
2024-11-13 19:37:26,808:INFO:   <<< do_pretrain: False
2024-11-13 19:37:26,808:INFO:   <<< do_train: False
2024-11-13 19:37:26,808:INFO:   <<< dual_mix: 0.5
2024-11-13 19:37:26,808:INFO:   <<< epochs: 200
2024-11-13 19:37:26,808:INFO:   <<< eval_frame_order: 0
2024-11-13 19:37:26,808:INFO:   <<< expand_msrvtt_sentences: False
2024-11-13 19:37:26,808:INFO:   <<< feature_framerate: 1
2024-11-13 19:37:26,808:INFO:   <<< feature_len: 64
2024-11-13 19:37:26,808:INFO:   <<< features_path: sign_feature/ph_domain_agnostic
2024-11-13 19:37:26,808:INFO:   <<< features_path_retrain: sign_feature/ph_domain_aware
2024-11-13 19:37:26,808:INFO:   <<< fp16: True
2024-11-13 19:37:26,808:INFO:   <<< fp16_opt_level: O1
2024-11-13 19:37:26,808:INFO:   <<< freeze_layer_num: 0
2024-11-13 19:37:26,808:INFO:   <<< gpu_ids: [0, 1]
2024-11-13 19:37:26,808:INFO:   <<< gradient_accumulation_steps: 1
2024-11-13 19:37:26,808:INFO:   <<< hard_negative_rate: 0.5
2024-11-13 19:37:26,808:INFO:   <<< init_model: chpt/ph_sota.pth
2024-11-13 19:37:26,808:INFO:   <<< linear_patch: 2d
2024-11-13 19:37:26,808:INFO:   <<< local_rank: 0
2024-11-13 19:37:26,808:INFO:   <<< loose_type: True
2024-11-13 19:37:26,808:INFO:   <<< lr: 1e-05
2024-11-13 19:37:26,808:INFO:   <<< lr_decay: 0.001
2024-11-13 19:37:26,808:INFO:   <<< margin: 0.1
2024-11-13 19:37:26,808:INFO:   <<< max_frames: 128
2024-11-13 19:37:26,808:INFO:   <<< max_words: 32
2024-11-13 19:37:26,808:INFO:   <<< mix_design: balance
2024-11-13 19:37:26,808:INFO:   <<< n_display: 1
2024-11-13 19:37:26,808:INFO:   <<< n_gpu: 1
2024-11-13 19:37:26,808:INFO:   <<< n_pair: 1
2024-11-13 19:37:26,808:INFO:   <<< negative_weighting: 1
2024-11-13 19:37:26,808:INFO:   <<< not_load_visual: False
2024-11-13 19:37:26,809:INFO:   <<< num_thread_reader: 8
2024-11-13 19:37:26,809:INFO:   <<< output_dir: new_experiment
2024-11-13 19:37:26,809:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-11-13 19:37:26,809:INFO:   <<< rank: 0
2024-11-13 19:37:26,809:INFO:   <<< resume_model: None
2024-11-13 19:37:26,809:INFO:   <<< sampled_use_mil: False
2024-11-13 19:37:26,809:INFO:   <<< seed: 42
2024-11-13 19:37:26,809:INFO:   <<< sim_calcu: softmax_max
2024-11-13 19:37:26,809:INFO:   <<< sim_header: Filip
2024-11-13 19:37:26,809:INFO:   <<< slice_framepos: 0
2024-11-13 19:37:26,809:INFO:   <<< task_type: retrieval
2024-11-13 19:37:26,809:INFO:   <<< tau: 0.07
2024-11-13 19:37:26,809:INFO:   <<< text_aug: True
2024-11-13 19:37:26,809:INFO:   <<< text_aug_choosen: random_swap
2024-11-13 19:37:26,809:INFO:   <<< text_num_hidden_layers: 12
2024-11-13 19:37:26,809:INFO:   <<< train_frame_order: 0
2024-11-13 19:37:26,809:INFO:   <<< use_mil: False
2024-11-13 19:37:26,809:INFO:   <<< video_dim: 1024
2024-11-13 19:37:26,809:INFO:   <<< visual_num_hidden_layers: 12
2024-11-13 19:37:26,809:INFO:   <<< warmup_proportion: 0.1
2024-11-13 19:37:26,809:INFO:   <<< world_size: 1
2024-11-13 19:37:26,809:INFO: device: cuda:0 n_gpu: 1
2024-11-13 19:37:27,856:INFO: loading archive file /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base
2024-11-13 19:37:27,858:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-11-13 19:37:27,859:INFO: Weight doesn't exsits. /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base/cross_pytorch_model.bin
2024-11-13 19:37:27,859:WARNING: Stage-One:True, Stage-Two:False
2024-11-13 19:37:27,859:WARNING: Test retrieval by loose type.
2024-11-13 19:37:27,859:WARNING: 	 embed_dim: 512
2024-11-13 19:37:27,859:WARNING: 	 image_resolution: 224
2024-11-13 19:37:27,859:WARNING: 	 vision_layers: 12
2024-11-13 19:37:27,860:WARNING: 	 vision_width: 768
2024-11-13 19:37:27,860:WARNING: 	 vision_patch_size: 32
2024-11-13 19:37:27,860:WARNING: 	 context_length: 77
2024-11-13 19:37:27,860:WARNING: 	 vocab_size: 49408
2024-11-13 19:37:27,860:WARNING: 	 transformer_width: 512
2024-11-13 19:37:27,860:WARNING: 	 transformer_heads: 8
2024-11-13 19:37:27,860:WARNING: 	 transformer_layers: 12
2024-11-13 19:37:27,860:WARNING: 		 linear_patch: 2d
2024-11-13 19:37:27,860:WARNING: 	 cut_top_layer: 0
2024-11-13 19:37:29,434:WARNING: 	 sim_header: Filip
2024-11-13 19:37:36,265:INFO: --------------------
2024-11-13 19:37:36,266:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-11-13 19:37:36,337:INFO: ***** Running test *****
2024-11-13 19:37:36,338:INFO:   Num examples = 642
2024-11-13 19:37:36,338:INFO:   Batch size = 256
2024-11-13 19:37:36,338:INFO:   Num steps = 3
2024-11-13 19:37:36,830:WARNING: Eval under the multi-sentence per video clip setting.
2024-11-13 19:37:36,830:WARNING: sentence num: 642, video num: 642
2024-11-13 19:37:39,044:INFO: before reshape, sim matrix size: 642 x 642
2024-11-13 19:37:39,147:INFO: after reshape, sim matrix size: 642 x 1 x 642
2024-11-13 19:37:39,200:INFO: Mix_Text-to-Video:
2024-11-13 19:37:39,200:INFO: 	>>>  R@1: 69.5 - R@5: 86.6 - R@10: 92.1 - Median R: 1.0 - Mean R: 5.2
2024-11-13 19:37:39,201:INFO: Mix_Video-to-Text:
2024-11-13 19:37:39,201:INFO: 	>>>  V2T$R@1: 70.1 - V2T$R@5: 87.9 - V2T$R@10: 92.7 - V2T$Median R: 1.0 - V2T$Mean R: 5.8
2024-11-13 22:37:51,385:INFO: Effective parameters:
2024-11-13 22:37:51,385:INFO:   <<< alpha: 0.9
2024-11-13 22:37:51,385:INFO:   <<< aug_choose: t2v
2024-11-13 22:37:51,385:INFO:   <<< batch_size: 512
2024-11-13 22:37:51,385:INFO:   <<< batch_size_val: 256
2024-11-13 22:37:51,385:INFO:   <<< cache_dir: 
2024-11-13 22:37:51,385:INFO:   <<< cla_weight_dir: cla_weight
2024-11-13 22:37:51,385:INFO:   <<< coef_lr: 1.0
2024-11-13 22:37:51,385:INFO:   <<< combine_type: sum
2024-11-13 22:37:51,385:INFO:   <<< cross_att_layers: 1
2024-11-13 22:37:51,385:INFO:   <<< cross_model: cross-base
2024-11-13 22:37:51,385:INFO:   <<< cross_num_hidden_layers: 4
2024-11-13 22:37:51,385:INFO:   <<< data_path: data_ph
2024-11-13 22:37:51,385:INFO:   <<< datatype: ph
2024-11-13 22:37:51,385:INFO:   <<< debug: False
2024-11-13 22:37:51,386:INFO:   <<< distributed: True
2024-11-13 22:37:51,386:INFO:   <<< do_eval: True
2024-11-13 22:37:51,386:INFO:   <<< do_lower_case: False
2024-11-13 22:37:51,386:INFO:   <<< do_pretrain: False
2024-11-13 22:37:51,386:INFO:   <<< do_train: False
2024-11-13 22:37:51,386:INFO:   <<< dual_mix: 0.5
2024-11-13 22:37:51,386:INFO:   <<< epochs: 200
2024-11-13 22:37:51,386:INFO:   <<< eval_frame_order: 0
2024-11-13 22:37:51,386:INFO:   <<< expand_msrvtt_sentences: False
2024-11-13 22:37:51,386:INFO:   <<< feature_framerate: 1
2024-11-13 22:37:51,386:INFO:   <<< feature_len: 64
2024-11-13 22:37:51,386:INFO:   <<< features_path: sign_feature/ph_domain_agnostic
2024-11-13 22:37:51,386:INFO:   <<< features_path_retrain: sign_feature/ph_domain_aware
2024-11-13 22:37:51,386:INFO:   <<< fp16: True
2024-11-13 22:37:51,386:INFO:   <<< fp16_opt_level: O1
2024-11-13 22:37:51,386:INFO:   <<< freeze_layer_num: 0
2024-11-13 22:37:51,386:INFO:   <<< gpu_ids: [0, 1]
2024-11-13 22:37:51,386:INFO:   <<< gradient_accumulation_steps: 1
2024-11-13 22:37:51,386:INFO:   <<< hard_negative_rate: 0.5
2024-11-13 22:37:51,386:INFO:   <<< init_model: chpt/ph_sota.pth
2024-11-13 22:37:51,386:INFO:   <<< linear_patch: 2d
2024-11-13 22:37:51,386:INFO:   <<< local_rank: 0
2024-11-13 22:37:51,386:INFO:   <<< loose_type: True
2024-11-13 22:37:51,386:INFO:   <<< lr: 1e-05
2024-11-13 22:37:51,386:INFO:   <<< lr_decay: 0.001
2024-11-13 22:37:51,386:INFO:   <<< margin: 0.1
2024-11-13 22:37:51,386:INFO:   <<< max_frames: 128
2024-11-13 22:37:51,386:INFO:   <<< max_words: 32
2024-11-13 22:37:51,386:INFO:   <<< mix_design: balance
2024-11-13 22:37:51,386:INFO:   <<< n_display: 1
2024-11-13 22:37:51,386:INFO:   <<< n_gpu: 1
2024-11-13 22:37:51,386:INFO:   <<< n_pair: 1
2024-11-13 22:37:51,386:INFO:   <<< negative_weighting: 1
2024-11-13 22:37:51,386:INFO:   <<< not_load_visual: False
2024-11-13 22:37:51,386:INFO:   <<< num_thread_reader: 8
2024-11-13 22:37:51,387:INFO:   <<< output_dir: new_experiment
2024-11-13 22:37:51,387:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-11-13 22:37:51,387:INFO:   <<< rank: 0
2024-11-13 22:37:51,387:INFO:   <<< resume_model: None
2024-11-13 22:37:51,387:INFO:   <<< sampled_use_mil: False
2024-11-13 22:37:51,387:INFO:   <<< seed: 42
2024-11-13 22:37:51,387:INFO:   <<< sim_calcu: softmax_max
2024-11-13 22:37:51,387:INFO:   <<< sim_header: Filip
2024-11-13 22:37:51,387:INFO:   <<< slice_framepos: 0
2024-11-13 22:37:51,387:INFO:   <<< task_type: retrieval
2024-11-13 22:37:51,387:INFO:   <<< tau: 0.07
2024-11-13 22:37:51,387:INFO:   <<< text_aug: True
2024-11-13 22:37:51,387:INFO:   <<< text_aug_choosen: random_swap
2024-11-13 22:37:51,387:INFO:   <<< text_num_hidden_layers: 12
2024-11-13 22:37:51,387:INFO:   <<< train_frame_order: 0
2024-11-13 22:37:51,387:INFO:   <<< use_mil: False
2024-11-13 22:37:51,387:INFO:   <<< video_dim: 1024
2024-11-13 22:37:51,387:INFO:   <<< visual_num_hidden_layers: 12
2024-11-13 22:37:51,387:INFO:   <<< warmup_proportion: 0.1
2024-11-13 22:37:51,387:INFO:   <<< world_size: 1
2024-11-13 22:37:51,387:INFO: device: cuda:0 n_gpu: 1
2024-11-13 22:37:52,351:INFO: loading archive file /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base
2024-11-13 22:37:52,353:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-11-13 22:37:52,353:INFO: Weight doesn't exsits. /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base/cross_pytorch_model.bin
2024-11-13 22:37:52,353:WARNING: Stage-One:True, Stage-Two:False
2024-11-13 22:37:52,353:WARNING: Test retrieval by loose type.
2024-11-13 22:37:52,354:WARNING: 	 embed_dim: 512
2024-11-13 22:37:52,354:WARNING: 	 image_resolution: 224
2024-11-13 22:37:52,354:WARNING: 	 vision_layers: 12
2024-11-13 22:37:52,354:WARNING: 	 vision_width: 768
2024-11-13 22:37:52,354:WARNING: 	 vision_patch_size: 32
2024-11-13 22:37:52,354:WARNING: 	 context_length: 77
2024-11-13 22:37:52,354:WARNING: 	 vocab_size: 49408
2024-11-13 22:37:52,354:WARNING: 	 transformer_width: 512
2024-11-13 22:37:52,354:WARNING: 	 transformer_heads: 8
2024-11-13 22:37:52,354:WARNING: 	 transformer_layers: 12
2024-11-13 22:37:52,354:WARNING: 		 linear_patch: 2d
2024-11-13 22:37:52,354:WARNING: 	 cut_top_layer: 0
2024-11-13 22:37:53,606:WARNING: 	 sim_header: Filip
2024-11-13 22:38:00,407:INFO: --------------------
2024-11-13 22:38:00,408:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-11-13 22:38:00,459:INFO: ***** Running test *****
2024-11-13 22:38:00,459:INFO:   Num examples = 642
2024-11-13 22:38:00,459:INFO:   Batch size = 256
2024-11-13 22:38:00,459:INFO:   Num steps = 3
2024-11-13 22:38:00,657:WARNING: Eval under the multi-sentence per video clip setting.
2024-11-13 22:38:00,657:WARNING: sentence num: 642, video num: 642
2024-11-13 22:38:02,033:INFO: before reshape, sim matrix size: 642 x 642
2024-11-13 22:38:02,070:INFO: after reshape, sim matrix size: 642 x 1 x 642
2024-11-13 22:38:02,124:INFO: Mix_Text-to-Video:
2024-11-13 22:38:02,124:INFO: 	>>>  R@1: 69.5 - R@5: 86.6 - R@10: 92.1 - Median R: 1.0 - Mean R: 5.2
2024-11-13 22:38:02,124:INFO: Mix_Video-to-Text:
2024-11-13 22:38:02,124:INFO: 	>>>  V2T$R@1: 70.1 - V2T$R@5: 87.9 - V2T$R@10: 92.7 - V2T$Median R: 1.0 - V2T$Mean R: 5.8
2024-11-13 22:38:39,184:INFO: Effective parameters:
2024-11-13 22:38:39,184:INFO:   <<< alpha: 0.9
2024-11-13 22:38:39,184:INFO:   <<< aug_choose: t2v
2024-11-13 22:38:39,184:INFO:   <<< batch_size: 512
2024-11-13 22:38:39,184:INFO:   <<< batch_size_val: 256
2024-11-13 22:38:39,185:INFO:   <<< cache_dir: 
2024-11-13 22:38:39,185:INFO:   <<< cla_weight_dir: cla_weight
2024-11-13 22:38:39,185:INFO:   <<< coef_lr: 1.0
2024-11-13 22:38:39,185:INFO:   <<< combine_type: sum
2024-11-13 22:38:39,185:INFO:   <<< cross_att_layers: 1
2024-11-13 22:38:39,185:INFO:   <<< cross_model: cross-base
2024-11-13 22:38:39,185:INFO:   <<< cross_num_hidden_layers: 4
2024-11-13 22:38:39,185:INFO:   <<< data_path: data_ph
2024-11-13 22:38:39,185:INFO:   <<< datatype: ph
2024-11-13 22:38:39,185:INFO:   <<< debug: False
2024-11-13 22:38:39,185:INFO:   <<< distributed: True
2024-11-13 22:38:39,185:INFO:   <<< do_eval: True
2024-11-13 22:38:39,185:INFO:   <<< do_lower_case: False
2024-11-13 22:38:39,185:INFO:   <<< do_pretrain: False
2024-11-13 22:38:39,185:INFO:   <<< do_train: False
2024-11-13 22:38:39,185:INFO:   <<< dual_mix: 0.5
2024-11-13 22:38:39,185:INFO:   <<< epochs: 200
2024-11-13 22:38:39,185:INFO:   <<< eval_frame_order: 0
2024-11-13 22:38:39,185:INFO:   <<< expand_msrvtt_sentences: False
2024-11-13 22:38:39,185:INFO:   <<< feature_framerate: 1
2024-11-13 22:38:39,185:INFO:   <<< feature_len: 64
2024-11-13 22:38:39,185:INFO:   <<< features_path: sign_feature/ph_domain_agnostic
2024-11-13 22:38:39,185:INFO:   <<< features_path_retrain: sign_feature/ph_domain_aware
2024-11-13 22:38:39,185:INFO:   <<< fp16: True
2024-11-13 22:38:39,185:INFO:   <<< fp16_opt_level: O1
2024-11-13 22:38:39,185:INFO:   <<< freeze_layer_num: 0
2024-11-13 22:38:39,185:INFO:   <<< gpu_ids: [0, 1]
2024-11-13 22:38:39,185:INFO:   <<< gradient_accumulation_steps: 1
2024-11-13 22:38:39,185:INFO:   <<< hard_negative_rate: 0.5
2024-11-13 22:38:39,185:INFO:   <<< init_model: chpt/ph_sota.pth
2024-11-13 22:38:39,185:INFO:   <<< linear_patch: 2d
2024-11-13 22:38:39,185:INFO:   <<< local_rank: 0
2024-11-13 22:38:39,185:INFO:   <<< loose_type: True
2024-11-13 22:38:39,185:INFO:   <<< lr: 1e-05
2024-11-13 22:38:39,185:INFO:   <<< lr_decay: 0.001
2024-11-13 22:38:39,186:INFO:   <<< margin: 0.1
2024-11-13 22:38:39,186:INFO:   <<< max_frames: 128
2024-11-13 22:38:39,186:INFO:   <<< max_words: 32
2024-11-13 22:38:39,186:INFO:   <<< mix_design: balance
2024-11-13 22:38:39,186:INFO:   <<< n_display: 1
2024-11-13 22:38:39,186:INFO:   <<< n_gpu: 1
2024-11-13 22:38:39,186:INFO:   <<< n_pair: 1
2024-11-13 22:38:39,186:INFO:   <<< negative_weighting: 1
2024-11-13 22:38:39,186:INFO:   <<< not_load_visual: False
2024-11-13 22:38:39,186:INFO:   <<< num_thread_reader: 8
2024-11-13 22:38:39,186:INFO:   <<< output_dir: new_experiment
2024-11-13 22:38:39,186:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-11-13 22:38:39,186:INFO:   <<< rank: 0
2024-11-13 22:38:39,186:INFO:   <<< resume_model: None
2024-11-13 22:38:39,186:INFO:   <<< sampled_use_mil: False
2024-11-13 22:38:39,186:INFO:   <<< seed: 42
2024-11-13 22:38:39,186:INFO:   <<< sim_calcu: softmax_max
2024-11-13 22:38:39,186:INFO:   <<< sim_header: Filip
2024-11-13 22:38:39,186:INFO:   <<< slice_framepos: 0
2024-11-13 22:38:39,186:INFO:   <<< task_type: retrieval
2024-11-13 22:38:39,186:INFO:   <<< tau: 0.07
2024-11-13 22:38:39,186:INFO:   <<< text_aug: True
2024-11-13 22:38:39,186:INFO:   <<< text_aug_choosen: random_swap
2024-11-13 22:38:39,186:INFO:   <<< text_num_hidden_layers: 12
2024-11-13 22:38:39,186:INFO:   <<< train_frame_order: 0
2024-11-13 22:38:39,186:INFO:   <<< use_mil: False
2024-11-13 22:38:39,186:INFO:   <<< video_dim: 1024
2024-11-13 22:38:39,186:INFO:   <<< visual_num_hidden_layers: 12
2024-11-13 22:38:39,186:INFO:   <<< warmup_proportion: 0.1
2024-11-13 22:38:39,186:INFO:   <<< world_size: 1
2024-11-13 22:38:39,187:INFO: device: cuda:0 n_gpu: 1
2024-11-13 22:38:40,115:INFO: loading archive file /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base
2024-11-13 22:38:40,115:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-11-13 22:38:40,116:INFO: Weight doesn't exsits. /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base/cross_pytorch_model.bin
2024-11-13 22:38:40,116:WARNING: Stage-One:True, Stage-Two:False
2024-11-13 22:38:40,116:WARNING: Test retrieval by loose type.
2024-11-13 22:38:40,116:WARNING: 	 embed_dim: 512
2024-11-13 22:38:40,116:WARNING: 	 image_resolution: 224
2024-11-13 22:38:40,116:WARNING: 	 vision_layers: 12
2024-11-13 22:38:40,116:WARNING: 	 vision_width: 768
2024-11-13 22:38:40,116:WARNING: 	 vision_patch_size: 32
2024-11-13 22:38:40,116:WARNING: 	 context_length: 77
2024-11-13 22:38:40,116:WARNING: 	 vocab_size: 49408
2024-11-13 22:38:40,116:WARNING: 	 transformer_width: 512
2024-11-13 22:38:40,116:WARNING: 	 transformer_heads: 8
2024-11-13 22:38:40,116:WARNING: 	 transformer_layers: 12
2024-11-13 22:38:40,117:WARNING: 		 linear_patch: 2d
2024-11-13 22:38:40,117:WARNING: 	 cut_top_layer: 0
2024-11-13 22:38:41,697:WARNING: 	 sim_header: Filip
2024-11-13 22:38:48,477:INFO: --------------------
2024-11-13 22:38:48,478:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-11-13 22:38:48,536:INFO: ***** Running test *****
2024-11-13 22:38:48,536:INFO:   Num examples = 642
2024-11-13 22:38:48,536:INFO:   Batch size = 256
2024-11-13 22:38:48,536:INFO:   Num steps = 3
2024-11-13 22:38:48,723:WARNING: Eval under the multi-sentence per video clip setting.
2024-11-13 22:38:48,723:WARNING: sentence num: 642, video num: 642
2024-11-13 22:38:50,004:INFO: before reshape, sim matrix size: 642 x 642
2024-11-13 22:38:50,051:INFO: after reshape, sim matrix size: 642 x 1 x 642
2024-11-13 22:38:50,126:INFO: Mix_Text-to-Video:
2024-11-13 22:38:50,126:INFO: 	>>>  R@1: 69.5 - R@5: 86.6 - R@10: 92.1 - Median R: 1.0 - Mean R: 5.2
2024-11-13 22:38:50,126:INFO: Mix_Video-to-Text:
2024-11-13 22:38:50,126:INFO: 	>>>  V2T$R@1: 70.1 - V2T$R@5: 87.9 - V2T$R@10: 92.7 - V2T$Median R: 1.0 - V2T$Mean R: 5.8
2024-11-13 23:12:13,028:INFO: Effective parameters:
2024-11-13 23:12:13,028:INFO:   <<< alpha: 0.9
2024-11-13 23:12:13,028:INFO:   <<< aug_choose: t2v
2024-11-13 23:12:13,028:INFO:   <<< batch_size: 512
2024-11-13 23:12:13,029:INFO:   <<< batch_size_val: 256
2024-11-13 23:12:13,029:INFO:   <<< cache_dir: 
2024-11-13 23:12:13,029:INFO:   <<< cla_weight_dir: cla_weight
2024-11-13 23:12:13,029:INFO:   <<< coef_lr: 1.0
2024-11-13 23:12:13,029:INFO:   <<< combine_type: sum
2024-11-13 23:12:13,029:INFO:   <<< cross_att_layers: 1
2024-11-13 23:12:13,029:INFO:   <<< cross_model: cross-base
2024-11-13 23:12:13,029:INFO:   <<< cross_num_hidden_layers: 4
2024-11-13 23:12:13,029:INFO:   <<< data_path: data_ph
2024-11-13 23:12:13,029:INFO:   <<< datatype: ph
2024-11-13 23:12:13,029:INFO:   <<< debug: False
2024-11-13 23:12:13,029:INFO:   <<< distributed: True
2024-11-13 23:12:13,029:INFO:   <<< do_eval: True
2024-11-13 23:12:13,029:INFO:   <<< do_lower_case: False
2024-11-13 23:12:13,029:INFO:   <<< do_pretrain: False
2024-11-13 23:12:13,029:INFO:   <<< do_train: False
2024-11-13 23:12:13,029:INFO:   <<< dual_mix: 0.5
2024-11-13 23:12:13,029:INFO:   <<< epochs: 200
2024-11-13 23:12:13,029:INFO:   <<< eval_frame_order: 0
2024-11-13 23:12:13,029:INFO:   <<< expand_msrvtt_sentences: False
2024-11-13 23:12:13,029:INFO:   <<< feature_framerate: 1
2024-11-13 23:12:13,029:INFO:   <<< feature_len: 64
2024-11-13 23:12:13,029:INFO:   <<< features_path: sign_feature/ph_domain_agnostic
2024-11-13 23:12:13,029:INFO:   <<< features_path_retrain: sign_feature/ph_domain_aware
2024-11-13 23:12:13,029:INFO:   <<< fp16: True
2024-11-13 23:12:13,029:INFO:   <<< fp16_opt_level: O1
2024-11-13 23:12:13,029:INFO:   <<< freeze_layer_num: 0
2024-11-13 23:12:13,029:INFO:   <<< gpu_ids: [0, 1]
2024-11-13 23:12:13,029:INFO:   <<< gradient_accumulation_steps: 1
2024-11-13 23:12:13,029:INFO:   <<< hard_negative_rate: 0.5
2024-11-13 23:12:13,029:INFO:   <<< init_model: chpt/ph_sota.pth
2024-11-13 23:12:13,029:INFO:   <<< linear_patch: 2d
2024-11-13 23:12:13,029:INFO:   <<< local_rank: 0
2024-11-13 23:12:13,029:INFO:   <<< loose_type: True
2024-11-13 23:12:13,029:INFO:   <<< lr: 1e-05
2024-11-13 23:12:13,029:INFO:   <<< lr_decay: 0.001
2024-11-13 23:12:13,030:INFO:   <<< margin: 0.1
2024-11-13 23:12:13,030:INFO:   <<< max_frames: 128
2024-11-13 23:12:13,030:INFO:   <<< max_words: 32
2024-11-13 23:12:13,030:INFO:   <<< mix_design: balance
2024-11-13 23:12:13,030:INFO:   <<< n_display: 1
2024-11-13 23:12:13,030:INFO:   <<< n_gpu: 1
2024-11-13 23:12:13,030:INFO:   <<< n_pair: 1
2024-11-13 23:12:13,030:INFO:   <<< negative_weighting: 1
2024-11-13 23:12:13,030:INFO:   <<< not_load_visual: False
2024-11-13 23:12:13,030:INFO:   <<< num_thread_reader: 8
2024-11-13 23:12:13,030:INFO:   <<< output_dir: new_experiment
2024-11-13 23:12:13,030:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-11-13 23:12:13,030:INFO:   <<< rank: 0
2024-11-13 23:12:13,030:INFO:   <<< resume_model: None
2024-11-13 23:12:13,030:INFO:   <<< sampled_use_mil: False
2024-11-13 23:12:13,030:INFO:   <<< seed: 42
2024-11-13 23:12:13,030:INFO:   <<< sim_calcu: softmax_max
2024-11-13 23:12:13,030:INFO:   <<< sim_header: Filip
2024-11-13 23:12:13,030:INFO:   <<< slice_framepos: 0
2024-11-13 23:12:13,030:INFO:   <<< task_type: retrieval
2024-11-13 23:12:13,030:INFO:   <<< tau: 0.07
2024-11-13 23:12:13,030:INFO:   <<< text_aug: True
2024-11-13 23:12:13,030:INFO:   <<< text_aug_choosen: random_swap
2024-11-13 23:12:13,030:INFO:   <<< text_num_hidden_layers: 12
2024-11-13 23:12:13,030:INFO:   <<< train_frame_order: 0
2024-11-13 23:12:13,030:INFO:   <<< use_mil: False
2024-11-13 23:12:13,030:INFO:   <<< video_dim: 1024
2024-11-13 23:12:13,030:INFO:   <<< visual_num_hidden_layers: 12
2024-11-13 23:12:13,030:INFO:   <<< warmup_proportion: 0.1
2024-11-13 23:12:13,030:INFO:   <<< world_size: 1
2024-11-13 23:12:13,031:INFO: device: cuda:0 n_gpu: 1
2024-11-13 23:12:13,962:INFO: loading archive file /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base
2024-11-13 23:12:13,963:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-11-13 23:12:13,963:INFO: Weight doesn't exsits. /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base/cross_pytorch_model.bin
2024-11-13 23:12:13,963:WARNING: Stage-One:True, Stage-Two:False
2024-11-13 23:12:13,963:WARNING: Test retrieval by loose type.
2024-11-13 23:12:13,963:WARNING: 	 embed_dim: 512
2024-11-13 23:12:13,964:WARNING: 	 image_resolution: 224
2024-11-13 23:12:13,964:WARNING: 	 vision_layers: 12
2024-11-13 23:12:13,964:WARNING: 	 vision_width: 768
2024-11-13 23:12:13,964:WARNING: 	 vision_patch_size: 32
2024-11-13 23:12:13,964:WARNING: 	 context_length: 77
2024-11-13 23:12:13,964:WARNING: 	 vocab_size: 49408
2024-11-13 23:12:13,964:WARNING: 	 transformer_width: 512
2024-11-13 23:12:13,964:WARNING: 	 transformer_heads: 8
2024-11-13 23:12:13,964:WARNING: 	 transformer_layers: 12
2024-11-13 23:12:13,964:WARNING: 		 linear_patch: 2d
2024-11-13 23:12:13,964:WARNING: 	 cut_top_layer: 0
2024-11-13 23:12:15,550:WARNING: 	 sim_header: Filip
2024-11-13 23:12:22,297:INFO: --------------------
2024-11-13 23:12:22,298:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-11-13 23:12:23,524:INFO: ***** Running test *****
2024-11-13 23:12:23,524:INFO:   Num examples = 3
2024-11-13 23:12:23,524:INFO:   Batch size = 256
2024-11-13 23:12:23,524:INFO:   Num steps = 3
2024-11-13 23:13:00,444:INFO: Effective parameters:
2024-11-13 23:13:00,444:INFO:   <<< alpha: 0.9
2024-11-13 23:13:00,444:INFO:   <<< aug_choose: t2v
2024-11-13 23:13:00,444:INFO:   <<< batch_size: 512
2024-11-13 23:13:00,444:INFO:   <<< batch_size_val: 256
2024-11-13 23:13:00,444:INFO:   <<< cache_dir: 
2024-11-13 23:13:00,444:INFO:   <<< cla_weight_dir: cla_weight
2024-11-13 23:13:00,444:INFO:   <<< coef_lr: 1.0
2024-11-13 23:13:00,444:INFO:   <<< combine_type: sum
2024-11-13 23:13:00,444:INFO:   <<< cross_att_layers: 1
2024-11-13 23:13:00,444:INFO:   <<< cross_model: cross-base
2024-11-13 23:13:00,444:INFO:   <<< cross_num_hidden_layers: 4
2024-11-13 23:13:00,444:INFO:   <<< data_path: data_ph
2024-11-13 23:13:00,444:INFO:   <<< datatype: ph
2024-11-13 23:13:00,444:INFO:   <<< debug: False
2024-11-13 23:13:00,444:INFO:   <<< distributed: True
2024-11-13 23:13:00,444:INFO:   <<< do_eval: True
2024-11-13 23:13:00,444:INFO:   <<< do_lower_case: False
2024-11-13 23:13:00,444:INFO:   <<< do_pretrain: False
2024-11-13 23:13:00,444:INFO:   <<< do_train: False
2024-11-13 23:13:00,444:INFO:   <<< dual_mix: 0.5
2024-11-13 23:13:00,444:INFO:   <<< epochs: 200
2024-11-13 23:13:00,445:INFO:   <<< eval_frame_order: 0
2024-11-13 23:13:00,445:INFO:   <<< expand_msrvtt_sentences: False
2024-11-13 23:13:00,445:INFO:   <<< feature_framerate: 1
2024-11-13 23:13:00,445:INFO:   <<< feature_len: 64
2024-11-13 23:13:00,445:INFO:   <<< features_path: sign_feature/ph_domain_agnostic
2024-11-13 23:13:00,445:INFO:   <<< features_path_retrain: sign_feature/ph_domain_aware
2024-11-13 23:13:00,445:INFO:   <<< fp16: True
2024-11-13 23:13:00,445:INFO:   <<< fp16_opt_level: O1
2024-11-13 23:13:00,445:INFO:   <<< freeze_layer_num: 0
2024-11-13 23:13:00,445:INFO:   <<< gpu_ids: [0, 1]
2024-11-13 23:13:00,445:INFO:   <<< gradient_accumulation_steps: 1
2024-11-13 23:13:00,445:INFO:   <<< hard_negative_rate: 0.5
2024-11-13 23:13:00,445:INFO:   <<< init_model: chpt/ph_sota.pth
2024-11-13 23:13:00,445:INFO:   <<< linear_patch: 2d
2024-11-13 23:13:00,445:INFO:   <<< local_rank: 0
2024-11-13 23:13:00,445:INFO:   <<< loose_type: True
2024-11-13 23:13:00,445:INFO:   <<< lr: 1e-05
2024-11-13 23:13:00,445:INFO:   <<< lr_decay: 0.001
2024-11-13 23:13:00,445:INFO:   <<< margin: 0.1
2024-11-13 23:13:00,445:INFO:   <<< max_frames: 128
2024-11-13 23:13:00,445:INFO:   <<< max_words: 32
2024-11-13 23:13:00,445:INFO:   <<< mix_design: balance
2024-11-13 23:13:00,445:INFO:   <<< n_display: 1
2024-11-13 23:13:00,445:INFO:   <<< n_gpu: 1
2024-11-13 23:13:00,445:INFO:   <<< n_pair: 1
2024-11-13 23:13:00,445:INFO:   <<< negative_weighting: 1
2024-11-13 23:13:00,445:INFO:   <<< not_load_visual: False
2024-11-13 23:13:00,445:INFO:   <<< num_thread_reader: 8
2024-11-13 23:13:00,445:INFO:   <<< output_dir: new_experiment
2024-11-13 23:13:00,445:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-11-13 23:13:00,445:INFO:   <<< rank: 0
2024-11-13 23:13:00,445:INFO:   <<< resume_model: None
2024-11-13 23:13:00,445:INFO:   <<< sampled_use_mil: False
2024-11-13 23:13:00,445:INFO:   <<< seed: 42
2024-11-13 23:13:00,445:INFO:   <<< sim_calcu: softmax_max
2024-11-13 23:13:00,445:INFO:   <<< sim_header: Filip
2024-11-13 23:13:00,445:INFO:   <<< slice_framepos: 0
2024-11-13 23:13:00,446:INFO:   <<< task_type: retrieval
2024-11-13 23:13:00,446:INFO:   <<< tau: 0.07
2024-11-13 23:13:00,446:INFO:   <<< text_aug: True
2024-11-13 23:13:00,446:INFO:   <<< text_aug_choosen: random_swap
2024-11-13 23:13:00,446:INFO:   <<< text_num_hidden_layers: 12
2024-11-13 23:13:00,446:INFO:   <<< train_frame_order: 0
2024-11-13 23:13:00,446:INFO:   <<< use_mil: False
2024-11-13 23:13:00,446:INFO:   <<< video_dim: 1024
2024-11-13 23:13:00,446:INFO:   <<< visual_num_hidden_layers: 12
2024-11-13 23:13:00,446:INFO:   <<< warmup_proportion: 0.1
2024-11-13 23:13:00,446:INFO:   <<< world_size: 1
2024-11-13 23:13:00,446:INFO: device: cuda:0 n_gpu: 1
2024-11-13 23:13:01,341:INFO: loading archive file /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base
2024-11-13 23:13:01,341:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-11-13 23:13:01,342:INFO: Weight doesn't exsits. /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base/cross_pytorch_model.bin
2024-11-13 23:13:01,342:WARNING: Stage-One:True, Stage-Two:False
2024-11-13 23:13:01,342:WARNING: Test retrieval by loose type.
2024-11-13 23:13:01,342:WARNING: 	 embed_dim: 512
2024-11-13 23:13:01,342:WARNING: 	 image_resolution: 224
2024-11-13 23:13:01,342:WARNING: 	 vision_layers: 12
2024-11-13 23:13:01,342:WARNING: 	 vision_width: 768
2024-11-13 23:13:01,342:WARNING: 	 vision_patch_size: 32
2024-11-13 23:13:01,342:WARNING: 	 context_length: 77
2024-11-13 23:13:01,342:WARNING: 	 vocab_size: 49408
2024-11-13 23:13:01,342:WARNING: 	 transformer_width: 512
2024-11-13 23:13:01,342:WARNING: 	 transformer_heads: 8
2024-11-13 23:13:01,342:WARNING: 	 transformer_layers: 12
2024-11-13 23:13:01,342:WARNING: 		 linear_patch: 2d
2024-11-13 23:13:01,342:WARNING: 	 cut_top_layer: 0
2024-11-13 23:13:02,559:WARNING: 	 sim_header: Filip
2024-11-13 23:13:09,255:INFO: --------------------
2024-11-13 23:13:09,256:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-11-13 23:13:58,990:INFO: ***** Running test *****
2024-11-13 23:13:58,990:INFO:   Num examples = 642
2024-11-13 23:13:58,990:INFO:   Batch size = 256
2024-11-13 23:13:58,991:INFO:   Num steps = 3
2024-11-13 23:13:59,262:WARNING: Eval under the multi-sentence per video clip setting.
2024-11-13 23:13:59,262:WARNING: sentence num: 642, video num: 642
2024-11-13 23:14:03,719:INFO: before reshape, sim matrix size: 642 x 642
2024-11-13 23:14:03,760:INFO: after reshape, sim matrix size: 642 x 1 x 642
2024-11-13 23:14:03,818:INFO: Mix_Text-to-Video:
2024-11-13 23:14:03,818:INFO: 	>>>  R@1: 69.5 - R@5: 86.6 - R@10: 92.1 - Median R: 1.0 - Mean R: 5.2
2024-11-13 23:14:03,818:INFO: Mix_Video-to-Text:
2024-11-13 23:14:03,818:INFO: 	>>>  V2T$R@1: 70.1 - V2T$R@5: 87.9 - V2T$R@10: 92.7 - V2T$Median R: 1.0 - V2T$Mean R: 5.8
2024-11-13 23:23:21,025:INFO: Effective parameters:
2024-11-13 23:23:21,025:INFO:   <<< alpha: 0.9
2024-11-13 23:23:21,026:INFO:   <<< aug_choose: t2v
2024-11-13 23:23:21,026:INFO:   <<< batch_size: 512
2024-11-13 23:23:21,026:INFO:   <<< batch_size_val: 256
2024-11-13 23:23:21,026:INFO:   <<< cache_dir: 
2024-11-13 23:23:21,026:INFO:   <<< cla_weight_dir: cla_weight
2024-11-13 23:23:21,026:INFO:   <<< coef_lr: 1.0
2024-11-13 23:23:21,026:INFO:   <<< combine_type: sum
2024-11-13 23:23:21,026:INFO:   <<< cross_att_layers: 1
2024-11-13 23:23:21,026:INFO:   <<< cross_model: cross-base
2024-11-13 23:23:21,026:INFO:   <<< cross_num_hidden_layers: 4
2024-11-13 23:23:21,026:INFO:   <<< data_path: data_ph
2024-11-13 23:23:21,026:INFO:   <<< datatype: ph
2024-11-13 23:23:21,026:INFO:   <<< debug: False
2024-11-13 23:23:21,026:INFO:   <<< distributed: True
2024-11-13 23:23:21,026:INFO:   <<< do_eval: True
2024-11-13 23:23:21,026:INFO:   <<< do_lower_case: False
2024-11-13 23:23:21,026:INFO:   <<< do_pretrain: False
2024-11-13 23:23:21,026:INFO:   <<< do_train: False
2024-11-13 23:23:21,026:INFO:   <<< dual_mix: 0.5
2024-11-13 23:23:21,026:INFO:   <<< epochs: 200
2024-11-13 23:23:21,026:INFO:   <<< eval_frame_order: 0
2024-11-13 23:23:21,026:INFO:   <<< expand_msrvtt_sentences: False
2024-11-13 23:23:21,026:INFO:   <<< feature_framerate: 1
2024-11-13 23:23:21,026:INFO:   <<< feature_len: 64
2024-11-13 23:23:21,026:INFO:   <<< features_path: sign_feature/ph_domain_agnostic
2024-11-13 23:23:21,026:INFO:   <<< features_path_retrain: sign_feature/ph_domain_aware
2024-11-13 23:23:21,026:INFO:   <<< fp16: True
2024-11-13 23:23:21,026:INFO:   <<< fp16_opt_level: O1
2024-11-13 23:23:21,026:INFO:   <<< freeze_layer_num: 0
2024-11-13 23:23:21,026:INFO:   <<< gpu_ids: [0, 1]
2024-11-13 23:23:21,026:INFO:   <<< gradient_accumulation_steps: 1
2024-11-13 23:23:21,026:INFO:   <<< hard_negative_rate: 0.5
2024-11-13 23:23:21,026:INFO:   <<< init_model: chpt/ph_sota.pth
2024-11-13 23:23:21,026:INFO:   <<< linear_patch: 2d
2024-11-13 23:23:21,026:INFO:   <<< local_rank: 0
2024-11-13 23:23:21,026:INFO:   <<< loose_type: True
2024-11-13 23:23:21,027:INFO:   <<< lr: 1e-05
2024-11-13 23:23:21,027:INFO:   <<< lr_decay: 0.001
2024-11-13 23:23:21,027:INFO:   <<< margin: 0.1
2024-11-13 23:23:21,027:INFO:   <<< max_frames: 128
2024-11-13 23:23:21,027:INFO:   <<< max_words: 32
2024-11-13 23:23:21,027:INFO:   <<< mix_design: balance
2024-11-13 23:23:21,027:INFO:   <<< n_display: 1
2024-11-13 23:23:21,027:INFO:   <<< n_gpu: 1
2024-11-13 23:23:21,027:INFO:   <<< n_pair: 1
2024-11-13 23:23:21,027:INFO:   <<< negative_weighting: 1
2024-11-13 23:23:21,027:INFO:   <<< not_load_visual: False
2024-11-13 23:23:21,027:INFO:   <<< num_thread_reader: 8
2024-11-13 23:23:21,027:INFO:   <<< output_dir: new_experiment
2024-11-13 23:23:21,027:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-11-13 23:23:21,027:INFO:   <<< rank: 0
2024-11-13 23:23:21,027:INFO:   <<< resume_model: None
2024-11-13 23:23:21,027:INFO:   <<< sampled_use_mil: False
2024-11-13 23:23:21,027:INFO:   <<< seed: 42
2024-11-13 23:23:21,027:INFO:   <<< sim_calcu: softmax_max
2024-11-13 23:23:21,027:INFO:   <<< sim_header: Filip
2024-11-13 23:23:21,027:INFO:   <<< slice_framepos: 0
2024-11-13 23:23:21,027:INFO:   <<< task_type: retrieval
2024-11-13 23:23:21,027:INFO:   <<< tau: 0.07
2024-11-13 23:23:21,027:INFO:   <<< text_aug: True
2024-11-13 23:23:21,027:INFO:   <<< text_aug_choosen: random_swap
2024-11-13 23:23:21,027:INFO:   <<< text_num_hidden_layers: 12
2024-11-13 23:23:21,027:INFO:   <<< train_frame_order: 0
2024-11-13 23:23:21,027:INFO:   <<< use_mil: False
2024-11-13 23:23:21,027:INFO:   <<< video_dim: 1024
2024-11-13 23:23:21,027:INFO:   <<< visual_num_hidden_layers: 12
2024-11-13 23:23:21,027:INFO:   <<< warmup_proportion: 0.1
2024-11-13 23:23:21,027:INFO:   <<< world_size: 1
2024-11-13 23:23:21,028:INFO: device: cuda:0 n_gpu: 1
2024-11-13 23:23:21,902:INFO: loading archive file /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base
2024-11-13 23:23:21,903:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-11-13 23:23:21,903:INFO: Weight doesn't exsits. /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base/cross_pytorch_model.bin
2024-11-13 23:23:21,903:WARNING: Stage-One:True, Stage-Two:False
2024-11-13 23:23:21,903:WARNING: Test retrieval by loose type.
2024-11-13 23:23:21,903:WARNING: 	 embed_dim: 512
2024-11-13 23:23:21,903:WARNING: 	 image_resolution: 224
2024-11-13 23:23:21,903:WARNING: 	 vision_layers: 12
2024-11-13 23:23:21,903:WARNING: 	 vision_width: 768
2024-11-13 23:23:21,903:WARNING: 	 vision_patch_size: 32
2024-11-13 23:23:21,903:WARNING: 	 context_length: 77
2024-11-13 23:23:21,904:WARNING: 	 vocab_size: 49408
2024-11-13 23:23:21,904:WARNING: 	 transformer_width: 512
2024-11-13 23:23:21,904:WARNING: 	 transformer_heads: 8
2024-11-13 23:23:21,904:WARNING: 	 transformer_layers: 12
2024-11-13 23:23:21,904:WARNING: 		 linear_patch: 2d
2024-11-13 23:23:21,904:WARNING: 	 cut_top_layer: 0
2024-11-13 23:23:23,133:WARNING: 	 sim_header: Filip
2024-11-13 23:23:29,883:INFO: --------------------
2024-11-13 23:23:29,885:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-11-13 23:23:31,118:INFO: ***** Running test *****
2024-11-13 23:23:31,118:INFO:   Num examples = 3
2024-11-13 23:23:31,118:INFO:   Batch size = 256
2024-11-13 23:23:31,118:INFO:   Num steps = 3
2024-11-13 23:24:33,401:INFO: Effective parameters:
2024-11-13 23:24:33,401:INFO:   <<< alpha: 0.9
2024-11-13 23:24:33,401:INFO:   <<< aug_choose: t2v
2024-11-13 23:24:33,401:INFO:   <<< batch_size: 512
2024-11-13 23:24:33,401:INFO:   <<< batch_size_val: 256
2024-11-13 23:24:33,402:INFO:   <<< cache_dir: 
2024-11-13 23:24:33,402:INFO:   <<< cla_weight_dir: cla_weight
2024-11-13 23:24:33,402:INFO:   <<< coef_lr: 1.0
2024-11-13 23:24:33,402:INFO:   <<< combine_type: sum
2024-11-13 23:24:33,402:INFO:   <<< cross_att_layers: 1
2024-11-13 23:24:33,402:INFO:   <<< cross_model: cross-base
2024-11-13 23:24:33,402:INFO:   <<< cross_num_hidden_layers: 4
2024-11-13 23:24:33,402:INFO:   <<< data_path: data_ph
2024-11-13 23:24:33,402:INFO:   <<< datatype: ph
2024-11-13 23:24:33,402:INFO:   <<< debug: False
2024-11-13 23:24:33,402:INFO:   <<< distributed: True
2024-11-13 23:24:33,402:INFO:   <<< do_eval: True
2024-11-13 23:24:33,402:INFO:   <<< do_lower_case: False
2024-11-13 23:24:33,402:INFO:   <<< do_pretrain: False
2024-11-13 23:24:33,402:INFO:   <<< do_train: False
2024-11-13 23:24:33,402:INFO:   <<< dual_mix: 0.5
2024-11-13 23:24:33,402:INFO:   <<< epochs: 200
2024-11-13 23:24:33,402:INFO:   <<< eval_frame_order: 0
2024-11-13 23:24:33,402:INFO:   <<< expand_msrvtt_sentences: False
2024-11-13 23:24:33,402:INFO:   <<< feature_framerate: 1
2024-11-13 23:24:33,402:INFO:   <<< feature_len: 64
2024-11-13 23:24:33,402:INFO:   <<< features_path: sign_feature/ph_domain_agnostic
2024-11-13 23:24:33,402:INFO:   <<< features_path_retrain: sign_feature/ph_domain_aware
2024-11-13 23:24:33,402:INFO:   <<< fp16: True
2024-11-13 23:24:33,402:INFO:   <<< fp16_opt_level: O1
2024-11-13 23:24:33,402:INFO:   <<< freeze_layer_num: 0
2024-11-13 23:24:33,402:INFO:   <<< gpu_ids: [0, 1]
2024-11-13 23:24:33,402:INFO:   <<< gradient_accumulation_steps: 1
2024-11-13 23:24:33,402:INFO:   <<< hard_negative_rate: 0.5
2024-11-13 23:24:33,402:INFO:   <<< init_model: chpt/ph_sota.pth
2024-11-13 23:24:33,402:INFO:   <<< linear_patch: 2d
2024-11-13 23:24:33,402:INFO:   <<< local_rank: 0
2024-11-13 23:24:33,402:INFO:   <<< loose_type: True
2024-11-13 23:24:33,402:INFO:   <<< lr: 1e-05
2024-11-13 23:24:33,402:INFO:   <<< lr_decay: 0.001
2024-11-13 23:24:33,403:INFO:   <<< margin: 0.1
2024-11-13 23:24:33,403:INFO:   <<< max_frames: 128
2024-11-13 23:24:33,403:INFO:   <<< max_words: 32
2024-11-13 23:24:33,403:INFO:   <<< mix_design: balance
2024-11-13 23:24:33,403:INFO:   <<< n_display: 1
2024-11-13 23:24:33,403:INFO:   <<< n_gpu: 1
2024-11-13 23:24:33,403:INFO:   <<< n_pair: 1
2024-11-13 23:24:33,403:INFO:   <<< negative_weighting: 1
2024-11-13 23:24:33,403:INFO:   <<< not_load_visual: False
2024-11-13 23:24:33,403:INFO:   <<< num_thread_reader: 8
2024-11-13 23:24:33,403:INFO:   <<< output_dir: new_experiment
2024-11-13 23:24:33,403:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-11-13 23:24:33,403:INFO:   <<< rank: 0
2024-11-13 23:24:33,403:INFO:   <<< resume_model: None
2024-11-13 23:24:33,403:INFO:   <<< sampled_use_mil: False
2024-11-13 23:24:33,403:INFO:   <<< seed: 42
2024-11-13 23:24:33,403:INFO:   <<< sim_calcu: softmax_max
2024-11-13 23:24:33,403:INFO:   <<< sim_header: Filip
2024-11-13 23:24:33,403:INFO:   <<< slice_framepos: 0
2024-11-13 23:24:33,403:INFO:   <<< task_type: retrieval
2024-11-13 23:24:33,403:INFO:   <<< tau: 0.07
2024-11-13 23:24:33,403:INFO:   <<< text_aug: True
2024-11-13 23:24:33,403:INFO:   <<< text_aug_choosen: random_swap
2024-11-13 23:24:33,403:INFO:   <<< text_num_hidden_layers: 12
2024-11-13 23:24:33,403:INFO:   <<< train_frame_order: 0
2024-11-13 23:24:33,403:INFO:   <<< use_mil: False
2024-11-13 23:24:33,403:INFO:   <<< video_dim: 1024
2024-11-13 23:24:33,403:INFO:   <<< visual_num_hidden_layers: 12
2024-11-13 23:24:33,403:INFO:   <<< warmup_proportion: 0.1
2024-11-13 23:24:33,403:INFO:   <<< world_size: 1
2024-11-13 23:24:33,404:INFO: device: cuda:0 n_gpu: 1
2024-11-13 23:24:34,285:INFO: loading archive file /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base
2024-11-13 23:24:34,289:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-11-13 23:24:34,289:INFO: Weight doesn't exsits. /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base/cross_pytorch_model.bin
2024-11-13 23:24:34,290:WARNING: Stage-One:True, Stage-Two:False
2024-11-13 23:24:34,290:WARNING: Test retrieval by loose type.
2024-11-13 23:24:34,290:WARNING: 	 embed_dim: 512
2024-11-13 23:24:34,290:WARNING: 	 image_resolution: 224
2024-11-13 23:24:34,290:WARNING: 	 vision_layers: 12
2024-11-13 23:24:34,290:WARNING: 	 vision_width: 768
2024-11-13 23:24:34,290:WARNING: 	 vision_patch_size: 32
2024-11-13 23:24:34,290:WARNING: 	 context_length: 77
2024-11-13 23:24:34,290:WARNING: 	 vocab_size: 49408
2024-11-13 23:24:34,290:WARNING: 	 transformer_width: 512
2024-11-13 23:24:34,290:WARNING: 	 transformer_heads: 8
2024-11-13 23:24:34,290:WARNING: 	 transformer_layers: 12
2024-11-13 23:24:34,290:WARNING: 		 linear_patch: 2d
2024-11-13 23:24:34,290:WARNING: 	 cut_top_layer: 0
2024-11-13 23:24:35,509:WARNING: 	 sim_header: Filip
2024-11-13 23:24:42,200:INFO: --------------------
2024-11-13 23:24:42,201:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-11-13 23:25:32,119:INFO: Effective parameters:
2024-11-13 23:25:32,119:INFO:   <<< alpha: 0.9
2024-11-13 23:25:32,119:INFO:   <<< aug_choose: t2v
2024-11-13 23:25:32,119:INFO:   <<< batch_size: 512
2024-11-13 23:25:32,119:INFO:   <<< batch_size_val: 256
2024-11-13 23:25:32,119:INFO:   <<< cache_dir: 
2024-11-13 23:25:32,119:INFO:   <<< cla_weight_dir: cla_weight
2024-11-13 23:25:32,119:INFO:   <<< coef_lr: 1.0
2024-11-13 23:25:32,119:INFO:   <<< combine_type: sum
2024-11-13 23:25:32,119:INFO:   <<< cross_att_layers: 1
2024-11-13 23:25:32,119:INFO:   <<< cross_model: cross-base
2024-11-13 23:25:32,119:INFO:   <<< cross_num_hidden_layers: 4
2024-11-13 23:25:32,119:INFO:   <<< data_path: data_ph
2024-11-13 23:25:32,119:INFO:   <<< datatype: ph
2024-11-13 23:25:32,119:INFO:   <<< debug: False
2024-11-13 23:25:32,119:INFO:   <<< distributed: True
2024-11-13 23:25:32,120:INFO:   <<< do_eval: True
2024-11-13 23:25:32,120:INFO:   <<< do_lower_case: False
2024-11-13 23:25:32,120:INFO:   <<< do_pretrain: False
2024-11-13 23:25:32,120:INFO:   <<< do_train: False
2024-11-13 23:25:32,120:INFO:   <<< dual_mix: 0.5
2024-11-13 23:25:32,120:INFO:   <<< epochs: 200
2024-11-13 23:25:32,120:INFO:   <<< eval_frame_order: 0
2024-11-13 23:25:32,120:INFO:   <<< expand_msrvtt_sentences: False
2024-11-13 23:25:32,120:INFO:   <<< feature_framerate: 1
2024-11-13 23:25:32,120:INFO:   <<< feature_len: 64
2024-11-13 23:25:32,120:INFO:   <<< features_path: sign_feature/ph_domain_agnostic
2024-11-13 23:25:32,120:INFO:   <<< features_path_retrain: sign_feature/ph_domain_aware
2024-11-13 23:25:32,120:INFO:   <<< fp16: True
2024-11-13 23:25:32,120:INFO:   <<< fp16_opt_level: O1
2024-11-13 23:25:32,120:INFO:   <<< freeze_layer_num: 0
2024-11-13 23:25:32,120:INFO:   <<< gpu_ids: [0, 1]
2024-11-13 23:25:32,120:INFO:   <<< gradient_accumulation_steps: 1
2024-11-13 23:25:32,120:INFO:   <<< hard_negative_rate: 0.5
2024-11-13 23:25:32,120:INFO:   <<< init_model: chpt/ph_sota.pth
2024-11-13 23:25:32,120:INFO:   <<< linear_patch: 2d
2024-11-13 23:25:32,120:INFO:   <<< local_rank: 0
2024-11-13 23:25:32,120:INFO:   <<< loose_type: True
2024-11-13 23:25:32,120:INFO:   <<< lr: 1e-05
2024-11-13 23:25:32,120:INFO:   <<< lr_decay: 0.001
2024-11-13 23:25:32,120:INFO:   <<< margin: 0.1
2024-11-13 23:25:32,120:INFO:   <<< max_frames: 128
2024-11-13 23:25:32,120:INFO:   <<< max_words: 32
2024-11-13 23:25:32,120:INFO:   <<< mix_design: balance
2024-11-13 23:25:32,120:INFO:   <<< n_display: 1
2024-11-13 23:25:32,120:INFO:   <<< n_gpu: 1
2024-11-13 23:25:32,120:INFO:   <<< n_pair: 1
2024-11-13 23:25:32,120:INFO:   <<< negative_weighting: 1
2024-11-13 23:25:32,120:INFO:   <<< not_load_visual: False
2024-11-13 23:25:32,120:INFO:   <<< num_thread_reader: 8
2024-11-13 23:25:32,120:INFO:   <<< output_dir: new_experiment
2024-11-13 23:25:32,120:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-11-13 23:25:32,121:INFO:   <<< rank: 0
2024-11-13 23:25:32,121:INFO:   <<< resume_model: None
2024-11-13 23:25:32,121:INFO:   <<< sampled_use_mil: False
2024-11-13 23:25:32,121:INFO:   <<< seed: 42
2024-11-13 23:25:32,121:INFO:   <<< sim_calcu: softmax_max
2024-11-13 23:25:32,121:INFO:   <<< sim_header: Filip
2024-11-13 23:25:32,121:INFO:   <<< slice_framepos: 0
2024-11-13 23:25:32,121:INFO:   <<< task_type: retrieval
2024-11-13 23:25:32,121:INFO:   <<< tau: 0.07
2024-11-13 23:25:32,121:INFO:   <<< text_aug: True
2024-11-13 23:25:32,121:INFO:   <<< text_aug_choosen: random_swap
2024-11-13 23:25:32,121:INFO:   <<< text_num_hidden_layers: 12
2024-11-13 23:25:32,121:INFO:   <<< train_frame_order: 0
2024-11-13 23:25:32,121:INFO:   <<< use_mil: False
2024-11-13 23:25:32,121:INFO:   <<< video_dim: 1024
2024-11-13 23:25:32,121:INFO:   <<< visual_num_hidden_layers: 12
2024-11-13 23:25:32,121:INFO:   <<< warmup_proportion: 0.1
2024-11-13 23:25:32,121:INFO:   <<< world_size: 1
2024-11-13 23:25:32,121:INFO: device: cuda:0 n_gpu: 1
2024-11-13 23:25:32,996:INFO: loading archive file /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base
2024-11-13 23:25:32,997:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-11-13 23:25:32,997:INFO: Weight doesn't exsits. /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base/cross_pytorch_model.bin
2024-11-13 23:25:32,997:WARNING: Stage-One:True, Stage-Two:False
2024-11-13 23:25:32,997:WARNING: Test retrieval by loose type.
2024-11-13 23:25:32,997:WARNING: 	 embed_dim: 512
2024-11-13 23:25:32,997:WARNING: 	 image_resolution: 224
2024-11-13 23:25:32,997:WARNING: 	 vision_layers: 12
2024-11-13 23:25:32,997:WARNING: 	 vision_width: 768
2024-11-13 23:25:32,997:WARNING: 	 vision_patch_size: 32
2024-11-13 23:25:32,997:WARNING: 	 context_length: 77
2024-11-13 23:25:32,997:WARNING: 	 vocab_size: 49408
2024-11-13 23:25:32,998:WARNING: 	 transformer_width: 512
2024-11-13 23:25:32,998:WARNING: 	 transformer_heads: 8
2024-11-13 23:25:32,998:WARNING: 	 transformer_layers: 12
2024-11-13 23:25:32,998:WARNING: 		 linear_patch: 2d
2024-11-13 23:25:32,998:WARNING: 	 cut_top_layer: 0
2024-11-13 23:25:34,195:WARNING: 	 sim_header: Filip
2024-11-13 23:25:40,897:INFO: --------------------
2024-11-13 23:25:40,898:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-11-13 23:26:33,930:INFO: Effective parameters:
2024-11-13 23:26:33,931:INFO:   <<< alpha: 0.9
2024-11-13 23:26:33,931:INFO:   <<< aug_choose: t2v
2024-11-13 23:26:33,931:INFO:   <<< batch_size: 512
2024-11-13 23:26:33,931:INFO:   <<< batch_size_val: 256
2024-11-13 23:26:33,931:INFO:   <<< cache_dir: 
2024-11-13 23:26:33,931:INFO:   <<< cla_weight_dir: cla_weight
2024-11-13 23:26:33,931:INFO:   <<< coef_lr: 1.0
2024-11-13 23:26:33,931:INFO:   <<< combine_type: sum
2024-11-13 23:26:33,931:INFO:   <<< cross_att_layers: 1
2024-11-13 23:26:33,931:INFO:   <<< cross_model: cross-base
2024-11-13 23:26:33,931:INFO:   <<< cross_num_hidden_layers: 4
2024-11-13 23:26:33,931:INFO:   <<< data_path: data_ph
2024-11-13 23:26:33,931:INFO:   <<< datatype: ph
2024-11-13 23:26:33,931:INFO:   <<< debug: False
2024-11-13 23:26:33,931:INFO:   <<< distributed: True
2024-11-13 23:26:33,931:INFO:   <<< do_eval: True
2024-11-13 23:26:33,931:INFO:   <<< do_lower_case: False
2024-11-13 23:26:33,931:INFO:   <<< do_pretrain: False
2024-11-13 23:26:33,931:INFO:   <<< do_train: False
2024-11-13 23:26:33,931:INFO:   <<< dual_mix: 0.5
2024-11-13 23:26:33,931:INFO:   <<< epochs: 200
2024-11-13 23:26:33,931:INFO:   <<< eval_frame_order: 0
2024-11-13 23:26:33,931:INFO:   <<< expand_msrvtt_sentences: False
2024-11-13 23:26:33,931:INFO:   <<< feature_framerate: 1
2024-11-13 23:26:33,931:INFO:   <<< feature_len: 64
2024-11-13 23:26:33,931:INFO:   <<< features_path: sign_feature/ph_domain_agnostic
2024-11-13 23:26:33,931:INFO:   <<< features_path_retrain: sign_feature/ph_domain_aware
2024-11-13 23:26:33,931:INFO:   <<< fp16: True
2024-11-13 23:26:33,931:INFO:   <<< fp16_opt_level: O1
2024-11-13 23:26:33,931:INFO:   <<< freeze_layer_num: 0
2024-11-13 23:26:33,931:INFO:   <<< gpu_ids: [0, 1]
2024-11-13 23:26:33,931:INFO:   <<< gradient_accumulation_steps: 1
2024-11-13 23:26:33,931:INFO:   <<< hard_negative_rate: 0.5
2024-11-13 23:26:33,931:INFO:   <<< init_model: chpt/ph_sota.pth
2024-11-13 23:26:33,932:INFO:   <<< linear_patch: 2d
2024-11-13 23:26:33,932:INFO:   <<< local_rank: 0
2024-11-13 23:26:33,932:INFO:   <<< loose_type: True
2024-11-13 23:26:33,932:INFO:   <<< lr: 1e-05
2024-11-13 23:26:33,932:INFO:   <<< lr_decay: 0.001
2024-11-13 23:26:33,932:INFO:   <<< margin: 0.1
2024-11-13 23:26:33,932:INFO:   <<< max_frames: 128
2024-11-13 23:26:33,932:INFO:   <<< max_words: 32
2024-11-13 23:26:33,932:INFO:   <<< mix_design: balance
2024-11-13 23:26:33,932:INFO:   <<< n_display: 1
2024-11-13 23:26:33,932:INFO:   <<< n_gpu: 1
2024-11-13 23:26:33,932:INFO:   <<< n_pair: 1
2024-11-13 23:26:33,932:INFO:   <<< negative_weighting: 1
2024-11-13 23:26:33,932:INFO:   <<< not_load_visual: False
2024-11-13 23:26:33,932:INFO:   <<< num_thread_reader: 8
2024-11-13 23:26:33,932:INFO:   <<< output_dir: new_experiment
2024-11-13 23:26:33,932:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-11-13 23:26:33,932:INFO:   <<< rank: 0
2024-11-13 23:26:33,932:INFO:   <<< resume_model: None
2024-11-13 23:26:33,932:INFO:   <<< sampled_use_mil: False
2024-11-13 23:26:33,932:INFO:   <<< seed: 42
2024-11-13 23:26:33,932:INFO:   <<< sim_calcu: softmax_max
2024-11-13 23:26:33,932:INFO:   <<< sim_header: Filip
2024-11-13 23:26:33,932:INFO:   <<< slice_framepos: 0
2024-11-13 23:26:33,932:INFO:   <<< task_type: retrieval
2024-11-13 23:26:33,932:INFO:   <<< tau: 0.07
2024-11-13 23:26:33,932:INFO:   <<< text_aug: True
2024-11-13 23:26:33,932:INFO:   <<< text_aug_choosen: random_swap
2024-11-13 23:26:33,932:INFO:   <<< text_num_hidden_layers: 12
2024-11-13 23:26:33,932:INFO:   <<< train_frame_order: 0
2024-11-13 23:26:33,932:INFO:   <<< use_mil: False
2024-11-13 23:26:33,932:INFO:   <<< video_dim: 1024
2024-11-13 23:26:33,932:INFO:   <<< visual_num_hidden_layers: 12
2024-11-13 23:26:33,932:INFO:   <<< warmup_proportion: 0.1
2024-11-13 23:26:33,932:INFO:   <<< world_size: 1
2024-11-13 23:26:33,933:INFO: device: cuda:0 n_gpu: 1
2024-11-13 23:26:34,812:INFO: loading archive file /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base
2024-11-13 23:26:34,813:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-11-13 23:26:34,814:INFO: Weight doesn't exsits. /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base/cross_pytorch_model.bin
2024-11-13 23:26:34,814:WARNING: Stage-One:True, Stage-Two:False
2024-11-13 23:26:34,814:WARNING: Test retrieval by loose type.
2024-11-13 23:26:34,814:WARNING: 	 embed_dim: 512
2024-11-13 23:26:34,814:WARNING: 	 image_resolution: 224
2024-11-13 23:26:34,814:WARNING: 	 vision_layers: 12
2024-11-13 23:26:34,814:WARNING: 	 vision_width: 768
2024-11-13 23:26:34,814:WARNING: 	 vision_patch_size: 32
2024-11-13 23:26:34,814:WARNING: 	 context_length: 77
2024-11-13 23:26:34,814:WARNING: 	 vocab_size: 49408
2024-11-13 23:26:34,814:WARNING: 	 transformer_width: 512
2024-11-13 23:26:34,814:WARNING: 	 transformer_heads: 8
2024-11-13 23:26:34,814:WARNING: 	 transformer_layers: 12
2024-11-13 23:26:34,814:WARNING: 		 linear_patch: 2d
2024-11-13 23:26:34,814:WARNING: 	 cut_top_layer: 0
2024-11-13 23:26:36,011:WARNING: 	 sim_header: Filip
2024-11-13 23:26:42,717:INFO: --------------------
2024-11-13 23:26:42,717:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-11-13 23:26:42,771:INFO: ***** Running test *****
2024-11-13 23:26:42,771:INFO:   Num examples = 3
2024-11-13 23:26:42,771:INFO:   Batch size = 256
2024-11-13 23:26:42,771:INFO:   Num steps = 1
2024-11-13 23:28:07,731:INFO: Effective parameters:
2024-11-13 23:28:07,732:INFO:   <<< alpha: 0.9
2024-11-13 23:28:07,732:INFO:   <<< aug_choose: t2v
2024-11-13 23:28:07,732:INFO:   <<< batch_size: 512
2024-11-13 23:28:07,732:INFO:   <<< batch_size_val: 256
2024-11-13 23:28:07,732:INFO:   <<< cache_dir: 
2024-11-13 23:28:07,732:INFO:   <<< cla_weight_dir: cla_weight
2024-11-13 23:28:07,732:INFO:   <<< coef_lr: 1.0
2024-11-13 23:28:07,732:INFO:   <<< combine_type: sum
2024-11-13 23:28:07,732:INFO:   <<< cross_att_layers: 1
2024-11-13 23:28:07,732:INFO:   <<< cross_model: cross-base
2024-11-13 23:28:07,732:INFO:   <<< cross_num_hidden_layers: 4
2024-11-13 23:28:07,732:INFO:   <<< data_path: data_ph
2024-11-13 23:28:07,732:INFO:   <<< datatype: ph
2024-11-13 23:28:07,732:INFO:   <<< debug: False
2024-11-13 23:28:07,732:INFO:   <<< distributed: True
2024-11-13 23:28:07,732:INFO:   <<< do_eval: True
2024-11-13 23:28:07,732:INFO:   <<< do_lower_case: False
2024-11-13 23:28:07,732:INFO:   <<< do_pretrain: False
2024-11-13 23:28:07,732:INFO:   <<< do_train: False
2024-11-13 23:28:07,732:INFO:   <<< dual_mix: 0.5
2024-11-13 23:28:07,732:INFO:   <<< epochs: 200
2024-11-13 23:28:07,732:INFO:   <<< eval_frame_order: 0
2024-11-13 23:28:07,732:INFO:   <<< expand_msrvtt_sentences: False
2024-11-13 23:28:07,732:INFO:   <<< feature_framerate: 1
2024-11-13 23:28:07,732:INFO:   <<< feature_len: 64
2024-11-13 23:28:07,732:INFO:   <<< features_path: sign_feature/ph_domain_agnostic
2024-11-13 23:28:07,732:INFO:   <<< features_path_retrain: sign_feature/ph_domain_aware
2024-11-13 23:28:07,732:INFO:   <<< fp16: True
2024-11-13 23:28:07,732:INFO:   <<< fp16_opt_level: O1
2024-11-13 23:28:07,732:INFO:   <<< freeze_layer_num: 0
2024-11-13 23:28:07,732:INFO:   <<< gpu_ids: [0, 1]
2024-11-13 23:28:07,732:INFO:   <<< gradient_accumulation_steps: 1
2024-11-13 23:28:07,733:INFO:   <<< hard_negative_rate: 0.5
2024-11-13 23:28:07,733:INFO:   <<< init_model: chpt/ph_sota.pth
2024-11-13 23:28:07,733:INFO:   <<< linear_patch: 2d
2024-11-13 23:28:07,733:INFO:   <<< local_rank: 0
2024-11-13 23:28:07,733:INFO:   <<< loose_type: True
2024-11-13 23:28:07,733:INFO:   <<< lr: 1e-05
2024-11-13 23:28:07,733:INFO:   <<< lr_decay: 0.001
2024-11-13 23:28:07,733:INFO:   <<< margin: 0.1
2024-11-13 23:28:07,733:INFO:   <<< max_frames: 128
2024-11-13 23:28:07,733:INFO:   <<< max_words: 32
2024-11-13 23:28:07,733:INFO:   <<< mix_design: balance
2024-11-13 23:28:07,733:INFO:   <<< n_display: 1
2024-11-13 23:28:07,733:INFO:   <<< n_gpu: 1
2024-11-13 23:28:07,733:INFO:   <<< n_pair: 1
2024-11-13 23:28:07,733:INFO:   <<< negative_weighting: 1
2024-11-13 23:28:07,733:INFO:   <<< not_load_visual: False
2024-11-13 23:28:07,733:INFO:   <<< num_thread_reader: 8
2024-11-13 23:28:07,733:INFO:   <<< output_dir: new_experiment
2024-11-13 23:28:07,733:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-11-13 23:28:07,733:INFO:   <<< rank: 0
2024-11-13 23:28:07,733:INFO:   <<< resume_model: None
2024-11-13 23:28:07,733:INFO:   <<< sampled_use_mil: False
2024-11-13 23:28:07,733:INFO:   <<< seed: 42
2024-11-13 23:28:07,733:INFO:   <<< sim_calcu: softmax_max
2024-11-13 23:28:07,733:INFO:   <<< sim_header: Filip
2024-11-13 23:28:07,733:INFO:   <<< slice_framepos: 0
2024-11-13 23:28:07,733:INFO:   <<< task_type: retrieval
2024-11-13 23:28:07,733:INFO:   <<< tau: 0.07
2024-11-13 23:28:07,733:INFO:   <<< text_aug: True
2024-11-13 23:28:07,733:INFO:   <<< text_aug_choosen: random_swap
2024-11-13 23:28:07,733:INFO:   <<< text_num_hidden_layers: 12
2024-11-13 23:28:07,733:INFO:   <<< train_frame_order: 0
2024-11-13 23:28:07,733:INFO:   <<< use_mil: False
2024-11-13 23:28:07,733:INFO:   <<< video_dim: 1024
2024-11-13 23:28:07,733:INFO:   <<< visual_num_hidden_layers: 12
2024-11-13 23:28:07,733:INFO:   <<< warmup_proportion: 0.1
2024-11-13 23:28:07,734:INFO:   <<< world_size: 1
2024-11-13 23:28:07,734:INFO: device: cuda:0 n_gpu: 1
2024-11-13 23:28:08,606:INFO: loading archive file /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base
2024-11-13 23:28:08,607:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-11-13 23:28:08,607:INFO: Weight doesn't exsits. /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base/cross_pytorch_model.bin
2024-11-13 23:28:08,608:WARNING: Stage-One:True, Stage-Two:False
2024-11-13 23:28:08,608:WARNING: Test retrieval by loose type.
2024-11-13 23:28:08,608:WARNING: 	 embed_dim: 512
2024-11-13 23:28:08,608:WARNING: 	 image_resolution: 224
2024-11-13 23:28:08,608:WARNING: 	 vision_layers: 12
2024-11-13 23:28:08,608:WARNING: 	 vision_width: 768
2024-11-13 23:28:08,608:WARNING: 	 vision_patch_size: 32
2024-11-13 23:28:08,608:WARNING: 	 context_length: 77
2024-11-13 23:28:08,608:WARNING: 	 vocab_size: 49408
2024-11-13 23:28:08,608:WARNING: 	 transformer_width: 512
2024-11-13 23:28:08,608:WARNING: 	 transformer_heads: 8
2024-11-13 23:28:08,608:WARNING: 	 transformer_layers: 12
2024-11-13 23:28:08,608:WARNING: 		 linear_patch: 2d
2024-11-13 23:28:08,608:WARNING: 	 cut_top_layer: 0
2024-11-13 23:28:09,830:WARNING: 	 sim_header: Filip
2024-11-13 23:28:16,522:INFO: --------------------
2024-11-13 23:28:16,523:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-11-13 23:28:16,580:INFO: ***** Running test *****
2024-11-13 23:28:16,580:INFO:   Num examples = 3
2024-11-13 23:28:16,580:INFO:   Batch size = 256
2024-11-13 23:28:16,580:INFO:   Num steps = 3
2024-11-13 23:28:16,970:WARNING: Eval under the multi-sentence per video clip setting.
2024-11-13 23:28:16,970:WARNING: sentence num: 642, video num: 642
2024-11-13 23:30:34,984:INFO: Effective parameters:
2024-11-13 23:30:34,984:INFO:   <<< alpha: 0.9
2024-11-13 23:30:34,984:INFO:   <<< aug_choose: t2v
2024-11-13 23:30:34,984:INFO:   <<< batch_size: 512
2024-11-13 23:30:34,984:INFO:   <<< batch_size_val: 256
2024-11-13 23:30:34,984:INFO:   <<< cache_dir: 
2024-11-13 23:30:34,984:INFO:   <<< cla_weight_dir: cla_weight
2024-11-13 23:30:34,984:INFO:   <<< coef_lr: 1.0
2024-11-13 23:30:34,985:INFO:   <<< combine_type: sum
2024-11-13 23:30:34,985:INFO:   <<< cross_att_layers: 1
2024-11-13 23:30:34,985:INFO:   <<< cross_model: cross-base
2024-11-13 23:30:34,985:INFO:   <<< cross_num_hidden_layers: 4
2024-11-13 23:30:34,985:INFO:   <<< data_path: data_ph
2024-11-13 23:30:34,985:INFO:   <<< datatype: ph
2024-11-13 23:30:34,985:INFO:   <<< debug: False
2024-11-13 23:30:34,985:INFO:   <<< distributed: True
2024-11-13 23:30:34,985:INFO:   <<< do_eval: True
2024-11-13 23:30:34,985:INFO:   <<< do_lower_case: False
2024-11-13 23:30:34,985:INFO:   <<< do_pretrain: False
2024-11-13 23:30:34,985:INFO:   <<< do_train: False
2024-11-13 23:30:34,985:INFO:   <<< dual_mix: 0.5
2024-11-13 23:30:34,985:INFO:   <<< epochs: 200
2024-11-13 23:30:34,985:INFO:   <<< eval_frame_order: 0
2024-11-13 23:30:34,985:INFO:   <<< expand_msrvtt_sentences: False
2024-11-13 23:30:34,985:INFO:   <<< feature_framerate: 1
2024-11-13 23:30:34,985:INFO:   <<< feature_len: 64
2024-11-13 23:30:34,985:INFO:   <<< features_path: sign_feature/ph_domain_agnostic
2024-11-13 23:30:34,985:INFO:   <<< features_path_retrain: sign_feature/ph_domain_aware
2024-11-13 23:30:34,985:INFO:   <<< fp16: True
2024-11-13 23:30:34,985:INFO:   <<< fp16_opt_level: O1
2024-11-13 23:30:34,985:INFO:   <<< freeze_layer_num: 0
2024-11-13 23:30:34,985:INFO:   <<< gpu_ids: [0, 1]
2024-11-13 23:30:34,985:INFO:   <<< gradient_accumulation_steps: 1
2024-11-13 23:30:34,985:INFO:   <<< hard_negative_rate: 0.5
2024-11-13 23:30:34,985:INFO:   <<< init_model: chpt/ph_sota.pth
2024-11-13 23:30:34,985:INFO:   <<< linear_patch: 2d
2024-11-13 23:30:34,985:INFO:   <<< local_rank: 0
2024-11-13 23:30:34,985:INFO:   <<< loose_type: True
2024-11-13 23:30:34,985:INFO:   <<< lr: 1e-05
2024-11-13 23:30:34,985:INFO:   <<< lr_decay: 0.001
2024-11-13 23:30:34,985:INFO:   <<< margin: 0.1
2024-11-13 23:30:34,985:INFO:   <<< max_frames: 128
2024-11-13 23:30:34,985:INFO:   <<< max_words: 32
2024-11-13 23:30:34,986:INFO:   <<< mix_design: balance
2024-11-13 23:30:34,986:INFO:   <<< n_display: 1
2024-11-13 23:30:34,986:INFO:   <<< n_gpu: 1
2024-11-13 23:30:34,986:INFO:   <<< n_pair: 1
2024-11-13 23:30:34,986:INFO:   <<< negative_weighting: 1
2024-11-13 23:30:34,986:INFO:   <<< not_load_visual: False
2024-11-13 23:30:34,986:INFO:   <<< num_thread_reader: 8
2024-11-13 23:30:34,986:INFO:   <<< output_dir: new_experiment
2024-11-13 23:30:34,986:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-11-13 23:30:34,986:INFO:   <<< rank: 0
2024-11-13 23:30:34,986:INFO:   <<< resume_model: None
2024-11-13 23:30:34,986:INFO:   <<< sampled_use_mil: False
2024-11-13 23:30:34,986:INFO:   <<< seed: 42
2024-11-13 23:30:34,986:INFO:   <<< sim_calcu: softmax_max
2024-11-13 23:30:34,986:INFO:   <<< sim_header: Filip
2024-11-13 23:30:34,986:INFO:   <<< slice_framepos: 0
2024-11-13 23:30:34,986:INFO:   <<< task_type: retrieval
2024-11-13 23:30:34,986:INFO:   <<< tau: 0.07
2024-11-13 23:30:34,986:INFO:   <<< text_aug: True
2024-11-13 23:30:34,986:INFO:   <<< text_aug_choosen: random_swap
2024-11-13 23:30:34,986:INFO:   <<< text_num_hidden_layers: 12
2024-11-13 23:30:34,986:INFO:   <<< train_frame_order: 0
2024-11-13 23:30:34,986:INFO:   <<< use_mil: False
2024-11-13 23:30:34,986:INFO:   <<< video_dim: 1024
2024-11-13 23:30:34,986:INFO:   <<< visual_num_hidden_layers: 12
2024-11-13 23:30:34,986:INFO:   <<< warmup_proportion: 0.1
2024-11-13 23:30:34,986:INFO:   <<< world_size: 1
2024-11-13 23:30:34,987:INFO: device: cuda:0 n_gpu: 1
2024-11-13 23:30:35,859:INFO: loading archive file /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base
2024-11-13 23:30:35,860:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-11-13 23:30:35,860:INFO: Weight doesn't exsits. /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base/cross_pytorch_model.bin
2024-11-13 23:30:35,860:WARNING: Stage-One:True, Stage-Two:False
2024-11-13 23:30:35,860:WARNING: Test retrieval by loose type.
2024-11-13 23:30:35,860:WARNING: 	 embed_dim: 512
2024-11-13 23:30:35,860:WARNING: 	 image_resolution: 224
2024-11-13 23:30:35,860:WARNING: 	 vision_layers: 12
2024-11-13 23:30:35,860:WARNING: 	 vision_width: 768
2024-11-13 23:30:35,861:WARNING: 	 vision_patch_size: 32
2024-11-13 23:30:35,861:WARNING: 	 context_length: 77
2024-11-13 23:30:35,861:WARNING: 	 vocab_size: 49408
2024-11-13 23:30:35,861:WARNING: 	 transformer_width: 512
2024-11-13 23:30:35,861:WARNING: 	 transformer_heads: 8
2024-11-13 23:30:35,861:WARNING: 	 transformer_layers: 12
2024-11-13 23:30:35,861:WARNING: 		 linear_patch: 2d
2024-11-13 23:30:35,861:WARNING: 	 cut_top_layer: 0
2024-11-13 23:30:37,082:WARNING: 	 sim_header: Filip
2024-11-13 23:30:43,764:INFO: --------------------
2024-11-13 23:30:43,765:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-11-13 23:30:43,819:INFO: ***** Running test *****
2024-11-13 23:30:43,819:INFO:   Num examples = 642
2024-11-13 23:30:43,819:INFO:   Batch size = 256
2024-11-13 23:30:43,819:INFO:   Num steps = 3
2024-11-13 23:30:44,082:WARNING: Eval under the multi-sentence per video clip setting.
2024-11-13 23:30:44,082:WARNING: sentence num: 642, video num: 642
2024-11-13 23:30:45,288:INFO: before reshape, sim matrix size: 642 x 642
2024-11-13 23:30:45,324:INFO: after reshape, sim matrix size: 642 x 1 x 642
2024-11-13 23:30:45,385:INFO: Mix_Text-to-Video:
2024-11-13 23:30:45,386:INFO: 	>>>  R@1: 69.5 - R@5: 86.6 - R@10: 92.1 - Median R: 1.0 - Mean R: 5.2
2024-11-13 23:30:45,386:INFO: Mix_Video-to-Text:
2024-11-13 23:30:45,386:INFO: 	>>>  V2T$R@1: 70.1 - V2T$R@5: 87.9 - V2T$R@10: 92.7 - V2T$Median R: 1.0 - V2T$Mean R: 5.8
2024-11-14 07:22:45,118:INFO: Effective parameters:
2024-11-14 07:22:45,118:INFO:   <<< alpha: 0.9
2024-11-14 07:22:45,118:INFO:   <<< aug_choose: t2v
2024-11-14 07:22:45,118:INFO:   <<< batch_size: 512
2024-11-14 07:22:45,118:INFO:   <<< batch_size_val: 256
2024-11-14 07:22:45,118:INFO:   <<< cache_dir: 
2024-11-14 07:22:45,118:INFO:   <<< cla_weight_dir: cla_weight
2024-11-14 07:22:45,118:INFO:   <<< coef_lr: 1.0
2024-11-14 07:22:45,118:INFO:   <<< combine_type: sum
2024-11-14 07:22:45,118:INFO:   <<< cross_att_layers: 1
2024-11-14 07:22:45,118:INFO:   <<< cross_model: cross-base
2024-11-14 07:22:45,119:INFO:   <<< cross_num_hidden_layers: 4
2024-11-14 07:22:45,119:INFO:   <<< data_path: data_ph
2024-11-14 07:22:45,119:INFO:   <<< datatype: ph
2024-11-14 07:22:45,119:INFO:   <<< debug: False
2024-11-14 07:22:45,119:INFO:   <<< distributed: True
2024-11-14 07:22:45,119:INFO:   <<< do_eval: True
2024-11-14 07:22:45,119:INFO:   <<< do_lower_case: False
2024-11-14 07:22:45,119:INFO:   <<< do_pretrain: False
2024-11-14 07:22:45,119:INFO:   <<< do_train: False
2024-11-14 07:22:45,119:INFO:   <<< dual_mix: 0.5
2024-11-14 07:22:45,119:INFO:   <<< epochs: 200
2024-11-14 07:22:45,119:INFO:   <<< eval_frame_order: 0
2024-11-14 07:22:45,119:INFO:   <<< expand_msrvtt_sentences: False
2024-11-14 07:22:45,119:INFO:   <<< feature_framerate: 1
2024-11-14 07:22:45,119:INFO:   <<< feature_len: 64
2024-11-14 07:22:45,119:INFO:   <<< features_path: sign_feature/ph_domain_agnostic
2024-11-14 07:22:45,120:INFO:   <<< features_path_retrain: sign_feature/ph_domain_aware
2024-11-14 07:22:45,120:INFO:   <<< fp16: True
2024-11-14 07:22:45,120:INFO:   <<< fp16_opt_level: O1
2024-11-14 07:22:45,120:INFO:   <<< freeze_layer_num: 0
2024-11-14 07:22:45,120:INFO:   <<< gpu_ids: [0, 1]
2024-11-14 07:22:45,120:INFO:   <<< gradient_accumulation_steps: 1
2024-11-14 07:22:45,120:INFO:   <<< hard_negative_rate: 0.5
2024-11-14 07:22:45,120:INFO:   <<< init_model: chpt/ph_sota.pth
2024-11-14 07:22:45,120:INFO:   <<< linear_patch: 2d
2024-11-14 07:22:45,120:INFO:   <<< local_rank: 0
2024-11-14 07:22:45,120:INFO:   <<< loose_type: True
2024-11-14 07:22:45,120:INFO:   <<< lr: 1e-05
2024-11-14 07:22:45,120:INFO:   <<< lr_decay: 0.001
2024-11-14 07:22:45,120:INFO:   <<< margin: 0.1
2024-11-14 07:22:45,120:INFO:   <<< max_frames: 128
2024-11-14 07:22:45,120:INFO:   <<< max_words: 32
2024-11-14 07:22:45,121:INFO:   <<< mix_design: balance
2024-11-14 07:22:45,121:INFO:   <<< n_display: 1
2024-11-14 07:22:45,121:INFO:   <<< n_gpu: 1
2024-11-14 07:22:45,121:INFO:   <<< n_pair: 1
2024-11-14 07:22:45,121:INFO:   <<< negative_weighting: 1
2024-11-14 07:22:45,121:INFO:   <<< not_load_visual: False
2024-11-14 07:22:45,121:INFO:   <<< num_thread_reader: 8
2024-11-14 07:22:45,121:INFO:   <<< output_dir: new_experiment
2024-11-14 07:22:45,121:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-11-14 07:22:45,121:INFO:   <<< rank: 0
2024-11-14 07:22:45,121:INFO:   <<< resume_model: None
2024-11-14 07:22:45,121:INFO:   <<< sampled_use_mil: False
2024-11-14 07:22:45,121:INFO:   <<< seed: 42
2024-11-14 07:22:45,121:INFO:   <<< sim_calcu: softmax_max
2024-11-14 07:22:45,121:INFO:   <<< sim_header: Filip
2024-11-14 07:22:45,122:INFO:   <<< slice_framepos: 0
2024-11-14 07:22:45,122:INFO:   <<< task_type: retrieval
2024-11-14 07:22:45,122:INFO:   <<< tau: 0.07
2024-11-14 07:22:45,122:INFO:   <<< text_aug: True
2024-11-14 07:22:45,122:INFO:   <<< text_aug_choosen: random_swap
2024-11-14 07:22:45,122:INFO:   <<< text_num_hidden_layers: 12
2024-11-14 07:22:45,122:INFO:   <<< train_frame_order: 0
2024-11-14 07:22:45,122:INFO:   <<< use_mil: False
2024-11-14 07:22:45,122:INFO:   <<< video_dim: 1024
2024-11-14 07:22:45,122:INFO:   <<< visual_num_hidden_layers: 12
2024-11-14 07:22:45,122:INFO:   <<< warmup_proportion: 0.1
2024-11-14 07:22:45,122:INFO:   <<< world_size: 1
2024-11-14 07:22:45,123:INFO: device: cuda:0 n_gpu: 1
2024-11-14 07:22:45,991:INFO: loading archive file /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base
2024-11-14 07:22:45,992:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-11-14 07:22:45,992:INFO: Weight doesn't exsits. /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base/cross_pytorch_model.bin
2024-11-14 07:22:45,993:WARNING: Stage-One:True, Stage-Two:False
2024-11-14 07:22:45,993:WARNING: Test retrieval by loose type.
2024-11-14 07:22:45,993:WARNING: 	 embed_dim: 512
2024-11-14 07:22:45,993:WARNING: 	 image_resolution: 224
2024-11-14 07:22:45,993:WARNING: 	 vision_layers: 12
2024-11-14 07:22:45,993:WARNING: 	 vision_width: 768
2024-11-14 07:22:45,993:WARNING: 	 vision_patch_size: 32
2024-11-14 07:22:45,993:WARNING: 	 context_length: 77
2024-11-14 07:22:45,993:WARNING: 	 vocab_size: 49408
2024-11-14 07:22:45,993:WARNING: 	 transformer_width: 512
2024-11-14 07:22:45,993:WARNING: 	 transformer_heads: 8
2024-11-14 07:22:45,994:WARNING: 	 transformer_layers: 12
2024-11-14 07:22:45,994:WARNING: 		 linear_patch: 2d
2024-11-14 07:22:45,994:WARNING: 	 cut_top_layer: 0
2024-11-14 07:22:47,350:WARNING: 	 sim_header: Filip
2024-11-14 07:22:54,170:INFO: --------------------
2024-11-14 07:22:54,171:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-11-14 07:22:54,232:INFO: ***** Running test *****
2024-11-14 07:22:54,232:INFO:   Num examples = 4
2024-11-14 07:22:54,232:INFO:   Batch size = 256
2024-11-14 07:22:54,232:INFO:   Num steps = 1
2024-11-14 07:38:35,096:INFO: Effective parameters:
2024-11-14 07:38:35,097:INFO:   <<< alpha: 0.9
2024-11-14 07:38:35,097:INFO:   <<< aug_choose: t2v
2024-11-14 07:38:35,097:INFO:   <<< batch_size: 512
2024-11-14 07:38:35,097:INFO:   <<< batch_size_val: 256
2024-11-14 07:38:35,097:INFO:   <<< cache_dir: 
2024-11-14 07:38:35,097:INFO:   <<< cla_weight_dir: cla_weight
2024-11-14 07:38:35,097:INFO:   <<< coef_lr: 1.0
2024-11-14 07:38:35,097:INFO:   <<< combine_type: sum
2024-11-14 07:38:35,097:INFO:   <<< cross_att_layers: 1
2024-11-14 07:38:35,097:INFO:   <<< cross_model: cross-base
2024-11-14 07:38:35,098:INFO:   <<< cross_num_hidden_layers: 4
2024-11-14 07:38:35,098:INFO:   <<< data_path: data_ph
2024-11-14 07:38:35,098:INFO:   <<< datatype: ph
2024-11-14 07:38:35,098:INFO:   <<< debug: False
2024-11-14 07:38:35,098:INFO:   <<< distributed: True
2024-11-14 07:38:35,098:INFO:   <<< do_eval: True
2024-11-14 07:38:35,098:INFO:   <<< do_lower_case: False
2024-11-14 07:38:35,098:INFO:   <<< do_pretrain: False
2024-11-14 07:38:35,098:INFO:   <<< do_train: False
2024-11-14 07:38:35,098:INFO:   <<< dual_mix: 0.5
2024-11-14 07:38:35,098:INFO:   <<< epochs: 200
2024-11-14 07:38:35,098:INFO:   <<< eval_frame_order: 0
2024-11-14 07:38:35,098:INFO:   <<< expand_msrvtt_sentences: False
2024-11-14 07:38:35,098:INFO:   <<< feature_framerate: 1
2024-11-14 07:38:35,098:INFO:   <<< feature_len: 64
2024-11-14 07:38:35,098:INFO:   <<< features_path: sign_feature/ph_domain_agnostic
2024-11-14 07:38:35,098:INFO:   <<< features_path_retrain: sign_feature/ph_domain_aware
2024-11-14 07:38:35,098:INFO:   <<< fp16: True
2024-11-14 07:38:35,098:INFO:   <<< fp16_opt_level: O1
2024-11-14 07:38:35,098:INFO:   <<< freeze_layer_num: 0
2024-11-14 07:38:35,098:INFO:   <<< gpu_ids: [0, 1]
2024-11-14 07:38:35,098:INFO:   <<< gradient_accumulation_steps: 1
2024-11-14 07:38:35,098:INFO:   <<< hard_negative_rate: 0.5
2024-11-14 07:38:35,098:INFO:   <<< init_model: chpt/ph_sota.pth
2024-11-14 07:38:35,098:INFO:   <<< linear_patch: 2d
2024-11-14 07:38:35,098:INFO:   <<< local_rank: 0
2024-11-14 07:38:35,098:INFO:   <<< loose_type: True
2024-11-14 07:38:35,098:INFO:   <<< lr: 1e-05
2024-11-14 07:38:35,098:INFO:   <<< lr_decay: 0.001
2024-11-14 07:38:35,099:INFO:   <<< margin: 0.1
2024-11-14 07:38:35,099:INFO:   <<< max_frames: 128
2024-11-14 07:38:35,099:INFO:   <<< max_words: 32
2024-11-14 07:38:35,099:INFO:   <<< mix_design: balance
2024-11-14 07:38:35,099:INFO:   <<< n_display: 1
2024-11-14 07:38:35,099:INFO:   <<< n_gpu: 1
2024-11-14 07:38:35,099:INFO:   <<< n_pair: 1
2024-11-14 07:38:35,099:INFO:   <<< negative_weighting: 1
2024-11-14 07:38:35,099:INFO:   <<< not_load_visual: False
2024-11-14 07:38:35,099:INFO:   <<< num_thread_reader: 8
2024-11-14 07:38:35,099:INFO:   <<< output_dir: new_experiment
2024-11-14 07:38:35,099:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-11-14 07:38:35,099:INFO:   <<< rank: 0
2024-11-14 07:38:35,099:INFO:   <<< resume_model: None
2024-11-14 07:38:35,099:INFO:   <<< sampled_use_mil: False
2024-11-14 07:38:35,099:INFO:   <<< seed: 42
2024-11-14 07:38:35,099:INFO:   <<< sim_calcu: softmax_max
2024-11-14 07:38:35,099:INFO:   <<< sim_header: Filip
2024-11-14 07:38:35,099:INFO:   <<< slice_framepos: 0
2024-11-14 07:38:35,099:INFO:   <<< task_type: retrieval
2024-11-14 07:38:35,099:INFO:   <<< tau: 0.07
2024-11-14 07:38:35,099:INFO:   <<< text_aug: True
2024-11-14 07:38:35,099:INFO:   <<< text_aug_choosen: random_swap
2024-11-14 07:38:35,099:INFO:   <<< text_num_hidden_layers: 12
2024-11-14 07:38:35,099:INFO:   <<< train_frame_order: 0
2024-11-14 07:38:35,099:INFO:   <<< use_mil: False
2024-11-14 07:38:35,099:INFO:   <<< video_dim: 1024
2024-11-14 07:38:35,099:INFO:   <<< visual_num_hidden_layers: 12
2024-11-14 07:38:35,099:INFO:   <<< warmup_proportion: 0.1
2024-11-14 07:38:35,099:INFO:   <<< world_size: 1
2024-11-14 07:38:35,100:INFO: device: cuda:0 n_gpu: 1
2024-11-14 07:38:36,003:INFO: loading archive file /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base
2024-11-14 07:38:36,004:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-11-14 07:38:36,004:INFO: Weight doesn't exsits. /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base/cross_pytorch_model.bin
2024-11-14 07:38:36,004:WARNING: Stage-One:True, Stage-Two:False
2024-11-14 07:38:36,004:WARNING: Test retrieval by loose type.
2024-11-14 07:38:36,005:WARNING: 	 embed_dim: 512
2024-11-14 07:38:36,005:WARNING: 	 image_resolution: 224
2024-11-14 07:38:36,005:WARNING: 	 vision_layers: 12
2024-11-14 07:38:36,005:WARNING: 	 vision_width: 768
2024-11-14 07:38:36,005:WARNING: 	 vision_patch_size: 32
2024-11-14 07:38:36,005:WARNING: 	 context_length: 77
2024-11-14 07:38:36,005:WARNING: 	 vocab_size: 49408
2024-11-14 07:38:36,005:WARNING: 	 transformer_width: 512
2024-11-14 07:38:36,005:WARNING: 	 transformer_heads: 8
2024-11-14 07:38:36,005:WARNING: 	 transformer_layers: 12
2024-11-14 07:38:36,005:WARNING: 		 linear_patch: 2d
2024-11-14 07:38:36,005:WARNING: 	 cut_top_layer: 0
2024-11-14 07:38:37,365:WARNING: 	 sim_header: Filip
2024-11-14 07:38:44,545:INFO: --------------------
2024-11-14 07:38:44,546:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-11-14 07:38:44,632:INFO: ***** Running test *****
2024-11-14 07:38:44,633:INFO:   Num examples = 4
2024-11-14 07:38:44,633:INFO:   Batch size = 256
2024-11-14 07:38:44,633:INFO:   Num steps = 1
2024-11-14 07:43:01,604:INFO: Effective parameters:
2024-11-14 07:43:01,605:INFO:   <<< alpha: 0.9
2024-11-14 07:43:01,605:INFO:   <<< aug_choose: t2v
2024-11-14 07:43:01,605:INFO:   <<< batch_size: 512
2024-11-14 07:43:01,605:INFO:   <<< batch_size_val: 256
2024-11-14 07:43:01,605:INFO:   <<< cache_dir: 
2024-11-14 07:43:01,605:INFO:   <<< cla_weight_dir: cla_weight
2024-11-14 07:43:01,605:INFO:   <<< coef_lr: 1.0
2024-11-14 07:43:01,605:INFO:   <<< combine_type: sum
2024-11-14 07:43:01,605:INFO:   <<< cross_att_layers: 1
2024-11-14 07:43:01,605:INFO:   <<< cross_model: cross-base
2024-11-14 07:43:01,605:INFO:   <<< cross_num_hidden_layers: 4
2024-11-14 07:43:01,606:INFO:   <<< data_path: data_ph
2024-11-14 07:43:01,606:INFO:   <<< datatype: ph
2024-11-14 07:43:01,606:INFO:   <<< debug: False
2024-11-14 07:43:01,606:INFO:   <<< distributed: True
2024-11-14 07:43:01,606:INFO:   <<< do_eval: True
2024-11-14 07:43:01,606:INFO:   <<< do_lower_case: False
2024-11-14 07:43:01,606:INFO:   <<< do_pretrain: False
2024-11-14 07:43:01,606:INFO:   <<< do_train: False
2024-11-14 07:43:01,606:INFO:   <<< dual_mix: 0.5
2024-11-14 07:43:01,606:INFO:   <<< epochs: 200
2024-11-14 07:43:01,606:INFO:   <<< eval_frame_order: 0
2024-11-14 07:43:01,606:INFO:   <<< expand_msrvtt_sentences: False
2024-11-14 07:43:01,606:INFO:   <<< feature_framerate: 1
2024-11-14 07:43:01,606:INFO:   <<< feature_len: 64
2024-11-14 07:43:01,606:INFO:   <<< features_path: sign_feature/ph_domain_agnostic
2024-11-14 07:43:01,606:INFO:   <<< features_path_retrain: sign_feature/ph_domain_aware
2024-11-14 07:43:01,607:INFO:   <<< fp16: True
2024-11-14 07:43:01,607:INFO:   <<< fp16_opt_level: O1
2024-11-14 07:43:01,607:INFO:   <<< freeze_layer_num: 0
2024-11-14 07:43:01,607:INFO:   <<< gpu_ids: [0, 1]
2024-11-14 07:43:01,607:INFO:   <<< gradient_accumulation_steps: 1
2024-11-14 07:43:01,607:INFO:   <<< hard_negative_rate: 0.5
2024-11-14 07:43:01,607:INFO:   <<< init_model: chpt/ph_sota.pth
2024-11-14 07:43:01,607:INFO:   <<< linear_patch: 2d
2024-11-14 07:43:01,607:INFO:   <<< local_rank: 0
2024-11-14 07:43:01,607:INFO:   <<< loose_type: True
2024-11-14 07:43:01,607:INFO:   <<< lr: 1e-05
2024-11-14 07:43:01,607:INFO:   <<< lr_decay: 0.001
2024-11-14 07:43:01,607:INFO:   <<< margin: 0.1
2024-11-14 07:43:01,607:INFO:   <<< max_frames: 128
2024-11-14 07:43:01,607:INFO:   <<< max_words: 32
2024-11-14 07:43:01,608:INFO:   <<< mix_design: balance
2024-11-14 07:43:01,608:INFO:   <<< n_display: 1
2024-11-14 07:43:01,608:INFO:   <<< n_gpu: 1
2024-11-14 07:43:01,608:INFO:   <<< n_pair: 1
2024-11-14 07:43:01,608:INFO:   <<< negative_weighting: 1
2024-11-14 07:43:01,608:INFO:   <<< not_load_visual: False
2024-11-14 07:43:01,608:INFO:   <<< num_thread_reader: 8
2024-11-14 07:43:01,608:INFO:   <<< output_dir: new_experiment
2024-11-14 07:43:01,608:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-11-14 07:43:01,608:INFO:   <<< rank: 0
2024-11-14 07:43:01,608:INFO:   <<< resume_model: None
2024-11-14 07:43:01,608:INFO:   <<< sampled_use_mil: False
2024-11-14 07:43:01,608:INFO:   <<< seed: 42
2024-11-14 07:43:01,608:INFO:   <<< sim_calcu: softmax_max
2024-11-14 07:43:01,608:INFO:   <<< sim_header: Filip
2024-11-14 07:43:01,608:INFO:   <<< slice_framepos: 0
2024-11-14 07:43:01,609:INFO:   <<< task_type: retrieval
2024-11-14 07:43:01,609:INFO:   <<< tau: 0.07
2024-11-14 07:43:01,609:INFO:   <<< text_aug: True
2024-11-14 07:43:01,609:INFO:   <<< text_aug_choosen: random_swap
2024-11-14 07:43:01,609:INFO:   <<< text_num_hidden_layers: 12
2024-11-14 07:43:01,609:INFO:   <<< train_frame_order: 0
2024-11-14 07:43:01,609:INFO:   <<< use_mil: False
2024-11-14 07:43:01,609:INFO:   <<< video_dim: 1024
2024-11-14 07:43:01,609:INFO:   <<< visual_num_hidden_layers: 12
2024-11-14 07:43:01,609:INFO:   <<< warmup_proportion: 0.1
2024-11-14 07:43:01,609:INFO:   <<< world_size: 1
2024-11-14 07:43:01,610:INFO: device: cuda:0 n_gpu: 1
2024-11-14 07:43:02,487:INFO: loading archive file /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base
2024-11-14 07:43:02,489:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-11-14 07:43:02,489:INFO: Weight doesn't exsits. /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base/cross_pytorch_model.bin
2024-11-14 07:43:02,489:WARNING: Stage-One:True, Stage-Two:False
2024-11-14 07:43:02,489:WARNING: Test retrieval by loose type.
2024-11-14 07:43:02,490:WARNING: 	 embed_dim: 512
2024-11-14 07:43:02,490:WARNING: 	 image_resolution: 224
2024-11-14 07:43:02,490:WARNING: 	 vision_layers: 12
2024-11-14 07:43:02,490:WARNING: 	 vision_width: 768
2024-11-14 07:43:02,490:WARNING: 	 vision_patch_size: 32
2024-11-14 07:43:02,490:WARNING: 	 context_length: 77
2024-11-14 07:43:02,490:WARNING: 	 vocab_size: 49408
2024-11-14 07:43:02,490:WARNING: 	 transformer_width: 512
2024-11-14 07:43:02,490:WARNING: 	 transformer_heads: 8
2024-11-14 07:43:02,490:WARNING: 	 transformer_layers: 12
2024-11-14 07:43:02,490:WARNING: 		 linear_patch: 2d
2024-11-14 07:43:02,491:WARNING: 	 cut_top_layer: 0
2024-11-14 07:43:04,200:WARNING: 	 sim_header: Filip
2024-11-14 07:43:11,255:INFO: --------------------
2024-11-14 07:43:11,257:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-11-14 07:43:11,339:INFO: ***** Running test *****
2024-11-14 07:43:11,339:INFO:   Num examples = 642
2024-11-14 07:43:11,339:INFO:   Batch size = 256
2024-11-14 07:43:11,339:INFO:   Num steps = 3
2024-11-14 07:43:11,911:WARNING: Eval under the multi-sentence per video clip setting.
2024-11-14 07:43:11,911:WARNING: sentence num: 642, video num: 642
2024-11-14 07:43:14,024:INFO: before reshape, sim matrix size: 642 x 642
2024-11-14 07:43:14,441:INFO: after reshape, sim matrix size: 642 x 1 x 642
2024-11-14 07:43:14,589:INFO: Mix_Text-to-Video:
2024-11-14 07:43:14,590:INFO: 	>>>  R@1: 69.5 - R@5: 86.6 - R@10: 92.1 - Median R: 1.0 - Mean R: 5.2
2024-11-14 07:43:14,590:INFO: Mix_Video-to-Text:
2024-11-14 07:43:14,590:INFO: 	>>>  V2T$R@1: 70.1 - V2T$R@5: 87.9 - V2T$R@10: 92.7 - V2T$Median R: 1.0 - V2T$Mean R: 5.8
2024-11-14 07:46:06,890:INFO: Effective parameters:
2024-11-14 07:46:06,890:INFO:   <<< alpha: 0.9
2024-11-14 07:46:06,890:INFO:   <<< aug_choose: t2v
2024-11-14 07:46:06,890:INFO:   <<< batch_size: 512
2024-11-14 07:46:06,890:INFO:   <<< batch_size_val: 256
2024-11-14 07:46:06,890:INFO:   <<< cache_dir: 
2024-11-14 07:46:06,890:INFO:   <<< cla_weight_dir: cla_weight
2024-11-14 07:46:06,890:INFO:   <<< coef_lr: 1.0
2024-11-14 07:46:06,891:INFO:   <<< combine_type: sum
2024-11-14 07:46:06,891:INFO:   <<< cross_att_layers: 1
2024-11-14 07:46:06,891:INFO:   <<< cross_model: cross-base
2024-11-14 07:46:06,891:INFO:   <<< cross_num_hidden_layers: 4
2024-11-14 07:46:06,891:INFO:   <<< data_path: data_ph
2024-11-14 07:46:06,891:INFO:   <<< datatype: ph
2024-11-14 07:46:06,891:INFO:   <<< debug: False
2024-11-14 07:46:06,891:INFO:   <<< distributed: True
2024-11-14 07:46:06,891:INFO:   <<< do_eval: True
2024-11-14 07:46:06,891:INFO:   <<< do_lower_case: False
2024-11-14 07:46:06,891:INFO:   <<< do_pretrain: False
2024-11-14 07:46:06,891:INFO:   <<< do_train: False
2024-11-14 07:46:06,891:INFO:   <<< dual_mix: 0.5
2024-11-14 07:46:06,891:INFO:   <<< epochs: 200
2024-11-14 07:46:06,891:INFO:   <<< eval_frame_order: 0
2024-11-14 07:46:06,892:INFO:   <<< expand_msrvtt_sentences: False
2024-11-14 07:46:06,892:INFO:   <<< feature_framerate: 1
2024-11-14 07:46:06,892:INFO:   <<< feature_len: 64
2024-11-14 07:46:06,892:INFO:   <<< features_path: sign_feature/ph_domain_agnostic
2024-11-14 07:46:06,892:INFO:   <<< features_path_retrain: sign_feature/ph_domain_aware
2024-11-14 07:46:06,892:INFO:   <<< fp16: True
2024-11-14 07:46:06,892:INFO:   <<< fp16_opt_level: O1
2024-11-14 07:46:06,892:INFO:   <<< freeze_layer_num: 0
2024-11-14 07:46:06,892:INFO:   <<< gpu_ids: [0, 1]
2024-11-14 07:46:06,892:INFO:   <<< gradient_accumulation_steps: 1
2024-11-14 07:46:06,892:INFO:   <<< hard_negative_rate: 0.5
2024-11-14 07:46:06,892:INFO:   <<< init_model: chpt/ph_sota.pth
2024-11-14 07:46:06,892:INFO:   <<< linear_patch: 2d
2024-11-14 07:46:06,892:INFO:   <<< local_rank: 0
2024-11-14 07:46:06,892:INFO:   <<< loose_type: True
2024-11-14 07:46:06,893:INFO:   <<< lr: 1e-05
2024-11-14 07:46:06,893:INFO:   <<< lr_decay: 0.001
2024-11-14 07:46:06,893:INFO:   <<< margin: 0.1
2024-11-14 07:46:06,893:INFO:   <<< max_frames: 128
2024-11-14 07:46:06,893:INFO:   <<< max_words: 32
2024-11-14 07:46:06,893:INFO:   <<< mix_design: balance
2024-11-14 07:46:06,893:INFO:   <<< n_display: 1
2024-11-14 07:46:06,893:INFO:   <<< n_gpu: 1
2024-11-14 07:46:06,893:INFO:   <<< n_pair: 1
2024-11-14 07:46:06,893:INFO:   <<< negative_weighting: 1
2024-11-14 07:46:06,893:INFO:   <<< not_load_visual: False
2024-11-14 07:46:06,893:INFO:   <<< num_thread_reader: 8
2024-11-14 07:46:06,893:INFO:   <<< output_dir: new_experiment
2024-11-14 07:46:06,893:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-11-14 07:46:06,893:INFO:   <<< rank: 0
2024-11-14 07:46:06,893:INFO:   <<< resume_model: None
2024-11-14 07:46:06,894:INFO:   <<< sampled_use_mil: False
2024-11-14 07:46:06,894:INFO:   <<< seed: 42
2024-11-14 07:46:06,894:INFO:   <<< sim_calcu: softmax_max
2024-11-14 07:46:06,894:INFO:   <<< sim_header: Filip
2024-11-14 07:46:06,894:INFO:   <<< slice_framepos: 0
2024-11-14 07:46:06,894:INFO:   <<< task_type: retrieval
2024-11-14 07:46:06,894:INFO:   <<< tau: 0.07
2024-11-14 07:46:06,894:INFO:   <<< text_aug: True
2024-11-14 07:46:06,894:INFO:   <<< text_aug_choosen: random_swap
2024-11-14 07:46:06,894:INFO:   <<< text_num_hidden_layers: 12
2024-11-14 07:46:06,894:INFO:   <<< train_frame_order: 0
2024-11-14 07:46:06,894:INFO:   <<< use_mil: False
2024-11-14 07:46:06,894:INFO:   <<< video_dim: 1024
2024-11-14 07:46:06,894:INFO:   <<< visual_num_hidden_layers: 12
2024-11-14 07:46:06,894:INFO:   <<< warmup_proportion: 0.1
2024-11-14 07:46:06,894:INFO:   <<< world_size: 1
2024-11-14 07:46:06,895:INFO: device: cuda:0 n_gpu: 1
2024-11-14 07:46:07,770:INFO: loading archive file /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base
2024-11-14 07:46:07,777:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-11-14 07:46:07,777:INFO: Weight doesn't exsits. /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base/cross_pytorch_model.bin
2024-11-14 07:46:07,777:WARNING: Stage-One:True, Stage-Two:False
2024-11-14 07:46:07,777:WARNING: Test retrieval by loose type.
2024-11-14 07:46:07,777:WARNING: 	 embed_dim: 512
2024-11-14 07:46:07,778:WARNING: 	 image_resolution: 224
2024-11-14 07:46:07,778:WARNING: 	 vision_layers: 12
2024-11-14 07:46:07,778:WARNING: 	 vision_width: 768
2024-11-14 07:46:07,778:WARNING: 	 vision_patch_size: 32
2024-11-14 07:46:07,778:WARNING: 	 context_length: 77
2024-11-14 07:46:07,778:WARNING: 	 vocab_size: 49408
2024-11-14 07:46:07,778:WARNING: 	 transformer_width: 512
2024-11-14 07:46:07,778:WARNING: 	 transformer_heads: 8
2024-11-14 07:46:07,778:WARNING: 	 transformer_layers: 12
2024-11-14 07:46:07,778:WARNING: 		 linear_patch: 2d
2024-11-14 07:46:07,778:WARNING: 	 cut_top_layer: 0
2024-11-14 07:46:09,257:WARNING: 	 sim_header: Filip
2024-11-14 07:46:16,395:INFO: --------------------
2024-11-14 07:46:16,397:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-11-14 07:46:16,472:INFO: ***** Running test *****
2024-11-14 07:46:16,472:INFO:   Num examples = 642
2024-11-14 07:46:16,472:INFO:   Batch size = 256
2024-11-14 07:46:16,472:INFO:   Num steps = 3
2024-11-14 07:46:16,772:WARNING: Eval under the multi-sentence per video clip setting.
2024-11-14 07:46:16,772:WARNING: sentence num: 642, video num: 642
2024-11-14 07:46:18,682:INFO: before reshape, sim matrix size: 642 x 642
2024-11-14 07:46:19,131:INFO: after reshape, sim matrix size: 642 x 1 x 642
2024-11-14 07:46:19,195:INFO: Mix_Text-to-Video:
2024-11-14 07:46:19,196:INFO: 	>>>  R@1: 69.5 - R@5: 86.6 - R@10: 92.1 - Median R: 1.0 - Mean R: 5.2
2024-11-14 07:46:19,196:INFO: Mix_Video-to-Text:
2024-11-14 07:46:19,196:INFO: 	>>>  V2T$R@1: 70.1 - V2T$R@5: 87.9 - V2T$R@10: 92.7 - V2T$Median R: 1.0 - V2T$Mean R: 5.8
2024-11-14 07:55:35,044:INFO: Effective parameters:
2024-11-14 07:55:35,044:INFO:   <<< alpha: 0.9
2024-11-14 07:55:35,044:INFO:   <<< aug_choose: t2v
2024-11-14 07:55:35,044:INFO:   <<< batch_size: 512
2024-11-14 07:55:35,044:INFO:   <<< batch_size_val: 256
2024-11-14 07:55:35,044:INFO:   <<< cache_dir: 
2024-11-14 07:55:35,044:INFO:   <<< cla_weight_dir: cla_weight
2024-11-14 07:55:35,044:INFO:   <<< coef_lr: 1.0
2024-11-14 07:55:35,044:INFO:   <<< combine_type: sum
2024-11-14 07:55:35,044:INFO:   <<< cross_att_layers: 1
2024-11-14 07:55:35,044:INFO:   <<< cross_model: cross-base
2024-11-14 07:55:35,044:INFO:   <<< cross_num_hidden_layers: 4
2024-11-14 07:55:35,044:INFO:   <<< data_path: data_ph
2024-11-14 07:55:35,044:INFO:   <<< datatype: ph
2024-11-14 07:55:35,044:INFO:   <<< debug: False
2024-11-14 07:55:35,044:INFO:   <<< distributed: True
2024-11-14 07:55:35,045:INFO:   <<< do_eval: True
2024-11-14 07:55:35,045:INFO:   <<< do_lower_case: False
2024-11-14 07:55:35,045:INFO:   <<< do_pretrain: False
2024-11-14 07:55:35,045:INFO:   <<< do_train: False
2024-11-14 07:55:35,045:INFO:   <<< dual_mix: 0.5
2024-11-14 07:55:35,045:INFO:   <<< epochs: 200
2024-11-14 07:55:35,045:INFO:   <<< eval_frame_order: 0
2024-11-14 07:55:35,045:INFO:   <<< expand_msrvtt_sentences: False
2024-11-14 07:55:35,045:INFO:   <<< feature_framerate: 1
2024-11-14 07:55:35,045:INFO:   <<< feature_len: 64
2024-11-14 07:55:35,045:INFO:   <<< features_path: sign_feature/ph_domain_agnostic
2024-11-14 07:55:35,045:INFO:   <<< features_path_retrain: sign_feature/ph_domain_aware
2024-11-14 07:55:35,045:INFO:   <<< fp16: True
2024-11-14 07:55:35,045:INFO:   <<< fp16_opt_level: O1
2024-11-14 07:55:35,045:INFO:   <<< freeze_layer_num: 0
2024-11-14 07:55:35,045:INFO:   <<< gpu_ids: [0, 1]
2024-11-14 07:55:35,045:INFO:   <<< gradient_accumulation_steps: 1
2024-11-14 07:55:35,045:INFO:   <<< hard_negative_rate: 0.5
2024-11-14 07:55:35,045:INFO:   <<< init_model: chpt/ph_sota.pth
2024-11-14 07:55:35,045:INFO:   <<< linear_patch: 2d
2024-11-14 07:55:35,045:INFO:   <<< local_rank: 0
2024-11-14 07:55:35,045:INFO:   <<< loose_type: True
2024-11-14 07:55:35,045:INFO:   <<< lr: 1e-05
2024-11-14 07:55:35,045:INFO:   <<< lr_decay: 0.001
2024-11-14 07:55:35,045:INFO:   <<< margin: 0.1
2024-11-14 07:55:35,045:INFO:   <<< max_frames: 128
2024-11-14 07:55:35,045:INFO:   <<< max_words: 32
2024-11-14 07:55:35,045:INFO:   <<< mix_design: balance
2024-11-14 07:55:35,045:INFO:   <<< n_display: 1
2024-11-14 07:55:35,045:INFO:   <<< n_gpu: 1
2024-11-14 07:55:35,045:INFO:   <<< n_pair: 1
2024-11-14 07:55:35,046:INFO:   <<< negative_weighting: 1
2024-11-14 07:55:35,046:INFO:   <<< not_load_visual: False
2024-11-14 07:55:35,046:INFO:   <<< num_thread_reader: 8
2024-11-14 07:55:35,046:INFO:   <<< output_dir: new_experiment
2024-11-14 07:55:35,046:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-11-14 07:55:35,046:INFO:   <<< rank: 0
2024-11-14 07:55:35,046:INFO:   <<< resume_model: None
2024-11-14 07:55:35,046:INFO:   <<< sampled_use_mil: False
2024-11-14 07:55:35,046:INFO:   <<< seed: 42
2024-11-14 07:55:35,046:INFO:   <<< sim_calcu: softmax_max
2024-11-14 07:55:35,046:INFO:   <<< sim_header: Filip
2024-11-14 07:55:35,046:INFO:   <<< slice_framepos: 0
2024-11-14 07:55:35,046:INFO:   <<< task_type: retrieval
2024-11-14 07:55:35,046:INFO:   <<< tau: 0.07
2024-11-14 07:55:35,046:INFO:   <<< text_aug: True
2024-11-14 07:55:35,046:INFO:   <<< text_aug_choosen: random_swap
2024-11-14 07:55:35,046:INFO:   <<< text_num_hidden_layers: 12
2024-11-14 07:55:35,046:INFO:   <<< train_frame_order: 0
2024-11-14 07:55:35,046:INFO:   <<< use_mil: False
2024-11-14 07:55:35,046:INFO:   <<< video_dim: 1024
2024-11-14 07:55:35,046:INFO:   <<< visual_num_hidden_layers: 12
2024-11-14 07:55:35,046:INFO:   <<< warmup_proportion: 0.1
2024-11-14 07:55:35,046:INFO:   <<< world_size: 1
2024-11-14 07:55:35,047:INFO: device: cuda:0 n_gpu: 1
2024-11-14 07:55:36,081:INFO: loading archive file /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base
2024-11-14 07:55:36,083:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-11-14 07:55:36,083:INFO: Weight doesn't exsits. /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base/cross_pytorch_model.bin
2024-11-14 07:55:36,083:WARNING: Stage-One:True, Stage-Two:False
2024-11-14 07:55:36,083:WARNING: Test retrieval by loose type.
2024-11-14 07:55:36,083:WARNING: 	 embed_dim: 512
2024-11-14 07:55:36,083:WARNING: 	 image_resolution: 224
2024-11-14 07:55:36,083:WARNING: 	 vision_layers: 12
2024-11-14 07:55:36,083:WARNING: 	 vision_width: 768
2024-11-14 07:55:36,084:WARNING: 	 vision_patch_size: 32
2024-11-14 07:55:36,084:WARNING: 	 context_length: 77
2024-11-14 07:55:36,084:WARNING: 	 vocab_size: 49408
2024-11-14 07:55:36,084:WARNING: 	 transformer_width: 512
2024-11-14 07:55:36,084:WARNING: 	 transformer_heads: 8
2024-11-14 07:55:36,084:WARNING: 	 transformer_layers: 12
2024-11-14 07:55:36,084:WARNING: 		 linear_patch: 2d
2024-11-14 07:55:36,084:WARNING: 	 cut_top_layer: 0
2024-11-14 07:55:37,508:WARNING: 	 sim_header: Filip
2024-11-14 07:55:44,743:INFO: --------------------
2024-11-14 07:55:44,744:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-11-14 07:55:44,899:INFO: ***** Running test *****
2024-11-14 07:55:44,899:INFO:   Num examples = 642
2024-11-14 07:55:44,899:INFO:   Batch size = 256
2024-11-14 07:55:44,899:INFO:   Num steps = 3
2024-11-14 07:55:45,108:WARNING: Eval under the multi-sentence per video clip setting.
2024-11-14 07:55:45,108:WARNING: sentence num: 642, video num: 642
2024-11-14 07:55:47,044:INFO: before reshape, sim matrix size: 642 x 642
2024-11-14 07:56:33,629:INFO: Effective parameters:
2024-11-14 07:56:33,629:INFO:   <<< alpha: 0.9
2024-11-14 07:56:33,629:INFO:   <<< aug_choose: t2v
2024-11-14 07:56:33,629:INFO:   <<< batch_size: 512
2024-11-14 07:56:33,629:INFO:   <<< batch_size_val: 256
2024-11-14 07:56:33,629:INFO:   <<< cache_dir: 
2024-11-14 07:56:33,629:INFO:   <<< cla_weight_dir: cla_weight
2024-11-14 07:56:33,629:INFO:   <<< coef_lr: 1.0
2024-11-14 07:56:33,629:INFO:   <<< combine_type: sum
2024-11-14 07:56:33,629:INFO:   <<< cross_att_layers: 1
2024-11-14 07:56:33,629:INFO:   <<< cross_model: cross-base
2024-11-14 07:56:33,629:INFO:   <<< cross_num_hidden_layers: 4
2024-11-14 07:56:33,629:INFO:   <<< data_path: data_ph
2024-11-14 07:56:33,629:INFO:   <<< datatype: ph
2024-11-14 07:56:33,630:INFO:   <<< debug: False
2024-11-14 07:56:33,630:INFO:   <<< distributed: True
2024-11-14 07:56:33,630:INFO:   <<< do_eval: True
2024-11-14 07:56:33,630:INFO:   <<< do_lower_case: False
2024-11-14 07:56:33,630:INFO:   <<< do_pretrain: False
2024-11-14 07:56:33,630:INFO:   <<< do_train: False
2024-11-14 07:56:33,630:INFO:   <<< dual_mix: 0.5
2024-11-14 07:56:33,630:INFO:   <<< epochs: 200
2024-11-14 07:56:33,630:INFO:   <<< eval_frame_order: 0
2024-11-14 07:56:33,630:INFO:   <<< expand_msrvtt_sentences: False
2024-11-14 07:56:33,630:INFO:   <<< feature_framerate: 1
2024-11-14 07:56:33,630:INFO:   <<< feature_len: 64
2024-11-14 07:56:33,630:INFO:   <<< features_path: sign_feature/ph_domain_agnostic
2024-11-14 07:56:33,630:INFO:   <<< features_path_retrain: sign_feature/ph_domain_aware
2024-11-14 07:56:33,630:INFO:   <<< fp16: True
2024-11-14 07:56:33,630:INFO:   <<< fp16_opt_level: O1
2024-11-14 07:56:33,630:INFO:   <<< freeze_layer_num: 0
2024-11-14 07:56:33,630:INFO:   <<< gpu_ids: [0, 1]
2024-11-14 07:56:33,630:INFO:   <<< gradient_accumulation_steps: 1
2024-11-14 07:56:33,630:INFO:   <<< hard_negative_rate: 0.5
2024-11-14 07:56:33,630:INFO:   <<< init_model: chpt/ph_sota.pth
2024-11-14 07:56:33,630:INFO:   <<< linear_patch: 2d
2024-11-14 07:56:33,630:INFO:   <<< local_rank: 0
2024-11-14 07:56:33,630:INFO:   <<< loose_type: True
2024-11-14 07:56:33,630:INFO:   <<< lr: 1e-05
2024-11-14 07:56:33,630:INFO:   <<< lr_decay: 0.001
2024-11-14 07:56:33,630:INFO:   <<< margin: 0.1
2024-11-14 07:56:33,630:INFO:   <<< max_frames: 128
2024-11-14 07:56:33,630:INFO:   <<< max_words: 32
2024-11-14 07:56:33,630:INFO:   <<< mix_design: balance
2024-11-14 07:56:33,630:INFO:   <<< n_display: 1
2024-11-14 07:56:33,630:INFO:   <<< n_gpu: 1
2024-11-14 07:56:33,630:INFO:   <<< n_pair: 1
2024-11-14 07:56:33,631:INFO:   <<< negative_weighting: 1
2024-11-14 07:56:33,631:INFO:   <<< not_load_visual: False
2024-11-14 07:56:33,631:INFO:   <<< num_thread_reader: 8
2024-11-14 07:56:33,631:INFO:   <<< output_dir: new_experiment
2024-11-14 07:56:33,631:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-11-14 07:56:33,631:INFO:   <<< rank: 0
2024-11-14 07:56:33,631:INFO:   <<< resume_model: None
2024-11-14 07:56:33,631:INFO:   <<< sampled_use_mil: False
2024-11-14 07:56:33,631:INFO:   <<< seed: 42
2024-11-14 07:56:33,631:INFO:   <<< sim_calcu: softmax_max
2024-11-14 07:56:33,631:INFO:   <<< sim_header: Filip
2024-11-14 07:56:33,631:INFO:   <<< slice_framepos: 0
2024-11-14 07:56:33,631:INFO:   <<< task_type: retrieval
2024-11-14 07:56:33,631:INFO:   <<< tau: 0.07
2024-11-14 07:56:33,631:INFO:   <<< text_aug: True
2024-11-14 07:56:33,631:INFO:   <<< text_aug_choosen: random_swap
2024-11-14 07:56:33,631:INFO:   <<< text_num_hidden_layers: 12
2024-11-14 07:56:33,631:INFO:   <<< train_frame_order: 0
2024-11-14 07:56:33,631:INFO:   <<< use_mil: False
2024-11-14 07:56:33,631:INFO:   <<< video_dim: 1024
2024-11-14 07:56:33,631:INFO:   <<< visual_num_hidden_layers: 12
2024-11-14 07:56:33,631:INFO:   <<< warmup_proportion: 0.1
2024-11-14 07:56:33,631:INFO:   <<< world_size: 1
2024-11-14 07:56:33,631:INFO: device: cuda:0 n_gpu: 1
2024-11-14 07:56:34,535:INFO: loading archive file /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base
2024-11-14 07:56:34,536:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-11-14 07:56:34,536:INFO: Weight doesn't exsits. /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base/cross_pytorch_model.bin
2024-11-14 07:56:34,536:WARNING: Stage-One:True, Stage-Two:False
2024-11-14 07:56:34,536:WARNING: Test retrieval by loose type.
2024-11-14 07:56:34,536:WARNING: 	 embed_dim: 512
2024-11-14 07:56:34,537:WARNING: 	 image_resolution: 224
2024-11-14 07:56:34,537:WARNING: 	 vision_layers: 12
2024-11-14 07:56:34,537:WARNING: 	 vision_width: 768
2024-11-14 07:56:34,537:WARNING: 	 vision_patch_size: 32
2024-11-14 07:56:34,537:WARNING: 	 context_length: 77
2024-11-14 07:56:34,537:WARNING: 	 vocab_size: 49408
2024-11-14 07:56:34,537:WARNING: 	 transformer_width: 512
2024-11-14 07:56:34,537:WARNING: 	 transformer_heads: 8
2024-11-14 07:56:34,537:WARNING: 	 transformer_layers: 12
2024-11-14 07:56:34,537:WARNING: 		 linear_patch: 2d
2024-11-14 07:56:34,537:WARNING: 	 cut_top_layer: 0
2024-11-14 07:56:35,865:WARNING: 	 sim_header: Filip
2024-11-14 07:56:42,913:INFO: --------------------
2024-11-14 07:56:42,914:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-11-14 07:56:43,081:INFO: ***** Running test *****
2024-11-14 07:56:43,081:INFO:   Num examples = 642
2024-11-14 07:56:43,081:INFO:   Batch size = 256
2024-11-14 07:56:43,081:INFO:   Num steps = 3
2024-11-14 07:56:43,276:WARNING: Eval under the multi-sentence per video clip setting.
2024-11-14 07:56:43,276:WARNING: sentence num: 642, video num: 642
2024-11-14 07:56:44,720:INFO: before reshape, sim matrix size: 642 x 642
2024-11-14 07:57:21,479:INFO: Effective parameters:
2024-11-14 07:57:21,480:INFO:   <<< alpha: 0.9
2024-11-14 07:57:21,480:INFO:   <<< aug_choose: t2v
2024-11-14 07:57:21,480:INFO:   <<< batch_size: 512
2024-11-14 07:57:21,480:INFO:   <<< batch_size_val: 256
2024-11-14 07:57:21,480:INFO:   <<< cache_dir: 
2024-11-14 07:57:21,480:INFO:   <<< cla_weight_dir: cla_weight
2024-11-14 07:57:21,480:INFO:   <<< coef_lr: 1.0
2024-11-14 07:57:21,480:INFO:   <<< combine_type: sum
2024-11-14 07:57:21,480:INFO:   <<< cross_att_layers: 1
2024-11-14 07:57:21,480:INFO:   <<< cross_model: cross-base
2024-11-14 07:57:21,480:INFO:   <<< cross_num_hidden_layers: 4
2024-11-14 07:57:21,480:INFO:   <<< data_path: data_ph
2024-11-14 07:57:21,480:INFO:   <<< datatype: ph
2024-11-14 07:57:21,480:INFO:   <<< debug: False
2024-11-14 07:57:21,480:INFO:   <<< distributed: True
2024-11-14 07:57:21,480:INFO:   <<< do_eval: True
2024-11-14 07:57:21,480:INFO:   <<< do_lower_case: False
2024-11-14 07:57:21,480:INFO:   <<< do_pretrain: False
2024-11-14 07:57:21,480:INFO:   <<< do_train: False
2024-11-14 07:57:21,480:INFO:   <<< dual_mix: 0.5
2024-11-14 07:57:21,480:INFO:   <<< epochs: 200
2024-11-14 07:57:21,480:INFO:   <<< eval_frame_order: 0
2024-11-14 07:57:21,480:INFO:   <<< expand_msrvtt_sentences: False
2024-11-14 07:57:21,480:INFO:   <<< feature_framerate: 1
2024-11-14 07:57:21,480:INFO:   <<< feature_len: 64
2024-11-14 07:57:21,480:INFO:   <<< features_path: sign_feature/ph_domain_agnostic
2024-11-14 07:57:21,480:INFO:   <<< features_path_retrain: sign_feature/ph_domain_aware
2024-11-14 07:57:21,481:INFO:   <<< fp16: True
2024-11-14 07:57:21,481:INFO:   <<< fp16_opt_level: O1
2024-11-14 07:57:21,481:INFO:   <<< freeze_layer_num: 0
2024-11-14 07:57:21,481:INFO:   <<< gpu_ids: [0, 1]
2024-11-14 07:57:21,481:INFO:   <<< gradient_accumulation_steps: 1
2024-11-14 07:57:21,481:INFO:   <<< hard_negative_rate: 0.5
2024-11-14 07:57:21,481:INFO:   <<< init_model: chpt/ph_sota.pth
2024-11-14 07:57:21,481:INFO:   <<< linear_patch: 2d
2024-11-14 07:57:21,481:INFO:   <<< local_rank: 0
2024-11-14 07:57:21,481:INFO:   <<< loose_type: True
2024-11-14 07:57:21,481:INFO:   <<< lr: 1e-05
2024-11-14 07:57:21,481:INFO:   <<< lr_decay: 0.001
2024-11-14 07:57:21,481:INFO:   <<< margin: 0.1
2024-11-14 07:57:21,481:INFO:   <<< max_frames: 128
2024-11-14 07:57:21,481:INFO:   <<< max_words: 32
2024-11-14 07:57:21,481:INFO:   <<< mix_design: balance
2024-11-14 07:57:21,481:INFO:   <<< n_display: 1
2024-11-14 07:57:21,481:INFO:   <<< n_gpu: 1
2024-11-14 07:57:21,481:INFO:   <<< n_pair: 1
2024-11-14 07:57:21,481:INFO:   <<< negative_weighting: 1
2024-11-14 07:57:21,481:INFO:   <<< not_load_visual: False
2024-11-14 07:57:21,481:INFO:   <<< num_thread_reader: 8
2024-11-14 07:57:21,481:INFO:   <<< output_dir: new_experiment
2024-11-14 07:57:21,481:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-11-14 07:57:21,481:INFO:   <<< rank: 0
2024-11-14 07:57:21,481:INFO:   <<< resume_model: None
2024-11-14 07:57:21,481:INFO:   <<< sampled_use_mil: False
2024-11-14 07:57:21,481:INFO:   <<< seed: 42
2024-11-14 07:57:21,481:INFO:   <<< sim_calcu: softmax_max
2024-11-14 07:57:21,481:INFO:   <<< sim_header: Filip
2024-11-14 07:57:21,481:INFO:   <<< slice_framepos: 0
2024-11-14 07:57:21,481:INFO:   <<< task_type: retrieval
2024-11-14 07:57:21,481:INFO:   <<< tau: 0.07
2024-11-14 07:57:21,481:INFO:   <<< text_aug: True
2024-11-14 07:57:21,481:INFO:   <<< text_aug_choosen: random_swap
2024-11-14 07:57:21,481:INFO:   <<< text_num_hidden_layers: 12
2024-11-14 07:57:21,482:INFO:   <<< train_frame_order: 0
2024-11-14 07:57:21,482:INFO:   <<< use_mil: False
2024-11-14 07:57:21,482:INFO:   <<< video_dim: 1024
2024-11-14 07:57:21,482:INFO:   <<< visual_num_hidden_layers: 12
2024-11-14 07:57:21,482:INFO:   <<< warmup_proportion: 0.1
2024-11-14 07:57:21,482:INFO:   <<< world_size: 1
2024-11-14 07:57:21,482:INFO: device: cuda:0 n_gpu: 1
2024-11-14 07:57:22,379:INFO: loading archive file /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base
2024-11-14 07:57:22,380:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-11-14 07:57:22,380:INFO: Weight doesn't exsits. /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base/cross_pytorch_model.bin
2024-11-14 07:57:22,381:WARNING: Stage-One:True, Stage-Two:False
2024-11-14 07:57:22,381:WARNING: Test retrieval by loose type.
2024-11-14 07:57:22,381:WARNING: 	 embed_dim: 512
2024-11-14 07:57:22,381:WARNING: 	 image_resolution: 224
2024-11-14 07:57:22,381:WARNING: 	 vision_layers: 12
2024-11-14 07:57:22,381:WARNING: 	 vision_width: 768
2024-11-14 07:57:22,381:WARNING: 	 vision_patch_size: 32
2024-11-14 07:57:22,381:WARNING: 	 context_length: 77
2024-11-14 07:57:22,381:WARNING: 	 vocab_size: 49408
2024-11-14 07:57:22,381:WARNING: 	 transformer_width: 512
2024-11-14 07:57:22,381:WARNING: 	 transformer_heads: 8
2024-11-14 07:57:22,381:WARNING: 	 transformer_layers: 12
2024-11-14 07:57:22,381:WARNING: 		 linear_patch: 2d
2024-11-14 07:57:22,381:WARNING: 	 cut_top_layer: 0
2024-11-14 07:57:23,720:WARNING: 	 sim_header: Filip
2024-11-14 07:57:31,100:INFO: --------------------
2024-11-14 07:57:31,105:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-11-14 07:57:31,219:INFO: ***** Running test *****
2024-11-14 07:57:31,220:INFO:   Num examples = 642
2024-11-14 07:57:31,220:INFO:   Batch size = 256
2024-11-14 07:57:31,220:INFO:   Num steps = 3
2024-11-14 07:57:31,465:WARNING: Eval under the multi-sentence per video clip setting.
2024-11-14 07:57:31,465:WARNING: sentence num: 642, video num: 642
2024-11-14 07:57:33,230:INFO: before reshape, sim matrix size: 642 x 642
2024-11-14 07:57:33,341:INFO: after reshape, sim matrix size: 642 x 1 x 642
2024-11-14 07:57:33,415:INFO: Mix_Text-to-Video:
2024-11-14 07:57:33,415:INFO: 	>>>  R@1: 69.5 - R@5: 86.6 - R@10: 92.1 - Median R: 1.0 - Mean R: 5.2
2024-11-14 07:57:33,415:INFO: Mix_Video-to-Text:
2024-11-14 07:57:33,415:INFO: 	>>>  V2T$R@1: 70.1 - V2T$R@5: 87.9 - V2T$R@10: 92.7 - V2T$Median R: 1.0 - V2T$Mean R: 5.8
2024-11-14 07:59:06,605:INFO: Effective parameters:
2024-11-14 07:59:06,605:INFO:   <<< alpha: 0.9
2024-11-14 07:59:06,605:INFO:   <<< aug_choose: t2v
2024-11-14 07:59:06,605:INFO:   <<< batch_size: 512
2024-11-14 07:59:06,605:INFO:   <<< batch_size_val: 256
2024-11-14 07:59:06,605:INFO:   <<< cache_dir: 
2024-11-14 07:59:06,605:INFO:   <<< cla_weight_dir: cla_weight
2024-11-14 07:59:06,605:INFO:   <<< coef_lr: 1.0
2024-11-14 07:59:06,605:INFO:   <<< combine_type: sum
2024-11-14 07:59:06,606:INFO:   <<< cross_att_layers: 1
2024-11-14 07:59:06,606:INFO:   <<< cross_model: cross-base
2024-11-14 07:59:06,606:INFO:   <<< cross_num_hidden_layers: 4
2024-11-14 07:59:06,606:INFO:   <<< data_path: data_ph
2024-11-14 07:59:06,606:INFO:   <<< datatype: ph
2024-11-14 07:59:06,606:INFO:   <<< debug: False
2024-11-14 07:59:06,606:INFO:   <<< distributed: True
2024-11-14 07:59:06,606:INFO:   <<< do_eval: True
2024-11-14 07:59:06,606:INFO:   <<< do_lower_case: False
2024-11-14 07:59:06,606:INFO:   <<< do_pretrain: False
2024-11-14 07:59:06,606:INFO:   <<< do_train: False
2024-11-14 07:59:06,606:INFO:   <<< dual_mix: 0.5
2024-11-14 07:59:06,606:INFO:   <<< epochs: 200
2024-11-14 07:59:06,606:INFO:   <<< eval_frame_order: 0
2024-11-14 07:59:06,606:INFO:   <<< expand_msrvtt_sentences: False
2024-11-14 07:59:06,606:INFO:   <<< feature_framerate: 1
2024-11-14 07:59:06,606:INFO:   <<< feature_len: 64
2024-11-14 07:59:06,606:INFO:   <<< features_path: sign_feature/ph_domain_agnostic
2024-11-14 07:59:06,606:INFO:   <<< features_path_retrain: sign_feature/ph_domain_aware
2024-11-14 07:59:06,606:INFO:   <<< fp16: True
2024-11-14 07:59:06,606:INFO:   <<< fp16_opt_level: O1
2024-11-14 07:59:06,606:INFO:   <<< freeze_layer_num: 0
2024-11-14 07:59:06,606:INFO:   <<< gpu_ids: [0, 1]
2024-11-14 07:59:06,606:INFO:   <<< gradient_accumulation_steps: 1
2024-11-14 07:59:06,606:INFO:   <<< hard_negative_rate: 0.5
2024-11-14 07:59:06,606:INFO:   <<< init_model: chpt/ph_sota.pth
2024-11-14 07:59:06,606:INFO:   <<< linear_patch: 2d
2024-11-14 07:59:06,606:INFO:   <<< local_rank: 0
2024-11-14 07:59:06,606:INFO:   <<< loose_type: True
2024-11-14 07:59:06,606:INFO:   <<< lr: 1e-05
2024-11-14 07:59:06,606:INFO:   <<< lr_decay: 0.001
2024-11-14 07:59:06,607:INFO:   <<< margin: 0.1
2024-11-14 07:59:06,607:INFO:   <<< max_frames: 128
2024-11-14 07:59:06,607:INFO:   <<< max_words: 32
2024-11-14 07:59:06,607:INFO:   <<< mix_design: balance
2024-11-14 07:59:06,607:INFO:   <<< n_display: 1
2024-11-14 07:59:06,607:INFO:   <<< n_gpu: 1
2024-11-14 07:59:06,607:INFO:   <<< n_pair: 1
2024-11-14 07:59:06,607:INFO:   <<< negative_weighting: 1
2024-11-14 07:59:06,607:INFO:   <<< not_load_visual: False
2024-11-14 07:59:06,607:INFO:   <<< num_thread_reader: 8
2024-11-14 07:59:06,607:INFO:   <<< output_dir: new_experiment
2024-11-14 07:59:06,607:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-11-14 07:59:06,607:INFO:   <<< rank: 0
2024-11-14 07:59:06,607:INFO:   <<< resume_model: None
2024-11-14 07:59:06,607:INFO:   <<< sampled_use_mil: False
2024-11-14 07:59:06,607:INFO:   <<< seed: 42
2024-11-14 07:59:06,607:INFO:   <<< sim_calcu: softmax_max
2024-11-14 07:59:06,607:INFO:   <<< sim_header: Filip
2024-11-14 07:59:06,607:INFO:   <<< slice_framepos: 0
2024-11-14 07:59:06,607:INFO:   <<< task_type: retrieval
2024-11-14 07:59:06,607:INFO:   <<< tau: 0.07
2024-11-14 07:59:06,607:INFO:   <<< text_aug: True
2024-11-14 07:59:06,607:INFO:   <<< text_aug_choosen: random_swap
2024-11-14 07:59:06,607:INFO:   <<< text_num_hidden_layers: 12
2024-11-14 07:59:06,607:INFO:   <<< train_frame_order: 0
2024-11-14 07:59:06,607:INFO:   <<< use_mil: False
2024-11-14 07:59:06,607:INFO:   <<< video_dim: 1024
2024-11-14 07:59:06,607:INFO:   <<< visual_num_hidden_layers: 12
2024-11-14 07:59:06,607:INFO:   <<< warmup_proportion: 0.1
2024-11-14 07:59:06,607:INFO:   <<< world_size: 1
2024-11-14 07:59:06,608:INFO: device: cuda:0 n_gpu: 1
2024-11-14 07:59:07,675:INFO: loading archive file /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base
2024-11-14 07:59:07,676:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-11-14 07:59:07,677:INFO: Weight doesn't exsits. /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base/cross_pytorch_model.bin
2024-11-14 07:59:07,677:WARNING: Stage-One:True, Stage-Two:False
2024-11-14 07:59:07,677:WARNING: Test retrieval by loose type.
2024-11-14 07:59:07,677:WARNING: 	 embed_dim: 512
2024-11-14 07:59:07,677:WARNING: 	 image_resolution: 224
2024-11-14 07:59:07,677:WARNING: 	 vision_layers: 12
2024-11-14 07:59:07,677:WARNING: 	 vision_width: 768
2024-11-14 07:59:07,677:WARNING: 	 vision_patch_size: 32
2024-11-14 07:59:07,677:WARNING: 	 context_length: 77
2024-11-14 07:59:07,677:WARNING: 	 vocab_size: 49408
2024-11-14 07:59:07,677:WARNING: 	 transformer_width: 512
2024-11-14 07:59:07,677:WARNING: 	 transformer_heads: 8
2024-11-14 07:59:07,677:WARNING: 	 transformer_layers: 12
2024-11-14 07:59:07,677:WARNING: 		 linear_patch: 2d
2024-11-14 07:59:07,677:WARNING: 	 cut_top_layer: 0
2024-11-14 07:59:09,062:WARNING: 	 sim_header: Filip
2024-11-14 07:59:16,233:INFO: --------------------
2024-11-14 07:59:16,234:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-11-14 07:59:16,313:INFO: ***** Running test *****
2024-11-14 07:59:16,313:INFO:   Num examples = 642
2024-11-14 07:59:16,313:INFO:   Batch size = 256
2024-11-14 07:59:16,313:INFO:   Num steps = 3
2024-11-14 07:59:16,542:WARNING: Eval under the multi-sentence per video clip setting.
2024-11-14 07:59:16,542:WARNING: sentence num: 642, video num: 642
2024-11-14 07:59:35,238:INFO: Effective parameters:
2024-11-14 07:59:35,238:INFO:   <<< alpha: 0.9
2024-11-14 07:59:35,238:INFO:   <<< aug_choose: t2v
2024-11-14 07:59:35,238:INFO:   <<< batch_size: 512
2024-11-14 07:59:35,238:INFO:   <<< batch_size_val: 256
2024-11-14 07:59:35,238:INFO:   <<< cache_dir: 
2024-11-14 07:59:35,238:INFO:   <<< cla_weight_dir: cla_weight
2024-11-14 07:59:35,238:INFO:   <<< coef_lr: 1.0
2024-11-14 07:59:35,238:INFO:   <<< combine_type: sum
2024-11-14 07:59:35,238:INFO:   <<< cross_att_layers: 1
2024-11-14 07:59:35,239:INFO:   <<< cross_model: cross-base
2024-11-14 07:59:35,239:INFO:   <<< cross_num_hidden_layers: 4
2024-11-14 07:59:35,239:INFO:   <<< data_path: data_ph
2024-11-14 07:59:35,239:INFO:   <<< datatype: ph
2024-11-14 07:59:35,239:INFO:   <<< debug: False
2024-11-14 07:59:35,239:INFO:   <<< distributed: True
2024-11-14 07:59:35,239:INFO:   <<< do_eval: True
2024-11-14 07:59:35,239:INFO:   <<< do_lower_case: False
2024-11-14 07:59:35,239:INFO:   <<< do_pretrain: False
2024-11-14 07:59:35,239:INFO:   <<< do_train: False
2024-11-14 07:59:35,239:INFO:   <<< dual_mix: 0.5
2024-11-14 07:59:35,239:INFO:   <<< epochs: 200
2024-11-14 07:59:35,239:INFO:   <<< eval_frame_order: 0
2024-11-14 07:59:35,239:INFO:   <<< expand_msrvtt_sentences: False
2024-11-14 07:59:35,239:INFO:   <<< feature_framerate: 1
2024-11-14 07:59:35,239:INFO:   <<< feature_len: 64
2024-11-14 07:59:35,239:INFO:   <<< features_path: sign_feature/ph_domain_agnostic
2024-11-14 07:59:35,239:INFO:   <<< features_path_retrain: sign_feature/ph_domain_aware
2024-11-14 07:59:35,239:INFO:   <<< fp16: True
2024-11-14 07:59:35,239:INFO:   <<< fp16_opt_level: O1
2024-11-14 07:59:35,239:INFO:   <<< freeze_layer_num: 0
2024-11-14 07:59:35,239:INFO:   <<< gpu_ids: [0, 1]
2024-11-14 07:59:35,239:INFO:   <<< gradient_accumulation_steps: 1
2024-11-14 07:59:35,239:INFO:   <<< hard_negative_rate: 0.5
2024-11-14 07:59:35,239:INFO:   <<< init_model: chpt/ph_sota.pth
2024-11-14 07:59:35,239:INFO:   <<< linear_patch: 2d
2024-11-14 07:59:35,239:INFO:   <<< local_rank: 0
2024-11-14 07:59:35,239:INFO:   <<< loose_type: True
2024-11-14 07:59:35,239:INFO:   <<< lr: 1e-05
2024-11-14 07:59:35,240:INFO:   <<< lr_decay: 0.001
2024-11-14 07:59:35,240:INFO:   <<< margin: 0.1
2024-11-14 07:59:35,240:INFO:   <<< max_frames: 128
2024-11-14 07:59:35,240:INFO:   <<< max_words: 32
2024-11-14 07:59:35,240:INFO:   <<< mix_design: balance
2024-11-14 07:59:35,240:INFO:   <<< n_display: 1
2024-11-14 07:59:35,240:INFO:   <<< n_gpu: 1
2024-11-14 07:59:35,240:INFO:   <<< n_pair: 1
2024-11-14 07:59:35,240:INFO:   <<< negative_weighting: 1
2024-11-14 07:59:35,240:INFO:   <<< not_load_visual: False
2024-11-14 07:59:35,240:INFO:   <<< num_thread_reader: 8
2024-11-14 07:59:35,240:INFO:   <<< output_dir: new_experiment
2024-11-14 07:59:35,240:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-11-14 07:59:35,240:INFO:   <<< rank: 0
2024-11-14 07:59:35,240:INFO:   <<< resume_model: None
2024-11-14 07:59:35,240:INFO:   <<< sampled_use_mil: False
2024-11-14 07:59:35,240:INFO:   <<< seed: 42
2024-11-14 07:59:35,240:INFO:   <<< sim_calcu: softmax_max
2024-11-14 07:59:35,240:INFO:   <<< sim_header: Filip
2024-11-14 07:59:35,240:INFO:   <<< slice_framepos: 0
2024-11-14 07:59:35,240:INFO:   <<< task_type: retrieval
2024-11-14 07:59:35,240:INFO:   <<< tau: 0.07
2024-11-14 07:59:35,240:INFO:   <<< text_aug: True
2024-11-14 07:59:35,240:INFO:   <<< text_aug_choosen: random_swap
2024-11-14 07:59:35,240:INFO:   <<< text_num_hidden_layers: 12
2024-11-14 07:59:35,240:INFO:   <<< train_frame_order: 0
2024-11-14 07:59:35,240:INFO:   <<< use_mil: False
2024-11-14 07:59:35,240:INFO:   <<< video_dim: 1024
2024-11-14 07:59:35,240:INFO:   <<< visual_num_hidden_layers: 12
2024-11-14 07:59:35,240:INFO:   <<< warmup_proportion: 0.1
2024-11-14 07:59:35,240:INFO:   <<< world_size: 1
2024-11-14 07:59:35,241:INFO: device: cuda:0 n_gpu: 1
2024-11-14 07:59:36,272:INFO: loading archive file /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base
2024-11-14 07:59:36,273:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-11-14 07:59:36,273:INFO: Weight doesn't exsits. /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base/cross_pytorch_model.bin
2024-11-14 07:59:36,274:WARNING: Stage-One:True, Stage-Two:False
2024-11-14 07:59:36,274:WARNING: Test retrieval by loose type.
2024-11-14 07:59:36,274:WARNING: 	 embed_dim: 512
2024-11-14 07:59:36,274:WARNING: 	 image_resolution: 224
2024-11-14 07:59:36,274:WARNING: 	 vision_layers: 12
2024-11-14 07:59:36,274:WARNING: 	 vision_width: 768
2024-11-14 07:59:36,274:WARNING: 	 vision_patch_size: 32
2024-11-14 07:59:36,274:WARNING: 	 context_length: 77
2024-11-14 07:59:36,274:WARNING: 	 vocab_size: 49408
2024-11-14 07:59:36,274:WARNING: 	 transformer_width: 512
2024-11-14 07:59:36,274:WARNING: 	 transformer_heads: 8
2024-11-14 07:59:36,274:WARNING: 	 transformer_layers: 12
2024-11-14 07:59:36,274:WARNING: 		 linear_patch: 2d
2024-11-14 07:59:36,274:WARNING: 	 cut_top_layer: 0
2024-11-14 07:59:37,677:WARNING: 	 sim_header: Filip
2024-11-14 07:59:44,936:INFO: --------------------
2024-11-14 07:59:44,937:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-11-14 07:59:45,009:INFO: ***** Running test *****
2024-11-14 07:59:45,010:INFO:   Num examples = 642
2024-11-14 07:59:45,010:INFO:   Batch size = 256
2024-11-14 07:59:45,010:INFO:   Num steps = 3
2024-11-14 07:59:45,237:WARNING: Eval under the multi-sentence per video clip setting.
2024-11-14 07:59:45,237:WARNING: sentence num: 642, video num: 642
2024-11-14 07:59:46,781:INFO: before reshape, sim matrix size: 642 x 642
2024-11-14 07:59:46,871:INFO: after reshape, sim matrix size: 642 x 1 x 642
2024-11-14 07:59:46,968:INFO: Mix_Text-to-Video:
2024-11-14 07:59:46,968:INFO: 	>>>  R@1: 69.5 - R@5: 86.6 - R@10: 92.1 - Median R: 1.0 - Mean R: 5.2
2024-11-14 07:59:46,968:INFO: Mix_Video-to-Text:
2024-11-14 07:59:46,968:INFO: 	>>>  V2T$R@1: 70.1 - V2T$R@5: 87.9 - V2T$R@10: 92.7 - V2T$Median R: 1.0 - V2T$Mean R: 5.8
2024-11-15 17:28:09,484:INFO: Effective parameters:
2024-11-15 17:28:09,484:INFO:   <<< alpha: 0.9
2024-11-15 17:28:09,484:INFO:   <<< aug_choose: t2v
2024-11-15 17:28:09,484:INFO:   <<< batch_size: 512
2024-11-15 17:28:09,485:INFO:   <<< batch_size_val: 256
2024-11-15 17:28:09,485:INFO:   <<< cache_dir: 
2024-11-15 17:28:09,485:INFO:   <<< cla_weight_dir: cla_weight
2024-11-15 17:28:09,485:INFO:   <<< coef_lr: 1.0
2024-11-15 17:28:09,485:INFO:   <<< combine_type: sum
2024-11-15 17:28:09,485:INFO:   <<< cross_att_layers: 1
2024-11-15 17:28:09,485:INFO:   <<< cross_model: cross-base
2024-11-15 17:28:09,485:INFO:   <<< cross_num_hidden_layers: 4
2024-11-15 17:28:09,485:INFO:   <<< data_path: data_ph
2024-11-15 17:28:09,486:INFO:   <<< datatype: ph
2024-11-15 17:28:09,486:INFO:   <<< debug: False
2024-11-15 17:28:09,486:INFO:   <<< distributed: True
2024-11-15 17:28:09,486:INFO:   <<< do_eval: True
2024-11-15 17:28:09,486:INFO:   <<< do_lower_case: False
2024-11-15 17:28:09,486:INFO:   <<< do_pretrain: False
2024-11-15 17:28:09,486:INFO:   <<< do_train: False
2024-11-15 17:28:09,486:INFO:   <<< dual_mix: 0.5
2024-11-15 17:28:09,486:INFO:   <<< epochs: 200
2024-11-15 17:28:09,487:INFO:   <<< eval_frame_order: 0
2024-11-15 17:28:09,487:INFO:   <<< expand_msrvtt_sentences: False
2024-11-15 17:28:09,487:INFO:   <<< feature_framerate: 1
2024-11-15 17:28:09,487:INFO:   <<< feature_len: 64
2024-11-15 17:28:09,487:INFO:   <<< features_path: sign_feature/ph_domain_agnostic
2024-11-15 17:28:09,487:INFO:   <<< features_path_retrain: sign_feature/ph_domain_aware
2024-11-15 17:28:09,487:INFO:   <<< fp16: True
2024-11-15 17:28:09,487:INFO:   <<< fp16_opt_level: O1
2024-11-15 17:28:09,487:INFO:   <<< freeze_layer_num: 0
2024-11-15 17:28:09,487:INFO:   <<< gpu_ids: [0, 1]
2024-11-15 17:28:09,488:INFO:   <<< gradient_accumulation_steps: 1
2024-11-15 17:28:09,488:INFO:   <<< hard_negative_rate: 0.5
2024-11-15 17:28:09,488:INFO:   <<< init_model: chpt/ph_sota.pth
2024-11-15 17:28:09,488:INFO:   <<< linear_patch: 2d
2024-11-15 17:28:09,488:INFO:   <<< local_rank: 0
2024-11-15 17:28:09,488:INFO:   <<< loose_type: True
2024-11-15 17:28:09,488:INFO:   <<< lr: 1e-05
2024-11-15 17:28:09,488:INFO:   <<< lr_decay: 0.001
2024-11-15 17:28:09,488:INFO:   <<< margin: 0.1
2024-11-15 17:28:09,489:INFO:   <<< max_frames: 128
2024-11-15 17:28:09,489:INFO:   <<< max_words: 32
2024-11-15 17:28:09,489:INFO:   <<< mix_design: balance
2024-11-15 17:28:09,489:INFO:   <<< n_display: 1
2024-11-15 17:28:09,489:INFO:   <<< n_gpu: 1
2024-11-15 17:28:09,489:INFO:   <<< n_pair: 1
2024-11-15 17:28:09,489:INFO:   <<< negative_weighting: 1
2024-11-15 17:28:09,489:INFO:   <<< not_load_visual: False
2024-11-15 17:28:09,489:INFO:   <<< num_thread_reader: 8
2024-11-15 17:28:09,490:INFO:   <<< output_dir: new_experiment
2024-11-15 17:28:09,490:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-11-15 17:28:09,490:INFO:   <<< rank: 0
2024-11-15 17:28:09,490:INFO:   <<< resume_model: None
2024-11-15 17:28:09,490:INFO:   <<< sampled_use_mil: False
2024-11-15 17:28:09,490:INFO:   <<< seed: 42
2024-11-15 17:28:09,490:INFO:   <<< sim_calcu: softmax_max
2024-11-15 17:28:09,490:INFO:   <<< sim_header: Filip
2024-11-15 17:28:09,490:INFO:   <<< slice_framepos: 0
2024-11-15 17:28:09,490:INFO:   <<< task_type: retrieval
2024-11-15 17:28:09,491:INFO:   <<< tau: 0.07
2024-11-15 17:28:09,491:INFO:   <<< text_aug: True
2024-11-15 17:28:09,491:INFO:   <<< text_aug_choosen: random_swap
2024-11-15 17:28:09,491:INFO:   <<< text_num_hidden_layers: 12
2024-11-15 17:28:09,491:INFO:   <<< train_frame_order: 0
2024-11-15 17:28:09,491:INFO:   <<< use_mil: False
2024-11-15 17:28:09,491:INFO:   <<< video_dim: 1024
2024-11-15 17:28:09,491:INFO:   <<< visual_num_hidden_layers: 12
2024-11-15 17:28:09,491:INFO:   <<< warmup_proportion: 0.1
2024-11-15 17:28:09,492:INFO:   <<< world_size: 1
2024-11-15 17:28:09,492:INFO: device: cuda:0 n_gpu: 1
2024-11-15 17:28:12,120:INFO: loading archive file /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base
2024-11-15 17:28:12,125:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-11-15 17:28:12,126:INFO: Weight doesn't exsits. /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base/cross_pytorch_model.bin
2024-11-15 17:28:12,126:WARNING: Stage-One:True, Stage-Two:False
2024-11-15 17:28:12,126:WARNING: Test retrieval by loose type.
2024-11-15 17:28:12,127:WARNING: 	 embed_dim: 512
2024-11-15 17:28:12,127:WARNING: 	 image_resolution: 224
2024-11-15 17:28:12,127:WARNING: 	 vision_layers: 12
2024-11-15 17:28:12,127:WARNING: 	 vision_width: 768
2024-11-15 17:28:12,127:WARNING: 	 vision_patch_size: 32
2024-11-15 17:28:12,127:WARNING: 	 context_length: 77
2024-11-15 17:28:12,127:WARNING: 	 vocab_size: 49408
2024-11-15 17:28:12,127:WARNING: 	 transformer_width: 512
2024-11-15 17:28:12,127:WARNING: 	 transformer_heads: 8
2024-11-15 17:28:12,127:WARNING: 	 transformer_layers: 12
2024-11-15 17:28:12,127:WARNING: 		 linear_patch: 2d
2024-11-15 17:28:12,127:WARNING: 	 cut_top_layer: 0
2024-11-15 17:28:13,919:WARNING: 	 sim_header: Filip
2024-11-15 17:28:21,209:INFO: --------------------
2024-11-15 17:28:21,212:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-11-15 17:28:21,295:INFO: ***** Running test *****
2024-11-15 17:28:21,295:INFO:   Num examples = 642
2024-11-15 17:28:21,295:INFO:   Batch size = 256
2024-11-15 17:28:21,295:INFO:   Num steps = 3
2024-11-15 17:28:22,206:WARNING: Eval under the multi-sentence per video clip setting.
2024-11-15 17:28:22,206:WARNING: sentence num: 642, video num: 642
2024-11-15 17:28:47,323:INFO: Effective parameters:
2024-11-15 17:28:47,323:INFO:   <<< alpha: 0.8
2024-11-15 17:28:47,323:INFO:   <<< aug_choose: t2v
2024-11-15 17:28:47,323:INFO:   <<< batch_size: 512
2024-11-15 17:28:47,323:INFO:   <<< batch_size_val: 256
2024-11-15 17:28:47,323:INFO:   <<< cache_dir: 
2024-11-15 17:28:47,323:INFO:   <<< cla_weight_dir: cla_weight
2024-11-15 17:28:47,323:INFO:   <<< coef_lr: 1.0
2024-11-15 17:28:47,323:INFO:   <<< combine_type: sum
2024-11-15 17:28:47,323:INFO:   <<< cross_att_layers: 1
2024-11-15 17:28:47,324:INFO:   <<< cross_model: cross-base
2024-11-15 17:28:47,324:INFO:   <<< cross_num_hidden_layers: 4
2024-11-15 17:28:47,324:INFO:   <<< data_path: data_csl
2024-11-15 17:28:47,324:INFO:   <<< datatype: csl
2024-11-15 17:28:47,324:INFO:   <<< debug: False
2024-11-15 17:28:47,324:INFO:   <<< distributed: True
2024-11-15 17:28:47,324:INFO:   <<< do_eval: True
2024-11-15 17:28:47,324:INFO:   <<< do_lower_case: False
2024-11-15 17:28:47,324:INFO:   <<< do_pretrain: False
2024-11-15 17:28:47,324:INFO:   <<< do_train: False
2024-11-15 17:28:47,324:INFO:   <<< dual_mix: 0.5
2024-11-15 17:28:47,324:INFO:   <<< epochs: 200
2024-11-15 17:28:47,324:INFO:   <<< eval_frame_order: 0
2024-11-15 17:28:47,324:INFO:   <<< expand_msrvtt_sentences: False
2024-11-15 17:28:47,324:INFO:   <<< feature_framerate: 1
2024-11-15 17:28:47,324:INFO:   <<< feature_len: 64
2024-11-15 17:28:47,324:INFO:   <<< features_path: sign_feature/csl_domain_agnostic
2024-11-15 17:28:47,324:INFO:   <<< features_path_retrain: sign_feature/csl_domain_aware
2024-11-15 17:28:47,324:INFO:   <<< fp16: True
2024-11-15 17:28:47,324:INFO:   <<< fp16_opt_level: O1
2024-11-15 17:28:47,324:INFO:   <<< freeze_layer_num: 0
2024-11-15 17:28:47,325:INFO:   <<< gpu_ids: [0, 1]
2024-11-15 17:28:47,325:INFO:   <<< gradient_accumulation_steps: 1
2024-11-15 17:28:47,325:INFO:   <<< hard_negative_rate: 0.5
2024-11-15 17:28:47,325:INFO:   <<< init_model: chpt/csl_sota.pth
2024-11-15 17:28:47,325:INFO:   <<< linear_patch: 2d
2024-11-15 17:28:47,325:INFO:   <<< local_rank: 0
2024-11-15 17:28:47,325:INFO:   <<< loose_type: True
2024-11-15 17:28:47,325:INFO:   <<< lr: 1e-05
2024-11-15 17:28:47,325:INFO:   <<< lr_decay: 0.001
2024-11-15 17:28:47,325:INFO:   <<< margin: 0.1
2024-11-15 17:28:47,325:INFO:   <<< max_frames: 128
2024-11-15 17:28:47,325:INFO:   <<< max_words: 32
2024-11-15 17:28:47,325:INFO:   <<< mix_design: balance
2024-11-15 17:28:47,325:INFO:   <<< n_display: 1
2024-11-15 17:28:47,325:INFO:   <<< n_gpu: 1
2024-11-15 17:28:47,325:INFO:   <<< n_pair: 1
2024-11-15 17:28:47,325:INFO:   <<< negative_weighting: 1
2024-11-15 17:28:47,325:INFO:   <<< not_load_visual: False
2024-11-15 17:28:47,325:INFO:   <<< num_thread_reader: 8
2024-11-15 17:28:47,325:INFO:   <<< output_dir: new_experiment
2024-11-15 17:28:47,325:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-11-15 17:28:47,325:INFO:   <<< rank: 0
2024-11-15 17:28:47,326:INFO:   <<< resume_model: None
2024-11-15 17:28:47,326:INFO:   <<< sampled_use_mil: False
2024-11-15 17:28:47,326:INFO:   <<< seed: 42
2024-11-15 17:28:47,326:INFO:   <<< sim_calcu: softmax_max
2024-11-15 17:28:47,326:INFO:   <<< sim_header: Filip
2024-11-15 17:28:47,326:INFO:   <<< slice_framepos: 0
2024-11-15 17:28:47,326:INFO:   <<< task_type: retrieval
2024-11-15 17:28:47,326:INFO:   <<< tau: 0.07
2024-11-15 17:28:47,326:INFO:   <<< text_aug: True
2024-11-15 17:28:47,326:INFO:   <<< text_aug_choosen: random_swap
2024-11-15 17:28:47,326:INFO:   <<< text_num_hidden_layers: 12
2024-11-15 17:28:47,326:INFO:   <<< train_frame_order: 0
2024-11-15 17:28:47,326:INFO:   <<< use_mil: False
2024-11-15 17:28:47,326:INFO:   <<< video_dim: 1024
2024-11-15 17:28:47,326:INFO:   <<< visual_num_hidden_layers: 12
2024-11-15 17:28:47,326:INFO:   <<< warmup_proportion: 0.1
2024-11-15 17:28:47,326:INFO:   <<< world_size: 1
2024-11-15 17:28:47,327:INFO: device: cuda:0 n_gpu: 1
2024-11-15 17:28:49,658:INFO: loading archive file /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base
2024-11-15 17:28:49,661:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-11-15 17:28:49,661:INFO: Weight doesn't exsits. /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base/cross_pytorch_model.bin
2024-11-15 17:28:49,661:WARNING: Stage-One:True, Stage-Two:False
2024-11-15 17:28:49,662:WARNING: Test retrieval by loose type.
2024-11-15 17:28:49,662:WARNING: 	 embed_dim: 512
2024-11-15 17:28:49,662:WARNING: 	 image_resolution: 224
2024-11-15 17:28:49,662:WARNING: 	 vision_layers: 12
2024-11-15 17:28:49,662:WARNING: 	 vision_width: 768
2024-11-15 17:28:49,662:WARNING: 	 vision_patch_size: 32
2024-11-15 17:28:49,662:WARNING: 	 context_length: 77
2024-11-15 17:28:49,662:WARNING: 	 vocab_size: 49408
2024-11-15 17:28:49,662:WARNING: 	 transformer_width: 512
2024-11-15 17:28:49,662:WARNING: 	 transformer_heads: 8
2024-11-15 17:28:49,662:WARNING: 	 transformer_layers: 12
2024-11-15 17:28:49,662:WARNING: 		 linear_patch: 2d
2024-11-15 17:28:49,662:WARNING: 	 cut_top_layer: 0
2024-11-15 17:28:51,452:WARNING: 	 sim_header: Filip
2024-11-15 17:28:58,682:INFO: --------------------
2024-11-15 17:28:58,682:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-11-15 17:28:58,779:INFO: ***** Running test *****
2024-11-15 17:28:58,779:INFO:   Num examples = 1176
2024-11-15 17:28:58,779:INFO:   Batch size = 256
2024-11-15 17:28:58,779:INFO:   Num steps = 5
2024-11-15 17:29:00,691:WARNING: Eval under the multi-sentence per video clip setting.
2024-11-15 17:29:00,691:WARNING: sentence num: 798, video num: 1176
2024-11-15 17:30:17,362:INFO: Effective parameters:
2024-11-15 17:30:17,362:INFO:   <<< alpha: 0.8
2024-11-15 17:30:17,362:INFO:   <<< aug_choose: t2v
2024-11-15 17:30:17,362:INFO:   <<< batch_size: 512
2024-11-15 17:30:17,362:INFO:   <<< batch_size_val: 256
2024-11-15 17:30:17,362:INFO:   <<< cache_dir: 
2024-11-15 17:30:17,362:INFO:   <<< cla_weight_dir: cla_weight
2024-11-15 17:30:17,362:INFO:   <<< coef_lr: 1.0
2024-11-15 17:30:17,363:INFO:   <<< combine_type: sum
2024-11-15 17:30:17,363:INFO:   <<< cross_att_layers: 1
2024-11-15 17:30:17,363:INFO:   <<< cross_model: cross-base
2024-11-15 17:30:17,363:INFO:   <<< cross_num_hidden_layers: 4
2024-11-15 17:30:17,363:INFO:   <<< data_path: data_csl
2024-11-15 17:30:17,363:INFO:   <<< datatype: csl
2024-11-15 17:30:17,363:INFO:   <<< debug: False
2024-11-15 17:30:17,363:INFO:   <<< distributed: True
2024-11-15 17:30:17,363:INFO:   <<< do_eval: True
2024-11-15 17:30:17,363:INFO:   <<< do_lower_case: False
2024-11-15 17:30:17,363:INFO:   <<< do_pretrain: False
2024-11-15 17:30:17,363:INFO:   <<< do_train: False
2024-11-15 17:30:17,363:INFO:   <<< dual_mix: 0.5
2024-11-15 17:30:17,363:INFO:   <<< epochs: 200
2024-11-15 17:30:17,363:INFO:   <<< eval_frame_order: 0
2024-11-15 17:30:17,363:INFO:   <<< expand_msrvtt_sentences: False
2024-11-15 17:30:17,363:INFO:   <<< feature_framerate: 1
2024-11-15 17:30:17,363:INFO:   <<< feature_len: 64
2024-11-15 17:30:17,363:INFO:   <<< features_path: sign_feature/csl_domain_agnostic
2024-11-15 17:30:17,363:INFO:   <<< features_path_retrain: sign_feature/csl_domain_aware
2024-11-15 17:30:17,364:INFO:   <<< fp16: True
2024-11-15 17:30:17,364:INFO:   <<< fp16_opt_level: O1
2024-11-15 17:30:17,364:INFO:   <<< freeze_layer_num: 0
2024-11-15 17:30:17,364:INFO:   <<< gpu_ids: [0, 1]
2024-11-15 17:30:17,364:INFO:   <<< gradient_accumulation_steps: 1
2024-11-15 17:30:17,364:INFO:   <<< hard_negative_rate: 0.5
2024-11-15 17:30:17,364:INFO:   <<< init_model: chpt/csl_sota.pth
2024-11-15 17:30:17,364:INFO:   <<< linear_patch: 2d
2024-11-15 17:30:17,364:INFO:   <<< local_rank: 0
2024-11-15 17:30:17,364:INFO:   <<< loose_type: True
2024-11-15 17:30:17,364:INFO:   <<< lr: 1e-05
2024-11-15 17:30:17,364:INFO:   <<< lr_decay: 0.001
2024-11-15 17:30:17,364:INFO:   <<< margin: 0.1
2024-11-15 17:30:17,364:INFO:   <<< max_frames: 128
2024-11-15 17:30:17,364:INFO:   <<< max_words: 32
2024-11-15 17:30:17,364:INFO:   <<< mix_design: balance
2024-11-15 17:30:17,364:INFO:   <<< n_display: 1
2024-11-15 17:30:17,364:INFO:   <<< n_gpu: 1
2024-11-15 17:30:17,364:INFO:   <<< n_pair: 1
2024-11-15 17:30:17,365:INFO:   <<< negative_weighting: 1
2024-11-15 17:30:17,365:INFO:   <<< not_load_visual: False
2024-11-15 17:30:17,365:INFO:   <<< num_thread_reader: 8
2024-11-15 17:30:17,365:INFO:   <<< output_dir: new_experiment
2024-11-15 17:30:17,365:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-11-15 17:30:17,365:INFO:   <<< rank: 0
2024-11-15 17:30:17,365:INFO:   <<< resume_model: None
2024-11-15 17:30:17,365:INFO:   <<< sampled_use_mil: False
2024-11-15 17:30:17,365:INFO:   <<< seed: 42
2024-11-15 17:30:17,365:INFO:   <<< sim_calcu: softmax_max
2024-11-15 17:30:17,365:INFO:   <<< sim_header: Filip
2024-11-15 17:30:17,365:INFO:   <<< slice_framepos: 0
2024-11-15 17:30:17,365:INFO:   <<< task_type: retrieval
2024-11-15 17:30:17,365:INFO:   <<< tau: 0.07
2024-11-15 17:30:17,365:INFO:   <<< text_aug: True
2024-11-15 17:30:17,365:INFO:   <<< text_aug_choosen: random_swap
2024-11-15 17:30:17,365:INFO:   <<< text_num_hidden_layers: 12
2024-11-15 17:30:17,365:INFO:   <<< train_frame_order: 0
2024-11-15 17:30:17,365:INFO:   <<< use_mil: False
2024-11-15 17:30:17,365:INFO:   <<< video_dim: 1024
2024-11-15 17:30:17,366:INFO:   <<< visual_num_hidden_layers: 12
2024-11-15 17:30:17,366:INFO:   <<< warmup_proportion: 0.1
2024-11-15 17:30:17,366:INFO:   <<< world_size: 1
2024-11-15 17:30:17,366:INFO: device: cuda:0 n_gpu: 1
2024-11-15 17:30:19,074:INFO: loading archive file /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base
2024-11-15 17:30:19,079:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-11-15 17:30:19,079:INFO: Weight doesn't exsits. /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base/cross_pytorch_model.bin
2024-11-15 17:30:19,079:WARNING: Stage-One:True, Stage-Two:False
2024-11-15 17:30:19,079:WARNING: Test retrieval by loose type.
2024-11-15 17:30:19,079:WARNING: 	 embed_dim: 512
2024-11-15 17:30:19,079:WARNING: 	 image_resolution: 224
2024-11-15 17:30:19,080:WARNING: 	 vision_layers: 12
2024-11-15 17:30:19,080:WARNING: 	 vision_width: 768
2024-11-15 17:30:19,080:WARNING: 	 vision_patch_size: 32
2024-11-15 17:30:19,080:WARNING: 	 context_length: 77
2024-11-15 17:30:19,080:WARNING: 	 vocab_size: 49408
2024-11-15 17:30:19,080:WARNING: 	 transformer_width: 512
2024-11-15 17:30:19,080:WARNING: 	 transformer_heads: 8
2024-11-15 17:30:19,080:WARNING: 	 transformer_layers: 12
2024-11-15 17:30:19,080:WARNING: 		 linear_patch: 2d
2024-11-15 17:30:19,080:WARNING: 	 cut_top_layer: 0
2024-11-15 17:30:20,875:WARNING: 	 sim_header: Filip
2024-11-15 17:30:28,124:INFO: --------------------
2024-11-15 17:30:28,125:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-11-15 17:30:28,210:INFO: ***** Running test *****
2024-11-15 17:30:28,211:INFO:   Num examples = 1176
2024-11-15 17:30:28,211:INFO:   Batch size = 256
2024-11-15 17:30:28,211:INFO:   Num steps = 5
2024-11-15 17:30:28,857:WARNING: Eval under the multi-sentence per video clip setting.
2024-11-15 17:30:28,857:WARNING: sentence num: 798, video num: 1176
2024-11-16 07:39:40,901:INFO: Effective parameters:
2024-11-16 07:39:40,901:INFO:   <<< alpha: 0.8
2024-11-16 07:39:40,901:INFO:   <<< aug_choose: t2v
2024-11-16 07:39:40,901:INFO:   <<< batch_size: 512
2024-11-16 07:39:40,901:INFO:   <<< batch_size_val: 256
2024-11-16 07:39:40,901:INFO:   <<< cache_dir: 
2024-11-16 07:39:40,901:INFO:   <<< cla_weight_dir: cla_weight
2024-11-16 07:39:40,901:INFO:   <<< coef_lr: 1.0
2024-11-16 07:39:40,901:INFO:   <<< combine_type: sum
2024-11-16 07:39:40,901:INFO:   <<< cross_att_layers: 1
2024-11-16 07:39:40,902:INFO:   <<< cross_model: cross-base
2024-11-16 07:39:40,902:INFO:   <<< cross_num_hidden_layers: 4
2024-11-16 07:39:40,902:INFO:   <<< data_path: data_csl
2024-11-16 07:39:40,902:INFO:   <<< datatype: csl
2024-11-16 07:39:40,902:INFO:   <<< debug: False
2024-11-16 07:39:40,902:INFO:   <<< distributed: True
2024-11-16 07:39:40,902:INFO:   <<< do_eval: True
2024-11-16 07:39:40,902:INFO:   <<< do_lower_case: False
2024-11-16 07:39:40,902:INFO:   <<< do_pretrain: False
2024-11-16 07:39:40,902:INFO:   <<< do_train: False
2024-11-16 07:39:40,902:INFO:   <<< dual_mix: 0.5
2024-11-16 07:39:40,902:INFO:   <<< epochs: 200
2024-11-16 07:39:40,902:INFO:   <<< eval_frame_order: 0
2024-11-16 07:39:40,902:INFO:   <<< expand_msrvtt_sentences: False
2024-11-16 07:39:40,902:INFO:   <<< feature_framerate: 1
2024-11-16 07:39:40,902:INFO:   <<< feature_len: 64
2024-11-16 07:39:40,902:INFO:   <<< features_path: sign_feature/csl_domain_agnostic
2024-11-16 07:39:40,902:INFO:   <<< features_path_retrain: sign_feature/csl_domain_aware
2024-11-16 07:39:40,902:INFO:   <<< fp16: True
2024-11-16 07:39:40,902:INFO:   <<< fp16_opt_level: O1
2024-11-16 07:39:40,902:INFO:   <<< freeze_layer_num: 0
2024-11-16 07:39:40,902:INFO:   <<< gpu_ids: [0, 1]
2024-11-16 07:39:40,902:INFO:   <<< gradient_accumulation_steps: 1
2024-11-16 07:39:40,902:INFO:   <<< hard_negative_rate: 0.5
2024-11-16 07:39:40,902:INFO:   <<< init_model: chpt/csl_sota.pth
2024-11-16 07:39:40,902:INFO:   <<< linear_patch: 2d
2024-11-16 07:39:40,902:INFO:   <<< local_rank: 0
2024-11-16 07:39:40,902:INFO:   <<< loose_type: True
2024-11-16 07:39:40,902:INFO:   <<< lr: 1e-05
2024-11-16 07:39:40,902:INFO:   <<< lr_decay: 0.001
2024-11-16 07:39:40,902:INFO:   <<< margin: 0.1
2024-11-16 07:39:40,903:INFO:   <<< max_frames: 128
2024-11-16 07:39:40,903:INFO:   <<< max_words: 32
2024-11-16 07:39:40,903:INFO:   <<< mix_design: balance
2024-11-16 07:39:40,903:INFO:   <<< n_display: 1
2024-11-16 07:39:40,903:INFO:   <<< n_gpu: 1
2024-11-16 07:39:40,903:INFO:   <<< n_pair: 1
2024-11-16 07:39:40,903:INFO:   <<< negative_weighting: 1
2024-11-16 07:39:40,903:INFO:   <<< not_load_visual: False
2024-11-16 07:39:40,903:INFO:   <<< num_thread_reader: 8
2024-11-16 07:39:40,903:INFO:   <<< output_dir: new_experiment
2024-11-16 07:39:40,903:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-11-16 07:39:40,903:INFO:   <<< rank: 0
2024-11-16 07:39:40,903:INFO:   <<< resume_model: None
2024-11-16 07:39:40,903:INFO:   <<< sampled_use_mil: False
2024-11-16 07:39:40,903:INFO:   <<< seed: 42
2024-11-16 07:39:40,903:INFO:   <<< sim_calcu: softmax_max
2024-11-16 07:39:40,903:INFO:   <<< sim_header: Filip
2024-11-16 07:39:40,903:INFO:   <<< slice_framepos: 0
2024-11-16 07:39:40,903:INFO:   <<< task_type: retrieval
2024-11-16 07:39:40,903:INFO:   <<< tau: 0.07
2024-11-16 07:39:40,903:INFO:   <<< text_aug: True
2024-11-16 07:39:40,903:INFO:   <<< text_aug_choosen: random_swap
2024-11-16 07:39:40,903:INFO:   <<< text_num_hidden_layers: 12
2024-11-16 07:39:40,903:INFO:   <<< train_frame_order: 0
2024-11-16 07:39:40,903:INFO:   <<< use_mil: False
2024-11-16 07:39:40,903:INFO:   <<< video_dim: 1024
2024-11-16 07:39:40,903:INFO:   <<< visual_num_hidden_layers: 12
2024-11-16 07:39:40,903:INFO:   <<< warmup_proportion: 0.1
2024-11-16 07:39:40,903:INFO:   <<< world_size: 1
2024-11-16 07:39:40,904:INFO: device: cuda:0 n_gpu: 1
2024-11-16 07:39:42,335:INFO: loading archive file /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base
2024-11-16 07:39:42,337:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-11-16 07:39:42,337:INFO: Weight doesn't exsits. /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base/cross_pytorch_model.bin
2024-11-16 07:39:42,337:WARNING: Stage-One:True, Stage-Two:False
2024-11-16 07:39:42,337:WARNING: Test retrieval by loose type.
2024-11-16 07:39:42,337:WARNING: 	 embed_dim: 512
2024-11-16 07:39:42,337:WARNING: 	 image_resolution: 224
2024-11-16 07:39:42,338:WARNING: 	 vision_layers: 12
2024-11-16 07:39:42,338:WARNING: 	 vision_width: 768
2024-11-16 07:39:42,338:WARNING: 	 vision_patch_size: 32
2024-11-16 07:39:42,338:WARNING: 	 context_length: 77
2024-11-16 07:39:42,338:WARNING: 	 vocab_size: 49408
2024-11-16 07:39:42,338:WARNING: 	 transformer_width: 512
2024-11-16 07:39:42,338:WARNING: 	 transformer_heads: 8
2024-11-16 07:39:42,338:WARNING: 	 transformer_layers: 12
2024-11-16 07:39:42,338:WARNING: 		 linear_patch: 2d
2024-11-16 07:39:42,338:WARNING: 	 cut_top_layer: 0
2024-11-16 07:39:43,567:WARNING: 	 sim_header: Filip
2024-11-16 07:39:50,227:INFO: --------------------
2024-11-16 07:39:50,228:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-11-16 07:39:50,287:INFO: ***** Running test *****
2024-11-16 07:39:50,287:INFO:   Num examples = 1176
2024-11-16 07:39:50,287:INFO:   Batch size = 256
2024-11-16 07:39:50,288:INFO:   Num steps = 5
2024-11-16 07:39:50,784:WARNING: Eval under the multi-sentence per video clip setting.
2024-11-16 07:39:50,785:WARNING: sentence num: 798, video num: 1176
2024-11-16 07:39:55,042:INFO: before reshape, sim matrix size: 1176 x 798
2024-11-16 07:39:55,153:INFO: after reshape, sim matrix size: 798 x 2 x 798
2024-11-16 07:39:55,284:INFO: Mix_Text-to-Video:
2024-11-16 07:39:55,284:INFO: 	>>>  R@1: 74.9 - R@5: 87.7 - R@10: 91.7 - Median R: 1.0 - Mean R: 6.0
2024-11-16 07:39:55,285:INFO: Mix_Video-to-Text:
2024-11-16 07:39:55,285:INFO: 	>>>  V2T$R@1: 74.8 - V2T$R@5: 88.9 - V2T$R@10: 92.3 - V2T$Median R: 1.0 - V2T$Mean R: 6.0
2024-11-16 07:40:43,156:INFO: Effective parameters:
2024-11-16 07:40:43,156:INFO:   <<< alpha: 0.9
2024-11-16 07:40:43,156:INFO:   <<< aug_choose: t2v
2024-11-16 07:40:43,156:INFO:   <<< batch_size: 512
2024-11-16 07:40:43,156:INFO:   <<< batch_size_val: 256
2024-11-16 07:40:43,156:INFO:   <<< cache_dir: 
2024-11-16 07:40:43,156:INFO:   <<< cla_weight_dir: cla_weight
2024-11-16 07:40:43,156:INFO:   <<< coef_lr: 1.0
2024-11-16 07:40:43,156:INFO:   <<< combine_type: sum
2024-11-16 07:40:43,156:INFO:   <<< cross_att_layers: 1
2024-11-16 07:40:43,156:INFO:   <<< cross_model: cross-base
2024-11-16 07:40:43,156:INFO:   <<< cross_num_hidden_layers: 4
2024-11-16 07:40:43,156:INFO:   <<< data_path: data_ph
2024-11-16 07:40:43,156:INFO:   <<< datatype: ph
2024-11-16 07:40:43,156:INFO:   <<< debug: False
2024-11-16 07:40:43,156:INFO:   <<< distributed: True
2024-11-16 07:40:43,156:INFO:   <<< do_eval: True
2024-11-16 07:40:43,156:INFO:   <<< do_lower_case: False
2024-11-16 07:40:43,156:INFO:   <<< do_pretrain: False
2024-11-16 07:40:43,156:INFO:   <<< do_train: False
2024-11-16 07:40:43,157:INFO:   <<< dual_mix: 0.5
2024-11-16 07:40:43,157:INFO:   <<< epochs: 200
2024-11-16 07:40:43,157:INFO:   <<< eval_frame_order: 0
2024-11-16 07:40:43,157:INFO:   <<< expand_msrvtt_sentences: False
2024-11-16 07:40:43,157:INFO:   <<< feature_framerate: 1
2024-11-16 07:40:43,157:INFO:   <<< feature_len: 64
2024-11-16 07:40:43,157:INFO:   <<< features_path: sign_feature/ph_domain_agnostic
2024-11-16 07:40:43,157:INFO:   <<< features_path_retrain: sign_feature/ph_domain_aware
2024-11-16 07:40:43,157:INFO:   <<< fp16: True
2024-11-16 07:40:43,157:INFO:   <<< fp16_opt_level: O1
2024-11-16 07:40:43,157:INFO:   <<< freeze_layer_num: 0
2024-11-16 07:40:43,157:INFO:   <<< gpu_ids: [0, 1]
2024-11-16 07:40:43,157:INFO:   <<< gradient_accumulation_steps: 1
2024-11-16 07:40:43,157:INFO:   <<< hard_negative_rate: 0.5
2024-11-16 07:40:43,157:INFO:   <<< init_model: chpt/ph_sota.pth
2024-11-16 07:40:43,157:INFO:   <<< linear_patch: 2d
2024-11-16 07:40:43,157:INFO:   <<< local_rank: 0
2024-11-16 07:40:43,157:INFO:   <<< loose_type: True
2024-11-16 07:40:43,157:INFO:   <<< lr: 1e-05
2024-11-16 07:40:43,157:INFO:   <<< lr_decay: 0.001
2024-11-16 07:40:43,157:INFO:   <<< margin: 0.1
2024-11-16 07:40:43,157:INFO:   <<< max_frames: 128
2024-11-16 07:40:43,157:INFO:   <<< max_words: 32
2024-11-16 07:40:43,157:INFO:   <<< mix_design: balance
2024-11-16 07:40:43,157:INFO:   <<< n_display: 1
2024-11-16 07:40:43,157:INFO:   <<< n_gpu: 1
2024-11-16 07:40:43,157:INFO:   <<< n_pair: 1
2024-11-16 07:40:43,157:INFO:   <<< negative_weighting: 1
2024-11-16 07:40:43,157:INFO:   <<< not_load_visual: False
2024-11-16 07:40:43,157:INFO:   <<< num_thread_reader: 8
2024-11-16 07:40:43,157:INFO:   <<< output_dir: new_experiment
2024-11-16 07:40:43,157:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-11-16 07:40:43,157:INFO:   <<< rank: 0
2024-11-16 07:40:43,157:INFO:   <<< resume_model: None
2024-11-16 07:40:43,157:INFO:   <<< sampled_use_mil: False
2024-11-16 07:40:43,158:INFO:   <<< seed: 42
2024-11-16 07:40:43,158:INFO:   <<< sim_calcu: softmax_max
2024-11-16 07:40:43,158:INFO:   <<< sim_header: Filip
2024-11-16 07:40:43,158:INFO:   <<< slice_framepos: 0
2024-11-16 07:40:43,158:INFO:   <<< task_type: retrieval
2024-11-16 07:40:43,158:INFO:   <<< tau: 0.07
2024-11-16 07:40:43,158:INFO:   <<< text_aug: True
2024-11-16 07:40:43,158:INFO:   <<< text_aug_choosen: random_swap
2024-11-16 07:40:43,158:INFO:   <<< text_num_hidden_layers: 12
2024-11-16 07:40:43,158:INFO:   <<< train_frame_order: 0
2024-11-16 07:40:43,158:INFO:   <<< use_mil: False
2024-11-16 07:40:43,158:INFO:   <<< video_dim: 1024
2024-11-16 07:40:43,158:INFO:   <<< visual_num_hidden_layers: 12
2024-11-16 07:40:43,158:INFO:   <<< warmup_proportion: 0.1
2024-11-16 07:40:43,158:INFO:   <<< world_size: 1
2024-11-16 07:40:43,158:INFO: device: cuda:0 n_gpu: 1
2024-11-16 07:40:44,187:INFO: loading archive file /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base
2024-11-16 07:40:44,188:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-11-16 07:40:44,188:INFO: Weight doesn't exsits. /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base/cross_pytorch_model.bin
2024-11-16 07:40:44,188:WARNING: Stage-One:True, Stage-Two:False
2024-11-16 07:40:44,188:WARNING: Test retrieval by loose type.
2024-11-16 07:40:44,189:WARNING: 	 embed_dim: 512
2024-11-16 07:40:44,189:WARNING: 	 image_resolution: 224
2024-11-16 07:40:44,189:WARNING: 	 vision_layers: 12
2024-11-16 07:40:44,189:WARNING: 	 vision_width: 768
2024-11-16 07:40:44,189:WARNING: 	 vision_patch_size: 32
2024-11-16 07:40:44,189:WARNING: 	 context_length: 77
2024-11-16 07:40:44,189:WARNING: 	 vocab_size: 49408
2024-11-16 07:40:44,189:WARNING: 	 transformer_width: 512
2024-11-16 07:40:44,189:WARNING: 	 transformer_heads: 8
2024-11-16 07:40:44,189:WARNING: 	 transformer_layers: 12
2024-11-16 07:40:44,189:WARNING: 		 linear_patch: 2d
2024-11-16 07:40:44,189:WARNING: 	 cut_top_layer: 0
2024-11-16 07:40:45,413:WARNING: 	 sim_header: Filip
2024-11-16 07:40:52,158:INFO: --------------------
2024-11-16 07:40:52,159:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-11-16 07:40:52,225:INFO: ***** Running test *****
2024-11-16 07:40:52,225:INFO:   Num examples = 642
2024-11-16 07:40:52,225:INFO:   Batch size = 256
2024-11-16 07:40:52,225:INFO:   Num steps = 3
2024-11-16 07:40:52,537:WARNING: Eval under the multi-sentence per video clip setting.
2024-11-16 07:40:52,537:WARNING: sentence num: 642, video num: 642
2024-11-16 07:40:54,331:INFO: before reshape, sim matrix size: 642 x 642
2024-11-16 07:40:54,420:INFO: after reshape, sim matrix size: 642 x 1 x 642
2024-11-16 07:40:54,476:INFO: Mix_Text-to-Video:
2024-11-16 07:40:54,477:INFO: 	>>>  R@1: 69.5 - R@5: 86.6 - R@10: 92.1 - Median R: 1.0 - Mean R: 5.2
2024-11-16 07:40:54,477:INFO: Mix_Video-to-Text:
2024-11-16 07:40:54,477:INFO: 	>>>  V2T$R@1: 70.1 - V2T$R@5: 87.9 - V2T$R@10: 92.7 - V2T$Median R: 1.0 - V2T$Mean R: 5.8
2024-11-16 07:54:46,062:INFO: Effective parameters:
2024-11-16 07:54:46,062:INFO:   <<< alpha: 0.8
2024-11-16 07:54:46,062:INFO:   <<< aug_choose: t2v
2024-11-16 07:54:46,062:INFO:   <<< batch_size: 512
2024-11-16 07:54:46,062:INFO:   <<< batch_size_val: 256
2024-11-16 07:54:46,062:INFO:   <<< cache_dir: 
2024-11-16 07:54:46,062:INFO:   <<< cla_weight_dir: cla_weight
2024-11-16 07:54:46,062:INFO:   <<< coef_lr: 1.0
2024-11-16 07:54:46,062:INFO:   <<< combine_type: sum
2024-11-16 07:54:46,062:INFO:   <<< cross_att_layers: 1
2024-11-16 07:54:46,062:INFO:   <<< cross_model: cross-base
2024-11-16 07:54:46,062:INFO:   <<< cross_num_hidden_layers: 4
2024-11-16 07:54:46,062:INFO:   <<< data_path: data_csl
2024-11-16 07:54:46,062:INFO:   <<< datatype: csl
2024-11-16 07:54:46,062:INFO:   <<< debug: False
2024-11-16 07:54:46,062:INFO:   <<< distributed: True
2024-11-16 07:54:46,062:INFO:   <<< do_eval: True
2024-11-16 07:54:46,062:INFO:   <<< do_lower_case: False
2024-11-16 07:54:46,062:INFO:   <<< do_pretrain: False
2024-11-16 07:54:46,062:INFO:   <<< do_train: False
2024-11-16 07:54:46,062:INFO:   <<< dual_mix: 0.5
2024-11-16 07:54:46,062:INFO:   <<< epochs: 200
2024-11-16 07:54:46,062:INFO:   <<< eval_frame_order: 0
2024-11-16 07:54:46,062:INFO:   <<< expand_msrvtt_sentences: False
2024-11-16 07:54:46,062:INFO:   <<< feature_framerate: 1
2024-11-16 07:54:46,062:INFO:   <<< feature_len: 64
2024-11-16 07:54:46,062:INFO:   <<< features_path: sign_feature/csl_domain_agnostic
2024-11-16 07:54:46,063:INFO:   <<< features_path_retrain: sign_feature/csl_domain_aware
2024-11-16 07:54:46,063:INFO:   <<< fp16: True
2024-11-16 07:54:46,063:INFO:   <<< fp16_opt_level: O1
2024-11-16 07:54:46,063:INFO:   <<< freeze_layer_num: 0
2024-11-16 07:54:46,063:INFO:   <<< gpu_ids: [0, 1]
2024-11-16 07:54:46,063:INFO:   <<< gradient_accumulation_steps: 1
2024-11-16 07:54:46,063:INFO:   <<< hard_negative_rate: 0.5
2024-11-16 07:54:46,063:INFO:   <<< init_model: chpt/csl_sota.pth
2024-11-16 07:54:46,063:INFO:   <<< linear_patch: 2d
2024-11-16 07:54:46,063:INFO:   <<< local_rank: 0
2024-11-16 07:54:46,063:INFO:   <<< loose_type: True
2024-11-16 07:54:46,063:INFO:   <<< lr: 1e-05
2024-11-16 07:54:46,063:INFO:   <<< lr_decay: 0.001
2024-11-16 07:54:46,063:INFO:   <<< margin: 0.1
2024-11-16 07:54:46,063:INFO:   <<< max_frames: 128
2024-11-16 07:54:46,063:INFO:   <<< max_words: 32
2024-11-16 07:54:46,063:INFO:   <<< mix_design: balance
2024-11-16 07:54:46,063:INFO:   <<< n_display: 1
2024-11-16 07:54:46,063:INFO:   <<< n_gpu: 1
2024-11-16 07:54:46,063:INFO:   <<< n_pair: 1
2024-11-16 07:54:46,063:INFO:   <<< negative_weighting: 1
2024-11-16 07:54:46,063:INFO:   <<< not_load_visual: False
2024-11-16 07:54:46,063:INFO:   <<< num_thread_reader: 8
2024-11-16 07:54:46,063:INFO:   <<< output_dir: new_experiment
2024-11-16 07:54:46,063:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-11-16 07:54:46,063:INFO:   <<< rank: 0
2024-11-16 07:54:46,063:INFO:   <<< resume_model: None
2024-11-16 07:54:46,063:INFO:   <<< sampled_use_mil: False
2024-11-16 07:54:46,063:INFO:   <<< seed: 42
2024-11-16 07:54:46,063:INFO:   <<< sim_calcu: softmax_max
2024-11-16 07:54:46,063:INFO:   <<< sim_header: Filip
2024-11-16 07:54:46,063:INFO:   <<< slice_framepos: 0
2024-11-16 07:54:46,063:INFO:   <<< task_type: retrieval
2024-11-16 07:54:46,063:INFO:   <<< tau: 0.07
2024-11-16 07:54:46,063:INFO:   <<< text_aug: True
2024-11-16 07:54:46,063:INFO:   <<< text_aug_choosen: random_swap
2024-11-16 07:54:46,063:INFO:   <<< text_num_hidden_layers: 12
2024-11-16 07:54:46,064:INFO:   <<< train_frame_order: 0
2024-11-16 07:54:46,064:INFO:   <<< use_mil: False
2024-11-16 07:54:46,064:INFO:   <<< video_dim: 1024
2024-11-16 07:54:46,064:INFO:   <<< visual_num_hidden_layers: 12
2024-11-16 07:54:46,064:INFO:   <<< warmup_proportion: 0.1
2024-11-16 07:54:46,064:INFO:   <<< world_size: 1
2024-11-16 07:54:46,064:INFO: device: cuda:0 n_gpu: 1
2024-11-16 07:54:47,099:INFO: loading archive file /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base
2024-11-16 07:54:47,100:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-11-16 07:54:47,100:INFO: Weight doesn't exsits. /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base/cross_pytorch_model.bin
2024-11-16 07:54:47,100:WARNING: Stage-One:True, Stage-Two:False
2024-11-16 07:54:47,100:WARNING: Test retrieval by loose type.
2024-11-16 07:54:47,100:WARNING: 	 embed_dim: 512
2024-11-16 07:54:47,100:WARNING: 	 image_resolution: 224
2024-11-16 07:54:47,100:WARNING: 	 vision_layers: 12
2024-11-16 07:54:47,100:WARNING: 	 vision_width: 768
2024-11-16 07:54:47,100:WARNING: 	 vision_patch_size: 32
2024-11-16 07:54:47,100:WARNING: 	 context_length: 77
2024-11-16 07:54:47,100:WARNING: 	 vocab_size: 49408
2024-11-16 07:54:47,100:WARNING: 	 transformer_width: 512
2024-11-16 07:54:47,100:WARNING: 	 transformer_heads: 8
2024-11-16 07:54:47,100:WARNING: 	 transformer_layers: 12
2024-11-16 07:54:47,100:WARNING: 		 linear_patch: 2d
2024-11-16 07:54:47,100:WARNING: 	 cut_top_layer: 0
2024-11-16 07:54:48,326:WARNING: 	 sim_header: Filip
2024-11-16 07:54:54,984:INFO: --------------------
2024-11-16 07:54:54,985:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-11-16 07:54:55,041:INFO: ***** Running test *****
2024-11-16 07:54:55,042:INFO:   Num examples = 1176
2024-11-16 07:54:55,042:INFO:   Batch size = 256
2024-11-16 07:54:55,042:INFO:   Num steps = 5
2024-11-16 07:54:55,623:WARNING: Eval under the multi-sentence per video clip setting.
2024-11-16 07:54:55,623:WARNING: sentence num: 798, video num: 1176
2024-11-16 07:54:57,789:INFO: before reshape, sim matrix size: 1176 x 798
2024-11-16 07:54:57,959:INFO: after reshape, sim matrix size: 798 x 2 x 798
2024-11-16 07:54:58,076:INFO: Mix_Text-to-Video:
2024-11-16 07:54:58,076:INFO: 	>>>  R@1: 74.9 - R@5: 87.7 - R@10: 91.7 - Median R: 1.0 - Mean R: 6.0
2024-11-16 07:54:58,076:INFO: Mix_Video-to-Text:
2024-11-16 07:54:58,076:INFO: 	>>>  V2T$R@1: 74.8 - V2T$R@5: 88.9 - V2T$R@10: 92.3 - V2T$Median R: 1.0 - V2T$Mean R: 6.0
2024-11-18 09:57:53,533:INFO: Effective parameters:
2024-11-18 09:57:53,534:INFO:   <<< alpha: 0.9
2024-11-18 09:57:53,534:INFO:   <<< aug_choose: t2v
2024-11-18 09:57:53,534:INFO:   <<< batch_size: 512
2024-11-18 09:57:53,534:INFO:   <<< batch_size_val: 256
2024-11-18 09:57:53,534:INFO:   <<< cache_dir: 
2024-11-18 09:57:53,534:INFO:   <<< cla_weight_dir: cla_weight
2024-11-18 09:57:53,534:INFO:   <<< coef_lr: 1.0
2024-11-18 09:57:53,534:INFO:   <<< combine_type: sum
2024-11-18 09:57:53,534:INFO:   <<< cross_att_layers: 1
2024-11-18 09:57:53,534:INFO:   <<< cross_model: cross-base
2024-11-18 09:57:53,534:INFO:   <<< cross_num_hidden_layers: 4
2024-11-18 09:57:53,534:INFO:   <<< data_path: data_ph
2024-11-18 09:57:53,534:INFO:   <<< datatype: ph
2024-11-18 09:57:53,535:INFO:   <<< debug: False
2024-11-18 09:57:53,535:INFO:   <<< distributed: True
2024-11-18 09:57:53,535:INFO:   <<< do_eval: True
2024-11-18 09:57:53,535:INFO:   <<< do_lower_case: False
2024-11-18 09:57:53,535:INFO:   <<< do_pretrain: False
2024-11-18 09:57:53,535:INFO:   <<< do_train: False
2024-11-18 09:57:53,535:INFO:   <<< dual_mix: 0.5
2024-11-18 09:57:53,535:INFO:   <<< epochs: 200
2024-11-18 09:57:53,535:INFO:   <<< eval_frame_order: 0
2024-11-18 09:57:53,535:INFO:   <<< expand_msrvtt_sentences: False
2024-11-18 09:57:53,535:INFO:   <<< feature_framerate: 1
2024-11-18 09:57:53,535:INFO:   <<< feature_len: 64
2024-11-18 09:57:53,535:INFO:   <<< features_path: sign_feature/ph_domain_agnostic
2024-11-18 09:57:53,535:INFO:   <<< features_path_retrain: sign_feature/ph_domain_aware
2024-11-18 09:57:53,535:INFO:   <<< fp16: True
2024-11-18 09:57:53,535:INFO:   <<< fp16_opt_level: O1
2024-11-18 09:57:53,535:INFO:   <<< freeze_layer_num: 0
2024-11-18 09:57:53,536:INFO:   <<< gpu_ids: [0, 1]
2024-11-18 09:57:53,536:INFO:   <<< gradient_accumulation_steps: 1
2024-11-18 09:57:53,536:INFO:   <<< hard_negative_rate: 0.5
2024-11-18 09:57:53,536:INFO:   <<< init_model: chpt/ph_sota.pth
2024-11-18 09:57:53,536:INFO:   <<< linear_patch: 2d
2024-11-18 09:57:53,536:INFO:   <<< local_rank: 0
2024-11-18 09:57:53,536:INFO:   <<< loose_type: True
2024-11-18 09:57:53,536:INFO:   <<< lr: 1e-05
2024-11-18 09:57:53,536:INFO:   <<< lr_decay: 0.001
2024-11-18 09:57:53,536:INFO:   <<< margin: 0.1
2024-11-18 09:57:53,536:INFO:   <<< max_frames: 128
2024-11-18 09:57:53,536:INFO:   <<< max_words: 32
2024-11-18 09:57:53,536:INFO:   <<< mix_design: balance
2024-11-18 09:57:53,536:INFO:   <<< n_display: 1
2024-11-18 09:57:53,536:INFO:   <<< n_gpu: 1
2024-11-18 09:57:53,536:INFO:   <<< n_pair: 1
2024-11-18 09:57:53,537:INFO:   <<< negative_weighting: 1
2024-11-18 09:57:53,537:INFO:   <<< not_load_visual: False
2024-11-18 09:57:53,537:INFO:   <<< num_thread_reader: 8
2024-11-18 09:57:53,537:INFO:   <<< output_dir: new_experiment
2024-11-18 09:57:53,537:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-11-18 09:57:53,537:INFO:   <<< rank: 0
2024-11-18 09:57:53,537:INFO:   <<< resume_model: None
2024-11-18 09:57:53,537:INFO:   <<< sampled_use_mil: False
2024-11-18 09:57:53,537:INFO:   <<< seed: 42
2024-11-18 09:57:53,537:INFO:   <<< sim_calcu: softmax_max
2024-11-18 09:57:53,537:INFO:   <<< sim_header: Filip
2024-11-18 09:57:53,537:INFO:   <<< slice_framepos: 0
2024-11-18 09:57:53,537:INFO:   <<< task_type: retrieval
2024-11-18 09:57:53,537:INFO:   <<< tau: 0.07
2024-11-18 09:57:53,537:INFO:   <<< text_aug: True
2024-11-18 09:57:53,537:INFO:   <<< text_aug_choosen: random_swap
2024-11-18 09:57:53,538:INFO:   <<< text_num_hidden_layers: 12
2024-11-18 09:57:53,538:INFO:   <<< train_frame_order: 0
2024-11-18 09:57:53,538:INFO:   <<< use_mil: False
2024-11-18 09:57:53,538:INFO:   <<< video_dim: 1024
2024-11-18 09:57:53,538:INFO:   <<< visual_num_hidden_layers: 12
2024-11-18 09:57:53,538:INFO:   <<< warmup_proportion: 0.1
2024-11-18 09:57:53,538:INFO:   <<< world_size: 1
2024-11-18 09:57:53,538:INFO: device: cuda:0 n_gpu: 1
2024-11-18 09:57:55,054:INFO: loading archive file /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base
2024-11-18 09:57:55,057:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-11-18 09:57:55,057:INFO: Weight doesn't exsits. /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base/cross_pytorch_model.bin
2024-11-18 09:57:55,058:WARNING: Stage-One:True, Stage-Two:False
2024-11-18 09:57:55,058:WARNING: Test retrieval by loose type.
2024-11-18 09:57:55,058:WARNING: 	 embed_dim: 512
2024-11-18 09:57:55,058:WARNING: 	 image_resolution: 224
2024-11-18 09:57:55,058:WARNING: 	 vision_layers: 12
2024-11-18 09:57:55,058:WARNING: 	 vision_width: 768
2024-11-18 09:57:55,058:WARNING: 	 vision_patch_size: 32
2024-11-18 09:57:55,058:WARNING: 	 context_length: 77
2024-11-18 09:57:55,058:WARNING: 	 vocab_size: 49408
2024-11-18 09:57:55,058:WARNING: 	 transformer_width: 512
2024-11-18 09:57:55,058:WARNING: 	 transformer_heads: 8
2024-11-18 09:57:55,059:WARNING: 	 transformer_layers: 12
2024-11-18 09:57:55,059:WARNING: 		 linear_patch: 2d
2024-11-18 09:57:55,059:WARNING: 	 cut_top_layer: 0
2024-11-18 09:57:56,523:WARNING: 	 sim_header: Filip
2024-11-18 09:58:03,640:INFO: --------------------
2024-11-18 09:58:03,642:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-11-18 09:58:03,772:INFO: ***** Running test *****
2024-11-18 09:58:03,772:INFO:   Num examples = 642
2024-11-18 09:58:03,772:INFO:   Batch size = 256
2024-11-18 09:58:03,772:INFO:   Num steps = 3
2024-11-18 09:58:04,150:WARNING: Eval under the multi-sentence per video clip setting.
2024-11-18 09:58:04,150:WARNING: sentence num: 642, video num: 642
2024-11-18 09:58:07,933:INFO: before reshape, sim matrix size: 642 x 642
2024-11-18 09:58:44,645:INFO: Effective parameters:
2024-11-18 09:58:44,645:INFO:   <<< alpha: 0.9
2024-11-18 09:58:44,645:INFO:   <<< aug_choose: t2v
2024-11-18 09:58:44,646:INFO:   <<< batch_size: 512
2024-11-18 09:58:44,646:INFO:   <<< batch_size_val: 256
2024-11-18 09:58:44,646:INFO:   <<< cache_dir: 
2024-11-18 09:58:44,646:INFO:   <<< cla_weight_dir: cla_weight
2024-11-18 09:58:44,646:INFO:   <<< coef_lr: 1.0
2024-11-18 09:58:44,646:INFO:   <<< combine_type: sum
2024-11-18 09:58:44,646:INFO:   <<< cross_att_layers: 1
2024-11-18 09:58:44,646:INFO:   <<< cross_model: cross-base
2024-11-18 09:58:44,646:INFO:   <<< cross_num_hidden_layers: 4
2024-11-18 09:58:44,646:INFO:   <<< data_path: data_ph
2024-11-18 09:58:44,646:INFO:   <<< datatype: ph
2024-11-18 09:58:44,646:INFO:   <<< debug: False
2024-11-18 09:58:44,646:INFO:   <<< distributed: True
2024-11-18 09:58:44,646:INFO:   <<< do_eval: True
2024-11-18 09:58:44,646:INFO:   <<< do_lower_case: False
2024-11-18 09:58:44,647:INFO:   <<< do_pretrain: False
2024-11-18 09:58:44,647:INFO:   <<< do_train: False
2024-11-18 09:58:44,647:INFO:   <<< dual_mix: 0.5
2024-11-18 09:58:44,647:INFO:   <<< epochs: 200
2024-11-18 09:58:44,647:INFO:   <<< eval_frame_order: 0
2024-11-18 09:58:44,647:INFO:   <<< expand_msrvtt_sentences: False
2024-11-18 09:58:44,647:INFO:   <<< feature_framerate: 1
2024-11-18 09:58:44,647:INFO:   <<< feature_len: 64
2024-11-18 09:58:44,647:INFO:   <<< features_path: sign_feature/ph_domain_agnostic
2024-11-18 09:58:44,647:INFO:   <<< features_path_retrain: sign_feature/ph_domain_aware
2024-11-18 09:58:44,647:INFO:   <<< fp16: True
2024-11-18 09:58:44,647:INFO:   <<< fp16_opt_level: O1
2024-11-18 09:58:44,647:INFO:   <<< freeze_layer_num: 0
2024-11-18 09:58:44,647:INFO:   <<< gpu_ids: [0, 1]
2024-11-18 09:58:44,647:INFO:   <<< gradient_accumulation_steps: 1
2024-11-18 09:58:44,647:INFO:   <<< hard_negative_rate: 0.5
2024-11-18 09:58:44,648:INFO:   <<< init_model: chpt/ph_sota.pth
2024-11-18 09:58:44,648:INFO:   <<< linear_patch: 2d
2024-11-18 09:58:44,648:INFO:   <<< local_rank: 0
2024-11-18 09:58:44,648:INFO:   <<< loose_type: True
2024-11-18 09:58:44,648:INFO:   <<< lr: 1e-05
2024-11-18 09:58:44,648:INFO:   <<< lr_decay: 0.001
2024-11-18 09:58:44,648:INFO:   <<< margin: 0.1
2024-11-18 09:58:44,648:INFO:   <<< max_frames: 128
2024-11-18 09:58:44,648:INFO:   <<< max_words: 32
2024-11-18 09:58:44,648:INFO:   <<< mix_design: balance
2024-11-18 09:58:44,648:INFO:   <<< n_display: 1
2024-11-18 09:58:44,648:INFO:   <<< n_gpu: 1
2024-11-18 09:58:44,648:INFO:   <<< n_pair: 1
2024-11-18 09:58:44,648:INFO:   <<< negative_weighting: 1
2024-11-18 09:58:44,648:INFO:   <<< not_load_visual: False
2024-11-18 09:58:44,649:INFO:   <<< num_thread_reader: 8
2024-11-18 09:58:44,649:INFO:   <<< output_dir: new_experiment
2024-11-18 09:58:44,649:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-11-18 09:58:44,649:INFO:   <<< rank: 0
2024-11-18 09:58:44,649:INFO:   <<< resume_model: None
2024-11-18 09:58:44,649:INFO:   <<< sampled_use_mil: False
2024-11-18 09:58:44,649:INFO:   <<< seed: 42
2024-11-18 09:58:44,649:INFO:   <<< sim_calcu: softmax_max
2024-11-18 09:58:44,649:INFO:   <<< sim_header: Filip
2024-11-18 09:58:44,649:INFO:   <<< slice_framepos: 0
2024-11-18 09:58:44,649:INFO:   <<< task_type: retrieval
2024-11-18 09:58:44,649:INFO:   <<< tau: 0.07
2024-11-18 09:58:44,649:INFO:   <<< text_aug: True
2024-11-18 09:58:44,649:INFO:   <<< text_aug_choosen: random_swap
2024-11-18 09:58:44,649:INFO:   <<< text_num_hidden_layers: 12
2024-11-18 09:58:44,649:INFO:   <<< train_frame_order: 0
2024-11-18 09:58:44,650:INFO:   <<< use_mil: False
2024-11-18 09:58:44,650:INFO:   <<< video_dim: 1024
2024-11-18 09:58:44,650:INFO:   <<< visual_num_hidden_layers: 12
2024-11-18 09:58:44,650:INFO:   <<< warmup_proportion: 0.1
2024-11-18 09:58:44,650:INFO:   <<< world_size: 1
2024-11-18 09:58:44,650:INFO: device: cuda:0 n_gpu: 1
2024-11-18 09:58:45,457:INFO: loading archive file /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base
2024-11-18 09:58:45,458:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-11-18 09:58:45,458:INFO: Weight doesn't exsits. /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base/cross_pytorch_model.bin
2024-11-18 09:58:45,459:WARNING: Stage-One:True, Stage-Two:False
2024-11-18 09:58:45,459:WARNING: Test retrieval by loose type.
2024-11-18 09:58:45,459:WARNING: 	 embed_dim: 512
2024-11-18 09:58:45,459:WARNING: 	 image_resolution: 224
2024-11-18 09:58:45,459:WARNING: 	 vision_layers: 12
2024-11-18 09:58:45,459:WARNING: 	 vision_width: 768
2024-11-18 09:58:45,459:WARNING: 	 vision_patch_size: 32
2024-11-18 09:58:45,459:WARNING: 	 context_length: 77
2024-11-18 09:58:45,459:WARNING: 	 vocab_size: 49408
2024-11-18 09:58:45,460:WARNING: 	 transformer_width: 512
2024-11-18 09:58:45,460:WARNING: 	 transformer_heads: 8
2024-11-18 09:58:45,460:WARNING: 	 transformer_layers: 12
2024-11-18 09:58:45,460:WARNING: 		 linear_patch: 2d
2024-11-18 09:58:45,460:WARNING: 	 cut_top_layer: 0
2024-11-18 09:58:46,953:WARNING: 	 sim_header: Filip
2024-11-18 09:58:54,093:INFO: --------------------
2024-11-18 09:58:54,094:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-11-18 09:58:54,159:INFO: ***** Running test *****
2024-11-18 09:58:54,160:INFO:   Num examples = 642
2024-11-18 09:58:54,160:INFO:   Batch size = 256
2024-11-18 09:58:54,160:INFO:   Num steps = 3
2024-11-18 09:58:54,985:WARNING: Eval under the multi-sentence per video clip setting.
2024-11-18 09:58:54,985:WARNING: sentence num: 642, video num: 642
2024-11-18 09:58:56,783:INFO: before reshape, sim matrix size: 642 x 642
2024-11-18 09:58:56,863:INFO: after reshape, sim matrix size: 642 x 1 x 642
2024-11-18 09:58:56,938:INFO: Mix_Text-to-Video:
2024-11-18 09:58:56,939:INFO: 	>>>  R@1: 69.5 - R@5: 86.6 - R@10: 92.1 - Median R: 1.0 - Mean R: 5.2
2024-11-18 09:58:56,939:INFO: Mix_Video-to-Text:
2024-11-18 09:58:56,939:INFO: 	>>>  V2T$R@1: 70.1 - V2T$R@5: 87.9 - V2T$R@10: 92.7 - V2T$Median R: 1.0 - V2T$Mean R: 5.8
2024-11-18 20:45:21,035:INFO: Effective parameters:
2024-11-18 20:45:21,035:INFO:   <<< alpha: 0.9
2024-11-18 20:45:21,035:INFO:   <<< aug_choose: t2v
2024-11-18 20:45:21,035:INFO:   <<< batch_size: 512
2024-11-18 20:45:21,035:INFO:   <<< batch_size_val: 256
2024-11-18 20:45:21,035:INFO:   <<< cache_dir: 
2024-11-18 20:45:21,035:INFO:   <<< cla_weight_dir: cla_weight
2024-11-18 20:45:21,035:INFO:   <<< coef_lr: 1.0
2024-11-18 20:45:21,035:INFO:   <<< combine_type: sum
2024-11-18 20:45:21,035:INFO:   <<< cross_att_layers: 1
2024-11-18 20:45:21,035:INFO:   <<< cross_model: cross-base
2024-11-18 20:45:21,035:INFO:   <<< cross_num_hidden_layers: 4
2024-11-18 20:45:21,035:INFO:   <<< data_path: data_ph
2024-11-18 20:45:21,035:INFO:   <<< datatype: ph
2024-11-18 20:45:21,035:INFO:   <<< debug: False
2024-11-18 20:45:21,035:INFO:   <<< distributed: True
2024-11-18 20:45:21,035:INFO:   <<< do_eval: True
2024-11-18 20:45:21,035:INFO:   <<< do_lower_case: False
2024-11-18 20:45:21,035:INFO:   <<< do_pretrain: False
2024-11-18 20:45:21,035:INFO:   <<< do_train: False
2024-11-18 20:45:21,035:INFO:   <<< dual_mix: 0.5
2024-11-18 20:45:21,035:INFO:   <<< epochs: 200
2024-11-18 20:45:21,035:INFO:   <<< eval_frame_order: 0
2024-11-18 20:45:21,036:INFO:   <<< expand_msrvtt_sentences: False
2024-11-18 20:45:21,036:INFO:   <<< feature_framerate: 1
2024-11-18 20:45:21,036:INFO:   <<< feature_len: 64
2024-11-18 20:45:21,036:INFO:   <<< features_path: sign_feature/ph_domain_agnostic
2024-11-18 20:45:21,036:INFO:   <<< features_path_retrain: sign_feature/ph_domain_aware
2024-11-18 20:45:21,036:INFO:   <<< fp16: True
2024-11-18 20:45:21,036:INFO:   <<< fp16_opt_level: O1
2024-11-18 20:45:21,036:INFO:   <<< freeze_layer_num: 0
2024-11-18 20:45:21,036:INFO:   <<< gpu_ids: [0, 1]
2024-11-18 20:45:21,036:INFO:   <<< gradient_accumulation_steps: 1
2024-11-18 20:45:21,036:INFO:   <<< hard_negative_rate: 0.5
2024-11-18 20:45:21,036:INFO:   <<< init_model: chpt/ph_sota.pth
2024-11-18 20:45:21,036:INFO:   <<< linear_patch: 2d
2024-11-18 20:45:21,036:INFO:   <<< local_rank: 0
2024-11-18 20:45:21,036:INFO:   <<< loose_type: True
2024-11-18 20:45:21,036:INFO:   <<< lr: 1e-05
2024-11-18 20:45:21,036:INFO:   <<< lr_decay: 0.001
2024-11-18 20:45:21,036:INFO:   <<< margin: 0.1
2024-11-18 20:45:21,036:INFO:   <<< max_frames: 128
2024-11-18 20:45:21,036:INFO:   <<< max_words: 32
2024-11-18 20:45:21,036:INFO:   <<< mix_design: balance
2024-11-18 20:45:21,036:INFO:   <<< n_display: 1
2024-11-18 20:45:21,036:INFO:   <<< n_gpu: 1
2024-11-18 20:45:21,036:INFO:   <<< n_pair: 1
2024-11-18 20:45:21,036:INFO:   <<< negative_weighting: 1
2024-11-18 20:45:21,036:INFO:   <<< not_load_visual: False
2024-11-18 20:45:21,036:INFO:   <<< num_thread_reader: 8
2024-11-18 20:45:21,036:INFO:   <<< output_dir: new_experiment
2024-11-18 20:45:21,036:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-11-18 20:45:21,036:INFO:   <<< rank: 0
2024-11-18 20:45:21,036:INFO:   <<< resume_model: None
2024-11-18 20:45:21,036:INFO:   <<< sampled_use_mil: False
2024-11-18 20:45:21,037:INFO:   <<< seed: 42
2024-11-18 20:45:21,037:INFO:   <<< sim_calcu: softmax_max
2024-11-18 20:45:21,037:INFO:   <<< sim_header: Filip
2024-11-18 20:45:21,037:INFO:   <<< slice_framepos: 0
2024-11-18 20:45:21,037:INFO:   <<< task_type: retrieval
2024-11-18 20:45:21,037:INFO:   <<< tau: 0.07
2024-11-18 20:45:21,037:INFO:   <<< text_aug: True
2024-11-18 20:45:21,037:INFO:   <<< text_aug_choosen: random_swap
2024-11-18 20:45:21,037:INFO:   <<< text_num_hidden_layers: 12
2024-11-18 20:45:21,037:INFO:   <<< train_frame_order: 0
2024-11-18 20:45:21,037:INFO:   <<< use_mil: False
2024-11-18 20:45:21,037:INFO:   <<< video_dim: 1024
2024-11-18 20:45:21,037:INFO:   <<< visual_num_hidden_layers: 12
2024-11-18 20:45:21,037:INFO:   <<< warmup_proportion: 0.1
2024-11-18 20:45:21,037:INFO:   <<< world_size: 1
2024-11-18 20:45:21,037:INFO: device: cuda:0 n_gpu: 1
2024-11-18 20:45:21,859:INFO: loading archive file /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base
2024-11-18 20:45:21,861:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-11-18 20:45:21,861:INFO: Weight doesn't exsits. /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base/cross_pytorch_model.bin
2024-11-18 20:45:21,862:WARNING: Stage-One:True, Stage-Two:False
2024-11-18 20:45:21,862:WARNING: Test retrieval by loose type.
2024-11-18 20:45:21,862:WARNING: 	 embed_dim: 512
2024-11-18 20:45:21,862:WARNING: 	 image_resolution: 224
2024-11-18 20:45:21,862:WARNING: 	 vision_layers: 12
2024-11-18 20:45:21,862:WARNING: 	 vision_width: 768
2024-11-18 20:45:21,862:WARNING: 	 vision_patch_size: 32
2024-11-18 20:45:21,862:WARNING: 	 context_length: 77
2024-11-18 20:45:21,862:WARNING: 	 vocab_size: 49408
2024-11-18 20:45:21,862:WARNING: 	 transformer_width: 512
2024-11-18 20:45:21,862:WARNING: 	 transformer_heads: 8
2024-11-18 20:45:21,862:WARNING: 	 transformer_layers: 12
2024-11-18 20:45:21,862:WARNING: 		 linear_patch: 2d
2024-11-18 20:45:21,862:WARNING: 	 cut_top_layer: 0
2024-11-18 20:45:24,372:WARNING: 	 sim_header: Filip
2024-11-18 20:45:32,701:INFO: --------------------
2024-11-18 20:45:32,707:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-11-18 20:45:32,788:INFO: ***** Running test *****
2024-11-18 20:45:32,788:INFO:   Num examples = 642
2024-11-18 20:45:32,788:INFO:   Batch size = 256
2024-11-18 20:45:32,788:INFO:   Num steps = 3
2024-11-18 20:45:33,294:WARNING: Eval under the multi-sentence per video clip setting.
2024-11-18 20:45:33,294:WARNING: sentence num: 642, video num: 642
2024-11-18 20:45:35,673:INFO: before reshape, sim matrix size: 642 x 642
2024-11-18 20:45:35,730:INFO: after reshape, sim matrix size: 642 x 1 x 642
2024-11-18 20:45:35,889:INFO: Mix_Text-to-Video:
2024-11-18 20:45:35,890:INFO: 	>>>  R@1: 69.5 - R@5: 86.6 - R@10: 92.1 - Median R: 1.0 - Mean R: 5.2
2024-11-18 20:45:35,890:INFO: Mix_Video-to-Text:
2024-11-18 20:45:35,890:INFO: 	>>>  V2T$R@1: 70.1 - V2T$R@5: 87.9 - V2T$R@10: 92.7 - V2T$Median R: 1.0 - V2T$Mean R: 5.8
2024-11-18 20:49:17,263:INFO: Effective parameters:
2024-11-18 20:49:17,263:INFO:   <<< alpha: 0.9
2024-11-18 20:49:17,263:INFO:   <<< aug_choose: t2v
2024-11-18 20:49:17,263:INFO:   <<< batch_size: 512
2024-11-18 20:49:17,263:INFO:   <<< batch_size_val: 256
2024-11-18 20:49:17,263:INFO:   <<< cache_dir: 
2024-11-18 20:49:17,263:INFO:   <<< cla_weight_dir: cla_weight
2024-11-18 20:49:17,263:INFO:   <<< coef_lr: 1.0
2024-11-18 20:49:17,263:INFO:   <<< combine_type: sum
2024-11-18 20:49:17,263:INFO:   <<< cross_att_layers: 1
2024-11-18 20:49:17,263:INFO:   <<< cross_model: cross-base
2024-11-18 20:49:17,263:INFO:   <<< cross_num_hidden_layers: 4
2024-11-18 20:49:17,263:INFO:   <<< data_path: data_ph
2024-11-18 20:49:17,263:INFO:   <<< datatype: ph
2024-11-18 20:49:17,263:INFO:   <<< debug: False
2024-11-18 20:49:17,263:INFO:   <<< distributed: True
2024-11-18 20:49:17,263:INFO:   <<< do_eval: True
2024-11-18 20:49:17,263:INFO:   <<< do_lower_case: False
2024-11-18 20:49:17,263:INFO:   <<< do_pretrain: False
2024-11-18 20:49:17,263:INFO:   <<< do_train: False
2024-11-18 20:49:17,264:INFO:   <<< dual_mix: 0.5
2024-11-18 20:49:17,264:INFO:   <<< epochs: 200
2024-11-18 20:49:17,264:INFO:   <<< eval_frame_order: 0
2024-11-18 20:49:17,264:INFO:   <<< expand_msrvtt_sentences: False
2024-11-18 20:49:17,264:INFO:   <<< feature_framerate: 1
2024-11-18 20:49:17,264:INFO:   <<< feature_len: 64
2024-11-18 20:49:17,264:INFO:   <<< features_path: sign_feature/ph_domain_agnostic
2024-11-18 20:49:17,264:INFO:   <<< features_path_retrain: sign_feature/ph_domain_aware
2024-11-18 20:49:17,264:INFO:   <<< fp16: True
2024-11-18 20:49:17,264:INFO:   <<< fp16_opt_level: O1
2024-11-18 20:49:17,264:INFO:   <<< freeze_layer_num: 0
2024-11-18 20:49:17,264:INFO:   <<< gpu_ids: [0, 1]
2024-11-18 20:49:17,264:INFO:   <<< gradient_accumulation_steps: 1
2024-11-18 20:49:17,264:INFO:   <<< hard_negative_rate: 0.5
2024-11-18 20:49:17,264:INFO:   <<< init_model: chpt/ph_sota.pth
2024-11-18 20:49:17,264:INFO:   <<< linear_patch: 2d
2024-11-18 20:49:17,264:INFO:   <<< local_rank: 0
2024-11-18 20:49:17,264:INFO:   <<< loose_type: True
2024-11-18 20:49:17,264:INFO:   <<< lr: 1e-05
2024-11-18 20:49:17,264:INFO:   <<< lr_decay: 0.001
2024-11-18 20:49:17,264:INFO:   <<< margin: 0.1
2024-11-18 20:49:17,264:INFO:   <<< max_frames: 128
2024-11-18 20:49:17,264:INFO:   <<< max_words: 32
2024-11-18 20:49:17,264:INFO:   <<< mix_design: balance
2024-11-18 20:49:17,264:INFO:   <<< n_display: 1
2024-11-18 20:49:17,264:INFO:   <<< n_gpu: 1
2024-11-18 20:49:17,264:INFO:   <<< n_pair: 1
2024-11-18 20:49:17,264:INFO:   <<< negative_weighting: 1
2024-11-18 20:49:17,264:INFO:   <<< not_load_visual: False
2024-11-18 20:49:17,264:INFO:   <<< num_thread_reader: 8
2024-11-18 20:49:17,264:INFO:   <<< output_dir: new_experiment
2024-11-18 20:49:17,265:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-11-18 20:49:17,265:INFO:   <<< rank: 0
2024-11-18 20:49:17,265:INFO:   <<< resume_model: None
2024-11-18 20:49:17,265:INFO:   <<< sampled_use_mil: False
2024-11-18 20:49:17,265:INFO:   <<< seed: 42
2024-11-18 20:49:17,265:INFO:   <<< sim_calcu: softmax_max
2024-11-18 20:49:17,265:INFO:   <<< sim_header: Filip
2024-11-18 20:49:17,265:INFO:   <<< slice_framepos: 0
2024-11-18 20:49:17,265:INFO:   <<< task_type: retrieval
2024-11-18 20:49:17,265:INFO:   <<< tau: 0.07
2024-11-18 20:49:17,265:INFO:   <<< text_aug: True
2024-11-18 20:49:17,265:INFO:   <<< text_aug_choosen: random_swap
2024-11-18 20:49:17,265:INFO:   <<< text_num_hidden_layers: 12
2024-11-18 20:49:17,265:INFO:   <<< train_frame_order: 0
2024-11-18 20:49:17,265:INFO:   <<< use_mil: False
2024-11-18 20:49:17,265:INFO:   <<< video_dim: 1024
2024-11-18 20:49:17,265:INFO:   <<< visual_num_hidden_layers: 12
2024-11-18 20:49:17,265:INFO:   <<< warmup_proportion: 0.1
2024-11-18 20:49:17,265:INFO:   <<< world_size: 1
2024-11-18 20:49:17,265:INFO: device: cuda:0 n_gpu: 1
2024-11-18 20:49:18,084:INFO: loading archive file /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base
2024-11-18 20:49:18,085:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-11-18 20:49:18,085:INFO: Weight doesn't exsits. /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base/cross_pytorch_model.bin
2024-11-18 20:49:18,085:WARNING: Stage-One:True, Stage-Two:False
2024-11-18 20:49:18,086:WARNING: Test retrieval by loose type.
2024-11-18 20:49:18,086:WARNING: 	 embed_dim: 512
2024-11-18 20:49:18,086:WARNING: 	 image_resolution: 224
2024-11-18 20:49:18,086:WARNING: 	 vision_layers: 12
2024-11-18 20:49:18,086:WARNING: 	 vision_width: 768
2024-11-18 20:49:18,086:WARNING: 	 vision_patch_size: 32
2024-11-18 20:49:18,086:WARNING: 	 context_length: 77
2024-11-18 20:49:18,086:WARNING: 	 vocab_size: 49408
2024-11-18 20:49:18,086:WARNING: 	 transformer_width: 512
2024-11-18 20:49:18,086:WARNING: 	 transformer_heads: 8
2024-11-18 20:49:18,086:WARNING: 	 transformer_layers: 12
2024-11-18 20:49:18,086:WARNING: 		 linear_patch: 2d
2024-11-18 20:49:18,086:WARNING: 	 cut_top_layer: 0
2024-11-18 20:49:20,578:WARNING: 	 sim_header: Filip
2024-11-18 20:49:28,828:INFO: --------------------
2024-11-18 20:49:28,829:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-11-18 20:49:28,922:INFO: ***** Running test *****
2024-11-18 20:49:28,922:INFO:   Num examples = 642
2024-11-18 20:49:28,922:INFO:   Batch size = 256
2024-11-18 20:49:28,922:INFO:   Num steps = 3
2024-11-18 20:49:29,265:WARNING: Eval under the multi-sentence per video clip setting.
2024-11-18 20:49:29,265:WARNING: sentence num: 642, video num: 642
2024-11-18 20:49:31,480:INFO: before reshape, sim matrix size: 642 x 642
2024-11-18 20:49:31,561:INFO: after reshape, sim matrix size: 642 x 1 x 642
2024-11-18 20:49:31,704:INFO: Mix_Text-to-Video:
2024-11-18 20:49:31,704:INFO: 	>>>  R@1: 69.5 - R@5: 86.6 - R@10: 92.1 - Median R: 1.0 - Mean R: 5.2
2024-11-18 20:49:31,704:INFO: Mix_Video-to-Text:
2024-11-18 20:49:31,704:INFO: 	>>>  V2T$R@1: 70.1 - V2T$R@5: 87.9 - V2T$R@10: 92.7 - V2T$Median R: 1.0 - V2T$Mean R: 5.8
2024-11-18 20:50:55,421:INFO: Effective parameters:
2024-11-18 20:50:55,422:INFO:   <<< alpha: 0.9
2024-11-18 20:50:55,422:INFO:   <<< aug_choose: t2v
2024-11-18 20:50:55,422:INFO:   <<< batch_size: 512
2024-11-18 20:50:55,422:INFO:   <<< batch_size_val: 256
2024-11-18 20:50:55,422:INFO:   <<< cache_dir: 
2024-11-18 20:50:55,422:INFO:   <<< cla_weight_dir: cla_weight
2024-11-18 20:50:55,422:INFO:   <<< coef_lr: 1.0
2024-11-18 20:50:55,422:INFO:   <<< combine_type: sum
2024-11-18 20:50:55,422:INFO:   <<< cross_att_layers: 1
2024-11-18 20:50:55,422:INFO:   <<< cross_model: cross-base
2024-11-18 20:50:55,422:INFO:   <<< cross_num_hidden_layers: 4
2024-11-18 20:50:55,422:INFO:   <<< data_path: data_ph
2024-11-18 20:50:55,422:INFO:   <<< datatype: ph
2024-11-18 20:50:55,422:INFO:   <<< debug: False
2024-11-18 20:50:55,422:INFO:   <<< distributed: True
2024-11-18 20:50:55,422:INFO:   <<< do_eval: True
2024-11-18 20:50:55,422:INFO:   <<< do_lower_case: False
2024-11-18 20:50:55,422:INFO:   <<< do_pretrain: False
2024-11-18 20:50:55,422:INFO:   <<< do_train: False
2024-11-18 20:50:55,422:INFO:   <<< dual_mix: 0.5
2024-11-18 20:50:55,422:INFO:   <<< epochs: 200
2024-11-18 20:50:55,422:INFO:   <<< eval_frame_order: 0
2024-11-18 20:50:55,422:INFO:   <<< expand_msrvtt_sentences: False
2024-11-18 20:50:55,423:INFO:   <<< feature_framerate: 1
2024-11-18 20:50:55,423:INFO:   <<< feature_len: 64
2024-11-18 20:50:55,423:INFO:   <<< features_path: sign_feature/ph_domain_agnostic
2024-11-18 20:50:55,423:INFO:   <<< features_path_retrain: sign_feature/ph_domain_aware
2024-11-18 20:50:55,423:INFO:   <<< fp16: True
2024-11-18 20:50:55,423:INFO:   <<< fp16_opt_level: O1
2024-11-18 20:50:55,423:INFO:   <<< freeze_layer_num: 0
2024-11-18 20:50:55,423:INFO:   <<< gpu_ids: [0, 1]
2024-11-18 20:50:55,423:INFO:   <<< gradient_accumulation_steps: 1
2024-11-18 20:50:55,423:INFO:   <<< hard_negative_rate: 0.5
2024-11-18 20:50:55,423:INFO:   <<< init_model: chpt/ph_sota.pth
2024-11-18 20:50:55,423:INFO:   <<< linear_patch: 2d
2024-11-18 20:50:55,423:INFO:   <<< local_rank: 0
2024-11-18 20:50:55,423:INFO:   <<< loose_type: True
2024-11-18 20:50:55,423:INFO:   <<< lr: 1e-05
2024-11-18 20:50:55,423:INFO:   <<< lr_decay: 0.001
2024-11-18 20:50:55,423:INFO:   <<< margin: 0.1
2024-11-18 20:50:55,423:INFO:   <<< max_frames: 128
2024-11-18 20:50:55,423:INFO:   <<< max_words: 32
2024-11-18 20:50:55,423:INFO:   <<< mix_design: balance
2024-11-18 20:50:55,423:INFO:   <<< n_display: 1
2024-11-18 20:50:55,423:INFO:   <<< n_gpu: 1
2024-11-18 20:50:55,423:INFO:   <<< n_pair: 1
2024-11-18 20:50:55,423:INFO:   <<< negative_weighting: 1
2024-11-18 20:50:55,423:INFO:   <<< not_load_visual: False
2024-11-18 20:50:55,423:INFO:   <<< num_thread_reader: 8
2024-11-18 20:50:55,423:INFO:   <<< output_dir: new_experiment
2024-11-18 20:50:55,423:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-11-18 20:50:55,423:INFO:   <<< rank: 0
2024-11-18 20:50:55,423:INFO:   <<< resume_model: None
2024-11-18 20:50:55,423:INFO:   <<< sampled_use_mil: False
2024-11-18 20:50:55,424:INFO:   <<< seed: 42
2024-11-18 20:50:55,424:INFO:   <<< sim_calcu: softmax_max
2024-11-18 20:50:55,424:INFO:   <<< sim_header: Filip
2024-11-18 20:50:55,424:INFO:   <<< slice_framepos: 0
2024-11-18 20:50:55,424:INFO:   <<< task_type: retrieval
2024-11-18 20:50:55,424:INFO:   <<< tau: 0.07
2024-11-18 20:50:55,424:INFO:   <<< text_aug: True
2024-11-18 20:50:55,424:INFO:   <<< text_aug_choosen: random_swap
2024-11-18 20:50:55,424:INFO:   <<< text_num_hidden_layers: 12
2024-11-18 20:50:55,424:INFO:   <<< train_frame_order: 0
2024-11-18 20:50:55,424:INFO:   <<< use_mil: False
2024-11-18 20:50:55,424:INFO:   <<< video_dim: 1024
2024-11-18 20:50:55,424:INFO:   <<< visual_num_hidden_layers: 12
2024-11-18 20:50:55,424:INFO:   <<< warmup_proportion: 0.1
2024-11-18 20:50:55,424:INFO:   <<< world_size: 1
2024-11-18 20:50:55,424:INFO: device: cuda:0 n_gpu: 1
2024-11-18 20:50:56,343:INFO: loading archive file /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base
2024-11-18 20:50:56,345:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-11-18 20:50:56,345:INFO: Weight doesn't exsits. /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base/cross_pytorch_model.bin
2024-11-18 20:50:56,345:WARNING: Stage-One:True, Stage-Two:False
2024-11-18 20:50:56,345:WARNING: Test retrieval by loose type.
2024-11-18 20:50:56,345:WARNING: 	 embed_dim: 512
2024-11-18 20:50:56,345:WARNING: 	 image_resolution: 224
2024-11-18 20:50:56,345:WARNING: 	 vision_layers: 12
2024-11-18 20:50:56,345:WARNING: 	 vision_width: 768
2024-11-18 20:50:56,345:WARNING: 	 vision_patch_size: 32
2024-11-18 20:50:56,345:WARNING: 	 context_length: 77
2024-11-18 20:50:56,345:WARNING: 	 vocab_size: 49408
2024-11-18 20:50:56,345:WARNING: 	 transformer_width: 512
2024-11-18 20:50:56,345:WARNING: 	 transformer_heads: 8
2024-11-18 20:50:56,345:WARNING: 	 transformer_layers: 12
2024-11-18 20:50:56,346:WARNING: 		 linear_patch: 2d
2024-11-18 20:50:56,346:WARNING: 	 cut_top_layer: 0
2024-11-18 20:50:58,678:WARNING: 	 sim_header: Filip
2024-11-18 20:51:06,779:INFO: --------------------
2024-11-18 20:51:06,783:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-11-18 20:51:06,890:INFO: ***** Running test *****
2024-11-18 20:51:06,890:INFO:   Num examples = 642
2024-11-18 20:51:06,890:INFO:   Batch size = 256
2024-11-18 20:51:06,890:INFO:   Num steps = 3
2024-11-18 20:51:07,172:WARNING: Eval under the multi-sentence per video clip setting.
2024-11-18 20:51:07,172:WARNING: sentence num: 642, video num: 642
2024-11-18 20:51:09,114:INFO: before reshape, sim matrix size: 642 x 642
2024-11-18 20:51:09,183:INFO: after reshape, sim matrix size: 642 x 1 x 642
2024-11-18 20:51:09,347:INFO: Mix_Text-to-Video:
2024-11-18 20:51:09,347:INFO: 	>>>  R@1: 69.5 - R@5: 86.6 - R@10: 92.1 - Median R: 1.0 - Mean R: 5.2
2024-11-18 20:51:09,347:INFO: Mix_Video-to-Text:
2024-11-18 20:51:09,348:INFO: 	>>>  V2T$R@1: 70.1 - V2T$R@5: 87.9 - V2T$R@10: 92.7 - V2T$Median R: 1.0 - V2T$Mean R: 5.8
2024-11-18 20:52:55,908:INFO: Effective parameters:
2024-11-18 20:52:55,909:INFO:   <<< alpha: 0.9
2024-11-18 20:52:55,909:INFO:   <<< aug_choose: t2v
2024-11-18 20:52:55,909:INFO:   <<< batch_size: 512
2024-11-18 20:52:55,909:INFO:   <<< batch_size_val: 256
2024-11-18 20:52:55,909:INFO:   <<< cache_dir: 
2024-11-18 20:52:55,909:INFO:   <<< cla_weight_dir: cla_weight
2024-11-18 20:52:55,909:INFO:   <<< coef_lr: 1.0
2024-11-18 20:52:55,909:INFO:   <<< combine_type: sum
2024-11-18 20:52:55,909:INFO:   <<< cross_att_layers: 1
2024-11-18 20:52:55,909:INFO:   <<< cross_model: cross-base
2024-11-18 20:52:55,909:INFO:   <<< cross_num_hidden_layers: 4
2024-11-18 20:52:55,909:INFO:   <<< data_path: data_ph
2024-11-18 20:52:55,909:INFO:   <<< datatype: ph
2024-11-18 20:52:55,909:INFO:   <<< debug: False
2024-11-18 20:52:55,909:INFO:   <<< distributed: True
2024-11-18 20:52:55,909:INFO:   <<< do_eval: True
2024-11-18 20:52:55,909:INFO:   <<< do_lower_case: False
2024-11-18 20:52:55,909:INFO:   <<< do_pretrain: False
2024-11-18 20:52:55,909:INFO:   <<< do_train: False
2024-11-18 20:52:55,909:INFO:   <<< dual_mix: 0.5
2024-11-18 20:52:55,909:INFO:   <<< epochs: 200
2024-11-18 20:52:55,909:INFO:   <<< eval_frame_order: 0
2024-11-18 20:52:55,909:INFO:   <<< expand_msrvtt_sentences: False
2024-11-18 20:52:55,910:INFO:   <<< feature_framerate: 1
2024-11-18 20:52:55,910:INFO:   <<< feature_len: 64
2024-11-18 20:52:55,910:INFO:   <<< features_path: sign_feature/ph_domain_agnostic
2024-11-18 20:52:55,910:INFO:   <<< features_path_retrain: sign_feature/ph_domain_aware
2024-11-18 20:52:55,910:INFO:   <<< fp16: True
2024-11-18 20:52:55,910:INFO:   <<< fp16_opt_level: O1
2024-11-18 20:52:55,910:INFO:   <<< freeze_layer_num: 0
2024-11-18 20:52:55,910:INFO:   <<< gpu_ids: [0, 1]
2024-11-18 20:52:55,910:INFO:   <<< gradient_accumulation_steps: 1
2024-11-18 20:52:55,910:INFO:   <<< hard_negative_rate: 0.5
2024-11-18 20:52:55,910:INFO:   <<< init_model: chpt/ph_sota.pth
2024-11-18 20:52:55,910:INFO:   <<< linear_patch: 2d
2024-11-18 20:52:55,910:INFO:   <<< local_rank: 0
2024-11-18 20:52:55,910:INFO:   <<< loose_type: True
2024-11-18 20:52:55,910:INFO:   <<< lr: 1e-05
2024-11-18 20:52:55,910:INFO:   <<< lr_decay: 0.001
2024-11-18 20:52:55,910:INFO:   <<< margin: 0.1
2024-11-18 20:52:55,910:INFO:   <<< max_frames: 128
2024-11-18 20:52:55,910:INFO:   <<< max_words: 32
2024-11-18 20:52:55,910:INFO:   <<< mix_design: balance
2024-11-18 20:52:55,910:INFO:   <<< n_display: 1
2024-11-18 20:52:55,910:INFO:   <<< n_gpu: 1
2024-11-18 20:52:55,910:INFO:   <<< n_pair: 1
2024-11-18 20:52:55,910:INFO:   <<< negative_weighting: 1
2024-11-18 20:52:55,910:INFO:   <<< not_load_visual: False
2024-11-18 20:52:55,910:INFO:   <<< num_thread_reader: 8
2024-11-18 20:52:55,910:INFO:   <<< output_dir: new_experiment
2024-11-18 20:52:55,910:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-11-18 20:52:55,910:INFO:   <<< rank: 0
2024-11-18 20:52:55,910:INFO:   <<< resume_model: None
2024-11-18 20:52:55,910:INFO:   <<< sampled_use_mil: False
2024-11-18 20:52:55,911:INFO:   <<< seed: 42
2024-11-18 20:52:55,911:INFO:   <<< sim_calcu: softmax_max
2024-11-18 20:52:55,911:INFO:   <<< sim_header: Filip
2024-11-18 20:52:55,911:INFO:   <<< slice_framepos: 0
2024-11-18 20:52:55,911:INFO:   <<< task_type: retrieval
2024-11-18 20:52:55,911:INFO:   <<< tau: 0.07
2024-11-18 20:52:55,911:INFO:   <<< text_aug: True
2024-11-18 20:52:55,911:INFO:   <<< text_aug_choosen: random_swap
2024-11-18 20:52:55,911:INFO:   <<< text_num_hidden_layers: 12
2024-11-18 20:52:55,911:INFO:   <<< train_frame_order: 0
2024-11-18 20:52:55,911:INFO:   <<< use_mil: False
2024-11-18 20:52:55,911:INFO:   <<< video_dim: 1024
2024-11-18 20:52:55,911:INFO:   <<< visual_num_hidden_layers: 12
2024-11-18 20:52:55,911:INFO:   <<< warmup_proportion: 0.1
2024-11-18 20:52:55,911:INFO:   <<< world_size: 1
2024-11-18 20:52:55,911:INFO: device: cuda:0 n_gpu: 1
2024-11-18 20:52:56,833:INFO: loading archive file /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base
2024-11-18 20:52:56,834:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-11-18 20:52:56,834:INFO: Weight doesn't exsits. /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base/cross_pytorch_model.bin
2024-11-18 20:52:56,834:WARNING: Stage-One:True, Stage-Two:False
2024-11-18 20:52:56,834:WARNING: Test retrieval by loose type.
2024-11-18 20:52:56,835:WARNING: 	 embed_dim: 512
2024-11-18 20:52:56,835:WARNING: 	 image_resolution: 224
2024-11-18 20:52:56,835:WARNING: 	 vision_layers: 12
2024-11-18 20:52:56,835:WARNING: 	 vision_width: 768
2024-11-18 20:52:56,835:WARNING: 	 vision_patch_size: 32
2024-11-18 20:52:56,835:WARNING: 	 context_length: 77
2024-11-18 20:52:56,835:WARNING: 	 vocab_size: 49408
2024-11-18 20:52:56,835:WARNING: 	 transformer_width: 512
2024-11-18 20:52:56,835:WARNING: 	 transformer_heads: 8
2024-11-18 20:52:56,835:WARNING: 	 transformer_layers: 12
2024-11-18 20:52:56,835:WARNING: 		 linear_patch: 2d
2024-11-18 20:52:56,835:WARNING: 	 cut_top_layer: 0
2024-11-18 20:52:59,186:WARNING: 	 sim_header: Filip
2024-11-18 20:53:07,299:INFO: --------------------
2024-11-18 20:53:07,300:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-11-18 20:53:07,462:INFO: ***** Running test *****
2024-11-18 20:53:07,462:INFO:   Num examples = 642
2024-11-18 20:53:07,463:INFO:   Batch size = 256
2024-11-18 20:53:07,463:INFO:   Num steps = 3
2024-11-18 20:53:07,701:WARNING: Eval under the multi-sentence per video clip setting.
2024-11-18 20:53:07,701:WARNING: sentence num: 642, video num: 642
2024-11-18 20:53:09,966:INFO: before reshape, sim matrix size: 642 x 642
2024-11-18 20:53:10,038:INFO: after reshape, sim matrix size: 642 x 1 x 642
2024-11-18 20:53:10,192:INFO: Mix_Text-to-Video:
2024-11-18 20:53:10,192:INFO: 	>>>  R@1: 69.5 - R@5: 86.6 - R@10: 92.1 - Median R: 1.0 - Mean R: 5.2
2024-11-18 20:53:10,192:INFO: Mix_Video-to-Text:
2024-11-18 20:53:10,192:INFO: 	>>>  V2T$R@1: 70.1 - V2T$R@5: 87.9 - V2T$R@10: 92.7 - V2T$Median R: 1.0 - V2T$Mean R: 5.8
2024-11-18 21:03:55,315:INFO: Effective parameters:
2024-11-18 21:03:55,315:INFO:   <<< alpha: 0.9
2024-11-18 21:03:55,315:INFO:   <<< aug_choose: t2v
2024-11-18 21:03:55,315:INFO:   <<< batch_size: 512
2024-11-18 21:03:55,315:INFO:   <<< batch_size_val: 256
2024-11-18 21:03:55,315:INFO:   <<< cache_dir: 
2024-11-18 21:03:55,316:INFO:   <<< cla_weight_dir: cla_weight
2024-11-18 21:03:55,316:INFO:   <<< coef_lr: 1.0
2024-11-18 21:03:55,316:INFO:   <<< combine_type: sum
2024-11-18 21:03:55,316:INFO:   <<< cross_att_layers: 1
2024-11-18 21:03:55,316:INFO:   <<< cross_model: cross-base
2024-11-18 21:03:55,316:INFO:   <<< cross_num_hidden_layers: 4
2024-11-18 21:03:55,316:INFO:   <<< data_path: data_ph
2024-11-18 21:03:55,316:INFO:   <<< datatype: ph
2024-11-18 21:03:55,316:INFO:   <<< debug: False
2024-11-18 21:03:55,316:INFO:   <<< distributed: True
2024-11-18 21:03:55,316:INFO:   <<< do_eval: True
2024-11-18 21:03:55,316:INFO:   <<< do_lower_case: False
2024-11-18 21:03:55,316:INFO:   <<< do_pretrain: False
2024-11-18 21:03:55,316:INFO:   <<< do_train: False
2024-11-18 21:03:55,316:INFO:   <<< dual_mix: 0.5
2024-11-18 21:03:55,316:INFO:   <<< epochs: 200
2024-11-18 21:03:55,316:INFO:   <<< eval_frame_order: 0
2024-11-18 21:03:55,316:INFO:   <<< expand_msrvtt_sentences: False
2024-11-18 21:03:55,316:INFO:   <<< feature_framerate: 1
2024-11-18 21:03:55,316:INFO:   <<< feature_len: 64
2024-11-18 21:03:55,316:INFO:   <<< features_path: sign_feature/ph_domain_agnostic
2024-11-18 21:03:55,316:INFO:   <<< features_path_retrain: sign_feature/ph_domain_aware
2024-11-18 21:03:55,316:INFO:   <<< fp16: True
2024-11-18 21:03:55,316:INFO:   <<< fp16_opt_level: O1
2024-11-18 21:03:55,316:INFO:   <<< freeze_layer_num: 0
2024-11-18 21:03:55,316:INFO:   <<< gpu_ids: [0, 1]
2024-11-18 21:03:55,316:INFO:   <<< gradient_accumulation_steps: 1
2024-11-18 21:03:55,316:INFO:   <<< hard_negative_rate: 0.5
2024-11-18 21:03:55,316:INFO:   <<< init_model: chpt/ph_sota.pth
2024-11-18 21:03:55,316:INFO:   <<< linear_patch: 2d
2024-11-18 21:03:55,316:INFO:   <<< local_rank: 0
2024-11-18 21:03:55,316:INFO:   <<< loose_type: True
2024-11-18 21:03:55,316:INFO:   <<< lr: 1e-05
2024-11-18 21:03:55,317:INFO:   <<< lr_decay: 0.001
2024-11-18 21:03:55,317:INFO:   <<< margin: 0.1
2024-11-18 21:03:55,317:INFO:   <<< max_frames: 128
2024-11-18 21:03:55,317:INFO:   <<< max_words: 32
2024-11-18 21:03:55,317:INFO:   <<< mix_design: balance
2024-11-18 21:03:55,317:INFO:   <<< n_display: 1
2024-11-18 21:03:55,317:INFO:   <<< n_gpu: 1
2024-11-18 21:03:55,317:INFO:   <<< n_pair: 1
2024-11-18 21:03:55,317:INFO:   <<< negative_weighting: 1
2024-11-18 21:03:55,317:INFO:   <<< not_load_visual: False
2024-11-18 21:03:55,317:INFO:   <<< num_thread_reader: 8
2024-11-18 21:03:55,317:INFO:   <<< output_dir: new_experiment
2024-11-18 21:03:55,317:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-11-18 21:03:55,317:INFO:   <<< rank: 0
2024-11-18 21:03:55,317:INFO:   <<< resume_model: None
2024-11-18 21:03:55,317:INFO:   <<< sampled_use_mil: False
2024-11-18 21:03:55,317:INFO:   <<< seed: 42
2024-11-18 21:03:55,317:INFO:   <<< sim_calcu: softmax_max
2024-11-18 21:03:55,317:INFO:   <<< sim_header: Filip
2024-11-18 21:03:55,317:INFO:   <<< slice_framepos: 0
2024-11-18 21:03:55,317:INFO:   <<< task_type: retrieval
2024-11-18 21:03:55,317:INFO:   <<< tau: 0.07
2024-11-18 21:03:55,317:INFO:   <<< text_aug: True
2024-11-18 21:03:55,317:INFO:   <<< text_aug_choosen: random_swap
2024-11-18 21:03:55,317:INFO:   <<< text_num_hidden_layers: 12
2024-11-18 21:03:55,317:INFO:   <<< train_frame_order: 0
2024-11-18 21:03:55,317:INFO:   <<< use_mil: False
2024-11-18 21:03:55,317:INFO:   <<< video_dim: 1024
2024-11-18 21:03:55,317:INFO:   <<< visual_num_hidden_layers: 12
2024-11-18 21:03:55,317:INFO:   <<< warmup_proportion: 0.1
2024-11-18 21:03:55,317:INFO:   <<< world_size: 1
2024-11-18 21:03:55,318:INFO: device: cuda:0 n_gpu: 1
2024-11-18 21:03:56,146:INFO: loading archive file /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base
2024-11-18 21:03:56,147:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-11-18 21:03:56,148:INFO: Weight doesn't exsits. /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base/cross_pytorch_model.bin
2024-11-18 21:03:56,148:WARNING: Stage-One:True, Stage-Two:False
2024-11-18 21:03:56,148:WARNING: Test retrieval by loose type.
2024-11-18 21:03:56,148:WARNING: 	 embed_dim: 512
2024-11-18 21:03:56,148:WARNING: 	 image_resolution: 224
2024-11-18 21:03:56,148:WARNING: 	 vision_layers: 12
2024-11-18 21:03:56,148:WARNING: 	 vision_width: 768
2024-11-18 21:03:56,148:WARNING: 	 vision_patch_size: 32
2024-11-18 21:03:56,149:WARNING: 	 context_length: 77
2024-11-18 21:03:56,149:WARNING: 	 vocab_size: 49408
2024-11-18 21:03:56,149:WARNING: 	 transformer_width: 512
2024-11-18 21:03:56,149:WARNING: 	 transformer_heads: 8
2024-11-18 21:03:56,149:WARNING: 	 transformer_layers: 12
2024-11-18 21:03:56,149:WARNING: 		 linear_patch: 2d
2024-11-18 21:03:56,149:WARNING: 	 cut_top_layer: 0
2024-11-18 21:03:58,669:WARNING: 	 sim_header: Filip
2024-11-18 21:04:06,919:INFO: --------------------
2024-11-18 21:04:06,927:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-11-18 21:04:07,019:INFO: ***** Running test *****
2024-11-18 21:04:07,019:INFO:   Num examples = 642
2024-11-18 21:04:07,019:INFO:   Batch size = 256
2024-11-18 21:04:07,020:INFO:   Num steps = 3
2024-11-18 21:04:08,257:WARNING: Eval under the multi-sentence per video clip setting.
2024-11-18 21:04:08,257:WARNING: sentence num: 642, video num: 642
2024-11-18 21:04:10,658:INFO: before reshape, sim matrix size: 642 x 642
2024-11-18 21:04:10,749:INFO: after reshape, sim matrix size: 642 x 1 x 642
2024-11-18 21:04:10,903:INFO: Mix_Text-to-Video:
2024-11-18 21:04:10,905:INFO: 	>>>  R@1: 69.5 - R@5: 86.6 - R@10: 92.1 - Median R: 1.0 - Mean R: 5.2
2024-11-18 21:04:10,905:INFO: Mix_Video-to-Text:
2024-11-18 21:04:10,905:INFO: 	>>>  V2T$R@1: 70.1 - V2T$R@5: 87.9 - V2T$R@10: 92.7 - V2T$Median R: 1.0 - V2T$Mean R: 5.8
2024-11-18 21:05:03,730:INFO: Effective parameters:
2024-11-18 21:05:03,730:INFO:   <<< alpha: 0.9
2024-11-18 21:05:03,730:INFO:   <<< aug_choose: t2v
2024-11-18 21:05:03,730:INFO:   <<< batch_size: 512
2024-11-18 21:05:03,730:INFO:   <<< batch_size_val: 256
2024-11-18 21:05:03,730:INFO:   <<< cache_dir: 
2024-11-18 21:05:03,730:INFO:   <<< cla_weight_dir: cla_weight
2024-11-18 21:05:03,730:INFO:   <<< coef_lr: 1.0
2024-11-18 21:05:03,730:INFO:   <<< combine_type: sum
2024-11-18 21:05:03,730:INFO:   <<< cross_att_layers: 1
2024-11-18 21:05:03,730:INFO:   <<< cross_model: cross-base
2024-11-18 21:05:03,730:INFO:   <<< cross_num_hidden_layers: 4
2024-11-18 21:05:03,730:INFO:   <<< data_path: data_ph
2024-11-18 21:05:03,731:INFO:   <<< datatype: ph
2024-11-18 21:05:03,731:INFO:   <<< debug: False
2024-11-18 21:05:03,731:INFO:   <<< distributed: True
2024-11-18 21:05:03,731:INFO:   <<< do_eval: True
2024-11-18 21:05:03,731:INFO:   <<< do_lower_case: False
2024-11-18 21:05:03,731:INFO:   <<< do_pretrain: False
2024-11-18 21:05:03,731:INFO:   <<< do_train: False
2024-11-18 21:05:03,731:INFO:   <<< dual_mix: 0.5
2024-11-18 21:05:03,731:INFO:   <<< epochs: 200
2024-11-18 21:05:03,731:INFO:   <<< eval_frame_order: 0
2024-11-18 21:05:03,731:INFO:   <<< expand_msrvtt_sentences: False
2024-11-18 21:05:03,731:INFO:   <<< feature_framerate: 1
2024-11-18 21:05:03,731:INFO:   <<< feature_len: 64
2024-11-18 21:05:03,731:INFO:   <<< features_path: sign_feature/ph_domain_agnostic
2024-11-18 21:05:03,731:INFO:   <<< features_path_retrain: sign_feature/ph_domain_aware
2024-11-18 21:05:03,731:INFO:   <<< fp16: True
2024-11-18 21:05:03,731:INFO:   <<< fp16_opt_level: O1
2024-11-18 21:05:03,731:INFO:   <<< freeze_layer_num: 0
2024-11-18 21:05:03,731:INFO:   <<< gpu_ids: [0, 1]
2024-11-18 21:05:03,731:INFO:   <<< gradient_accumulation_steps: 1
2024-11-18 21:05:03,731:INFO:   <<< hard_negative_rate: 0.5
2024-11-18 21:05:03,731:INFO:   <<< init_model: chpt/ph_sota.pth
2024-11-18 21:05:03,731:INFO:   <<< linear_patch: 2d
2024-11-18 21:05:03,731:INFO:   <<< local_rank: 0
2024-11-18 21:05:03,731:INFO:   <<< loose_type: True
2024-11-18 21:05:03,731:INFO:   <<< lr: 1e-05
2024-11-18 21:05:03,731:INFO:   <<< lr_decay: 0.001
2024-11-18 21:05:03,731:INFO:   <<< margin: 0.1
2024-11-18 21:05:03,731:INFO:   <<< max_frames: 128
2024-11-18 21:05:03,731:INFO:   <<< max_words: 32
2024-11-18 21:05:03,731:INFO:   <<< mix_design: balance
2024-11-18 21:05:03,731:INFO:   <<< n_display: 1
2024-11-18 21:05:03,731:INFO:   <<< n_gpu: 1
2024-11-18 21:05:03,732:INFO:   <<< n_pair: 1
2024-11-18 21:05:03,732:INFO:   <<< negative_weighting: 1
2024-11-18 21:05:03,732:INFO:   <<< not_load_visual: False
2024-11-18 21:05:03,732:INFO:   <<< num_thread_reader: 8
2024-11-18 21:05:03,732:INFO:   <<< output_dir: new_experiment
2024-11-18 21:05:03,732:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-11-18 21:05:03,732:INFO:   <<< rank: 0
2024-11-18 21:05:03,732:INFO:   <<< resume_model: None
2024-11-18 21:05:03,732:INFO:   <<< sampled_use_mil: False
2024-11-18 21:05:03,732:INFO:   <<< seed: 42
2024-11-18 21:05:03,732:INFO:   <<< sim_calcu: softmax_max
2024-11-18 21:05:03,732:INFO:   <<< sim_header: Filip
2024-11-18 21:05:03,732:INFO:   <<< slice_framepos: 0
2024-11-18 21:05:03,732:INFO:   <<< task_type: retrieval
2024-11-18 21:05:03,732:INFO:   <<< tau: 0.07
2024-11-18 21:05:03,732:INFO:   <<< text_aug: True
2024-11-18 21:05:03,732:INFO:   <<< text_aug_choosen: random_swap
2024-11-18 21:05:03,732:INFO:   <<< text_num_hidden_layers: 12
2024-11-18 21:05:03,732:INFO:   <<< train_frame_order: 0
2024-11-18 21:05:03,732:INFO:   <<< use_mil: False
2024-11-18 21:05:03,732:INFO:   <<< video_dim: 1024
2024-11-18 21:05:03,732:INFO:   <<< visual_num_hidden_layers: 12
2024-11-18 21:05:03,732:INFO:   <<< warmup_proportion: 0.1
2024-11-18 21:05:03,732:INFO:   <<< world_size: 1
2024-11-18 21:05:03,732:INFO: device: cuda:0 n_gpu: 1
2024-11-18 21:05:04,780:INFO: loading archive file /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base
2024-11-18 21:05:04,782:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-11-18 21:05:04,782:INFO: Weight doesn't exsits. /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base/cross_pytorch_model.bin
2024-11-18 21:05:04,782:WARNING: Stage-One:True, Stage-Two:False
2024-11-18 21:05:04,782:WARNING: Test retrieval by loose type.
2024-11-18 21:05:04,782:WARNING: 	 embed_dim: 512
2024-11-18 21:05:04,782:WARNING: 	 image_resolution: 224
2024-11-18 21:05:04,782:WARNING: 	 vision_layers: 12
2024-11-18 21:05:04,782:WARNING: 	 vision_width: 768
2024-11-18 21:05:04,782:WARNING: 	 vision_patch_size: 32
2024-11-18 21:05:04,782:WARNING: 	 context_length: 77
2024-11-18 21:05:04,782:WARNING: 	 vocab_size: 49408
2024-11-18 21:05:04,782:WARNING: 	 transformer_width: 512
2024-11-18 21:05:04,782:WARNING: 	 transformer_heads: 8
2024-11-18 21:05:04,783:WARNING: 	 transformer_layers: 12
2024-11-18 21:05:04,783:WARNING: 		 linear_patch: 2d
2024-11-18 21:05:04,783:WARNING: 	 cut_top_layer: 0
2024-11-18 21:05:07,152:WARNING: 	 sim_header: Filip
2024-11-18 21:05:15,224:INFO: --------------------
2024-11-18 21:05:15,226:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-11-18 21:05:15,324:INFO: ***** Running test *****
2024-11-18 21:05:15,324:INFO:   Num examples = 642
2024-11-18 21:05:15,324:INFO:   Batch size = 256
2024-11-18 21:05:15,324:INFO:   Num steps = 3
2024-11-18 21:05:16,088:WARNING: Eval under the multi-sentence per video clip setting.
2024-11-18 21:05:16,088:WARNING: sentence num: 642, video num: 642
2024-11-18 21:05:18,630:INFO: before reshape, sim matrix size: 642 x 642
2024-11-18 21:05:18,715:INFO: after reshape, sim matrix size: 642 x 1 x 642
2024-11-18 21:05:18,872:INFO: Mix_Text-to-Video:
2024-11-18 21:05:18,872:INFO: 	>>>  R@1: 69.5 - R@5: 86.6 - R@10: 92.1 - Median R: 1.0 - Mean R: 5.2
2024-11-18 21:05:18,872:INFO: Mix_Video-to-Text:
2024-11-18 21:05:18,872:INFO: 	>>>  V2T$R@1: 70.1 - V2T$R@5: 87.9 - V2T$R@10: 92.7 - V2T$Median R: 1.0 - V2T$Mean R: 5.8
2024-11-18 21:06:51,279:INFO: Effective parameters:
2024-11-18 21:06:51,279:INFO:   <<< alpha: 0.9
2024-11-18 21:06:51,280:INFO:   <<< aug_choose: t2v
2024-11-18 21:06:51,280:INFO:   <<< batch_size: 512
2024-11-18 21:06:51,280:INFO:   <<< batch_size_val: 256
2024-11-18 21:06:51,280:INFO:   <<< cache_dir: 
2024-11-18 21:06:51,280:INFO:   <<< cla_weight_dir: cla_weight
2024-11-18 21:06:51,280:INFO:   <<< coef_lr: 1.0
2024-11-18 21:06:51,280:INFO:   <<< combine_type: sum
2024-11-18 21:06:51,280:INFO:   <<< cross_att_layers: 1
2024-11-18 21:06:51,280:INFO:   <<< cross_model: cross-base
2024-11-18 21:06:51,280:INFO:   <<< cross_num_hidden_layers: 4
2024-11-18 21:06:51,280:INFO:   <<< data_path: data_ph
2024-11-18 21:06:51,280:INFO:   <<< datatype: ph
2024-11-18 21:06:51,280:INFO:   <<< debug: False
2024-11-18 21:06:51,280:INFO:   <<< distributed: True
2024-11-18 21:06:51,280:INFO:   <<< do_eval: True
2024-11-18 21:06:51,281:INFO:   <<< do_lower_case: False
2024-11-18 21:06:51,281:INFO:   <<< do_pretrain: False
2024-11-18 21:06:51,281:INFO:   <<< do_train: False
2024-11-18 21:06:51,281:INFO:   <<< dual_mix: 0.5
2024-11-18 21:06:51,281:INFO:   <<< epochs: 200
2024-11-18 21:06:51,281:INFO:   <<< eval_frame_order: 0
2024-11-18 21:06:51,281:INFO:   <<< expand_msrvtt_sentences: False
2024-11-18 21:06:51,281:INFO:   <<< feature_framerate: 1
2024-11-18 21:06:51,281:INFO:   <<< feature_len: 64
2024-11-18 21:06:51,281:INFO:   <<< features_path: sign_feature/ph_domain_agnostic
2024-11-18 21:06:51,281:INFO:   <<< features_path_retrain: sign_feature/ph_domain_aware
2024-11-18 21:06:51,281:INFO:   <<< fp16: True
2024-11-18 21:06:51,281:INFO:   <<< fp16_opt_level: O1
2024-11-18 21:06:51,281:INFO:   <<< freeze_layer_num: 0
2024-11-18 21:06:51,281:INFO:   <<< gpu_ids: [0, 1]
2024-11-18 21:06:51,282:INFO:   <<< gradient_accumulation_steps: 1
2024-11-18 21:06:51,282:INFO:   <<< hard_negative_rate: 0.5
2024-11-18 21:06:51,282:INFO:   <<< init_model: chpt/ph_sota.pth
2024-11-18 21:06:51,282:INFO:   <<< linear_patch: 2d
2024-11-18 21:06:51,282:INFO:   <<< local_rank: 0
2024-11-18 21:06:51,282:INFO:   <<< loose_type: True
2024-11-18 21:06:51,282:INFO:   <<< lr: 1e-05
2024-11-18 21:06:51,282:INFO:   <<< lr_decay: 0.001
2024-11-18 21:06:51,282:INFO:   <<< margin: 0.1
2024-11-18 21:06:51,282:INFO:   <<< max_frames: 128
2024-11-18 21:06:51,282:INFO:   <<< max_words: 32
2024-11-18 21:06:51,282:INFO:   <<< mix_design: balance
2024-11-18 21:06:51,282:INFO:   <<< n_display: 1
2024-11-18 21:06:51,282:INFO:   <<< n_gpu: 1
2024-11-18 21:06:51,282:INFO:   <<< n_pair: 1
2024-11-18 21:06:51,282:INFO:   <<< negative_weighting: 1
2024-11-18 21:06:51,283:INFO:   <<< not_load_visual: False
2024-11-18 21:06:51,283:INFO:   <<< num_thread_reader: 8
2024-11-18 21:06:51,283:INFO:   <<< output_dir: new_experiment
2024-11-18 21:06:51,283:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-11-18 21:06:51,283:INFO:   <<< rank: 0
2024-11-18 21:06:51,283:INFO:   <<< resume_model: None
2024-11-18 21:06:51,283:INFO:   <<< sampled_use_mil: False
2024-11-18 21:06:51,283:INFO:   <<< seed: 42
2024-11-18 21:06:51,283:INFO:   <<< sim_calcu: softmax_max
2024-11-18 21:06:51,283:INFO:   <<< sim_header: Filip
2024-11-18 21:06:51,283:INFO:   <<< slice_framepos: 0
2024-11-18 21:06:51,283:INFO:   <<< task_type: retrieval
2024-11-18 21:06:51,283:INFO:   <<< tau: 0.07
2024-11-18 21:06:51,283:INFO:   <<< text_aug: True
2024-11-18 21:06:51,283:INFO:   <<< text_aug_choosen: random_swap
2024-11-18 21:06:51,283:INFO:   <<< text_num_hidden_layers: 12
2024-11-18 21:06:51,284:INFO:   <<< train_frame_order: 0
2024-11-18 21:06:51,284:INFO:   <<< use_mil: False
2024-11-18 21:06:51,284:INFO:   <<< video_dim: 1024
2024-11-18 21:06:51,284:INFO:   <<< visual_num_hidden_layers: 12
2024-11-18 21:06:51,284:INFO:   <<< warmup_proportion: 0.1
2024-11-18 21:06:51,284:INFO:   <<< world_size: 1
2024-11-18 21:06:51,284:INFO: device: cuda:0 n_gpu: 1
2024-11-18 21:06:51,968:INFO: loading archive file /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base
2024-11-18 21:06:51,972:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-11-18 21:06:51,972:INFO: Weight doesn't exsits. /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base/cross_pytorch_model.bin
2024-11-18 21:06:51,972:WARNING: Stage-One:True, Stage-Two:False
2024-11-18 21:06:51,972:WARNING: Test retrieval by loose type.
2024-11-18 21:06:51,973:WARNING: 	 embed_dim: 512
2024-11-18 21:06:51,973:WARNING: 	 image_resolution: 224
2024-11-18 21:06:51,973:WARNING: 	 vision_layers: 12
2024-11-18 21:06:51,973:WARNING: 	 vision_width: 768
2024-11-18 21:06:51,973:WARNING: 	 vision_patch_size: 32
2024-11-18 21:06:51,973:WARNING: 	 context_length: 77
2024-11-18 21:06:51,973:WARNING: 	 vocab_size: 49408
2024-11-18 21:06:51,973:WARNING: 	 transformer_width: 512
2024-11-18 21:06:51,973:WARNING: 	 transformer_heads: 8
2024-11-18 21:06:51,973:WARNING: 	 transformer_layers: 12
2024-11-18 21:06:51,974:WARNING: 		 linear_patch: 2d
2024-11-18 21:06:51,974:WARNING: 	 cut_top_layer: 0
2024-11-18 21:06:54,371:WARNING: 	 sim_header: Filip
2024-11-18 21:07:02,441:INFO: --------------------
2024-11-18 21:07:02,443:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-11-18 21:07:02,501:INFO: ***** Running test *****
2024-11-18 21:07:02,501:INFO:   Num examples = 642
2024-11-18 21:07:02,501:INFO:   Batch size = 256
2024-11-18 21:07:02,501:INFO:   Num steps = 3
2024-11-18 21:07:03,059:WARNING: Eval under the multi-sentence per video clip setting.
2024-11-18 21:07:03,059:WARNING: sentence num: 642, video num: 642
2024-11-18 21:07:05,912:INFO: before reshape, sim matrix size: 642 x 642
2024-11-18 21:07:06,009:INFO: after reshape, sim matrix size: 642 x 1 x 642
2024-11-18 21:07:06,176:INFO: Mix_Text-to-Video:
2024-11-18 21:07:06,176:INFO: 	>>>  R@1: 69.5 - R@5: 86.6 - R@10: 92.1 - Median R: 1.0 - Mean R: 5.2
2024-11-18 21:07:06,177:INFO: Mix_Video-to-Text:
2024-11-18 21:07:06,177:INFO: 	>>>  V2T$R@1: 70.1 - V2T$R@5: 87.9 - V2T$R@10: 92.7 - V2T$Median R: 1.0 - V2T$Mean R: 5.8
2024-11-29 12:29:32,097:INFO: Effective parameters:
2024-11-29 12:29:32,097:INFO:   <<< alpha: 0.9
2024-11-29 12:29:32,097:INFO:   <<< aug_choose: t2v
2024-11-29 12:29:32,097:INFO:   <<< batch_size: 512
2024-11-29 12:29:32,097:INFO:   <<< batch_size_val: 256
2024-11-29 12:29:32,098:INFO:   <<< cache_dir: 
2024-11-29 12:29:32,098:INFO:   <<< cla_weight_dir: cla_weight
2024-11-29 12:29:32,098:INFO:   <<< coef_lr: 1.0
2024-11-29 12:29:32,098:INFO:   <<< combine_type: sum
2024-11-29 12:29:32,098:INFO:   <<< cross_att_layers: 1
2024-11-29 12:29:32,098:INFO:   <<< cross_model: cross-base
2024-11-29 12:29:32,098:INFO:   <<< cross_num_hidden_layers: 4
2024-11-29 12:29:32,098:INFO:   <<< data_path: data_ph
2024-11-29 12:29:32,098:INFO:   <<< datatype: ph
2024-11-29 12:29:32,098:INFO:   <<< debug: False
2024-11-29 12:29:32,098:INFO:   <<< distributed: True
2024-11-29 12:29:32,098:INFO:   <<< do_eval: True
2024-11-29 12:29:32,098:INFO:   <<< do_lower_case: False
2024-11-29 12:29:32,098:INFO:   <<< do_pretrain: False
2024-11-29 12:29:32,098:INFO:   <<< do_train: False
2024-11-29 12:29:32,098:INFO:   <<< dual_mix: 0.5
2024-11-29 12:29:32,098:INFO:   <<< epochs: 200
2024-11-29 12:29:32,098:INFO:   <<< eval_frame_order: 0
2024-11-29 12:29:32,098:INFO:   <<< expand_msrvtt_sentences: False
2024-11-29 12:29:32,098:INFO:   <<< feature_framerate: 1
2024-11-29 12:29:32,098:INFO:   <<< feature_len: 64
2024-11-29 12:29:32,098:INFO:   <<< features_path: sign_feature/ph_domain_agnostic
2024-11-29 12:29:32,098:INFO:   <<< features_path_retrain: sign_feature/ph_domain_aware
2024-11-29 12:29:32,098:INFO:   <<< fp16: True
2024-11-29 12:29:32,098:INFO:   <<< fp16_opt_level: O1
2024-11-29 12:29:32,098:INFO:   <<< freeze_layer_num: 0
2024-11-29 12:29:32,098:INFO:   <<< gpu_ids: [0, 1]
2024-11-29 12:29:32,098:INFO:   <<< gradient_accumulation_steps: 1
2024-11-29 12:29:32,098:INFO:   <<< hard_negative_rate: 0.5
2024-11-29 12:29:32,098:INFO:   <<< init_model: chpt/ph_sota.pth
2024-11-29 12:29:32,098:INFO:   <<< linear_patch: 2d
2024-11-29 12:29:32,098:INFO:   <<< local_rank: 0
2024-11-29 12:29:32,099:INFO:   <<< loose_type: True
2024-11-29 12:29:32,099:INFO:   <<< lr: 1e-05
2024-11-29 12:29:32,099:INFO:   <<< lr_decay: 0.001
2024-11-29 12:29:32,099:INFO:   <<< margin: 0.1
2024-11-29 12:29:32,099:INFO:   <<< max_frames: 128
2024-11-29 12:29:32,099:INFO:   <<< max_words: 32
2024-11-29 12:29:32,099:INFO:   <<< mix_design: balance
2024-11-29 12:29:32,099:INFO:   <<< n_display: 1
2024-11-29 12:29:32,099:INFO:   <<< n_gpu: 1
2024-11-29 12:29:32,099:INFO:   <<< n_pair: 1
2024-11-29 12:29:32,099:INFO:   <<< negative_weighting: 1
2024-11-29 12:29:32,099:INFO:   <<< not_load_visual: False
2024-11-29 12:29:32,099:INFO:   <<< num_thread_reader: 8
2024-11-29 12:29:32,099:INFO:   <<< output_dir: new_experiment
2024-11-29 12:29:32,099:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-11-29 12:29:32,099:INFO:   <<< rank: 0
2024-11-29 12:29:32,099:INFO:   <<< resume_model: None
2024-11-29 12:29:32,099:INFO:   <<< sampled_use_mil: False
2024-11-29 12:29:32,099:INFO:   <<< seed: 42
2024-11-29 12:29:32,099:INFO:   <<< sim_calcu: softmax_max
2024-11-29 12:29:32,099:INFO:   <<< sim_header: Filip
2024-11-29 12:29:32,099:INFO:   <<< slice_framepos: 0
2024-11-29 12:29:32,099:INFO:   <<< task_type: retrieval
2024-11-29 12:29:32,099:INFO:   <<< tau: 0.07
2024-11-29 12:29:32,099:INFO:   <<< text_aug: True
2024-11-29 12:29:32,099:INFO:   <<< text_aug_choosen: random_swap
2024-11-29 12:29:32,099:INFO:   <<< text_num_hidden_layers: 12
2024-11-29 12:29:32,099:INFO:   <<< train_frame_order: 0
2024-11-29 12:29:32,099:INFO:   <<< use_mil: False
2024-11-29 12:29:32,099:INFO:   <<< video_dim: 1024
2024-11-29 12:29:32,099:INFO:   <<< visual_num_hidden_layers: 12
2024-11-29 12:29:32,099:INFO:   <<< warmup_proportion: 0.1
2024-11-29 12:29:32,099:INFO:   <<< world_size: 1
2024-11-29 12:29:32,100:INFO: device: cuda:0 n_gpu: 1
2024-11-29 12:29:33,313:INFO: loading archive file /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base
2024-11-29 12:29:33,316:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-11-29 12:29:33,317:INFO: Weight doesn't exsits. /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base/cross_pytorch_model.bin
2024-11-29 12:29:33,317:WARNING: Stage-One:True, Stage-Two:False
2024-11-29 12:29:33,317:WARNING: Test retrieval by loose type.
2024-11-29 12:29:33,317:WARNING: 	 embed_dim: 512
2024-11-29 12:29:33,317:WARNING: 	 image_resolution: 224
2024-11-29 12:29:33,317:WARNING: 	 vision_layers: 12
2024-11-29 12:29:33,317:WARNING: 	 vision_width: 768
2024-11-29 12:29:33,317:WARNING: 	 vision_patch_size: 32
2024-11-29 12:29:33,317:WARNING: 	 context_length: 77
2024-11-29 12:29:33,317:WARNING: 	 vocab_size: 49408
2024-11-29 12:29:33,317:WARNING: 	 transformer_width: 512
2024-11-29 12:29:33,317:WARNING: 	 transformer_heads: 8
2024-11-29 12:29:33,317:WARNING: 	 transformer_layers: 12
2024-11-29 12:29:33,318:WARNING: 		 linear_patch: 2d
2024-11-29 12:29:33,318:WARNING: 	 cut_top_layer: 0
2024-11-29 12:29:35,389:WARNING: 	 sim_header: Filip
2024-11-29 12:29:43,369:INFO: --------------------
2024-11-29 12:29:43,371:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-11-29 12:29:43,435:INFO: ***** Running test *****
2024-11-29 12:29:43,435:INFO:   Num examples = 642
2024-11-29 12:29:43,435:INFO:   Batch size = 256
2024-11-29 12:29:43,435:INFO:   Num steps = 3
2024-11-29 12:29:43,742:WARNING: Eval under the multi-sentence per video clip setting.
2024-11-29 12:29:43,742:WARNING: sentence num: 642, video num: 642
2024-11-29 12:30:40,950:INFO: Effective parameters:
2024-11-29 12:30:40,950:INFO:   <<< alpha: 0.9
2024-11-29 12:30:40,950:INFO:   <<< aug_choose: t2v
2024-11-29 12:30:40,950:INFO:   <<< batch_size: 512
2024-11-29 12:30:40,950:INFO:   <<< batch_size_val: 256
2024-11-29 12:30:40,950:INFO:   <<< cache_dir: 
2024-11-29 12:30:40,950:INFO:   <<< cla_weight_dir: cla_weight
2024-11-29 12:30:40,950:INFO:   <<< coef_lr: 1.0
2024-11-29 12:30:40,950:INFO:   <<< combine_type: sum
2024-11-29 12:30:40,950:INFO:   <<< cross_att_layers: 1
2024-11-29 12:30:40,950:INFO:   <<< cross_model: cross-base
2024-11-29 12:30:40,950:INFO:   <<< cross_num_hidden_layers: 4
2024-11-29 12:30:40,950:INFO:   <<< data_path: data_ph
2024-11-29 12:30:40,950:INFO:   <<< datatype: ph
2024-11-29 12:30:40,950:INFO:   <<< debug: False
2024-11-29 12:30:40,950:INFO:   <<< distributed: True
2024-11-29 12:30:40,950:INFO:   <<< do_eval: True
2024-11-29 12:30:40,950:INFO:   <<< do_lower_case: False
2024-11-29 12:30:40,950:INFO:   <<< do_pretrain: False
2024-11-29 12:30:40,950:INFO:   <<< do_train: False
2024-11-29 12:30:40,950:INFO:   <<< dual_mix: 0.5
2024-11-29 12:30:40,950:INFO:   <<< epochs: 200
2024-11-29 12:30:40,951:INFO:   <<< eval_frame_order: 0
2024-11-29 12:30:40,951:INFO:   <<< expand_msrvtt_sentences: False
2024-11-29 12:30:40,951:INFO:   <<< feature_framerate: 1
2024-11-29 12:30:40,951:INFO:   <<< feature_len: 64
2024-11-29 12:30:40,951:INFO:   <<< features_path: sign_feature/ph_domain_agnostic
2024-11-29 12:30:40,951:INFO:   <<< features_path_retrain: sign_feature/ph_domain_aware
2024-11-29 12:30:40,951:INFO:   <<< fp16: True
2024-11-29 12:30:40,951:INFO:   <<< fp16_opt_level: O1
2024-11-29 12:30:40,951:INFO:   <<< freeze_layer_num: 0
2024-11-29 12:30:40,951:INFO:   <<< gpu_ids: [0, 1]
2024-11-29 12:30:40,951:INFO:   <<< gradient_accumulation_steps: 1
2024-11-29 12:30:40,951:INFO:   <<< hard_negative_rate: 0.5
2024-11-29 12:30:40,951:INFO:   <<< init_model: chpt/ph_sota.pth
2024-11-29 12:30:40,951:INFO:   <<< linear_patch: 2d
2024-11-29 12:30:40,951:INFO:   <<< local_rank: 0
2024-11-29 12:30:40,951:INFO:   <<< loose_type: True
2024-11-29 12:30:40,951:INFO:   <<< lr: 1e-05
2024-11-29 12:30:40,951:INFO:   <<< lr_decay: 0.001
2024-11-29 12:30:40,951:INFO:   <<< margin: 0.1
2024-11-29 12:30:40,951:INFO:   <<< max_frames: 128
2024-11-29 12:30:40,951:INFO:   <<< max_words: 32
2024-11-29 12:30:40,951:INFO:   <<< mix_design: balance
2024-11-29 12:30:40,951:INFO:   <<< n_display: 1
2024-11-29 12:30:40,951:INFO:   <<< n_gpu: 1
2024-11-29 12:30:40,951:INFO:   <<< n_pair: 1
2024-11-29 12:30:40,951:INFO:   <<< negative_weighting: 1
2024-11-29 12:30:40,951:INFO:   <<< not_load_visual: False
2024-11-29 12:30:40,951:INFO:   <<< num_thread_reader: 8
2024-11-29 12:30:40,951:INFO:   <<< output_dir: new_experiment
2024-11-29 12:30:40,951:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-11-29 12:30:40,951:INFO:   <<< rank: 0
2024-11-29 12:30:40,951:INFO:   <<< resume_model: None
2024-11-29 12:30:40,951:INFO:   <<< sampled_use_mil: False
2024-11-29 12:30:40,952:INFO:   <<< seed: 42
2024-11-29 12:30:40,952:INFO:   <<< sim_calcu: softmax_max
2024-11-29 12:30:40,952:INFO:   <<< sim_header: Filip
2024-11-29 12:30:40,952:INFO:   <<< slice_framepos: 0
2024-11-29 12:30:40,952:INFO:   <<< task_type: retrieval
2024-11-29 12:30:40,952:INFO:   <<< tau: 0.07
2024-11-29 12:30:40,952:INFO:   <<< text_aug: True
2024-11-29 12:30:40,952:INFO:   <<< text_aug_choosen: random_swap
2024-11-29 12:30:40,952:INFO:   <<< text_num_hidden_layers: 12
2024-11-29 12:30:40,952:INFO:   <<< train_frame_order: 0
2024-11-29 12:30:40,952:INFO:   <<< use_mil: False
2024-11-29 12:30:40,952:INFO:   <<< video_dim: 1024
2024-11-29 12:30:40,952:INFO:   <<< visual_num_hidden_layers: 12
2024-11-29 12:30:40,952:INFO:   <<< warmup_proportion: 0.1
2024-11-29 12:30:40,952:INFO:   <<< world_size: 1
2024-11-29 12:30:40,952:INFO: device: cuda:0 n_gpu: 1
2024-11-29 12:30:41,586:INFO: loading archive file /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base
2024-11-29 12:30:41,589:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-11-29 12:30:41,589:INFO: Weight doesn't exsits. /home/imai.s/SLRT/CiCo/CLCL/modules/cross-base/cross_pytorch_model.bin
2024-11-29 12:30:41,589:WARNING: Stage-One:True, Stage-Two:False
2024-11-29 12:30:41,589:WARNING: Test retrieval by loose type.
2024-11-29 12:30:41,589:WARNING: 	 embed_dim: 512
2024-11-29 12:30:41,590:WARNING: 	 image_resolution: 224
2024-11-29 12:30:41,590:WARNING: 	 vision_layers: 12
2024-11-29 12:30:41,590:WARNING: 	 vision_width: 768
2024-11-29 12:30:41,590:WARNING: 	 vision_patch_size: 32
2024-11-29 12:30:41,590:WARNING: 	 context_length: 77
2024-11-29 12:30:41,590:WARNING: 	 vocab_size: 49408
2024-11-29 12:30:41,590:WARNING: 	 transformer_width: 512
2024-11-29 12:30:41,590:WARNING: 	 transformer_heads: 8
2024-11-29 12:30:41,590:WARNING: 	 transformer_layers: 12
2024-11-29 12:30:41,590:WARNING: 		 linear_patch: 2d
2024-11-29 12:30:41,590:WARNING: 	 cut_top_layer: 0
2024-11-29 12:30:43,920:WARNING: 	 sim_header: Filip
2024-11-29 12:30:50,850:INFO: --------------------
2024-11-29 12:30:50,851:INFO: Weights from pretrained model not used in CLIP4Clip: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-11-29 12:30:50,911:INFO: ***** Running test *****
2024-11-29 12:30:50,911:INFO:   Num examples = 642
2024-11-29 12:30:50,911:INFO:   Batch size = 256
2024-11-29 12:30:50,911:INFO:   Num steps = 3
2024-11-29 12:30:51,209:WARNING: Eval under the multi-sentence per video clip setting.
2024-11-29 12:30:51,209:WARNING: sentence num: 642, video num: 642
2024-11-29 12:30:52,597:INFO: before reshape, sim matrix size: 642 x 642
2024-11-29 12:30:52,678:INFO: after reshape, sim matrix size: 642 x 1 x 642
2024-11-29 12:30:52,823:INFO: Mix_Text-to-Video:
2024-11-29 12:30:52,823:INFO: 	>>>  R@1: 69.5 - R@5: 86.6 - R@10: 92.1 - Median R: 1.0 - Mean R: 5.2
2024-11-29 12:30:52,823:INFO: Mix_Video-to-Text:
2024-11-29 12:30:52,823:INFO: 	>>>  V2T$R@1: 70.1 - V2T$R@5: 87.9 - V2T$R@10: 92.7 - V2T$Median R: 1.0 - V2T$Mean R: 5.8
